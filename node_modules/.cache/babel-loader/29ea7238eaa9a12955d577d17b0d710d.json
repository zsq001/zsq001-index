{"remainingRequest":"/home/zsq001/code/zsq001-index/node_modules/thread-loader/dist/cjs.js!/home/zsq001/code/zsq001-index/node_modules/babel-loader/lib/index.js!/home/zsq001/code/zsq001-index/node_modules/eslint-loader/index.js??ref--13-0!/home/zsq001/code/zsq001-index/src/assets/js/mdui.js","dependencies":[{"path":"/home/zsq001/code/zsq001-index/src/assets/js/mdui.js","mtime":1603951420000},{"path":"/home/zsq001/code/zsq001-index/node_modules/cache-loader/dist/cjs.js","mtime":1614866055024},{"path":"/home/zsq001/code/zsq001-index/node_modules/thread-loader/dist/cjs.js","mtime":1614866066850},{"path":"/home/zsq001/code/zsq001-index/node_modules/babel-loader/lib/index.js","mtime":1615356859313},{"path":"/home/zsq001/code/zsq001-index/node_modules/eslint-loader/index.js","mtime":1614866087130}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyohCiAqIG1kdWkgMS4wLjEgKGh0dHBzOi8vbWR1aS5vcmcpCiAqIENvcHlyaWdodCAyMDE2LTIwMjAgemRoeGlvbmcKICogTGljZW5zZWQgdW5kZXIgTUlUCiAqLwooZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkgewogIHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyA/IG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpIDogdHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKGZhY3RvcnkpIDogKGdsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiBnbG9iYWwgfHwgc2VsZiwgZ2xvYmFsLm1kdWkgPSBmYWN0b3J5KCkpOwp9KSh0aGlzLCBmdW5jdGlvbiAoKSB7CiAgJ3VzZSBzdHJpY3QnOwoKICAhZnVuY3Rpb24gKCkgewogICAgdHJ5IHsKICAgICAgcmV0dXJuIG5ldyBNb3VzZUV2ZW50KCJ0ZXN0Iik7CiAgICB9IGNhdGNoIChlJDEpIHt9CgogICAgdmFyIGUgPSBmdW5jdGlvbiAoZSwgdCkgewogICAgICB0ID0gdCB8fCB7CiAgICAgICAgYnViYmxlczogITEsCiAgICAgICAgY2FuY2VsYWJsZTogITEKICAgICAgfTsKICAgICAgdmFyIG4gPSBkb2N1bWVudC5jcmVhdGVFdmVudCgiTW91c2VFdmVudCIpOwogICAgICByZXR1cm4gbi5pbml0TW91c2VFdmVudChlLCB0LmJ1YmJsZXMsIHQuY2FuY2VsYWJsZSwgd2luZG93LCAwLCB0LnNjcmVlblggfHwgMCwgdC5zY3JlZW5ZIHx8IDAsIHQuY2xpZW50WCB8fCAwLCB0LmNsaWVudFkgfHwgMCwgdC5jdHJsS2V5IHx8ICExLCB0LmFsdEtleSB8fCAhMSwgdC5zaGlmdEtleSB8fCAhMSwgdC5tZXRhS2V5IHx8ICExLCB0LmJ1dHRvbiB8fCAwLCB0LnJlbGF0ZWRUYXJnZXQgfHwgbnVsbCksIG47CiAgICB9OwoKICAgIGUucHJvdG90eXBlID0gRXZlbnQucHJvdG90eXBlLCB3aW5kb3cuTW91c2VFdmVudCA9IGU7CiAgfSgpOwogICFmdW5jdGlvbiAoKSB7CiAgICBmdW5jdGlvbiB0KHQsIGUpIHsKICAgICAgZSA9IGUgfHwgewogICAgICAgIGJ1YmJsZXM6ICExLAogICAgICAgIGNhbmNlbGFibGU6ICExLAogICAgICAgIGRldGFpbDogdm9pZCAwCiAgICAgIH07CiAgICAgIHZhciBuID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoIkN1c3RvbUV2ZW50Iik7CiAgICAgIHJldHVybiBuLmluaXRDdXN0b21FdmVudCh0LCBlLmJ1YmJsZXMsIGUuY2FuY2VsYWJsZSwgZS5kZXRhaWwpLCBuOwogICAgfQoKICAgICJmdW5jdGlvbiIgIT0gdHlwZW9mIHdpbmRvdy5DdXN0b21FdmVudCAmJiAodC5wcm90b3R5cGUgPSB3aW5kb3cuRXZlbnQucHJvdG90eXBlLCB3aW5kb3cuQ3VzdG9tRXZlbnQgPSB0KTsKICB9KCk7CiAgLyoqCiAgICogQHRoaXMge1Byb21pc2V9CiAgICovCgogIGZ1bmN0aW9uIGZpbmFsbHlDb25zdHJ1Y3RvcihjYWxsYmFjaykgewogICAgdmFyIGNvbnN0cnVjdG9yID0gdGhpcy5jb25zdHJ1Y3RvcjsKICAgIHJldHVybiB0aGlzLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yLnJlc29sdmUoY2FsbGJhY2soKSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICB9KTsKICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgLy8gQHRzLWlnbm9yZQogICAgICByZXR1cm4gY29uc3RydWN0b3IucmVzb2x2ZShjYWxsYmFjaygpKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yLnJlamVjdChyZWFzb24pOwogICAgICB9KTsKICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gYWxsU2V0dGxlZChhcnIpIHsKICAgIHZhciBQID0gdGhpczsKICAgIHJldHVybiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIGlmICghKGFyciAmJiB0eXBlb2YgYXJyLmxlbmd0aCAhPT0gJ3VuZGVmaW5lZCcpKSB7CiAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgVHlwZUVycm9yKHR5cGVvZiBhcnIgKyAnICcgKyBhcnIgKyAnIGlzIG5vdCBpdGVyYWJsZShjYW5ub3QgcmVhZCBwcm9wZXJ0eSBTeW1ib2woU3ltYm9sLml0ZXJhdG9yKSknKSk7CiAgICAgIH0KCiAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKTsKCiAgICAgIGlmIChhcmdzLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiByZXNvbHZlKFtdKTsKICAgICAgfQoKICAgICAgdmFyIHJlbWFpbmluZyA9IGFyZ3MubGVuZ3RoOwoKICAgICAgZnVuY3Rpb24gcmVzKGksIHZhbCkgewogICAgICAgIGlmICh2YWwgJiYgKHR5cGVvZiB2YWwgPT09ICdvYmplY3QnIHx8IHR5cGVvZiB2YWwgPT09ICdmdW5jdGlvbicpKSB7CiAgICAgICAgICB2YXIgdGhlbiA9IHZhbC50aGVuOwoKICAgICAgICAgIGlmICh0eXBlb2YgdGhlbiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICB0aGVuLmNhbGwodmFsLCBmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICAgICAgcmVzKGksIHZhbCk7CiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgYXJnc1tpXSA9IHsKICAgICAgICAgICAgICAgIHN0YXR1czogJ3JlamVjdGVkJywKICAgICAgICAgICAgICAgIHJlYXNvbjogZQogICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgIGlmICgtLXJlbWFpbmluZyA9PT0gMCkgewogICAgICAgICAgICAgICAgcmVzb2x2ZShhcmdzKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBhcmdzW2ldID0gewogICAgICAgICAgc3RhdHVzOiAnZnVsZmlsbGVkJywKICAgICAgICAgIHZhbHVlOiB2YWwKICAgICAgICB9OwoKICAgICAgICBpZiAoLS1yZW1haW5pbmcgPT09IDApIHsKICAgICAgICAgIHJlc29sdmUoYXJncyk7CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICByZXMoaSwgYXJnc1tpXSk7CiAgICAgIH0KICAgIH0pOwogIH0gLy8gU3RvcmUgc2V0VGltZW91dCByZWZlcmVuY2Ugc28gcHJvbWlzZS1wb2x5ZmlsbCB3aWxsIGJlIHVuYWZmZWN0ZWQgYnkKICAvLyBvdGhlciBjb2RlIG1vZGlmeWluZyBzZXRUaW1lb3V0IChsaWtlIHNpbm9uLnVzZUZha2VUaW1lcnMoKSkKCgogIHZhciBzZXRUaW1lb3V0RnVuYyA9IHNldFRpbWVvdXQ7CgogIGZ1bmN0aW9uIGlzQXJyYXkoeCkgewogICAgcmV0dXJuIEJvb2xlYW4oeCAmJiB0eXBlb2YgeC5sZW5ndGggIT09ICd1bmRlZmluZWQnKTsKICB9CgogIGZ1bmN0aW9uIG5vb3AoKSB7fSAvLyBQb2x5ZmlsbCBmb3IgRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQKCgogIGZ1bmN0aW9uIGJpbmQoZm4sIHRoaXNBcmcpIHsKICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgIGZuLmFwcGx5KHRoaXNBcmcsIGFyZ3VtZW50cyk7CiAgICB9OwogIH0KICAvKioKICAgKiBAY29uc3RydWN0b3IKICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbgogICAqLwoKCiAgZnVuY3Rpb24gUHJvbWlzZSQxKGZuKSB7CiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUHJvbWlzZSQxKSkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdQcm9taXNlcyBtdXN0IGJlIGNvbnN0cnVjdGVkIHZpYSBuZXcnKTsKICAgIH0KCiAgICBpZiAodHlwZW9mIGZuICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ25vdCBhIGZ1bmN0aW9uJyk7CiAgICB9CiAgICAvKiogQHR5cGUgeyFudW1iZXJ9ICovCgoKICAgIHRoaXMuX3N0YXRlID0gMDsKICAgIC8qKiBAdHlwZSB7IWJvb2xlYW59ICovCgogICAgdGhpcy5faGFuZGxlZCA9IGZhbHNlOwogICAgLyoqIEB0eXBlIHtQcm9taXNlfHVuZGVmaW5lZH0gKi8KCiAgICB0aGlzLl92YWx1ZSA9IHVuZGVmaW5lZDsKICAgIC8qKiBAdHlwZSB7IUFycmF5PCFGdW5jdGlvbj59ICovCgogICAgdGhpcy5fZGVmZXJyZWRzID0gW107CiAgICBkb1Jlc29sdmUoZm4sIHRoaXMpOwogIH0KCiAgZnVuY3Rpb24gaGFuZGxlKHNlbGYsIGRlZmVycmVkKSB7CiAgICB3aGlsZSAoc2VsZi5fc3RhdGUgPT09IDMpIHsKICAgICAgc2VsZiA9IHNlbGYuX3ZhbHVlOwogICAgfQoKICAgIGlmIChzZWxmLl9zdGF0ZSA9PT0gMCkgewogICAgICBzZWxmLl9kZWZlcnJlZHMucHVzaChkZWZlcnJlZCk7CgogICAgICByZXR1cm47CiAgICB9CgogICAgc2VsZi5faGFuZGxlZCA9IHRydWU7CgogICAgUHJvbWlzZSQxLl9pbW1lZGlhdGVGbihmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBjYiA9IHNlbGYuX3N0YXRlID09PSAxID8gZGVmZXJyZWQub25GdWxmaWxsZWQgOiBkZWZlcnJlZC5vblJlamVjdGVkOwoKICAgICAgaWYgKGNiID09PSBudWxsKSB7CiAgICAgICAgKHNlbGYuX3N0YXRlID09PSAxID8gcmVzb2x2ZSA6IHJlamVjdCkoZGVmZXJyZWQucHJvbWlzZSwgc2VsZi5fdmFsdWUpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHJldDsKCiAgICAgIHRyeSB7CiAgICAgICAgcmV0ID0gY2Ioc2VsZi5fdmFsdWUpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgcmVqZWN0KGRlZmVycmVkLnByb21pc2UsIGUpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgcmVzb2x2ZShkZWZlcnJlZC5wcm9taXNlLCByZXQpOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiByZXNvbHZlKHNlbGYsIG5ld1ZhbHVlKSB7CiAgICB0cnkgewogICAgICAvLyBQcm9taXNlIFJlc29sdXRpb24gUHJvY2VkdXJlOiBodHRwczovL2dpdGh1Yi5jb20vcHJvbWlzZXMtYXBsdXMvcHJvbWlzZXMtc3BlYyN0aGUtcHJvbWlzZS1yZXNvbHV0aW9uLXByb2NlZHVyZQogICAgICBpZiAobmV3VmFsdWUgPT09IHNlbGYpIHsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBIHByb21pc2UgY2Fubm90IGJlIHJlc29sdmVkIHdpdGggaXRzZWxmLicpOwogICAgICB9CgogICAgICBpZiAobmV3VmFsdWUgJiYgKHR5cGVvZiBuZXdWYWx1ZSA9PT0gJ29iamVjdCcgfHwgdHlwZW9mIG5ld1ZhbHVlID09PSAnZnVuY3Rpb24nKSkgewogICAgICAgIHZhciB0aGVuID0gbmV3VmFsdWUudGhlbjsKCiAgICAgICAgaWYgKG5ld1ZhbHVlIGluc3RhbmNlb2YgUHJvbWlzZSQxKSB7CiAgICAgICAgICBzZWxmLl9zdGF0ZSA9IDM7CiAgICAgICAgICBzZWxmLl92YWx1ZSA9IG5ld1ZhbHVlOwogICAgICAgICAgZmluYWxlKHNlbGYpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoZW4gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIGRvUmVzb2x2ZShiaW5kKHRoZW4sIG5ld1ZhbHVlKSwgc2VsZik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CgogICAgICBzZWxmLl9zdGF0ZSA9IDE7CiAgICAgIHNlbGYuX3ZhbHVlID0gbmV3VmFsdWU7CiAgICAgIGZpbmFsZShzZWxmKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgcmVqZWN0KHNlbGYsIGUpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcmVqZWN0KHNlbGYsIG5ld1ZhbHVlKSB7CiAgICBzZWxmLl9zdGF0ZSA9IDI7CiAgICBzZWxmLl92YWx1ZSA9IG5ld1ZhbHVlOwogICAgZmluYWxlKHNlbGYpOwogIH0KCiAgZnVuY3Rpb24gZmluYWxlKHNlbGYpIHsKICAgIGlmIChzZWxmLl9zdGF0ZSA9PT0gMiAmJiBzZWxmLl9kZWZlcnJlZHMubGVuZ3RoID09PSAwKSB7CiAgICAgIFByb21pc2UkMS5faW1tZWRpYXRlRm4oZnVuY3Rpb24gKCkgewogICAgICAgIGlmICghc2VsZi5faGFuZGxlZCkgewogICAgICAgICAgUHJvbWlzZSQxLl91bmhhbmRsZWRSZWplY3Rpb25GbihzZWxmLl92YWx1ZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gc2VsZi5fZGVmZXJyZWRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgIGhhbmRsZShzZWxmLCBzZWxmLl9kZWZlcnJlZHNbaV0pOwogICAgfQoKICAgIHNlbGYuX2RlZmVycmVkcyA9IG51bGw7CiAgfQogIC8qKgogICAqIEBjb25zdHJ1Y3RvcgogICAqLwoKCiAgZnVuY3Rpb24gSGFuZGxlcihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCwgcHJvbWlzZSkgewogICAgdGhpcy5vbkZ1bGZpbGxlZCA9IHR5cGVvZiBvbkZ1bGZpbGxlZCA9PT0gJ2Z1bmN0aW9uJyA/IG9uRnVsZmlsbGVkIDogbnVsbDsKICAgIHRoaXMub25SZWplY3RlZCA9IHR5cGVvZiBvblJlamVjdGVkID09PSAnZnVuY3Rpb24nID8gb25SZWplY3RlZCA6IG51bGw7CiAgICB0aGlzLnByb21pc2UgPSBwcm9taXNlOwogIH0KICAvKioKICAgKiBUYWtlIGEgcG90ZW50aWFsbHkgbWlzYmVoYXZpbmcgcmVzb2x2ZXIgZnVuY3Rpb24gYW5kIG1ha2Ugc3VyZQogICAqIG9uRnVsZmlsbGVkIGFuZCBvblJlamVjdGVkIGFyZSBvbmx5IGNhbGxlZCBvbmNlLgogICAqCiAgICogTWFrZXMgbm8gZ3VhcmFudGVlcyBhYm91dCBhc3luY2hyb255LgogICAqLwoKCiAgZnVuY3Rpb24gZG9SZXNvbHZlKGZuLCBzZWxmKSB7CiAgICB2YXIgZG9uZSA9IGZhbHNlOwoKICAgIHRyeSB7CiAgICAgIGZuKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIGlmIChkb25lKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBkb25lID0gdHJ1ZTsKICAgICAgICByZXNvbHZlKHNlbGYsIHZhbHVlKTsKICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgIGlmIChkb25lKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBkb25lID0gdHJ1ZTsKICAgICAgICByZWplY3Qoc2VsZiwgcmVhc29uKTsKICAgICAgfSk7CiAgICB9IGNhdGNoIChleCkgewogICAgICBpZiAoZG9uZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgZG9uZSA9IHRydWU7CiAgICAgIHJlamVjdChzZWxmLCBleCk7CiAgICB9CiAgfQoKICBQcm9taXNlJDEucHJvdG90eXBlWydjYXRjaCddID0gZnVuY3Rpb24gKG9uUmVqZWN0ZWQpIHsKICAgIHJldHVybiB0aGlzLnRoZW4obnVsbCwgb25SZWplY3RlZCk7CiAgfTsKCiAgUHJvbWlzZSQxLnByb3RvdHlwZS50aGVuID0gZnVuY3Rpb24gKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkKSB7CiAgICAvLyBAdHMtaWdub3JlCiAgICB2YXIgcHJvbSA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKG5vb3ApOwogICAgaGFuZGxlKHRoaXMsIG5ldyBIYW5kbGVyKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkLCBwcm9tKSk7CiAgICByZXR1cm4gcHJvbTsKICB9OwoKICBQcm9taXNlJDEucHJvdG90eXBlWydmaW5hbGx5J10gPSBmaW5hbGx5Q29uc3RydWN0b3I7CgogIFByb21pc2UkMS5hbGwgPSBmdW5jdGlvbiAoYXJyKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UkMShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIGlmICghaXNBcnJheShhcnIpKSB7CiAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgVHlwZUVycm9yKCdQcm9taXNlLmFsbCBhY2NlcHRzIGFuIGFycmF5JykpOwogICAgICB9CgogICAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFycik7CgogICAgICBpZiAoYXJncy5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gcmVzb2x2ZShbXSk7CiAgICAgIH0KCiAgICAgIHZhciByZW1haW5pbmcgPSBhcmdzLmxlbmd0aDsKCiAgICAgIGZ1bmN0aW9uIHJlcyhpLCB2YWwpIHsKICAgICAgICB0cnkgewogICAgICAgICAgaWYgKHZhbCAmJiAodHlwZW9mIHZhbCA9PT0gJ29iamVjdCcgfHwgdHlwZW9mIHZhbCA9PT0gJ2Z1bmN0aW9uJykpIHsKICAgICAgICAgICAgdmFyIHRoZW4gPSB2YWwudGhlbjsKCiAgICAgICAgICAgIGlmICh0eXBlb2YgdGhlbiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgIHRoZW4uY2FsbCh2YWwsIGZ1bmN0aW9uICh2YWwpIHsKICAgICAgICAgICAgICAgIHJlcyhpLCB2YWwpOwogICAgICAgICAgICAgIH0sIHJlamVjdCk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgYXJnc1tpXSA9IHZhbDsKCiAgICAgICAgICBpZiAoLS1yZW1haW5pbmcgPT09IDApIHsKICAgICAgICAgICAgcmVzb2x2ZShhcmdzKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgcmVqZWN0KGV4KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykgewogICAgICAgIHJlcyhpLCBhcmdzW2ldKTsKICAgICAgfQogICAgfSk7CiAgfTsKCiAgUHJvbWlzZSQxLmFsbFNldHRsZWQgPSBhbGxTZXR0bGVkOwoKICBQcm9taXNlJDEucmVzb2x2ZSA9IGZ1bmN0aW9uICh2YWx1ZSkgewogICAgaWYgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUuY29uc3RydWN0b3IgPT09IFByb21pc2UkMSkgewogICAgICByZXR1cm4gdmFsdWU7CiAgICB9CgogICAgcmV0dXJuIG5ldyBQcm9taXNlJDEoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgcmVzb2x2ZSh2YWx1ZSk7CiAgICB9KTsKICB9OwoKICBQcm9taXNlJDEucmVqZWN0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UkMShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIHJlamVjdCh2YWx1ZSk7CiAgICB9KTsKICB9OwoKICBQcm9taXNlJDEucmFjZSA9IGZ1bmN0aW9uIChhcnIpIHsKICAgIHJldHVybiBuZXcgUHJvbWlzZSQxKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgaWYgKCFpc0FycmF5KGFycikpIHsKICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ1Byb21pc2UucmFjZSBhY2NlcHRzIGFuIGFycmF5JykpOwogICAgICB9CgogICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gYXJyLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgUHJvbWlzZSQxLnJlc29sdmUoYXJyW2ldKS50aGVuKHJlc29sdmUsIHJlamVjdCk7CiAgICAgIH0KICAgIH0pOwogIH07IC8vIFVzZSBwb2x5ZmlsbCBmb3Igc2V0SW1tZWRpYXRlIGZvciBwZXJmb3JtYW5jZSBnYWlucwoKCiAgUHJvbWlzZSQxLl9pbW1lZGlhdGVGbiA9IC8vIEB0cy1pZ25vcmUKICB0eXBlb2Ygc2V0SW1tZWRpYXRlID09PSAnZnVuY3Rpb24nICYmIGZ1bmN0aW9uIChmbikgewogICAgLy8gQHRzLWlnbm9yZQogICAgc2V0SW1tZWRpYXRlKGZuKTsKICB9IHx8IGZ1bmN0aW9uIChmbikgewogICAgc2V0VGltZW91dEZ1bmMoZm4sIDApOwogIH07CgogIFByb21pc2UkMS5fdW5oYW5kbGVkUmVqZWN0aW9uRm4gPSBmdW5jdGlvbiBfdW5oYW5kbGVkUmVqZWN0aW9uRm4oZXJyKSB7CiAgICBpZiAodHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnICYmIGNvbnNvbGUpIHsKICAgICAgY29uc29sZS53YXJuKCdQb3NzaWJsZSBVbmhhbmRsZWQgUHJvbWlzZSBSZWplY3Rpb246JywgZXJyKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlCiAgICB9CiAgfTsKICAvKiogQHN1cHByZXNzIHt1bmRlZmluZWRWYXJzfSAqLwoKCiAgdmFyIGdsb2JhbE5TID0gZnVuY3Rpb24gKCkgewogICAgLy8gdGhlIG9ubHkgcmVsaWFibGUgbWVhbnMgdG8gZ2V0IHRoZSBnbG9iYWwgb2JqZWN0IGlzCiAgICAvLyBgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKWAKICAgIC8vIEhvd2V2ZXIsIHRoaXMgY2F1c2VzIENTUCB2aW9sYXRpb25zIGluIENocm9tZSBhcHBzLgogICAgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJykgewogICAgICByZXR1cm4gc2VsZjsKICAgIH0KCiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgcmV0dXJuIHdpbmRvdzsKICAgIH0KCiAgICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgcmV0dXJuIGdsb2JhbDsKICAgIH0KCiAgICB0aHJvdyBuZXcgRXJyb3IoJ3VuYWJsZSB0byBsb2NhdGUgZ2xvYmFsIG9iamVjdCcpOwogIH0oKTsgLy8gRXhwb3NlIHRoZSBwb2x5ZmlsbCBpZiBQcm9taXNlIGlzIHVuZGVmaW5lZCBvciBzZXQgdG8gYQogIC8vIG5vbi1mdW5jdGlvbiB2YWx1ZS4gVGhlIGxhdHRlciBjYW4gYmUgZHVlIHRvIGEgbmFtZWQgSFRNTEVsZW1lbnQKICAvLyBiZWluZyBleHBvc2VkIGJ5IGJyb3dzZXJzIGZvciBsZWdhY3kgcmVhc29ucy4KICAvLyBodHRwczovL2dpdGh1Yi5jb20vdGF5bG9yaGFrZXMvcHJvbWlzZS1wb2x5ZmlsbC9pc3N1ZXMvMTE0CgoKICBpZiAodHlwZW9mIGdsb2JhbE5TWydQcm9taXNlJ10gIT09ICdmdW5jdGlvbicpIHsKICAgIGdsb2JhbE5TWydQcm9taXNlJ10gPSBQcm9taXNlJDE7CiAgfSBlbHNlIGlmICghZ2xvYmFsTlMuUHJvbWlzZS5wcm90b3R5cGVbJ2ZpbmFsbHknXSkgewogICAgZ2xvYmFsTlMuUHJvbWlzZS5wcm90b3R5cGVbJ2ZpbmFsbHknXSA9IGZpbmFsbHlDb25zdHJ1Y3RvcjsKICB9IGVsc2UgaWYgKCFnbG9iYWxOUy5Qcm9taXNlLmFsbFNldHRsZWQpIHsKICAgIGdsb2JhbE5TLlByb21pc2UuYWxsU2V0dGxlZCA9IGFsbFNldHRsZWQ7CiAgfQoKICBmdW5jdGlvbiBpc0Z1bmN0aW9uKHRhcmdldCkgewogICAgcmV0dXJuIHR5cGVvZiB0YXJnZXQgPT09ICdmdW5jdGlvbic7CiAgfQoKICBmdW5jdGlvbiBpc1N0cmluZyh0YXJnZXQpIHsKICAgIHJldHVybiB0eXBlb2YgdGFyZ2V0ID09PSAnc3RyaW5nJzsKICB9CgogIGZ1bmN0aW9uIGlzTnVtYmVyKHRhcmdldCkgewogICAgcmV0dXJuIHR5cGVvZiB0YXJnZXQgPT09ICdudW1iZXInOwogIH0KCiAgZnVuY3Rpb24gaXNCb29sZWFuKHRhcmdldCkgewogICAgcmV0dXJuIHR5cGVvZiB0YXJnZXQgPT09ICdib29sZWFuJzsKICB9CgogIGZ1bmN0aW9uIGlzVW5kZWZpbmVkKHRhcmdldCkgewogICAgcmV0dXJuIHR5cGVvZiB0YXJnZXQgPT09ICd1bmRlZmluZWQnOwogIH0KCiAgZnVuY3Rpb24gaXNOdWxsKHRhcmdldCkgewogICAgcmV0dXJuIHRhcmdldCA9PT0gbnVsbDsKICB9CgogIGZ1bmN0aW9uIGlzV2luZG93KHRhcmdldCkgewogICAgcmV0dXJuIHRhcmdldCBpbnN0YW5jZW9mIFdpbmRvdzsKICB9CgogIGZ1bmN0aW9uIGlzRG9jdW1lbnQodGFyZ2V0KSB7CiAgICByZXR1cm4gdGFyZ2V0IGluc3RhbmNlb2YgRG9jdW1lbnQ7CiAgfQoKICBmdW5jdGlvbiBpc0VsZW1lbnQodGFyZ2V0KSB7CiAgICByZXR1cm4gdGFyZ2V0IGluc3RhbmNlb2YgRWxlbWVudDsKICB9CgogIGZ1bmN0aW9uIGlzTm9kZSh0YXJnZXQpIHsKICAgIHJldHVybiB0YXJnZXQgaW5zdGFuY2VvZiBOb2RlOwogIH0KICAvKioKICAgKiDmmK/lkKbmmK8gSUUg5rWP6KeI5ZmoCiAgICovCgoKICBmdW5jdGlvbiBpc0lFKCkgewogICAgLy8gQHRzLWlnbm9yZQogICAgcmV0dXJuICEhd2luZG93LmRvY3VtZW50LmRvY3VtZW50TW9kZTsKICB9CgogIGZ1bmN0aW9uIGlzQXJyYXlMaWtlKHRhcmdldCkgewogICAgaWYgKGlzRnVuY3Rpb24odGFyZ2V0KSB8fCBpc1dpbmRvdyh0YXJnZXQpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gaXNOdW1iZXIodGFyZ2V0Lmxlbmd0aCk7CiAgfQoKICBmdW5jdGlvbiBpc09iamVjdExpa2UodGFyZ2V0KSB7CiAgICByZXR1cm4gdHlwZW9mIHRhcmdldCA9PT0gJ29iamVjdCcgJiYgdGFyZ2V0ICE9PSBudWxsOwogIH0KCiAgZnVuY3Rpb24gdG9FbGVtZW50KHRhcmdldCkgewogICAgcmV0dXJuIGlzRG9jdW1lbnQodGFyZ2V0KSA/IHRhcmdldC5kb2N1bWVudEVsZW1lbnQgOiB0YXJnZXQ7CiAgfQogIC8qKgogICAqIOaKiueUqCAtIOWIhumalOeahOWtl+espuS4sui9rOS4uumpvOWzsO+8iOWmgiBib3gtc2l6aW5nIOi9rOaNouS4uiBib3hTaXppbmfvvIkKICAgKiBAcGFyYW0gc3RyaW5nCiAgICovCgoKICBmdW5jdGlvbiB0b0NhbWVsQ2FzZShzdHJpbmcpIHsKICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvXi1tcy0vLCAnbXMtJykucmVwbGFjZSgvLShbYS16XSkvZywgZnVuY3Rpb24gKF8sIGxldHRlcikgewogICAgICByZXR1cm4gbGV0dGVyLnRvVXBwZXJDYXNlKCk7CiAgICB9KTsKICB9CiAgLyoqCiAgICog5oqK6am85bOw5rOV6L2s5Li655SoIC0g5YiG6ZqU55qE5a2X56ym5Liy77yI5aaCIGJveFNpemluZyDovazmjaLkuLogYm94LXNpemluZ++8iQogICAqIEBwYXJhbSBzdHJpbmcKICAgKi8KCgogIGZ1bmN0aW9uIHRvS2ViYWJDYXNlKHN0cmluZykgewogICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC9bQS1aXS9nLCBmdW5jdGlvbiAocmVwbGFjZXIpIHsKICAgICAgcmV0dXJuICctJyArIHJlcGxhY2VyLnRvTG93ZXJDYXNlKCk7CiAgICB9KTsKICB9CiAgLyoqCiAgICog6I635Y+W5YWD57Sg55qE5qC35byP5YC8CiAgICogQHBhcmFtIGVsZW1lbnQKICAgKiBAcGFyYW0gbmFtZQogICAqLwoKCiAgZnVuY3Rpb24gZ2V0Q29tcHV0ZWRTdHlsZVZhbHVlKGVsZW1lbnQsIG5hbWUpIHsKICAgIHJldHVybiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KS5nZXRQcm9wZXJ0eVZhbHVlKHRvS2ViYWJDYXNlKG5hbWUpKTsKICB9CiAgLyoqCiAgICog5qOA5p+l5YWD57Sg55qEIGJveC1zaXppbmcg5piv5ZCm5pivIGJvcmRlci1ib3gKICAgKiBAcGFyYW0gZWxlbWVudAogICAqLwoKCiAgZnVuY3Rpb24gaXNCb3JkZXJCb3goZWxlbWVudCkgewogICAgcmV0dXJuIGdldENvbXB1dGVkU3R5bGVWYWx1ZShlbGVtZW50LCAnYm94LXNpemluZycpID09PSAnYm9yZGVyLWJveCc7CiAgfQogIC8qKgogICAqIOiOt+WPluWFg+e0oOeahCBwYWRkaW5nLCBib3JkZXIsIG1hcmdpbiDlrr3luqbvvIjkuKTkvqflrr3luqbnmoTlkozvvIzljZXkvY3kuLpweO+8iQogICAqIEBwYXJhbSBlbGVtZW50CiAgICogQHBhcmFtIGRpcmVjdGlvbgogICAqIEBwYXJhbSBleHRyYQogICAqLwoKCiAgZnVuY3Rpb24gZ2V0RXh0cmFXaWR0aChlbGVtZW50LCBkaXJlY3Rpb24sIGV4dHJhKSB7CiAgICB2YXIgcG9zaXRpb24gPSBkaXJlY3Rpb24gPT09ICd3aWR0aCcgPyBbJ0xlZnQnLCAnUmlnaHQnXSA6IFsnVG9wJywgJ0JvdHRvbSddOwogICAgcmV0dXJuIFswLCAxXS5yZWR1Y2UoZnVuY3Rpb24gKHByZXYsIF8sIGluZGV4KSB7CiAgICAgIHZhciBwcm9wID0gZXh0cmEgKyBwb3NpdGlvbltpbmRleF07CgogICAgICBpZiAoZXh0cmEgPT09ICdib3JkZXInKSB7CiAgICAgICAgcHJvcCArPSAnV2lkdGgnOwogICAgICB9CgogICAgICByZXR1cm4gcHJldiArIHBhcnNlRmxvYXQoZ2V0Q29tcHV0ZWRTdHlsZVZhbHVlKGVsZW1lbnQsIHByb3ApIHx8ICcwJyk7CiAgICB9LCAwKTsKICB9CiAgLyoqCiAgICog6I635Y+W5YWD57Sg55qE5qC35byP5YC877yM5a+5IHdpZHRoIOWSjCBoZWlnaHQg6L+b6KGM6L+H5aSE55CGCiAgICogQHBhcmFtIGVsZW1lbnQKICAgKiBAcGFyYW0gbmFtZQogICAqLwoKCiAgZnVuY3Rpb24gZ2V0U3R5bGUoZWxlbWVudCwgbmFtZSkgewogICAgLy8gd2lkdGjjgIFoZWlnaHQg5bGe5oCn5L2/55SoIGdldENvbXB1dGVkU3R5bGUg5b6X5Yiw55qE5YC85LiN5YeG56Gu77yM6ZyA6KaB5L2/55SoIGdldEJvdW5kaW5nQ2xpZW50UmVjdCDojrflj5YKICAgIGlmIChuYW1lID09PSAnd2lkdGgnIHx8IG5hbWUgPT09ICdoZWlnaHQnKSB7CiAgICAgIHZhciB2YWx1ZU51bWJlciA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClbbmFtZV07CgogICAgICBpZiAoaXNCb3JkZXJCb3goZWxlbWVudCkpIHsKICAgICAgICByZXR1cm4gdmFsdWVOdW1iZXIgKyAicHgiOwogICAgICB9CgogICAgICByZXR1cm4gdmFsdWVOdW1iZXIgLSBnZXRFeHRyYVdpZHRoKGVsZW1lbnQsIG5hbWUsICdib3JkZXInKSAtIGdldEV4dHJhV2lkdGgoZWxlbWVudCwgbmFtZSwgJ3BhZGRpbmcnKSArICJweCI7CiAgICB9CgogICAgcmV0dXJuIGdldENvbXB1dGVkU3R5bGVWYWx1ZShlbGVtZW50LCBuYW1lKTsKICB9CiAgLyoqCiAgICog6I635Y+W5a2Q6IqC54K557uE5oiQ55qE5pWw57uECiAgICogQHBhcmFtIHRhcmdldAogICAqIEBwYXJhbSBwYXJlbnQKICAgKi8KCgogIGZ1bmN0aW9uIGdldENoaWxkTm9kZXNBcnJheSh0YXJnZXQsIHBhcmVudCkgewogICAgdmFyIHRlbXBQYXJlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHBhcmVudCk7CiAgICB0ZW1wUGFyZW50LmlubmVySFRNTCA9IHRhcmdldDsKICAgIHJldHVybiBbXS5zbGljZS5jYWxsKHRlbXBQYXJlbnQuY2hpbGROb2Rlcyk7CiAgfQogIC8qKgogICAqIOWni+e7iOi/lOWbniBmYWxzZSDnmoTlh73mlbAKICAgKi8KCgogIGZ1bmN0aW9uIHJldHVybkZhbHNlKCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KICAvKioKICAgKiDmlbDlgLzljZXkvY3nmoQgQ1NTIOWxnuaApwogICAqLwoKCiAgdmFyIGNzc051bWJlciA9IFsnYW5pbWF0aW9uSXRlcmF0aW9uQ291bnQnLCAnY29sdW1uQ291bnQnLCAnZmlsbE9wYWNpdHknLCAnZmxleEdyb3cnLCAnZmxleFNocmluaycsICdmb250V2VpZ2h0JywgJ2dyaWRBcmVhJywgJ2dyaWRDb2x1bW4nLCAnZ3JpZENvbHVtbkVuZCcsICdncmlkQ29sdW1uU3RhcnQnLCAnZ3JpZFJvdycsICdncmlkUm93RW5kJywgJ2dyaWRSb3dTdGFydCcsICdsaW5lSGVpZ2h0JywgJ29wYWNpdHknLCAnb3JkZXInLCAnb3JwaGFucycsICd3aWRvd3MnLCAnekluZGV4JywgJ3pvb20nXTsKCiAgZnVuY3Rpb24gZWFjaCh0YXJnZXQsIGNhbGxiYWNrKSB7CiAgICBpZiAoaXNBcnJheUxpa2UodGFyZ2V0KSkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhcmdldC5sZW5ndGg7IGkgKz0gMSkgewogICAgICAgIGlmIChjYWxsYmFjay5jYWxsKHRhcmdldFtpXSwgaSwgdGFyZ2V0W2ldKSA9PT0gZmFsc2UpIHsKICAgICAgICAgIHJldHVybiB0YXJnZXQ7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHRhcmdldCk7CgogICAgICBmb3IgKHZhciBpJDEgPSAwOyBpJDEgPCBrZXlzLmxlbmd0aDsgaSQxICs9IDEpIHsKICAgICAgICBpZiAoY2FsbGJhY2suY2FsbCh0YXJnZXRba2V5c1tpJDFdXSwga2V5c1tpJDFdLCB0YXJnZXRba2V5c1tpJDFdXSkgPT09IGZhbHNlKSB7CiAgICAgICAgICByZXR1cm4gdGFyZ2V0OwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiB0YXJnZXQ7CiAgfQogIC8qKgogICAqIOS4uuS6huS9v+eUqOaooeWdl+aJqeWFhe+8jOi/memHjOS4jeiDveS9v+eUqOm7mOiupOWvvOWHugogICAqLwoKCiAgdmFyIEpRID0gZnVuY3Rpb24gSlEoYXJyKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgIHRoaXMubGVuZ3RoID0gMDsKCiAgICBpZiAoIWFycikgewogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBlYWNoKGFyciwgZnVuY3Rpb24gKGksIGl0ZW0pIHsKICAgICAgLy8gQHRzLWlnbm9yZQogICAgICB0aGlzJDFbaV0gPSBpdGVtOwogICAgfSk7CiAgICB0aGlzLmxlbmd0aCA9IGFyci5sZW5ndGg7CiAgICByZXR1cm4gdGhpczsKICB9OwoKICBmdW5jdGlvbiBnZXQkKCkgewogICAgdmFyICQgPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgICAgaWYgKCFzZWxlY3RvcikgewogICAgICAgIHJldHVybiBuZXcgSlEoKTsKICAgICAgfSAvLyBKUQoKCiAgICAgIGlmIChzZWxlY3RvciBpbnN0YW5jZW9mIEpRKSB7CiAgICAgICAgcmV0dXJuIHNlbGVjdG9yOwogICAgICB9IC8vIGZ1bmN0aW9uCgoKICAgICAgaWYgKGlzRnVuY3Rpb24oc2VsZWN0b3IpKSB7CiAgICAgICAgaWYgKC9jb21wbGV0ZXxsb2FkZWR8aW50ZXJhY3RpdmUvLnRlc3QoZG9jdW1lbnQucmVhZHlTdGF0ZSkgJiYgZG9jdW1lbnQuYm9keSkgewogICAgICAgICAgc2VsZWN0b3IuY2FsbChkb2N1bWVudCwgJCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBzZWxlY3Rvci5jYWxsKGRvY3VtZW50LCAkKTsKICAgICAgICAgIH0sIGZhbHNlKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBuZXcgSlEoW2RvY3VtZW50XSk7CiAgICAgIH0gLy8gU3RyaW5nCgoKICAgICAgaWYgKGlzU3RyaW5nKHNlbGVjdG9yKSkgewogICAgICAgIHZhciBodG1sID0gc2VsZWN0b3IudHJpbSgpOyAvLyDmoLnmja4gSFRNTCDlrZfnrKbkuLLliJvlu7ogSlEg5a+56LGhCgogICAgICAgIGlmIChodG1sWzBdID09PSAnPCcgJiYgaHRtbFtodG1sLmxlbmd0aCAtIDFdID09PSAnPicpIHsKICAgICAgICAgIHZhciB0b0NyZWF0ZSA9ICdkaXYnOwogICAgICAgICAgdmFyIHRhZ3MgPSB7CiAgICAgICAgICAgIGxpOiAndWwnLAogICAgICAgICAgICB0cjogJ3Rib2R5JywKICAgICAgICAgICAgdGQ6ICd0cicsCiAgICAgICAgICAgIHRoOiAndHInLAogICAgICAgICAgICB0Ym9keTogJ3RhYmxlJywKICAgICAgICAgICAgb3B0aW9uOiAnc2VsZWN0JwogICAgICAgICAgfTsKICAgICAgICAgIGVhY2godGFncywgZnVuY3Rpb24gKGNoaWxkVGFnLCBwYXJlbnRUYWcpIHsKICAgICAgICAgICAgaWYgKGh0bWwuaW5kZXhPZigiPCIgKyBjaGlsZFRhZykgPT09IDApIHsKICAgICAgICAgICAgICB0b0NyZWF0ZSA9IHBhcmVudFRhZzsKICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuIG5ldyBKUShnZXRDaGlsZE5vZGVzQXJyYXkoaHRtbCwgdG9DcmVhdGUpKTsKICAgICAgICB9IC8vIOagueaNriBDU1Mg6YCJ5oup5Zmo5Yib5bu6IEpRIOWvueixoQoKCiAgICAgICAgdmFyIGlzSWRTZWxlY3RvciA9IHNlbGVjdG9yWzBdID09PSAnIycgJiYgIXNlbGVjdG9yLm1hdGNoKC9bIC48Pjp+XS8pOwoKICAgICAgICBpZiAoIWlzSWRTZWxlY3RvcikgewogICAgICAgICAgcmV0dXJuIG5ldyBKUShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSk7CiAgICAgICAgfQoKICAgICAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNlbGVjdG9yLnNsaWNlKDEpKTsKCiAgICAgICAgaWYgKGVsZW1lbnQpIHsKICAgICAgICAgIHJldHVybiBuZXcgSlEoW2VsZW1lbnRdKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBuZXcgSlEoKTsKICAgICAgfQoKICAgICAgaWYgKGlzQXJyYXlMaWtlKHNlbGVjdG9yKSAmJiAhaXNOb2RlKHNlbGVjdG9yKSkgewogICAgICAgIHJldHVybiBuZXcgSlEoc2VsZWN0b3IpOwogICAgICB9CgogICAgICByZXR1cm4gbmV3IEpRKFtzZWxlY3Rvcl0pOwogICAgfTsKCiAgICAkLmZuID0gSlEucHJvdG90eXBlOwogICAgcmV0dXJuICQ7CiAgfQoKICB2YXIgJCA9IGdldCQoKTsgLy8g6YG/5YWN6aG16Z2i5Yqg6L295a6M5ZCO55u05o6l5omn6KGMY3Nz5Yqo55S7CiAgLy8gaHR0cHM6Ly9jc3MtdHJpY2tzLmNvbS90cmFuc2l0aW9ucy1vbmx5LWFmdGVyLXBhZ2UtbG9hZC8KCiAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gJCgnYm9keScpLmFkZENsYXNzKCdtZHVpLWxvYWRlZCcpOwogIH0pOwogIHZhciBtZHVpID0gewogICAgJDogJAogIH07CgogICQuZm4uZWFjaCA9IGZ1bmN0aW9uIChjYWxsYmFjaykgewogICAgcmV0dXJuIGVhY2godGhpcywgY2FsbGJhY2spOwogIH07CiAgLyoqCiAgICog5qOA5p+lIGNvbnRhaW5lciDlhYPntKDlhoXmmK/lkKbljIXlkKsgY29udGFpbnMg5YWD57SgCiAgICogQHBhcmFtIGNvbnRhaW5lciDniLblhYPntKAKICAgKiBAcGFyYW0gY29udGFpbnMg5a2Q5YWD57SgCiAgICogQGV4YW1wbGUKICBgYGBqcwogIGNvbnRhaW5zKCBkb2N1bWVudCwgZG9jdW1lbnQuYm9keSApOyAvLyB0cnVlCiAgY29udGFpbnMoIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZXN0JyksIGRvY3VtZW50ICk7IC8vIGZhbHNlCiAgY29udGFpbnMoICQoJy5jb250YWluZXInKS5nZXQoMCksICQoJy5jb250YWlucycpLmdldCgwKSApOyAvLyBmYWxzZQogIGBgYAogICAqLwoKCiAgZnVuY3Rpb24gY29udGFpbnMoY29udGFpbmVyLCBjb250YWlucykgewogICAgcmV0dXJuIGNvbnRhaW5lciAhPT0gY29udGFpbnMgJiYgdG9FbGVtZW50KGNvbnRhaW5lcikuY29udGFpbnMoY29udGFpbnMpOwogIH0KICAvKioKICAgKiDmiornrKzkuozkuKrmlbDnu4TnmoTlhYPntKDov73liqDliLDnrKzkuIDkuKrmlbDnu4TkuK3vvIzlubbov5Tlm57lkIjlubblkI7nmoTmlbDnu4QKICAgKiBAcGFyYW0gZmlyc3Qg56ys5LiA5Liq5pWw57uECiAgICogQHBhcmFtIHNlY29uZCDor6XmlbDnu4TnmoTlhYPntKDlsIbooqvov73liqDliLDnrKzkuIDkuKrmlbDnu4TkuK0KICAgKiBAZXhhbXBsZQogIGBgYGpzCiAgbWVyZ2UoIFsgMCwgMSwgMiBdLCBbIDIsIDMsIDQgXSApCiAgLy8gWyAwLCAxLCAyLCAyLCAzLCA0IF0KICBgYGAKICAgKi8KCgogIGZ1bmN0aW9uIG1lcmdlKGZpcnN0LCBzZWNvbmQpIHsKICAgIGVhY2goc2Vjb25kLCBmdW5jdGlvbiAoXywgdmFsdWUpIHsKICAgICAgZmlyc3QucHVzaCh2YWx1ZSk7CiAgICB9KTsKICAgIHJldHVybiBmaXJzdDsKICB9CgogICQuZm4uZ2V0ID0gZnVuY3Rpb24gKGluZGV4KSB7CiAgICByZXR1cm4gaW5kZXggPT09IHVuZGVmaW5lZCA/IFtdLnNsaWNlLmNhbGwodGhpcykgOiB0aGlzW2luZGV4ID49IDAgPyBpbmRleCA6IGluZGV4ICsgdGhpcy5sZW5ndGhdOwogIH07CgogICQuZm4uZmluZCA9IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgdmFyIGZvdW5kRWxlbWVudHMgPSBbXTsKICAgIHRoaXMuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICBtZXJnZShmb3VuZEVsZW1lbnRzLCAkKGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikpLmdldCgpKTsKICAgIH0pOwogICAgcmV0dXJuIG5ldyBKUShmb3VuZEVsZW1lbnRzKTsKICB9OyAvLyDlrZjlgqjkuovku7YKCgogIHZhciBoYW5kbGVycyA9IHt9OyAvLyDlhYPntKBJRAoKICB2YXIgbWR1aUVsZW1lbnRJZCA9IDE7CiAgLyoqCiAgICog5Li65YWD57Sg6LWL5LqI5LiA5Liq5ZSv5LiA55qESUQKICAgKi8KCiAgZnVuY3Rpb24gZ2V0RWxlbWVudElkKGVsZW1lbnQpIHsKICAgIHZhciBrZXkgPSAnX21kdWlFdmVudElkJzsgLy8gQHRzLWlnbm9yZQoKICAgIGlmICghZWxlbWVudFtrZXldKSB7CiAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgZWxlbWVudFtrZXldID0gKyttZHVpRWxlbWVudElkOwogICAgfSAvLyBAdHMtaWdub3JlCgoKICAgIHJldHVybiBlbGVtZW50W2tleV07CiAgfQogIC8qKgogICAqIOino+aekOS6i+S7tuWQjeS4reeahOWRveWQjeepuumXtAogICAqLwoKCiAgZnVuY3Rpb24gcGFyc2UodHlwZSkgewogICAgdmFyIHBhcnRzID0gdHlwZS5zcGxpdCgnLicpOwogICAgcmV0dXJuIHsKICAgICAgdHlwZTogcGFydHNbMF0sCiAgICAgIG5zOiBwYXJ0cy5zbGljZSgxKS5zb3J0KCkuam9pbignICcpCiAgICB9OwogIH0KICAvKioKICAgKiDlkb3lkI3nqbrpl7TljLnphY3op4TliJkKICAgKi8KCgogIGZ1bmN0aW9uIG1hdGNoZXJGb3IobnMpIHsKICAgIHJldHVybiBuZXcgUmVnRXhwKCcoPzpefCApJyArIG5zLnJlcGxhY2UoJyAnLCAnIC4qID8nKSArICcoPzogfCQpJyk7CiAgfQogIC8qKgogICAqIOiOt+WPluWMuemFjeeahOS6i+S7tgogICAqIEBwYXJhbSBlbGVtZW50CiAgICogQHBhcmFtIHR5cGUKICAgKiBAcGFyYW0gZnVuYwogICAqIEBwYXJhbSBzZWxlY3RvcgogICAqLwoKCiAgZnVuY3Rpb24gZ2V0SGFuZGxlcnMoZWxlbWVudCwgdHlwZSwgZnVuYywgc2VsZWN0b3IpIHsKICAgIHZhciBldmVudCA9IHBhcnNlKHR5cGUpOwogICAgcmV0dXJuIChoYW5kbGVyc1tnZXRFbGVtZW50SWQoZWxlbWVudCldIHx8IFtdKS5maWx0ZXIoZnVuY3Rpb24gKGhhbmRsZXIpIHsKICAgICAgcmV0dXJuIGhhbmRsZXIgJiYgKCFldmVudC50eXBlIHx8IGhhbmRsZXIudHlwZSA9PT0gZXZlbnQudHlwZSkgJiYgKCFldmVudC5ucyB8fCBtYXRjaGVyRm9yKGV2ZW50Lm5zKS50ZXN0KGhhbmRsZXIubnMpKSAmJiAoIWZ1bmMgfHwgZ2V0RWxlbWVudElkKGhhbmRsZXIuZnVuYykgPT09IGdldEVsZW1lbnRJZChmdW5jKSkgJiYgKCFzZWxlY3RvciB8fCBoYW5kbGVyLnNlbGVjdG9yID09PSBzZWxlY3Rvcik7CiAgICB9KTsKICB9CiAgLyoqCiAgICog5re75Yqg5LqL5Lu255uR5ZCsCiAgICogQHBhcmFtIGVsZW1lbnQKICAgKiBAcGFyYW0gdHlwZXMKICAgKiBAcGFyYW0gZnVuYwogICAqIEBwYXJhbSBkYXRhCiAgICogQHBhcmFtIHNlbGVjdG9yCiAgICovCgoKICBmdW5jdGlvbiBhZGQoZWxlbWVudCwgdHlwZXMsIGZ1bmMsIGRhdGEsIHNlbGVjdG9yKSB7CiAgICB2YXIgZWxlbWVudElkID0gZ2V0RWxlbWVudElkKGVsZW1lbnQpOwoKICAgIGlmICghaGFuZGxlcnNbZWxlbWVudElkXSkgewogICAgICBoYW5kbGVyc1tlbGVtZW50SWRdID0gW107CiAgICB9IC8vIOS8oOWFpSBkYXRhLnVzZUNhcHR1cmUg5p2l6K6+572uIHVzZUNhcHR1cmU6IHRydWUKCgogICAgdmFyIHVzZUNhcHR1cmUgPSBmYWxzZTsKCiAgICBpZiAoaXNPYmplY3RMaWtlKGRhdGEpICYmIGRhdGEudXNlQ2FwdHVyZSkgewogICAgICB1c2VDYXB0dXJlID0gdHJ1ZTsKICAgIH0KCiAgICB0eXBlcy5zcGxpdCgnICcpLmZvckVhY2goZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgaWYgKCF0eXBlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgZXZlbnQgPSBwYXJzZSh0eXBlKTsKCiAgICAgIGZ1bmN0aW9uIGNhbGxGbihlLCBlbGVtKSB7CiAgICAgICAgLy8g5Zug5Li66byg5qCH5LqL5Lu25qih5ouf5LqL5Lu255qEIGRldGFpbCDlsZ7mgKfmmK/lj6ror7vnmoTvvIzlm6DmraTlnKggZS5fZGV0YWlsIOS4reWtmOWCqOWPguaVsAogICAgICAgIHZhciByZXN1bHQgPSBmdW5jLmFwcGx5KGVsZW0sIC8vIEB0cy1pZ25vcmUKICAgICAgICBlLl9kZXRhaWwgPT09IHVuZGVmaW5lZCA/IFtlXSA6IFtlXS5jb25jYXQoZS5fZGV0YWlsKSk7CgogICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSB7CiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZnVuY3Rpb24gcHJveHlGbihlKSB7CiAgICAgICAgLy8gQHRzLWlnbm9yZQogICAgICAgIGlmIChlLl9ucyAmJiAhbWF0Y2hlckZvcihlLl9ucykudGVzdChldmVudC5ucykpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IC8vIEB0cy1pZ25vcmUKCgogICAgICAgIGUuX2RhdGEgPSBkYXRhOwoKICAgICAgICBpZiAoc2VsZWN0b3IpIHsKICAgICAgICAgIC8vIOS6i+S7tuS7o+eQhgogICAgICAgICAgJChlbGVtZW50KS5maW5kKHNlbGVjdG9yKS5nZXQoKS5yZXZlcnNlKCkuZm9yRWFjaChmdW5jdGlvbiAoZWxlbSkgewogICAgICAgICAgICBpZiAoZWxlbSA9PT0gZS50YXJnZXQgfHwgY29udGFpbnMoZWxlbSwgZS50YXJnZXQpKSB7CiAgICAgICAgICAgICAgY2FsbEZuKGUsIGVsZW0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8g5LiN5L2/55So5LqL5Lu25Luj55CGCiAgICAgICAgICBjYWxsRm4oZSwgZWxlbWVudCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgaGFuZGxlciA9IHsKICAgICAgICB0eXBlOiBldmVudC50eXBlLAogICAgICAgIG5zOiBldmVudC5ucywKICAgICAgICBmdW5jOiBmdW5jLAogICAgICAgIHNlbGVjdG9yOiBzZWxlY3RvciwKICAgICAgICBpZDogaGFuZGxlcnNbZWxlbWVudElkXS5sZW5ndGgsCiAgICAgICAgcHJveHk6IHByb3h5Rm4KICAgICAgfTsKICAgICAgaGFuZGxlcnNbZWxlbWVudElkXS5wdXNoKGhhbmRsZXIpOwogICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoaGFuZGxlci50eXBlLCBwcm94eUZuLCB1c2VDYXB0dXJlKTsKICAgIH0pOwogIH0KICAvKioKICAgKiDnp7vpmaTkuovku7bnm5HlkKwKICAgKiBAcGFyYW0gZWxlbWVudAogICAqIEBwYXJhbSB0eXBlcwogICAqIEBwYXJhbSBmdW5jCiAgICogQHBhcmFtIHNlbGVjdG9yCiAgICovCgoKICBmdW5jdGlvbiByZW1vdmUoZWxlbWVudCwgdHlwZXMsIGZ1bmMsIHNlbGVjdG9yKSB7CiAgICB2YXIgaGFuZGxlcnNJbkVsZW1lbnQgPSBoYW5kbGVyc1tnZXRFbGVtZW50SWQoZWxlbWVudCldIHx8IFtdOwoKICAgIHZhciByZW1vdmVFdmVudCA9IGZ1bmN0aW9uIChoYW5kbGVyKSB7CiAgICAgIGRlbGV0ZSBoYW5kbGVyc0luRWxlbWVudFtoYW5kbGVyLmlkXTsKICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGhhbmRsZXIudHlwZSwgaGFuZGxlci5wcm94eSwgZmFsc2UpOwogICAgfTsKCiAgICBpZiAoIXR5cGVzKSB7CiAgICAgIGhhbmRsZXJzSW5FbGVtZW50LmZvckVhY2goZnVuY3Rpb24gKGhhbmRsZXIpIHsKICAgICAgICByZXR1cm4gcmVtb3ZlRXZlbnQoaGFuZGxlcik7CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgdHlwZXMuc3BsaXQoJyAnKS5mb3JFYWNoKGZ1bmN0aW9uICh0eXBlKSB7CiAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgIGdldEhhbmRsZXJzKGVsZW1lbnQsIHR5cGUsIGZ1bmMsIHNlbGVjdG9yKS5mb3JFYWNoKGZ1bmN0aW9uIChoYW5kbGVyKSB7CiAgICAgICAgICAgIHJldHVybiByZW1vdmVFdmVudChoYW5kbGVyKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfQoKICAkLmZuLnRyaWdnZXIgPSBmdW5jdGlvbiAodHlwZSwgZXh0cmFQYXJhbWV0ZXJzKSB7CiAgICB2YXIgZXZlbnQgPSBwYXJzZSh0eXBlKTsKICAgIHZhciBldmVudE9iamVjdDsKICAgIHZhciBldmVudFBhcmFtcyA9IHsKICAgICAgYnViYmxlczogdHJ1ZSwKICAgICAgY2FuY2VsYWJsZTogdHJ1ZQogICAgfTsKICAgIHZhciBpc01vdXNlRXZlbnQgPSBbJ2NsaWNrJywgJ21vdXNlZG93bicsICdtb3VzZXVwJywgJ21vdXNlbW92ZSddLmluZGV4T2YoZXZlbnQudHlwZSkgPiAtMTsKCiAgICBpZiAoaXNNb3VzZUV2ZW50KSB7CiAgICAgIC8vIE5vdGU6IE1vdXNlRXZlbnQg5peg5rOV5Lyg5YWlIGRldGFpbCDlj4LmlbAKICAgICAgZXZlbnRPYmplY3QgPSBuZXcgTW91c2VFdmVudChldmVudC50eXBlLCBldmVudFBhcmFtcyk7CiAgICB9IGVsc2UgewogICAgICBldmVudFBhcmFtcy5kZXRhaWwgPSBleHRyYVBhcmFtZXRlcnM7CiAgICAgIGV2ZW50T2JqZWN0ID0gbmV3IEN1c3RvbUV2ZW50KGV2ZW50LnR5cGUsIGV2ZW50UGFyYW1zKTsKICAgIH0gLy8gQHRzLWlnbm9yZQoKCiAgICBldmVudE9iamVjdC5fZGV0YWlsID0gZXh0cmFQYXJhbWV0ZXJzOyAvLyBAdHMtaWdub3JlCgogICAgZXZlbnRPYmplY3QuX25zID0gZXZlbnQubnM7CiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGV2ZW50T2JqZWN0KTsKICAgIH0pOwogIH07CgogIGZ1bmN0aW9uIGV4dGVuZCh0YXJnZXQsIG9iamVjdDEpIHsKICAgIHZhciBvYmplY3ROID0gW10sCiAgICAgICAgbGVuID0gYXJndW1lbnRzLmxlbmd0aCAtIDI7CgogICAgd2hpbGUgKGxlbi0tID4gMCkgb2JqZWN0TltsZW5dID0gYXJndW1lbnRzW2xlbiArIDJdOwoKICAgIG9iamVjdE4udW5zaGlmdChvYmplY3QxKTsKICAgIGVhY2gob2JqZWN0TiwgZnVuY3Rpb24gKF8sIG9iamVjdCkgewogICAgICBlYWNoKG9iamVjdCwgZnVuY3Rpb24gKHByb3AsIHZhbHVlKSB7CiAgICAgICAgaWYgKCFpc1VuZGVmaW5lZCh2YWx1ZSkpIHsKICAgICAgICAgIHRhcmdldFtwcm9wXSA9IHZhbHVlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9KTsKICAgIHJldHVybiB0YXJnZXQ7CiAgfQogIC8qKgogICAqIOWwhuaVsOe7hOaIluWvueixoeW6j+WIl+WMlu+8jOW6j+WIl+WMluWQjueahOWtl+espuS4suWPr+S9nOS4uiBVUkwg5p+l6K+i5a2X56ym5Liy5L2/55SoCiAgICoKICAgKiDoi6XkvKDlhaXmlbDnu4TvvIzliJnmoLzlvI/lv4Xpobvlkowgc2VyaWFsaXplQXJyYXkg5pa55rOV55qE6L+U5Zue5YC85LiA5qC3CiAgICogQHBhcmFtIG9iaiDlr7nosaHmiJbmlbDnu4QKICAgKiBAZXhhbXBsZQogIGBgYGpzCiAgcGFyYW0oeyB3aWR0aDogMTY4MCwgaGVpZ2h0OiAxMDUwIH0pOwogIC8vIHdpZHRoPTE2ODAmaGVpZ2h0PTEwNTAKICBgYGAKICAgKiBAZXhhbXBsZQogIGBgYGpzCiAgcGFyYW0oeyBmb286IHsgb25lOiAxLCB0d286IDIgfX0pCiAgLy8gZm9vW29uZV09MSZmb29bdHdvXT0yCiAgYGBgCiAgICogQGV4YW1wbGUKICBgYGBqcwogIHBhcmFtKHtpZHM6IFsxLCAyLCAzXX0pCiAgLy8gaWRzW109MSZpZHNbXT0yJmlkc1tdPTMKICBgYGAKICAgKiBAZXhhbXBsZQogIGBgYGpzCiAgcGFyYW0oWwogICAgeyJuYW1lIjoibmFtZSIsInZhbHVlIjoibWR1aSJ9LAogICAgeyJuYW1lIjoicGFzc3dvcmQiLCJ2YWx1ZSI6IjEyMzQ1NiJ9CiAgXSkKICAvLyBuYW1lPW1kdWkmcGFzc3dvcmQ9MTIzNDU2CiAgYGBgCiAgICovCgoKICBmdW5jdGlvbiBwYXJhbShvYmopIHsKICAgIGlmICghaXNPYmplY3RMaWtlKG9iaikgJiYgIUFycmF5LmlzQXJyYXkob2JqKSkgewogICAgICByZXR1cm4gJyc7CiAgICB9CgogICAgdmFyIGFyZ3MgPSBbXTsKCiAgICBmdW5jdGlvbiBkZXN0cnVjdHVyZShrZXksIHZhbHVlKSB7CiAgICAgIHZhciBrZXlUbXA7CgogICAgICBpZiAoaXNPYmplY3RMaWtlKHZhbHVlKSkgewogICAgICAgIGVhY2godmFsdWUsIGZ1bmN0aW9uIChpLCB2KSB7CiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgJiYgIWlzT2JqZWN0TGlrZSh2KSkgewogICAgICAgICAgICBrZXlUbXAgPSAnJzsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGtleVRtcCA9IGk7CiAgICAgICAgICB9CgogICAgICAgICAgZGVzdHJ1Y3R1cmUoa2V5ICsgIlsiICsga2V5VG1wICsgIl0iLCB2KTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodmFsdWUgPT0gbnVsbCB8fCB2YWx1ZSA9PT0gJycpIHsKICAgICAgICAgIGtleVRtcCA9ICc9JzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAga2V5VG1wID0gIj0iICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKTsKICAgICAgICB9CgogICAgICAgIGFyZ3MucHVzaChlbmNvZGVVUklDb21wb25lbnQoa2V5KSArIGtleVRtcCk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoQXJyYXkuaXNBcnJheShvYmopKSB7CiAgICAgIGVhY2gob2JqLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgZGVzdHJ1Y3R1cmUodGhpcy5uYW1lLCB0aGlzLnZhbHVlKTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBlYWNoKG9iaiwgZGVzdHJ1Y3R1cmUpOwogICAgfQoKICAgIHJldHVybiBhcmdzLmpvaW4oJyYnKTsKICB9IC8vIOWFqOWxgOmFjee9ruWPguaVsAoKCiAgdmFyIGdsb2JhbE9wdGlvbnMgPSB7fTsgLy8g5YWo5bGA5LqL5Lu25ZCNCgogIHZhciBhamF4RXZlbnRzID0gewogICAgYWpheFN0YXJ0OiAnc3RhcnQubWR1aS5hamF4JywKICAgIGFqYXhTdWNjZXNzOiAnc3VjY2Vzcy5tZHVpLmFqYXgnLAogICAgYWpheEVycm9yOiAnZXJyb3IubWR1aS5hamF4JywKICAgIGFqYXhDb21wbGV0ZTogJ2NvbXBsZXRlLm1kdWkuYWpheCcKICB9OwogIC8qKgogICAqIOWIpOaWreatpOivt+axguaWueazleaYr+WQpumAmui/h+afpeivouWtl+espuS4suaPkOS6pOWPguaVsAogICAqIEBwYXJhbSBtZXRob2Qg6K+35rGC5pa55rOV77yM5aSn5YaZCiAgICovCgogIGZ1bmN0aW9uIGlzUXVlcnlTdHJpbmdEYXRhKG1ldGhvZCkgewogICAgcmV0dXJuIFsnR0VUJywgJ0hFQUQnXS5pbmRleE9mKG1ldGhvZCkgPj0gMDsKICB9CiAgLyoqCiAgICog5re75Yqg5Y+C5pWw5YiwIFVSTCDkuIrvvIzkuJQgVVJMIOS4reS4jeWtmOWcqCA/IOaXtu+8jOiHquWKqOaKiuesrOS4gOS4qiAmIOabv+aNouS4uiA/CiAgICogQHBhcmFtIHVybAogICAqIEBwYXJhbSBxdWVyeQogICAqLwoKCiAgZnVuY3Rpb24gYXBwZW5kUXVlcnkodXJsLCBxdWVyeSkgewogICAgcmV0dXJuICh1cmwgKyAiJiIgKyBxdWVyeSkucmVwbGFjZSgvWyY/XXsxLDJ9LywgJz8nKTsKICB9CiAgLyoqCiAgICog5ZCI5bm26K+35rGC5Y+C5pWw77yM5Y+C5pWw5LyY5YWI57qn77yab3B0aW9ucyA+IGdsb2JhbE9wdGlvbnMgPiBkZWZhdWx0cwogICAqIEBwYXJhbSBvcHRpb25zCiAgICovCgoKICBmdW5jdGlvbiBtZXJnZU9wdGlvbnMob3B0aW9ucykgewogICAgLy8g6buY6K6k5Y+C5pWwCiAgICB2YXIgZGVmYXVsdHMgPSB7CiAgICAgIHVybDogJycsCiAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgIGRhdGE6ICcnLAogICAgICBwcm9jZXNzRGF0YTogdHJ1ZSwKICAgICAgYXN5bmM6IHRydWUsCiAgICAgIGNhY2hlOiB0cnVlLAogICAgICB1c2VybmFtZTogJycsCiAgICAgIHBhc3N3b3JkOiAnJywKICAgICAgaGVhZGVyczoge30sCiAgICAgIHhockZpZWxkczoge30sCiAgICAgIHN0YXR1c0NvZGU6IHt9LAogICAgICBkYXRhVHlwZTogJ3RleHQnLAogICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsCiAgICAgIHRpbWVvdXQ6IDAsCiAgICAgIGdsb2JhbDogdHJ1ZQogICAgfTsgLy8gZ2xvYmFsT3B0aW9ucyDkuK3nmoTlm57osIPlh73mlbDkuI3lkIjlubYKCiAgICBlYWNoKGdsb2JhbE9wdGlvbnMsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICAgIHZhciBjYWxsYmFja3MgPSBbJ2JlZm9yZVNlbmQnLCAnc3VjY2VzcycsICdlcnJvcicsICdjb21wbGV0ZScsICdzdGF0dXNDb2RlJ107IC8vIEB0cy1pZ25vcmUKCiAgICAgIGlmIChjYWxsYmFja3MuaW5kZXhPZihrZXkpIDwgMCAmJiAhaXNVbmRlZmluZWQodmFsdWUpKSB7CiAgICAgICAgZGVmYXVsdHNba2V5XSA9IHZhbHVlOwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiBleHRlbmQoe30sIGRlZmF1bHRzLCBvcHRpb25zKTsKICB9CiAgLyoqCiAgICog5Y+R6YCBIGFqYXgg6K+35rGCCiAgICogQHBhcmFtIG9wdGlvbnMKICAgKiBAZXhhbXBsZQogIGBgYGpzCiAgYWpheCh7CiAgICBtZXRob2Q6ICJQT1NUIiwKICAgIHVybDogInNvbWUucGhwIiwKICAgIGRhdGE6IHsgbmFtZTogIkpvaG4iLCBsb2NhdGlvbjogIkJvc3RvbiIgfQogIH0pLnRoZW4oZnVuY3Rpb24oIG1zZyApIHsKICAgIGFsZXJ0KCAiRGF0YSBTYXZlZDogIiArIG1zZyApOwogIH0pOwogIGBgYAogICAqLwoKCiAgZnVuY3Rpb24gYWpheChvcHRpb25zKSB7CiAgICAvLyDmmK/lkKblt7Llj5bmtojor7fmsYIKICAgIHZhciBpc0NhbmNlbGVkID0gZmFsc2U7IC8vIOS6i+S7tuWPguaVsAoKICAgIHZhciBldmVudFBhcmFtcyA9IHt9OyAvLyDlj4LmlbDlkIjlubYKCiAgICB2YXIgbWVyZ2VkT3B0aW9ucyA9IG1lcmdlT3B0aW9ucyhvcHRpb25zKTsKICAgIHZhciB1cmwgPSBtZXJnZWRPcHRpb25zLnVybCB8fCB3aW5kb3cubG9jYXRpb24udG9TdHJpbmcoKTsKICAgIHZhciBtZXRob2QgPSBtZXJnZWRPcHRpb25zLm1ldGhvZC50b1VwcGVyQ2FzZSgpOwogICAgdmFyIGRhdGEgPSBtZXJnZWRPcHRpb25zLmRhdGE7CiAgICB2YXIgcHJvY2Vzc0RhdGEgPSBtZXJnZWRPcHRpb25zLnByb2Nlc3NEYXRhOwogICAgdmFyIGFzeW5jID0gbWVyZ2VkT3B0aW9ucy5hc3luYzsKICAgIHZhciBjYWNoZSA9IG1lcmdlZE9wdGlvbnMuY2FjaGU7CiAgICB2YXIgdXNlcm5hbWUgPSBtZXJnZWRPcHRpb25zLnVzZXJuYW1lOwogICAgdmFyIHBhc3N3b3JkID0gbWVyZ2VkT3B0aW9ucy5wYXNzd29yZDsKICAgIHZhciBoZWFkZXJzID0gbWVyZ2VkT3B0aW9ucy5oZWFkZXJzOwogICAgdmFyIHhockZpZWxkcyA9IG1lcmdlZE9wdGlvbnMueGhyRmllbGRzOwogICAgdmFyIHN0YXR1c0NvZGUgPSBtZXJnZWRPcHRpb25zLnN0YXR1c0NvZGU7CiAgICB2YXIgZGF0YVR5cGUgPSBtZXJnZWRPcHRpb25zLmRhdGFUeXBlOwogICAgdmFyIGNvbnRlbnRUeXBlID0gbWVyZ2VkT3B0aW9ucy5jb250ZW50VHlwZTsKICAgIHZhciB0aW1lb3V0ID0gbWVyZ2VkT3B0aW9ucy50aW1lb3V0OwogICAgdmFyIGdsb2JhbCA9IG1lcmdlZE9wdGlvbnMuZ2xvYmFsOyAvLyDpnIDopoHlj5HpgIHnmoTmlbDmja4KICAgIC8vIEdFVC9IRUFEIOivt+axguWSjCBwcm9jZXNzRGF0YSDkuLogdHJ1ZSDml7bvvIzovazmjaLkuLrmn6Xor6LlrZfnrKbkuLLmoLzlvI/vvIznibnmrormoLzlvI/kuI3ovazmjaIKCiAgICBpZiAoZGF0YSAmJiAoaXNRdWVyeVN0cmluZ0RhdGEobWV0aG9kKSB8fCBwcm9jZXNzRGF0YSkgJiYgIWlzU3RyaW5nKGRhdGEpICYmICEoZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSAmJiAhKGRhdGEgaW5zdGFuY2VvZiBCbG9iKSAmJiAhKGRhdGEgaW5zdGFuY2VvZiBEb2N1bWVudCkgJiYgIShkYXRhIGluc3RhbmNlb2YgRm9ybURhdGEpKSB7CiAgICAgIGRhdGEgPSBwYXJhbShkYXRhKTsKICAgIH0gLy8g5a+55LqOIEdFVOOAgUhFQUQg57G75Z6L55qE6K+35rGC77yM5oqKIGRhdGEg5pWw5o2u5re75Yqg5YiwIFVSTCDkuK0KCgogICAgaWYgKGRhdGEgJiYgaXNRdWVyeVN0cmluZ0RhdGEobWV0aG9kKSkgewogICAgICAvLyDmn6Xor6LlrZfnrKbkuLLmi7zmjqXliLAgVVJMIOS4rQogICAgICB1cmwgPSBhcHBlbmRRdWVyeSh1cmwsIGRhdGEpOwogICAgICBkYXRhID0gbnVsbDsKICAgIH0KICAgIC8qKgogICAgICog6Kem5Y+R5LqL5Lu25ZKM5Zue6LCD5Ye95pWwCiAgICAgKiBAcGFyYW0gZXZlbnQKICAgICAqIEBwYXJhbSBwYXJhbXMKICAgICAqIEBwYXJhbSBjYWxsYmFjawogICAgICogQHBhcmFtIGFyZ3MKICAgICAqLwoKCiAgICBmdW5jdGlvbiB0cmlnZ2VyKGV2ZW50LCBwYXJhbXMsIGNhbGxiYWNrKSB7CiAgICAgIHZhciBhcmdzID0gW10sCiAgICAgICAgICBsZW4gPSBhcmd1bWVudHMubGVuZ3RoIC0gMzsKCiAgICAgIHdoaWxlIChsZW4tLSA+IDApIGFyZ3NbbGVuXSA9IGFyZ3VtZW50c1tsZW4gKyAzXTsgLy8g6Kem5Y+R5YWo5bGA5LqL5Lu2CgoKICAgICAgaWYgKGdsb2JhbCkgewogICAgICAgICQoZG9jdW1lbnQpLnRyaWdnZXIoZXZlbnQsIHBhcmFtcyk7CiAgICAgIH0gLy8g6Kem5Y+RIGFqYXgg5Zue6LCD5ZKM5LqL5Lu2CgoKICAgICAgdmFyIHJlc3VsdDE7CiAgICAgIHZhciByZXN1bHQyOwoKICAgICAgaWYgKGNhbGxiYWNrKSB7CiAgICAgICAgLy8g5YWo5bGA5Zue6LCDCiAgICAgICAgaWYgKGNhbGxiYWNrIGluIGdsb2JhbE9wdGlvbnMpIHsKICAgICAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgICAgIHJlc3VsdDEgPSBnbG9iYWxPcHRpb25zW2NhbGxiYWNrXS5hcHBseShnbG9iYWxPcHRpb25zLCBhcmdzKTsKICAgICAgICB9IC8vIOiHquWumuS5ieWbnuiwgwoKCiAgICAgICAgaWYgKG1lcmdlZE9wdGlvbnNbY2FsbGJhY2tdKSB7CiAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICByZXN1bHQyID0gbWVyZ2VkT3B0aW9uc1tjYWxsYmFja10uYXBwbHkobWVyZ2VkT3B0aW9ucywgYXJncyk7CiAgICAgICAgfSAvLyBiZWZvcmVTZW5kIOWbnuiwg+i/lOWbniBmYWxzZSDml7blj5bmtoggYWpheCDor7fmsYIKCgogICAgICAgIGlmIChjYWxsYmFjayA9PT0gJ2JlZm9yZVNlbmQnICYmIChyZXN1bHQxID09PSBmYWxzZSB8fCByZXN1bHQyID09PSBmYWxzZSkpIHsKICAgICAgICAgIGlzQ2FuY2VsZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfSAvLyBYTUxIdHRwUmVxdWVzdCDor7fmsYIKCgogICAgZnVuY3Rpb24gWEhSKCkgewogICAgICB2YXIgdGV4dFN0YXR1czsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICAvLyBHRVQvSEVBRCDor7fmsYLnmoTnvJPlrZjlpITnkIYKICAgICAgICBpZiAoaXNRdWVyeVN0cmluZ0RhdGEobWV0aG9kKSAmJiAhY2FjaGUpIHsKICAgICAgICAgIHVybCA9IGFwcGVuZFF1ZXJ5KHVybCwgIl89IiArIERhdGUubm93KCkpOwogICAgICAgIH0gLy8g5Yib5bu6IFhIUgoKCiAgICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwogICAgICAgIHhoci5vcGVuKG1ldGhvZCwgdXJsLCBhc3luYywgdXNlcm5hbWUsIHBhc3N3b3JkKTsKCiAgICAgICAgaWYgKGNvbnRlbnRUeXBlIHx8IGRhdGEgJiYgIWlzUXVlcnlTdHJpbmdEYXRhKG1ldGhvZCkgJiYgY29udGVudFR5cGUgIT09IGZhbHNlKSB7CiAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywgY29udGVudFR5cGUpOwogICAgICAgIH0gLy8g6K6+572uIEFjY2VwdAoKCiAgICAgICAgaWYgKGRhdGFUeXBlID09PSAnanNvbicpIHsKICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKCdBY2NlcHQnLCAnYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0Jyk7CiAgICAgICAgfSAvLyDmt7vliqAgaGVhZGVycwoKCiAgICAgICAgaWYgKGhlYWRlcnMpIHsKICAgICAgICAgIGVhY2goaGVhZGVycywgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHsKICAgICAgICAgICAgLy8gdW5kZWZpbmVkIOWAvOS4jeWPkemAge+8jHN0cmluZyDlkowgbnVsbCDpnIDopoHlj5HpgIEKICAgICAgICAgICAgaWYgKCFpc1VuZGVmaW5lZCh2YWx1ZSkpIHsKICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihrZXksIHZhbHVlICsgJycpOyAvLyDmioogbnVsbCDovazmjaLmiJDlrZfnrKbkuLIKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSAvLyDmo4Dmn6XmmK/lkKbmmK/ot6jln5/or7fmsYLvvIzot6jln5/or7fmsYLml7bkuI3mt7vliqAgWC1SZXF1ZXN0ZWQtV2l0aAoKCiAgICAgICAgdmFyIGNyb3NzRG9tYWluID0gL14oW1x3LV0rOik/XC9cLyhbXi9dKykvLnRlc3QodXJsKSAmJiBSZWdFeHAuJDIgIT09IHdpbmRvdy5sb2NhdGlvbi5ob3N0OwoKICAgICAgICBpZiAoIWNyb3NzRG9tYWluKSB7CiAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignWC1SZXF1ZXN0ZWQtV2l0aCcsICdYTUxIdHRwUmVxdWVzdCcpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHhockZpZWxkcykgewogICAgICAgICAgZWFjaCh4aHJGaWVsZHMsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgICAgICAgeGhyW2tleV0gPSB2YWx1ZTsKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgZXZlbnRQYXJhbXMueGhyID0geGhyOwogICAgICAgIGV2ZW50UGFyYW1zLm9wdGlvbnMgPSBtZXJnZWRPcHRpb25zOwogICAgICAgIHZhciB4aHJUaW1lb3V0OwoKICAgICAgICB4aHIub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKHhoclRpbWVvdXQpIHsKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHhoclRpbWVvdXQpOwogICAgICAgICAgfSAvLyBBSkFYIOi/lOWbnueahCBIVFRQIOWTjeW6lOeggeaYr+WQpuihqOekuuaIkOWKnwoKCiAgICAgICAgICB2YXIgaXNIdHRwU3RhdHVzU3VjY2VzcyA9IHhoci5zdGF0dXMgPj0gMjAwICYmIHhoci5zdGF0dXMgPCAzMDAgfHwgeGhyLnN0YXR1cyA9PT0gMzA0IHx8IHhoci5zdGF0dXMgPT09IDA7CiAgICAgICAgICB2YXIgcmVzcG9uc2VEYXRhOwoKICAgICAgICAgIGlmIChpc0h0dHBTdGF0dXNTdWNjZXNzKSB7CiAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzID09PSAyMDQgfHwgbWV0aG9kID09PSAnSEVBRCcpIHsKICAgICAgICAgICAgICB0ZXh0U3RhdHVzID0gJ25vY29udGVudCc7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoeGhyLnN0YXR1cyA9PT0gMzA0KSB7CiAgICAgICAgICAgICAgdGV4dFN0YXR1cyA9ICdub3Rtb2RpZmllZCc7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGV4dFN0YXR1cyA9ICdzdWNjZXNzJzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGRhdGFUeXBlID09PSAnanNvbicpIHsKICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmVzcG9uc2VEYXRhID0gbWV0aG9kID09PSAnSEVBRCcgPyB1bmRlZmluZWQgOiBKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgZXZlbnRQYXJhbXMuZGF0YSA9IHJlc3BvbnNlRGF0YTsKICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIHRleHRTdGF0dXMgPSAncGFyc2VyZXJyb3InOwogICAgICAgICAgICAgICAgdHJpZ2dlcihhamF4RXZlbnRzLmFqYXhFcnJvciwgZXZlbnRQYXJhbXMsICdlcnJvcicsIHhociwgdGV4dFN0YXR1cyk7CiAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKHRleHRTdGF0dXMpKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmICh0ZXh0U3RhdHVzICE9PSAncGFyc2VyZXJyb3InKSB7CiAgICAgICAgICAgICAgICB0cmlnZ2VyKGFqYXhFdmVudHMuYWpheFN1Y2Nlc3MsIGV2ZW50UGFyYW1zLCAnc3VjY2VzcycsIHJlc3BvbnNlRGF0YSwgdGV4dFN0YXR1cywgeGhyKTsKICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2VEYXRhKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcmVzcG9uc2VEYXRhID0gbWV0aG9kID09PSAnSEVBRCcgPyB1bmRlZmluZWQgOiB4aHIucmVzcG9uc2VUeXBlID09PSAndGV4dCcgfHwgeGhyLnJlc3BvbnNlVHlwZSA9PT0gJycgPyB4aHIucmVzcG9uc2VUZXh0IDogeGhyLnJlc3BvbnNlOwogICAgICAgICAgICAgIGV2ZW50UGFyYW1zLmRhdGEgPSByZXNwb25zZURhdGE7CiAgICAgICAgICAgICAgdHJpZ2dlcihhamF4RXZlbnRzLmFqYXhTdWNjZXNzLCBldmVudFBhcmFtcywgJ3N1Y2Nlc3MnLCByZXNwb25zZURhdGEsIHRleHRTdGF0dXMsIHhocik7CiAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZURhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0ZXh0U3RhdHVzID0gJ2Vycm9yJzsKICAgICAgICAgICAgdHJpZ2dlcihhamF4RXZlbnRzLmFqYXhFcnJvciwgZXZlbnRQYXJhbXMsICdlcnJvcicsIHhociwgdGV4dFN0YXR1cyk7CiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IodGV4dFN0YXR1cykpOwogICAgICAgICAgfSAvLyBzdGF0dXNDb2RlCgoKICAgICAgICAgIGVhY2goW2dsb2JhbE9wdGlvbnMuc3RhdHVzQ29kZSwgc3RhdHVzQ29kZV0sIGZ1bmN0aW9uIChfLCBmdW5jKSB7CiAgICAgICAgICAgIGlmIChmdW5jICYmIGZ1bmNbeGhyLnN0YXR1c10pIHsKICAgICAgICAgICAgICBpZiAoaXNIdHRwU3RhdHVzU3VjY2VzcykgewogICAgICAgICAgICAgICAgZnVuY1t4aHIuc3RhdHVzXShyZXNwb25zZURhdGEsIHRleHRTdGF0dXMsIHhocik7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGZ1bmNbeGhyLnN0YXR1c10oeGhyLCB0ZXh0U3RhdHVzKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgdHJpZ2dlcihhamF4RXZlbnRzLmFqYXhDb21wbGV0ZSwgZXZlbnRQYXJhbXMsICdjb21wbGV0ZScsIHhociwgdGV4dFN0YXR1cyk7CiAgICAgICAgfTsKCiAgICAgICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoeGhyVGltZW91dCkgewogICAgICAgICAgICBjbGVhclRpbWVvdXQoeGhyVGltZW91dCk7CiAgICAgICAgICB9CgogICAgICAgICAgdHJpZ2dlcihhamF4RXZlbnRzLmFqYXhFcnJvciwgZXZlbnRQYXJhbXMsICdlcnJvcicsIHhociwgeGhyLnN0YXR1c1RleHQpOwogICAgICAgICAgdHJpZ2dlcihhamF4RXZlbnRzLmFqYXhDb21wbGV0ZSwgZXZlbnRQYXJhbXMsICdjb21wbGV0ZScsIHhociwgJ2Vycm9yJyk7CiAgICAgICAgICByZWplY3QobmV3IEVycm9yKHhoci5zdGF0dXNUZXh0KSk7CiAgICAgICAgfTsKCiAgICAgICAgeGhyLm9uYWJvcnQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgc3RhdHVzVGV4dCA9ICdhYm9ydCc7CgogICAgICAgICAgaWYgKHhoclRpbWVvdXQpIHsKICAgICAgICAgICAgc3RhdHVzVGV4dCA9ICd0aW1lb3V0JzsKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHhoclRpbWVvdXQpOwogICAgICAgICAgfQoKICAgICAgICAgIHRyaWdnZXIoYWpheEV2ZW50cy5hamF4RXJyb3IsIGV2ZW50UGFyYW1zLCAnZXJyb3InLCB4aHIsIHN0YXR1c1RleHQpOwogICAgICAgICAgdHJpZ2dlcihhamF4RXZlbnRzLmFqYXhDb21wbGV0ZSwgZXZlbnRQYXJhbXMsICdjb21wbGV0ZScsIHhociwgc3RhdHVzVGV4dCk7CiAgICAgICAgICByZWplY3QobmV3IEVycm9yKHN0YXR1c1RleHQpKTsKICAgICAgICB9OyAvLyBhamF4IHN0YXJ0IOWbnuiwgwoKCiAgICAgICAgdHJpZ2dlcihhamF4RXZlbnRzLmFqYXhTdGFydCwgZXZlbnRQYXJhbXMsICdiZWZvcmVTZW5kJywgeGhyKTsKCiAgICAgICAgaWYgKGlzQ2FuY2VsZWQpIHsKICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ2NhbmNlbCcpKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IC8vIFRpbWVvdXQKCgogICAgICAgIGlmICh0aW1lb3V0ID4gMCkgewogICAgICAgICAgeGhyVGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB4aHIuYWJvcnQoKTsKICAgICAgICAgIH0sIHRpbWVvdXQpOwogICAgICAgIH0gLy8g5Y+R6YCBIFhIUgoKCiAgICAgICAgeGhyLnNlbmQoZGF0YSk7CiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiBYSFIoKTsKICB9CgogICQuYWpheCA9IGFqYXg7CiAgLyoqCiAgICog5Li6IEFqYXgg6K+35rGC6K6+572u5YWo5bGA6YWN572u5Y+C5pWwCiAgICogQHBhcmFtIG9wdGlvbnMg6ZSu5YC85a+55Y+C5pWwCiAgICogQGV4YW1wbGUKICBgYGBqcwogIGFqYXhTZXR1cCh7CiAgICBkYXRhVHlwZTogJ2pzb24nLAogICAgbWV0aG9kOiAnUE9TVCcsCiAgfSk7CiAgYGBgCiAgICovCgogIGZ1bmN0aW9uIGFqYXhTZXR1cChvcHRpb25zKSB7CiAgICByZXR1cm4gZXh0ZW5kKGdsb2JhbE9wdGlvbnMsIG9wdGlvbnMpOwogIH0KCiAgJC5hamF4U2V0dXAgPSBhamF4U2V0dXA7CiAgJC5jb250YWlucyA9IGNvbnRhaW5zOwogIHZhciBkYXRhTlMgPSAnX21kdWlFbGVtZW50RGF0YVN0b3JhZ2UnOwogIC8qKgogICAqIOWcqOWFg+e0oOS4iuiuvue9rumUruWAvOWvueaVsOaNrgogICAqIEBwYXJhbSBlbGVtZW50CiAgICogQHBhcmFtIG9iamVjdAogICAqLwoKICBmdW5jdGlvbiBzZXRPYmplY3RUb0VsZW1lbnQoZWxlbWVudCwgb2JqZWN0KSB7CiAgICAvLyBAdHMtaWdub3JlCiAgICBpZiAoIWVsZW1lbnRbZGF0YU5TXSkgewogICAgICAvLyBAdHMtaWdub3JlCiAgICAgIGVsZW1lbnRbZGF0YU5TXSA9IHt9OwogICAgfQoKICAgIGVhY2gob2JqZWN0LCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgICAvLyBAdHMtaWdub3JlCiAgICAgIGVsZW1lbnRbZGF0YU5TXVt0b0NhbWVsQ2FzZShrZXkpXSA9IHZhbHVlOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBkYXRhKGVsZW1lbnQsIGtleSwgdmFsdWUpIHsKICAgIHZhciBvYmo7IC8vIOagueaNrumUruWAvOWvueiuvue9ruWAvAogICAgLy8gZGF0YShlbGVtZW50LCB7ICdrZXknIDogJ3ZhbHVlJyB9KQoKICAgIGlmIChpc09iamVjdExpa2Uoa2V5KSkgewogICAgICBzZXRPYmplY3RUb0VsZW1lbnQoZWxlbWVudCwga2V5KTsKICAgICAgcmV0dXJuIGtleTsKICAgIH0gLy8g5qC55o2uIGtleeOAgXZhbHVlIOiuvue9ruWAvAogICAgLy8gZGF0YShlbGVtZW50LCAna2V5JywgJ3ZhbHVlJykKCgogICAgaWYgKCFpc1VuZGVmaW5lZCh2YWx1ZSkpIHsKICAgICAgc2V0T2JqZWN0VG9FbGVtZW50KGVsZW1lbnQsIChvYmogPSB7fSwgb2JqW2tleV0gPSB2YWx1ZSwgb2JqKSk7CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0gLy8g6I635Y+W5omA5pyJ5YC8CiAgICAvLyBkYXRhKGVsZW1lbnQpCgoKICAgIGlmIChpc1VuZGVmaW5lZChrZXkpKSB7CiAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgcmV0dXJuIGVsZW1lbnRbZGF0YU5TXSA/IGVsZW1lbnRbZGF0YU5TXSA6IHt9OwogICAgfSAvLyDku44gZGF0YU5TIOS4reiOt+WPluaMh+WumuWAvAogICAgLy8gZGF0YShlbGVtZW50LCAna2V5JykKCgogICAga2V5ID0gdG9DYW1lbENhc2Uoa2V5KTsgLy8gQHRzLWlnbm9yZQoKICAgIGlmIChlbGVtZW50W2RhdGFOU10gJiYga2V5IGluIGVsZW1lbnRbZGF0YU5TXSkgewogICAgICAvLyBAdHMtaWdub3JlCiAgICAgIHJldHVybiBlbGVtZW50W2RhdGFOU11ba2V5XTsKICAgIH0KCiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KCiAgJC5kYXRhID0gZGF0YTsKICAkLmVhY2ggPSBlYWNoOwoKICAkLmV4dGVuZCA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgdmFyIG9iamVjdE4gPSBbXSwKICAgICAgICBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOwoKICAgIHdoaWxlIChsZW4tLSkgb2JqZWN0TltsZW5dID0gYXJndW1lbnRzW2xlbl07CgogICAgaWYgKG9iamVjdE4ubGVuZ3RoID09PSAxKSB7CiAgICAgIGVhY2gob2JqZWN0TlswXSwgZnVuY3Rpb24gKHByb3AsIHZhbHVlKSB7CiAgICAgICAgdGhpcyQxW3Byb3BdID0gdmFsdWU7CiAgICAgIH0pOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICByZXR1cm4gZXh0ZW5kLmFwcGx5KHZvaWQgMCwgW29iamVjdE4uc2hpZnQoKSwgb2JqZWN0Ti5zaGlmdCgpXS5jb25jYXQob2JqZWN0TikpOwogIH07CgogIGZ1bmN0aW9uIG1hcChlbGVtZW50cywgY2FsbGJhY2spIHsKICAgIHZhciByZWY7CiAgICB2YXIgdmFsdWU7CiAgICB2YXIgcmV0ID0gW107CiAgICBlYWNoKGVsZW1lbnRzLCBmdW5jdGlvbiAoaSwgZWxlbWVudCkgewogICAgICB2YWx1ZSA9IGNhbGxiYWNrLmNhbGwod2luZG93LCBlbGVtZW50LCBpKTsKCiAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSB7CiAgICAgICAgcmV0LnB1c2godmFsdWUpOwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiAocmVmID0gW10pLmNvbmNhdC5hcHBseShyZWYsIHJldCk7CiAgfQoKICAkLm1hcCA9IG1hcDsKICAkLm1lcmdlID0gbWVyZ2U7CiAgJC5wYXJhbSA9IHBhcmFtOwogIC8qKgogICAqIOenu+mZpOaMh+WumuWFg+e0oOS4iuWtmOaUvueahOaVsOaNrgogICAqIEBwYXJhbSBlbGVtZW50IOWtmOaUvuaVsOaNrueahOWFg+e0oAogICAqIEBwYXJhbSBuYW1lCiAgICog5pWw5o2u6ZSu5ZCNCiAgICoKICAgKiDoi6XmnKrmjIflrprplK7lkI3vvIzlsIbnp7vpmaTlhYPntKDkuIrmiYDmnInmlbDmja4KICAgKgogICAqIOWkmuS4qumUruWQjeWPr+S7peeUqOepuuagvOWIhumalO+8jOaIluiAheeUqOaVsOe7hOihqOekuuWkmuS4qumUruWQjQogICAgQGV4YW1wbGUKICBgYGBqcwogIC8vIOenu+mZpOWFg+e0oOS4iumUruWQjeS4uiBuYW1lIOeahOaVsOaNrgogIHJlbW92ZURhdGEoZG9jdW1lbnQuYm9keSwgJ25hbWUnKTsKICBgYGAKICAgKiBAZXhhbXBsZQogIGBgYGpzCiAgLy8g56e76Zmk5YWD57Sg5LiK6ZSu5ZCN5Li6IG5hbWUxIOWSjCBuYW1lMiDnmoTmlbDmja4KICByZW1vdmVEYXRhKGRvY3VtZW50LmJvZHksICduYW1lMSBuYW1lMicpOwogIGBgYAogICAqIEBleGFtcGxlCiAgYGBganMKICAvLyDnp7vpmaTlhYPntKDkuIrplK7lkI3kuLogbmFtZTEg5ZKMIG5hbWUyIOeahOaVsOaNrgogIHJlbW92ZURhdGEoZG9jdW1lbnQuYm9keSwgWyduYW1lMScsICduYW1lMiddKTsKICBgYGAKICAgKiBAZXhhbXBsZQogIGBgYGpzCiAgLy8g56e76Zmk5YWD57Sg5LiK5omA5pyJ5pWw5o2uCiAgcmVtb3ZlRGF0YShkb2N1bWVudC5ib2R5KTsKICBgYGAKICAgKi8KCiAgZnVuY3Rpb24gcmVtb3ZlRGF0YShlbGVtZW50LCBuYW1lKSB7CiAgICAvLyBAdHMtaWdub3JlCiAgICBpZiAoIWVsZW1lbnRbZGF0YU5TXSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIHJlbW92ZSA9IGZ1bmN0aW9uIChuYW1lSXRlbSkgewogICAgICBuYW1lSXRlbSA9IHRvQ2FtZWxDYXNlKG5hbWVJdGVtKTsgLy8gQHRzLWlnbm9yZQoKICAgICAgaWYgKGVsZW1lbnRbZGF0YU5TXVtuYW1lSXRlbV0pIHsKICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgZWxlbWVudFtkYXRhTlNdW25hbWVJdGVtXSA9IG51bGw7IC8vIEB0cy1pZ25vcmUKCiAgICAgICAgZGVsZXRlIGVsZW1lbnRbZGF0YU5TXVtuYW1lSXRlbV07CiAgICAgIH0KICAgIH07CgogICAgaWYgKGlzVW5kZWZpbmVkKG5hbWUpKSB7CiAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgZWxlbWVudFtkYXRhTlNdID0gbnVsbDsgLy8gQHRzLWlnbm9yZQoKICAgICAgZGVsZXRlIGVsZW1lbnRbZGF0YU5TXTsgLy8gQHRzLWlnbm9yZQogICAgfSBlbHNlIGlmIChpc1N0cmluZyhuYW1lKSkgewogICAgICBuYW1lLnNwbGl0KCcgJykuZmlsdGVyKGZ1bmN0aW9uIChuYW1lSXRlbSkgewogICAgICAgIHJldHVybiBuYW1lSXRlbTsKICAgICAgfSkuZm9yRWFjaChmdW5jdGlvbiAobmFtZUl0ZW0pIHsKICAgICAgICByZXR1cm4gcmVtb3ZlKG5hbWVJdGVtKTsKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBlYWNoKG5hbWUsIGZ1bmN0aW9uIChfLCBuYW1lSXRlbSkgewogICAgICAgIHJldHVybiByZW1vdmUobmFtZUl0ZW0pOwogICAgICB9KTsKICAgIH0KICB9CgogICQucmVtb3ZlRGF0YSA9IHJlbW92ZURhdGE7CiAgLyoqCiAgICog6L+H5ruk5o6J5pWw57uE5Lit55qE6YeN5aSN5YWD57SgCiAgICogQHBhcmFtIGFyciDmlbDnu4QKICAgKiBAZXhhbXBsZQogIGBgYGpzCiAgdW5pcXVlKFsxLCAyLCAxMiwgMywgMiwgMSwgMiwgMSwgMV0pOwogIC8vIFsxLCAyLCAxMiwgM10KICBgYGAKICAgKi8KCiAgZnVuY3Rpb24gdW5pcXVlKGFycikgewogICAgdmFyIHJlc3VsdCA9IFtdOwogICAgZWFjaChhcnIsIGZ1bmN0aW9uIChfLCB2YWwpIHsKICAgICAgaWYgKHJlc3VsdC5pbmRleE9mKHZhbCkgPT09IC0xKSB7CiAgICAgICAgcmVzdWx0LnB1c2godmFsKTsKICAgICAgfQogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0OwogIH0KCiAgJC51bmlxdWUgPSB1bmlxdWU7CgogICQuZm4uYWRkID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICByZXR1cm4gbmV3IEpRKHVuaXF1ZShtZXJnZSh0aGlzLmdldCgpLCAkKHNlbGVjdG9yKS5nZXQoKSkpKTsKICB9OwoKICBlYWNoKFsnYWRkJywgJ3JlbW92ZScsICd0b2dnbGUnXSwgZnVuY3Rpb24gKF8sIG5hbWUpIHsKICAgICQuZm5bbmFtZSArICJDbGFzcyJdID0gZnVuY3Rpb24gKGNsYXNzTmFtZSkgewogICAgICBpZiAobmFtZSA9PT0gJ3JlbW92ZScgJiYgIWFyZ3VtZW50cy5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChfLCBlbGVtZW50KSB7CiAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnJyk7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKGksIGVsZW1lbnQpIHsKICAgICAgICBpZiAoIWlzRWxlbWVudChlbGVtZW50KSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIGNsYXNzZXMgPSAoaXNGdW5jdGlvbihjbGFzc05hbWUpID8gY2xhc3NOYW1lLmNhbGwoZWxlbWVudCwgaSwgZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykgfHwgJycpIDogY2xhc3NOYW1lKS5zcGxpdCgnICcpLmZpbHRlcihmdW5jdGlvbiAobmFtZSkgewogICAgICAgICAgcmV0dXJuIG5hbWU7CiAgICAgICAgfSk7CiAgICAgICAgZWFjaChjbGFzc2VzLCBmdW5jdGlvbiAoXywgY2xzKSB7CiAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdFtuYW1lXShjbHMpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH07CiAgfSk7CiAgZWFjaChbJ2luc2VydEJlZm9yZScsICdpbnNlcnRBZnRlciddLCBmdW5jdGlvbiAobmFtZUluZGV4LCBuYW1lKSB7CiAgICAkLmZuW25hbWVdID0gZnVuY3Rpb24gKHRhcmdldCkgewogICAgICB2YXIgJGVsZW1lbnQgPSBuYW1lSW5kZXggPyAkKHRoaXMuZ2V0KCkucmV2ZXJzZSgpKSA6IHRoaXM7IC8vIOmhuuW6j+WSjCBqUXVlcnkg5L+d5oyB5LiA6Ie0CgogICAgICB2YXIgJHRhcmdldCA9ICQodGFyZ2V0KTsKICAgICAgdmFyIHJlc3VsdCA9IFtdOwogICAgICAkdGFyZ2V0LmVhY2goZnVuY3Rpb24gKGluZGV4LCB0YXJnZXQpIHsKICAgICAgICBpZiAoIXRhcmdldC5wYXJlbnROb2RlKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAkZWxlbWVudC5lYWNoKGZ1bmN0aW9uIChfLCBlbGVtZW50KSB7CiAgICAgICAgICB2YXIgbmV3SXRlbSA9IGluZGV4ID8gZWxlbWVudC5jbG9uZU5vZGUodHJ1ZSkgOiBlbGVtZW50OwogICAgICAgICAgdmFyIGV4aXN0aW5nSXRlbSA9IG5hbWVJbmRleCA/IHRhcmdldC5uZXh0U2libGluZyA6IHRhcmdldDsKICAgICAgICAgIHJlc3VsdC5wdXNoKG5ld0l0ZW0pOwogICAgICAgICAgdGFyZ2V0LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG5ld0l0ZW0sIGV4aXN0aW5nSXRlbSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICByZXR1cm4gJChuYW1lSW5kZXggPyByZXN1bHQucmV2ZXJzZSgpIDogcmVzdWx0KTsKICAgIH07CiAgfSk7CiAgLyoqCiAgICog5piv5ZCm5LiN5pivIEhUTUwg5a2X56ym5Liy77yI5YyF6KO55ZyoIDw+IOS4re+8iQogICAqIEBwYXJhbSB0YXJnZXQKICAgKi8KCiAgZnVuY3Rpb24gaXNQbGFpblRleHQodGFyZ2V0KSB7CiAgICByZXR1cm4gaXNTdHJpbmcodGFyZ2V0KSAmJiAodGFyZ2V0WzBdICE9PSAnPCcgfHwgdGFyZ2V0W3RhcmdldC5sZW5ndGggLSAxXSAhPT0gJz4nKTsKICB9CgogIGVhY2goWydiZWZvcmUnLCAnYWZ0ZXInXSwgZnVuY3Rpb24gKG5hbWVJbmRleCwgbmFtZSkgewogICAgJC5mbltuYW1lXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGFyZ3MgPSBbXSwKICAgICAgICAgIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7CgogICAgICB3aGlsZSAobGVuLS0pIGFyZ3NbbGVuXSA9IGFyZ3VtZW50c1tsZW5dOyAvLyBhZnRlciDmlrnms5XvvIzlpJrkuKrlj4LmlbDpnIDopoHmjInlj4LmlbDpobrluo/mt7vliqDliLDlhYPntKDlkI7pnaLvvIzmiYDku6XpnIDopoHlsIblj4LmlbDpobrluo/lj43lkJHlpITnkIYKCgogICAgICBpZiAobmFtZUluZGV4ID09PSAxKSB7CiAgICAgICAgYXJncyA9IGFyZ3MucmV2ZXJzZSgpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkgewogICAgICAgIHZhciB0YXJnZXRzID0gaXNGdW5jdGlvbihhcmdzWzBdKSA/IFthcmdzWzBdLmNhbGwoZWxlbWVudCwgaW5kZXgsIGVsZW1lbnQuaW5uZXJIVE1MKV0gOiBhcmdzOwogICAgICAgIGVhY2godGFyZ2V0cywgZnVuY3Rpb24gKF8sIHRhcmdldCkgewogICAgICAgICAgdmFyICR0YXJnZXQ7CgogICAgICAgICAgaWYgKGlzUGxhaW5UZXh0KHRhcmdldCkpIHsKICAgICAgICAgICAgJHRhcmdldCA9ICQoZ2V0Q2hpbGROb2Rlc0FycmF5KHRhcmdldCwgJ2RpdicpKTsKICAgICAgICAgIH0gZWxzZSBpZiAoaW5kZXggJiYgaXNFbGVtZW50KHRhcmdldCkpIHsKICAgICAgICAgICAgJHRhcmdldCA9ICQodGFyZ2V0LmNsb25lTm9kZSh0cnVlKSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkdGFyZ2V0ID0gJCh0YXJnZXQpOwogICAgICAgICAgfQoKICAgICAgICAgICR0YXJnZXRbbmFtZUluZGV4ID8gJ2luc2VydEFmdGVyJyA6ICdpbnNlcnRCZWZvcmUnXShlbGVtZW50KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9OwogIH0pOwoKICAkLmZuLm9mZiA9IGZ1bmN0aW9uICh0eXBlcywgc2VsZWN0b3IsIGNhbGxiYWNrKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsgLy8gdHlwZXMg5piv5a+56LGhCgogICAgaWYgKGlzT2JqZWN0TGlrZSh0eXBlcykpIHsKICAgICAgZWFjaCh0eXBlcywgZnVuY3Rpb24gKHR5cGUsIGZuKSB7CiAgICAgICAgLy8gdGhpcy5vZmYoJ2NsaWNrJywgdW5kZWZpbmVkLCBmdW5jdGlvbiAoKSB7fSkKICAgICAgICAvLyB0aGlzLm9mZignY2xpY2snLCAnLmJveCcsIGZ1bmN0aW9uICgpIHt9KQogICAgICAgIHRoaXMkMS5vZmYodHlwZSwgc2VsZWN0b3IsIGZuKTsKICAgICAgfSk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSAvLyBzZWxlY3RvciDkuI3lrZjlnKgKCgogICAgaWYgKHNlbGVjdG9yID09PSBmYWxzZSB8fCBpc0Z1bmN0aW9uKHNlbGVjdG9yKSkgewogICAgICBjYWxsYmFjayA9IHNlbGVjdG9yOwogICAgICBzZWxlY3RvciA9IHVuZGVmaW5lZDsgLy8gdGhpcy5vZmYoJ2NsaWNrJywgdW5kZWZpbmVkLCBmdW5jdGlvbiAoKSB7fSkKICAgIH0gLy8gY2FsbGJhY2sg5Lyg5YWlIGBmYWxzZWDvvIznm7jlvZPkuo4gYHJldHVybiBmYWxzZWAKCgogICAgaWYgKGNhbGxiYWNrID09PSBmYWxzZSkgewogICAgICBjYWxsYmFjayA9IHJldHVybkZhbHNlOwogICAgfQoKICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICByZW1vdmUodGhpcywgdHlwZXMsIGNhbGxiYWNrLCBzZWxlY3Rvcik7CiAgICB9KTsKICB9OwoKICAkLmZuLm9uID0gZnVuY3Rpb24gKHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgY2FsbGJhY2ssIG9uZSkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7IC8vIHR5cGVzIOWPr+S7peaYryB0eXBlL2Z1bmMg5a+56LGhCgogICAgaWYgKGlzT2JqZWN0TGlrZSh0eXBlcykpIHsKICAgICAgLy8gKHR5cGVzLU9iamVjdCwgc2VsZWN0b3IsIGRhdGEpCiAgICAgIGlmICghaXNTdHJpbmcoc2VsZWN0b3IpKSB7CiAgICAgICAgLy8gKHR5cGVzLU9iamVjdCwgZGF0YSkKICAgICAgICBkYXRhID0gZGF0YSB8fCBzZWxlY3RvcjsKICAgICAgICBzZWxlY3RvciA9IHVuZGVmaW5lZDsKICAgICAgfQoKICAgICAgZWFjaCh0eXBlcywgZnVuY3Rpb24gKHR5cGUsIGZuKSB7CiAgICAgICAgLy8gc2VsZWN0b3Ig5ZKMIGRhdGEg6YO95Y+v6IO95pivIHVuZGVmaW5lZAogICAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgICB0aGlzJDEub24odHlwZSwgc2VsZWN0b3IsIGRhdGEsIGZuLCBvbmUpOwogICAgICB9KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgaWYgKGRhdGEgPT0gbnVsbCAmJiBjYWxsYmFjayA9PSBudWxsKSB7CiAgICAgIC8vICh0eXBlcywgZm4pCiAgICAgIGNhbGxiYWNrID0gc2VsZWN0b3I7CiAgICAgIGRhdGEgPSBzZWxlY3RvciA9IHVuZGVmaW5lZDsKICAgIH0gZWxzZSBpZiAoY2FsbGJhY2sgPT0gbnVsbCkgewogICAgICBpZiAoaXNTdHJpbmcoc2VsZWN0b3IpKSB7CiAgICAgICAgLy8gKHR5cGVzLCBzZWxlY3RvciwgZm4pCiAgICAgICAgY2FsbGJhY2sgPSBkYXRhOwogICAgICAgIGRhdGEgPSB1bmRlZmluZWQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gKHR5cGVzLCBkYXRhLCBmbikKICAgICAgICBjYWxsYmFjayA9IGRhdGE7CiAgICAgICAgZGF0YSA9IHNlbGVjdG9yOwogICAgICAgIHNlbGVjdG9yID0gdW5kZWZpbmVkOwogICAgICB9CiAgICB9CgogICAgaWYgKGNhbGxiYWNrID09PSBmYWxzZSkgewogICAgICBjYWxsYmFjayA9IHJldHVybkZhbHNlOwogICAgfSBlbHNlIGlmICghY2FsbGJhY2spIHsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9IC8vICQoKS5vbmUoKQoKCiAgICBpZiAob25lKSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdGhpcy1hbGlhcwogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIG9yaWdDYWxsYmFjayA9IGNhbGxiYWNrOwoKICAgICAgY2FsbGJhY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBfdGhpcy5vZmYoZXZlbnQudHlwZSwgc2VsZWN0b3IsIGNhbGxiYWNrKTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1yZXN0LXBhcmFtcwoKCiAgICAgICAgcmV0dXJuIG9yaWdDYWxsYmFjay5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9OwogICAgfQoKICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICBhZGQodGhpcywgdHlwZXMsIGNhbGxiYWNrLCBkYXRhLCBzZWxlY3Rvcik7CiAgICB9KTsKICB9OwoKICBlYWNoKGFqYXhFdmVudHMsIGZ1bmN0aW9uIChuYW1lLCBldmVudE5hbWUpIHsKICAgICQuZm5bbmFtZV0gPSBmdW5jdGlvbiAoZm4pIHsKICAgICAgcmV0dXJuIHRoaXMub24oZXZlbnROYW1lLCBmdW5jdGlvbiAoZSwgcGFyYW1zKSB7CiAgICAgICAgZm4oZSwgcGFyYW1zLnhociwgcGFyYW1zLm9wdGlvbnMsIHBhcmFtcy5kYXRhKTsKICAgICAgfSk7CiAgICB9OwogIH0pOwoKICAkLmZuLm1hcCA9IGZ1bmN0aW9uIChjYWxsYmFjaykgewogICAgcmV0dXJuIG5ldyBKUShtYXAodGhpcywgZnVuY3Rpb24gKGVsZW1lbnQsIGkpIHsKICAgICAgcmV0dXJuIGNhbGxiYWNrLmNhbGwoZWxlbWVudCwgaSwgZWxlbWVudCk7CiAgICB9KSk7CiAgfTsKCiAgJC5mbi5jbG9uZSA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzLm1hcChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzLmNsb25lTm9kZSh0cnVlKTsKICAgIH0pOwogIH07CgogICQuZm4uaXMgPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgIHZhciBpc01hdGNoZWQgPSBmYWxzZTsKCiAgICBpZiAoaXNGdW5jdGlvbihzZWxlY3RvcikpIHsKICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkgewogICAgICAgIGlmIChzZWxlY3Rvci5jYWxsKGVsZW1lbnQsIGluZGV4LCBlbGVtZW50KSkgewogICAgICAgICAgaXNNYXRjaGVkID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gaXNNYXRjaGVkOwogICAgfQoKICAgIGlmIChpc1N0cmluZyhzZWxlY3RvcikpIHsKICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uIChfLCBlbGVtZW50KSB7CiAgICAgICAgaWYgKGlzRG9jdW1lbnQoZWxlbWVudCkgfHwgaXNXaW5kb3coZWxlbWVudCkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IC8vIEB0cy1pZ25vcmUKCgogICAgICAgIHZhciBtYXRjaGVzID0gZWxlbWVudC5tYXRjaGVzIHx8IGVsZW1lbnQubXNNYXRjaGVzU2VsZWN0b3I7CgogICAgICAgIGlmIChtYXRjaGVzLmNhbGwoZWxlbWVudCwgc2VsZWN0b3IpKSB7CiAgICAgICAgICBpc01hdGNoZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiBpc01hdGNoZWQ7CiAgICB9CgogICAgdmFyICRjb21wYXJlV2l0aCA9ICQoc2VsZWN0b3IpOwogICAgdGhpcy5lYWNoKGZ1bmN0aW9uIChfLCBlbGVtZW50KSB7CiAgICAgICRjb21wYXJlV2l0aC5lYWNoKGZ1bmN0aW9uIChfLCBjb21wYXJlKSB7CiAgICAgICAgaWYgKGVsZW1lbnQgPT09IGNvbXBhcmUpIHsKICAgICAgICAgIGlzTWF0Y2hlZCA9IHRydWU7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwogICAgcmV0dXJuIGlzTWF0Y2hlZDsKICB9OwoKICAkLmZuLnJlbW92ZSA9IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICBpZiAoZWxlbWVudC5wYXJlbnROb2RlICYmICghc2VsZWN0b3IgfHwgJChlbGVtZW50KS5pcyhzZWxlY3RvcikpKSB7CiAgICAgICAgZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsZW1lbnQpOwogICAgICB9CiAgICB9KTsKICB9OwoKICBlYWNoKFsncHJlcGVuZCcsICdhcHBlbmQnXSwgZnVuY3Rpb24gKG5hbWVJbmRleCwgbmFtZSkgewogICAgJC5mbltuYW1lXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGFyZ3MgPSBbXSwKICAgICAgICAgIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7CgogICAgICB3aGlsZSAobGVuLS0pIGFyZ3NbbGVuXSA9IGFyZ3VtZW50c1tsZW5dOwoKICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGVsZW1lbnQpIHsKICAgICAgICB2YXIgcmVmOwogICAgICAgIHZhciBjaGlsZE5vZGVzID0gZWxlbWVudC5jaGlsZE5vZGVzOwogICAgICAgIHZhciBjaGlsZExlbmd0aCA9IGNoaWxkTm9kZXMubGVuZ3RoOwogICAgICAgIHZhciBjaGlsZCA9IGNoaWxkTGVuZ3RoID8gY2hpbGROb2Rlc1tuYW1lSW5kZXggPyBjaGlsZExlbmd0aCAtIDEgOiAwXSA6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwoKICAgICAgICBpZiAoIWNoaWxkTGVuZ3RoKSB7CiAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGNoaWxkKTsKICAgICAgICB9CgogICAgICAgIHZhciBjb250ZW50cyA9IGlzRnVuY3Rpb24oYXJnc1swXSkgPyBbYXJnc1swXS5jYWxsKGVsZW1lbnQsIGluZGV4LCBlbGVtZW50LmlubmVySFRNTCldIDogYXJnczsgLy8g5aaC5p6c5LiN5piv5a2X56ym5Liy77yM5YiZ5LuF56ys5LiA5Liq5YWD57Sg5L2/55So5Y6f5aeL5YWD57Sg77yM5YW25LuW55qE6YO95YWL6ZqG6Ieq56ys5LiA5Liq5YWD57SgCgogICAgICAgIGlmIChpbmRleCkgewogICAgICAgICAgY29udGVudHMgPSBjb250ZW50cy5tYXAoZnVuY3Rpb24gKGNvbnRlbnQpIHsKICAgICAgICAgICAgcmV0dXJuIGlzU3RyaW5nKGNvbnRlbnQpID8gY29udGVudCA6ICQoY29udGVudCkuY2xvbmUoKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgKHJlZiA9ICQoY2hpbGQpKVtuYW1lSW5kZXggPyAnYWZ0ZXInIDogJ2JlZm9yZSddLmFwcGx5KHJlZiwgY29udGVudHMpOwoKICAgICAgICBpZiAoIWNoaWxkTGVuZ3RoKSB7CiAgICAgICAgICBlbGVtZW50LnJlbW92ZUNoaWxkKGNoaWxkKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKICB9KTsKICBlYWNoKFsnYXBwZW5kVG8nLCAncHJlcGVuZFRvJ10sIGZ1bmN0aW9uIChuYW1lSW5kZXgsIG5hbWUpIHsKICAgICQuZm5bbmFtZV0gPSBmdW5jdGlvbiAodGFyZ2V0KSB7CiAgICAgIHZhciBleHRyYUNoaWxkcyA9IFtdOwogICAgICB2YXIgJHRhcmdldCA9ICQodGFyZ2V0KS5tYXAoZnVuY3Rpb24gKF8sIGVsZW1lbnQpIHsKICAgICAgICB2YXIgY2hpbGROb2RlcyA9IGVsZW1lbnQuY2hpbGROb2RlczsKICAgICAgICB2YXIgY2hpbGRMZW5ndGggPSBjaGlsZE5vZGVzLmxlbmd0aDsKCiAgICAgICAgaWYgKGNoaWxkTGVuZ3RoKSB7CiAgICAgICAgICByZXR1cm4gY2hpbGROb2Rlc1tuYW1lSW5kZXggPyAwIDogY2hpbGRMZW5ndGggLSAxXTsKICAgICAgICB9CgogICAgICAgIHZhciBjaGlsZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoY2hpbGQpOwogICAgICAgIGV4dHJhQ2hpbGRzLnB1c2goY2hpbGQpOwogICAgICAgIHJldHVybiBjaGlsZDsKICAgICAgfSk7CiAgICAgIHZhciAkcmVzdWx0ID0gdGhpc1tuYW1lSW5kZXggPyAnaW5zZXJ0QmVmb3JlJyA6ICdpbnNlcnRBZnRlciddKCR0YXJnZXQpOwogICAgICAkKGV4dHJhQ2hpbGRzKS5yZW1vdmUoKTsKICAgICAgcmV0dXJuICRyZXN1bHQ7CiAgICB9OwogIH0pOwogIGVhY2goWydhdHRyJywgJ3Byb3AnLCAnY3NzJ10sIGZ1bmN0aW9uIChuYW1lSW5kZXgsIG5hbWUpIHsKICAgIGZ1bmN0aW9uIHNldChlbGVtZW50LCBrZXksIHZhbHVlKSB7CiAgICAgIC8vIOWAvOS4uiB1bmRlZmluZWQg5pe277yM5LiN5L+u5pS5CiAgICAgIGlmIChpc1VuZGVmaW5lZCh2YWx1ZSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHN3aXRjaCAobmFtZUluZGV4KSB7CiAgICAgICAgLy8gYXR0cgogICAgICAgIGNhc2UgMDoKICAgICAgICAgIGlmIChpc051bGwodmFsdWUpKSB7CiAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKGtleSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShrZXksIHZhbHVlKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKICAgICAgICAvLyBwcm9wCgogICAgICAgIGNhc2UgMToKICAgICAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgICAgIGVsZW1lbnRba2V5XSA9IHZhbHVlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgLy8gY3NzCgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBrZXkgPSB0b0NhbWVsQ2FzZShrZXkpOyAvLyBAdHMtaWdub3JlCgogICAgICAgICAgZWxlbWVudC5zdHlsZVtrZXldID0gaXNOdW1iZXIodmFsdWUpID8gIiIgKyB2YWx1ZSArIChjc3NOdW1iZXIuaW5kZXhPZihrZXkpID4gLTEgPyAnJyA6ICdweCcpIDogdmFsdWU7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGdldChlbGVtZW50LCBrZXkpIHsKICAgICAgc3dpdGNoIChuYW1lSW5kZXgpIHsKICAgICAgICAvLyBhdHRyCiAgICAgICAgY2FzZSAwOgogICAgICAgICAgLy8g5bGe5oCn5LiN5a2Y5Zyo5pe277yM5Y6f55SfIGdldEF0dHJpYnV0ZSDmlrnms5Xov5Tlm54gbnVsbO+8jOiAjCBqcXVlcnkg6L+U5ZueIHVuZGVmaW5lZOOAgui/memHjOWSjCBqcXVlcnkg5L+d5oyB5LiA6Ie0CiAgICAgICAgICB2YXIgdmFsdWUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShrZXkpOwogICAgICAgICAgcmV0dXJuIGlzTnVsbCh2YWx1ZSkgPyB1bmRlZmluZWQgOiB2YWx1ZTsKICAgICAgICAvLyBwcm9wCgogICAgICAgIGNhc2UgMToKICAgICAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgICAgIHJldHVybiBlbGVtZW50W2tleV07CiAgICAgICAgLy8gY3NzCgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICByZXR1cm4gZ2V0U3R5bGUoZWxlbWVudCwga2V5KTsKICAgICAgfQogICAgfQoKICAgICQuZm5bbmFtZV0gPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgICB2YXIgdGhpcyQxID0gdGhpczsKCiAgICAgIGlmIChpc09iamVjdExpa2Uoa2V5KSkgewogICAgICAgIGVhY2goa2V5LCBmdW5jdGlvbiAoaywgdikgewogICAgICAgICAgLy8gQHRzLWlnbm9yZQogICAgICAgICAgdGhpcyQxW25hbWVdKGssIHYpOwogICAgICAgIH0pOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CgogICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkgewogICAgICAgIHZhciBlbGVtZW50ID0gdGhpc1swXTsKICAgICAgICByZXR1cm4gaXNFbGVtZW50KGVsZW1lbnQpID8gZ2V0KGVsZW1lbnQsIGtleSkgOiB1bmRlZmluZWQ7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKGksIGVsZW1lbnQpIHsKICAgICAgICBzZXQoZWxlbWVudCwga2V5LCBpc0Z1bmN0aW9uKHZhbHVlKSA/IHZhbHVlLmNhbGwoZWxlbWVudCwgaSwgZ2V0KGVsZW1lbnQsIGtleSkpIDogdmFsdWUpOwogICAgICB9KTsKICAgIH07CiAgfSk7CgogICQuZm4uY2hpbGRyZW4gPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgIHZhciBjaGlsZHJlbiA9IFtdOwogICAgdGhpcy5lYWNoKGZ1bmN0aW9uIChfLCBlbGVtZW50KSB7CiAgICAgIGVhY2goZWxlbWVudC5jaGlsZE5vZGVzLCBmdW5jdGlvbiAoX18sIGNoaWxkTm9kZSkgewogICAgICAgIGlmICghaXNFbGVtZW50KGNoaWxkTm9kZSkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICghc2VsZWN0b3IgfHwgJChjaGlsZE5vZGUpLmlzKHNlbGVjdG9yKSkgewogICAgICAgICAgY2hpbGRyZW4ucHVzaChjaGlsZE5vZGUpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9KTsKICAgIHJldHVybiBuZXcgSlEodW5pcXVlKGNoaWxkcmVuKSk7CiAgfTsKCiAgJC5mbi5zbGljZSA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciBhcmdzID0gW10sCiAgICAgICAgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsKCiAgICB3aGlsZSAobGVuLS0pIGFyZ3NbbGVuXSA9IGFyZ3VtZW50c1tsZW5dOwoKICAgIHJldHVybiBuZXcgSlEoW10uc2xpY2UuYXBwbHkodGhpcywgYXJncykpOwogIH07CgogICQuZm4uZXEgPSBmdW5jdGlvbiAoaW5kZXgpIHsKICAgIHZhciByZXQgPSBpbmRleCA9PT0gLTEgPyB0aGlzLnNsaWNlKGluZGV4KSA6IHRoaXMuc2xpY2UoaW5kZXgsICtpbmRleCArIDEpOwogICAgcmV0dXJuIG5ldyBKUShyZXQpOwogIH07CgogIGZ1bmN0aW9uIGRpcigkZWxlbWVudHMsIG5hbWVJbmRleCwgbm9kZSwgc2VsZWN0b3IsIGZpbHRlcikgewogICAgdmFyIHJldCA9IFtdOwogICAgdmFyIHRhcmdldDsKICAgICRlbGVtZW50cy5lYWNoKGZ1bmN0aW9uIChfLCBlbGVtZW50KSB7CiAgICAgIHRhcmdldCA9IGVsZW1lbnRbbm9kZV07IC8vIOS4jeiDveWMheWQq+acgOmhtuWxgueahCBkb2N1bWVudCDlhYPntKAKCiAgICAgIHdoaWxlICh0YXJnZXQgJiYgaXNFbGVtZW50KHRhcmdldCkpIHsKICAgICAgICAvLyBwcmV2VW50aWwsIG5leHRVbnRpbCwgcGFyZW50c1VudGlsCiAgICAgICAgaWYgKG5hbWVJbmRleCA9PT0gMikgewogICAgICAgICAgaWYgKHNlbGVjdG9yICYmICQodGFyZ2V0KS5pcyhzZWxlY3RvcikpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFmaWx0ZXIgfHwgJCh0YXJnZXQpLmlzKGZpbHRlcikpIHsKICAgICAgICAgICAgcmV0LnB1c2godGFyZ2V0KTsKICAgICAgICAgIH0KICAgICAgICB9IC8vIHByZXYsIG5leHQsIHBhcmVudAogICAgICAgIGVsc2UgaWYgKG5hbWVJbmRleCA9PT0gMCkgewogICAgICAgICAgICBpZiAoIXNlbGVjdG9yIHx8ICQodGFyZ2V0KS5pcyhzZWxlY3RvcikpIHsKICAgICAgICAgICAgICByZXQucHVzaCh0YXJnZXQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0gLy8gcHJldkFsbCwgbmV4dEFsbCwgcGFyZW50cwogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgaWYgKCFzZWxlY3RvciB8fCAkKHRhcmdldCkuaXMoc2VsZWN0b3IpKSB7CiAgICAgICAgICAgICAgICByZXQucHVzaCh0YXJnZXQpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSAvLyBAdHMtaWdub3JlCgoKICAgICAgICB0YXJnZXQgPSB0YXJnZXRbbm9kZV07CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIG5ldyBKUSh1bmlxdWUocmV0KSk7CiAgfQoKICBlYWNoKFsnJywgJ3MnLCAnc1VudGlsJ10sIGZ1bmN0aW9uIChuYW1lSW5kZXgsIG5hbWUpIHsKICAgICQuZm5bInBhcmVudCIgKyBuYW1lXSA9IGZ1bmN0aW9uIChzZWxlY3RvciwgZmlsdGVyKSB7CiAgICAgIC8vIHBhcmVudHPjgIFwYXJlbnRzVW50aWwg6ZyA6KaB5oqK5YWD57Sg55qE6aG65bqP5Y+N5ZCR5aSE55CG77yM5Lul5L6/5ZKMIGpRdWVyeSDnmoTnu5PmnpzkuIDoh7QKICAgICAgdmFyICRub2RlcyA9ICFuYW1lSW5kZXggPyB0aGlzIDogJCh0aGlzLmdldCgpLnJldmVyc2UoKSk7CiAgICAgIHJldHVybiBkaXIoJG5vZGVzLCBuYW1lSW5kZXgsICdwYXJlbnROb2RlJywgc2VsZWN0b3IsIGZpbHRlcik7CiAgICB9OwogIH0pOwoKICAkLmZuLmNsb3Nlc3QgPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgIGlmICh0aGlzLmlzKHNlbGVjdG9yKSkgewogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICB2YXIgbWF0Y2hlZCA9IFtdOwogICAgdGhpcy5wYXJlbnRzKCkuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICBpZiAoJChlbGVtZW50KS5pcyhzZWxlY3RvcikpIHsKICAgICAgICBtYXRjaGVkLnB1c2goZWxlbWVudCk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiBuZXcgSlEobWF0Y2hlZCk7CiAgfTsKCiAgdmFyIHJicmFjZSA9IC9eKD86e1tcd1xXXSpcfXxcW1tcd1xXXSpcXSkkLzsgLy8g5LuOIGBkYXRhLSpgIOS4reiOt+WPlueahOWAvO+8jOmcgOimgee7j+i/h+ivpeWHveaVsOi9rOaNogoKICBmdW5jdGlvbiBnZXREYXRhKHZhbHVlKSB7CiAgICBpZiAodmFsdWUgPT09ICd0cnVlJykgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBpZiAodmFsdWUgPT09ICdmYWxzZScpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIGlmICh2YWx1ZSA9PT0gJ251bGwnKSB7CiAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGlmICh2YWx1ZSA9PT0gK3ZhbHVlICsgJycpIHsKICAgICAgcmV0dXJuICt2YWx1ZTsKICAgIH0KCiAgICBpZiAocmJyYWNlLnRlc3QodmFsdWUpKSB7CiAgICAgIHJldHVybiBKU09OLnBhcnNlKHZhbHVlKTsKICAgIH0KCiAgICByZXR1cm4gdmFsdWU7CiAgfSAvLyDoi6UgdmFsdWUg5LiN5a2Y5Zyo77yM5YiZ5LuOIGBkYXRhLSpgIOS4reiOt+WPluWAvAoKCiAgZnVuY3Rpb24gZGF0YUF0dHIoZWxlbWVudCwga2V5LCB2YWx1ZSkgewogICAgaWYgKGlzVW5kZWZpbmVkKHZhbHVlKSAmJiBlbGVtZW50Lm5vZGVUeXBlID09PSAxKSB7CiAgICAgIHZhciBuYW1lID0gJ2RhdGEtJyArIHRvS2ViYWJDYXNlKGtleSk7CiAgICAgIHZhbHVlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUobmFtZSk7CgogICAgICBpZiAoaXNTdHJpbmcodmFsdWUpKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHZhbHVlID0gZ2V0RGF0YSh2YWx1ZSk7CiAgICAgICAgfSBjYXRjaCAoZSkge30KICAgICAgfSBlbHNlIHsKICAgICAgICB2YWx1ZSA9IHVuZGVmaW5lZDsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB2YWx1ZTsKICB9CgogICQuZm4uZGF0YSA9IGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICAvLyDojrflj5bmiYDmnInlgLwKICAgIGlmIChpc1VuZGVmaW5lZChrZXkpKSB7CiAgICAgIGlmICghdGhpcy5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICB9CgogICAgICB2YXIgZWxlbWVudCA9IHRoaXNbMF07CiAgICAgIHZhciByZXN1bHREYXRhID0gZGF0YShlbGVtZW50KTsgLy8gd2luZG93LCBkb2N1bWVudCDkuIrkuI3lrZjlnKggYGRhdGEtKmAg5bGe5oCnCgogICAgICBpZiAoZWxlbWVudC5ub2RlVHlwZSAhPT0gMSkgewogICAgICAgIHJldHVybiByZXN1bHREYXRhOwogICAgICB9IC8vIOS7jiBgZGF0YS0qYCDkuK3ojrflj5blgLwKCgogICAgICB2YXIgYXR0cnMgPSBlbGVtZW50LmF0dHJpYnV0ZXM7CiAgICAgIHZhciBpID0gYXR0cnMubGVuZ3RoOwoKICAgICAgd2hpbGUgKGktLSkgewogICAgICAgIGlmIChhdHRyc1tpXSkgewogICAgICAgICAgdmFyIG5hbWUgPSBhdHRyc1tpXS5uYW1lOwoKICAgICAgICAgIGlmIChuYW1lLmluZGV4T2YoJ2RhdGEtJykgPT09IDApIHsKICAgICAgICAgICAgbmFtZSA9IHRvQ2FtZWxDYXNlKG5hbWUuc2xpY2UoNSkpOwogICAgICAgICAgICByZXN1bHREYXRhW25hbWVdID0gZGF0YUF0dHIoZWxlbWVudCwgbmFtZSwgcmVzdWx0RGF0YVtuYW1lXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0RGF0YTsKICAgIH0gLy8g5ZCM5pe26K6+572u5aSa5Liq5YC8CgoKICAgIGlmIChpc09iamVjdExpa2Uoa2V5KSkgewogICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICBkYXRhKHRoaXMsIGtleSk7CiAgICAgIH0pOwogICAgfSAvLyB2YWx1ZSDkvKDlhaXkuoYgdW5kZWZpbmVkCgoKICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyICYmIGlzVW5kZWZpbmVkKHZhbHVlKSkgewogICAgICByZXR1cm4gdGhpczsKICAgIH0gLy8g6K6+572u5YC8CgoKICAgIGlmICghaXNVbmRlZmluZWQodmFsdWUpKSB7CiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgIGRhdGEodGhpcywga2V5LCB2YWx1ZSk7CiAgICAgIH0pOwogICAgfSAvLyDojrflj5blgLwKCgogICAgaWYgKCF0aGlzLmxlbmd0aCkgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfQoKICAgIHJldHVybiBkYXRhQXR0cih0aGlzWzBdLCBrZXksIGRhdGEodGhpc1swXSwga2V5KSk7CiAgfTsKCiAgJC5mbi5lbXB0eSA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICB0aGlzLmlubmVySFRNTCA9ICcnOwogICAgfSk7CiAgfTsKCiAgJC5mbi5leHRlbmQgPSBmdW5jdGlvbiAob2JqKSB7CiAgICBlYWNoKG9iaiwgZnVuY3Rpb24gKHByb3AsIHZhbHVlKSB7CiAgICAgIC8vIOWcqCBKUSDlr7nosaHkuIrmianlsZXmlrnms5Xml7bvvIzpnIDopoHoh6rlt7Hmt7vliqAgdHlwZXNjcmlwdCDnmoTnsbvlnovlrprkuYkKICAgICAgJC5mbltwcm9wXSA9IHZhbHVlOwogICAgfSk7CiAgICByZXR1cm4gdGhpczsKICB9OwoKICAkLmZuLmZpbHRlciA9IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgaWYgKGlzRnVuY3Rpb24oc2VsZWN0b3IpKSB7CiAgICAgIHJldHVybiB0aGlzLm1hcChmdW5jdGlvbiAoaW5kZXgsIGVsZW1lbnQpIHsKICAgICAgICByZXR1cm4gc2VsZWN0b3IuY2FsbChlbGVtZW50LCBpbmRleCwgZWxlbWVudCkgPyBlbGVtZW50IDogdW5kZWZpbmVkOwogICAgICB9KTsKICAgIH0KCiAgICBpZiAoaXNTdHJpbmcoc2VsZWN0b3IpKSB7CiAgICAgIHJldHVybiB0aGlzLm1hcChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICAgIHJldHVybiAkKGVsZW1lbnQpLmlzKHNlbGVjdG9yKSA/IGVsZW1lbnQgOiB1bmRlZmluZWQ7CiAgICAgIH0pOwogICAgfQoKICAgIHZhciAkc2VsZWN0b3IgPSAkKHNlbGVjdG9yKTsKICAgIHJldHVybiB0aGlzLm1hcChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICByZXR1cm4gJHNlbGVjdG9yLmdldCgpLmluZGV4T2YoZWxlbWVudCkgPiAtMSA/IGVsZW1lbnQgOiB1bmRlZmluZWQ7CiAgICB9KTsKICB9OwoKICAkLmZuLmZpcnN0ID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHRoaXMuZXEoMCk7CiAgfTsKCiAgJC5mbi5oYXMgPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgIHZhciAkdGFyZ2V0cyA9IGlzU3RyaW5nKHNlbGVjdG9yKSA/IHRoaXMuZmluZChzZWxlY3RvcikgOiAkKHNlbGVjdG9yKTsKICAgIHZhciBsZW5ndGggPSAkdGFyZ2V0cy5sZW5ndGg7CiAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKCkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7CiAgICAgICAgaWYgKGNvbnRhaW5zKHRoaXMsICR0YXJnZXRzW2ldKSkgewogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm47CiAgICB9KTsKICB9OwoKICAkLmZuLmhhc0NsYXNzID0gZnVuY3Rpb24gKGNsYXNzTmFtZSkgewogICAgcmV0dXJuIHRoaXNbMF0uY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSk7CiAgfTsKICAvKioKICAgKiDlgLzkuIrpnaLnmoQgcGFkZGluZ+OAgWJvcmRlcuOAgW1hcmdpbiDlpITnkIYKICAgKiBAcGFyYW0gZWxlbWVudAogICAqIEBwYXJhbSBuYW1lCiAgICogQHBhcmFtIHZhbHVlCiAgICogQHBhcmFtIGZ1bmNJbmRleAogICAqIEBwYXJhbSBpbmNsdWRlTWFyZ2luCiAgICogQHBhcmFtIG11bHRpcGx5CiAgICovCgoKICBmdW5jdGlvbiBoYW5kbGVFeHRyYVdpZHRoKGVsZW1lbnQsIG5hbWUsIHZhbHVlLCBmdW5jSW5kZXgsIGluY2x1ZGVNYXJnaW4sIG11bHRpcGx5KSB7CiAgICAvLyDojrflj5blhYPntKDnmoQgcGFkZGluZywgYm9yZGVyLCBtYXJnaW4g5a695bqm77yI5Lik5L6n5a695bqm55qE5ZKM77yJCiAgICB2YXIgZ2V0RXh0cmFXaWR0aFZhbHVlID0gZnVuY3Rpb24gKGV4dHJhKSB7CiAgICAgIHJldHVybiBnZXRFeHRyYVdpZHRoKGVsZW1lbnQsIG5hbWUudG9Mb3dlckNhc2UoKSwgZXh0cmEpICogbXVsdGlwbHk7CiAgICB9OwoKICAgIGlmIChmdW5jSW5kZXggPT09IDIgJiYgaW5jbHVkZU1hcmdpbikgewogICAgICB2YWx1ZSArPSBnZXRFeHRyYVdpZHRoVmFsdWUoJ21hcmdpbicpOwogICAgfQoKICAgIGlmIChpc0JvcmRlckJveChlbGVtZW50KSkgewogICAgICAvLyBJRSDkuLogYm94LXNpemluZzogYm9yZGVyLWJveCDml7bvvIzlvpfliLDnmoTlgLzkuI3lkKsgYm9yZGVyIOWSjCBwYWRkaW5n77yM6L+Z6YeM5YWI5L+u5aSNCiAgICAgIC8vIOS7heiOt+WPluaXtumcgOimgeWkhOeQhu+8jG11bHRpcGx5ID09PSAxIOS4uiBnZXQKICAgICAgaWYgKGlzSUUoKSAmJiBtdWx0aXBseSA9PT0gMSkgewogICAgICAgIHZhbHVlICs9IGdldEV4dHJhV2lkdGhWYWx1ZSgnYm9yZGVyJyk7CiAgICAgICAgdmFsdWUgKz0gZ2V0RXh0cmFXaWR0aFZhbHVlKCdwYWRkaW5nJyk7CiAgICAgIH0KCiAgICAgIGlmIChmdW5jSW5kZXggPT09IDApIHsKICAgICAgICB2YWx1ZSAtPSBnZXRFeHRyYVdpZHRoVmFsdWUoJ2JvcmRlcicpOwogICAgICB9CgogICAgICBpZiAoZnVuY0luZGV4ID09PSAxKSB7CiAgICAgICAgdmFsdWUgLT0gZ2V0RXh0cmFXaWR0aFZhbHVlKCdib3JkZXInKTsKICAgICAgICB2YWx1ZSAtPSBnZXRFeHRyYVdpZHRoVmFsdWUoJ3BhZGRpbmcnKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKGZ1bmNJbmRleCA9PT0gMCkgewogICAgICAgIHZhbHVlICs9IGdldEV4dHJhV2lkdGhWYWx1ZSgncGFkZGluZycpOwogICAgICB9CgogICAgICBpZiAoZnVuY0luZGV4ID09PSAyKSB7CiAgICAgICAgdmFsdWUgKz0gZ2V0RXh0cmFXaWR0aFZhbHVlKCdib3JkZXInKTsKICAgICAgICB2YWx1ZSArPSBnZXRFeHRyYVdpZHRoVmFsdWUoJ3BhZGRpbmcnKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB2YWx1ZTsKICB9CiAgLyoqCiAgICog6I635Y+W5YWD57Sg55qE5qC35byP5YC8CiAgICogQHBhcmFtIGVsZW1lbnQKICAgKiBAcGFyYW0gbmFtZQogICAqIEBwYXJhbSBmdW5jSW5kZXggMDogaW5uZXJXaWR0aCwgaW5uZXJIZWlnaHQ7IDE6IHdpZHRoLCBoZWlnaHQ7IDI6IG91dGVyV2lkdGgsIG91dGVySGVpZ2h0CiAgICogQHBhcmFtIGluY2x1ZGVNYXJnaW4KICAgKi8KCgogIGZ1bmN0aW9uIGdldChlbGVtZW50LCBuYW1lLCBmdW5jSW5kZXgsIGluY2x1ZGVNYXJnaW4pIHsKICAgIHZhciBjbGllbnRQcm9wID0gImNsaWVudCIgKyBuYW1lOwogICAgdmFyIHNjcm9sbFByb3AgPSAic2Nyb2xsIiArIG5hbWU7CiAgICB2YXIgb2Zmc2V0UHJvcCA9ICJvZmZzZXQiICsgbmFtZTsKICAgIHZhciBpbm5lclByb3AgPSAiaW5uZXIiICsgbmFtZTsgLy8gJCh3aW5kb3cpLndpZHRoKCkKCiAgICBpZiAoaXNXaW5kb3coZWxlbWVudCkpIHsKICAgICAgLy8gb3V0ZXJXaWR0aCwgb3V0ZXJIZWlnaHQg6ZyA6KaB5YyF5ZCr5rua5Yqo5p2h55qE5a695bqmCiAgICAgIHJldHVybiBmdW5jSW5kZXggPT09IDIgPyBlbGVtZW50W2lubmVyUHJvcF0gOiB0b0VsZW1lbnQoZG9jdW1lbnQpW2NsaWVudFByb3BdOwogICAgfSAvLyAkKGRvY3VtZW50KS53aWR0aCgpCgoKICAgIGlmIChpc0RvY3VtZW50KGVsZW1lbnQpKSB7CiAgICAgIHZhciBkb2MgPSB0b0VsZW1lbnQoZWxlbWVudCk7CiAgICAgIHJldHVybiBNYXRoLm1heCggLy8gQHRzLWlnbm9yZQogICAgICBlbGVtZW50LmJvZHlbc2Nyb2xsUHJvcF0sIGRvY1tzY3JvbGxQcm9wXSwgLy8gQHRzLWlnbm9yZQogICAgICBlbGVtZW50LmJvZHlbb2Zmc2V0UHJvcF0sIGRvY1tvZmZzZXRQcm9wXSwgZG9jW2NsaWVudFByb3BdKTsKICAgIH0KCiAgICB2YXIgdmFsdWUgPSBwYXJzZUZsb2F0KGdldENvbXB1dGVkU3R5bGVWYWx1ZShlbGVtZW50LCBuYW1lLnRvTG93ZXJDYXNlKCkpIHx8ICcwJyk7CiAgICByZXR1cm4gaGFuZGxlRXh0cmFXaWR0aChlbGVtZW50LCBuYW1lLCB2YWx1ZSwgZnVuY0luZGV4LCBpbmNsdWRlTWFyZ2luLCAxKTsKICB9CiAgLyoqCiAgICog6K6+572u5YWD57Sg55qE5qC35byP5YC8CiAgICogQHBhcmFtIGVsZW1lbnQKICAgKiBAcGFyYW0gZWxlbWVudEluZGV4CiAgICogQHBhcmFtIG5hbWUKICAgKiBAcGFyYW0gZnVuY0luZGV4IDA6IGlubmVyV2lkdGgsIGlubmVySGVpZ2h0OyAxOiB3aWR0aCwgaGVpZ2h0OyAyOiBvdXRlcldpZHRoLCBvdXRlckhlaWdodAogICAqIEBwYXJhbSBpbmNsdWRlTWFyZ2luCiAgICogQHBhcmFtIHZhbHVlCiAgICovCgoKICBmdW5jdGlvbiBzZXQoZWxlbWVudCwgZWxlbWVudEluZGV4LCBuYW1lLCBmdW5jSW5kZXgsIGluY2x1ZGVNYXJnaW4sIHZhbHVlKSB7CiAgICB2YXIgY29tcHV0ZWRWYWx1ZSA9IGlzRnVuY3Rpb24odmFsdWUpID8gdmFsdWUuY2FsbChlbGVtZW50LCBlbGVtZW50SW5kZXgsIGdldChlbGVtZW50LCBuYW1lLCBmdW5jSW5kZXgsIGluY2x1ZGVNYXJnaW4pKSA6IHZhbHVlOwoKICAgIGlmIChjb21wdXRlZFZhbHVlID09IG51bGwpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciAkZWxlbWVudCA9ICQoZWxlbWVudCk7CiAgICB2YXIgZGltZW5zaW9uID0gbmFtZS50b0xvd2VyQ2FzZSgpOyAvLyDnibnmrornmoTlgLzvvIzkuI3pnIDopoHorqHnrpcgcGFkZGluZ+OAgWJvcmRlcuOAgW1hcmdpbgoKICAgIGlmIChbJ2F1dG8nLCAnaW5oZXJpdCcsICcnXS5pbmRleE9mKGNvbXB1dGVkVmFsdWUpID4gLTEpIHsKICAgICAgJGVsZW1lbnQuY3NzKGRpbWVuc2lvbiwgY29tcHV0ZWRWYWx1ZSk7CiAgICAgIHJldHVybjsKICAgIH0gLy8g5YW25LuW5YC85L+d55WZ5Y6f5aeL5Y2V5L2N44CC5rOo5oSP77ya5aaC5p6c5LiN5L2/55SoIHB4IOS9nOS4uuWNleS9je+8jOWImeeul+WHuueahOWAvOS4gOiIrOaYr+S4jeWHhuehrueahAoKCiAgICB2YXIgc3VmZml4ID0gY29tcHV0ZWRWYWx1ZS50b1N0cmluZygpLnJlcGxhY2UoL1xiWzAtOS5dKi8sICcnKTsKICAgIHZhciBudW1lcmljYWwgPSBwYXJzZUZsb2F0KGNvbXB1dGVkVmFsdWUpOwogICAgY29tcHV0ZWRWYWx1ZSA9IGhhbmRsZUV4dHJhV2lkdGgoZWxlbWVudCwgbmFtZSwgbnVtZXJpY2FsLCBmdW5jSW5kZXgsIGluY2x1ZGVNYXJnaW4sIC0xKSArIChzdWZmaXggfHwgJ3B4Jyk7CiAgICAkZWxlbWVudC5jc3MoZGltZW5zaW9uLCBjb21wdXRlZFZhbHVlKTsKICB9CgogIGVhY2goWydXaWR0aCcsICdIZWlnaHQnXSwgZnVuY3Rpb24gKF8sIG5hbWUpIHsKICAgIGVhY2goWyJpbm5lciIgKyBuYW1lLCBuYW1lLnRvTG93ZXJDYXNlKCksICJvdXRlciIgKyBuYW1lXSwgZnVuY3Rpb24gKGZ1bmNJbmRleCwgZnVuY05hbWUpIHsKICAgICAgJC5mbltmdW5jTmFtZV0gPSBmdW5jdGlvbiAobWFyZ2luLCB2YWx1ZSkgewogICAgICAgIC8vIOaYr+WQpuaYr+i1i+WAvOaTjeS9nAogICAgICAgIHZhciBpc1NldCA9IGFyZ3VtZW50cy5sZW5ndGggJiYgKGZ1bmNJbmRleCA8IDIgfHwgIWlzQm9vbGVhbihtYXJnaW4pKTsKICAgICAgICB2YXIgaW5jbHVkZU1hcmdpbiA9IG1hcmdpbiA9PT0gdHJ1ZSB8fCB2YWx1ZSA9PT0gdHJ1ZTsgLy8g6I635Y+W56ys5LiA5Liq5YWD57Sg55qE5YC8CgogICAgICAgIGlmICghaXNTZXQpIHsKICAgICAgICAgIHJldHVybiB0aGlzLmxlbmd0aCA/IGdldCh0aGlzWzBdLCBuYW1lLCBmdW5jSW5kZXgsIGluY2x1ZGVNYXJnaW4pIDogdW5kZWZpbmVkOwogICAgICAgIH0gLy8g6K6+572u5q+P5Liq5YWD57Sg55qE5YC8CgoKICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkgewogICAgICAgICAgcmV0dXJuIHNldChlbGVtZW50LCBpbmRleCwgbmFtZSwgZnVuY0luZGV4LCBpbmNsdWRlTWFyZ2luLCBtYXJnaW4pOwogICAgICAgIH0pOwogICAgICB9OwogICAgfSk7CiAgfSk7CgogICQuZm4uaGlkZSA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICB0aGlzLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICB9KTsKICB9OwoKICBlYWNoKFsndmFsJywgJ2h0bWwnLCAndGV4dCddLCBmdW5jdGlvbiAobmFtZUluZGV4LCBuYW1lKSB7CiAgICB2YXIgcHJvcHMgPSB7CiAgICAgIDA6ICd2YWx1ZScsCiAgICAgIDE6ICdpbm5lckhUTUwnLAogICAgICAyOiAndGV4dENvbnRlbnQnCiAgICB9OwogICAgdmFyIHByb3BOYW1lID0gcHJvcHNbbmFtZUluZGV4XTsKCiAgICBmdW5jdGlvbiBnZXQoJGVsZW1lbnRzKSB7CiAgICAgIC8vIHRleHQoKSDojrflj5bmiYDmnInlhYPntKDnmoTmlofmnKwKICAgICAgaWYgKG5hbWVJbmRleCA9PT0gMikgewogICAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgICByZXR1cm4gbWFwKCRlbGVtZW50cywgZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICAgIHJldHVybiB0b0VsZW1lbnQoZWxlbWVudClbcHJvcE5hbWVdOwogICAgICAgIH0pLmpvaW4oJycpOwogICAgICB9IC8vIOepuumbhuWQiOaXtu+8jHZhbCgpIOWSjCBodG1sKCkg6L+U5ZueIHVuZGVmaW5lZAoKCiAgICAgIGlmICghJGVsZW1lbnRzLmxlbmd0aCkgewogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH0gLy8gdmFsKCkg5ZKMIGh0bWwoKSDku4Xojrflj5bnrKzkuIDkuKrlhYPntKDnmoTlhoXlrrkKCgogICAgICB2YXIgZmlyc3RFbGVtZW50ID0gJGVsZW1lbnRzWzBdOyAvLyBzZWxlY3QgbXVsdGlwbGUg6L+U5Zue5pWw57uECgogICAgICBpZiAobmFtZUluZGV4ID09PSAwICYmICQoZmlyc3RFbGVtZW50KS5pcygnc2VsZWN0W211bHRpcGxlXScpKSB7CiAgICAgICAgcmV0dXJuIG1hcCgkKGZpcnN0RWxlbWVudCkuZmluZCgnb3B0aW9uOmNoZWNrZWQnKSwgZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICAgIHJldHVybiBlbGVtZW50LnZhbHVlOwogICAgICAgIH0pOwogICAgICB9IC8vIEB0cy1pZ25vcmUKCgogICAgICByZXR1cm4gZmlyc3RFbGVtZW50W3Byb3BOYW1lXTsKICAgIH0KCiAgICBmdW5jdGlvbiBzZXQoZWxlbWVudCwgdmFsdWUpIHsKICAgICAgLy8gdGV4dCgpIOWSjCBodG1sKCkg6LWL5YC85Li6IHVuZGVmaW5lZO+8jOWImeS/neaMgeWOn+WGheWuueS4jeWPmAogICAgICAvLyB2YWwoKSDotYvlgLzkuLogdW5kZWZpbmVkIOWImei1i+WAvOS4uuepugogICAgICBpZiAoaXNVbmRlZmluZWQodmFsdWUpKSB7CiAgICAgICAgaWYgKG5hbWVJbmRleCAhPT0gMCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFsdWUgPSAnJzsKICAgICAgfQoKICAgICAgaWYgKG5hbWVJbmRleCA9PT0gMSAmJiBpc0VsZW1lbnQodmFsdWUpKSB7CiAgICAgICAgdmFsdWUgPSB2YWx1ZS5vdXRlckhUTUw7CiAgICAgIH0gLy8gQHRzLWlnbm9yZQoKCiAgICAgIGVsZW1lbnRbcHJvcE5hbWVdID0gdmFsdWU7CiAgICB9CgogICAgJC5mbltuYW1lXSA9IGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAvLyDojrflj5blgLwKICAgICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIGdldCh0aGlzKTsKICAgICAgfSAvLyDorr7nva7lgLwKCgogICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChpLCBlbGVtZW50KSB7CiAgICAgICAgdmFyIGNvbXB1dGVkVmFsdWUgPSBpc0Z1bmN0aW9uKHZhbHVlKSA/IHZhbHVlLmNhbGwoZWxlbWVudCwgaSwgZ2V0KCQoZWxlbWVudCkpKSA6IHZhbHVlOyAvLyB2YWx1ZSDmmK/mlbDnu4TvvIzliJnpgInkuK3mlbDnu4TkuK3nmoTlhYPntKDvvIzlj43pgInkuI3lnKjmlbDnu4TkuK3nmoTlhYPntKAKCiAgICAgICAgaWYgKG5hbWVJbmRleCA9PT0gMCAmJiBBcnJheS5pc0FycmF5KGNvbXB1dGVkVmFsdWUpKSB7CiAgICAgICAgICAvLyBzZWxlY3RbbXVsdGlwbGVdCiAgICAgICAgICBpZiAoJChlbGVtZW50KS5pcygnc2VsZWN0W211bHRpcGxlXScpKSB7CiAgICAgICAgICAgIG1hcCgkKGVsZW1lbnQpLmZpbmQoJ29wdGlvbicpLCBmdW5jdGlvbiAob3B0aW9uKSB7CiAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbi5zZWxlY3RlZCA9IGNvbXB1dGVkVmFsdWUuaW5kZXhPZihvcHRpb24udmFsdWUpID4gLTE7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSAvLyDlhbbku5YgY2hlY2tib3gsIHJhZGlvIOetieWFg+e0oAogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgZWxlbWVudC5jaGVja2VkID0gY29tcHV0ZWRWYWx1ZS5pbmRleE9mKGVsZW1lbnQudmFsdWUpID4gLTE7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgc2V0KGVsZW1lbnQsIGNvbXB1dGVkVmFsdWUpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwogIH0pOwoKICAkLmZuLmluZGV4ID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHsKICAgICAgcmV0dXJuIHRoaXMuZXEoMCkucGFyZW50KCkuY2hpbGRyZW4oKS5nZXQoKS5pbmRleE9mKHRoaXNbMF0pOwogICAgfQoKICAgIGlmIChpc1N0cmluZyhzZWxlY3RvcikpIHsKICAgICAgcmV0dXJuICQoc2VsZWN0b3IpLmdldCgpLmluZGV4T2YodGhpc1swXSk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuZ2V0KCkuaW5kZXhPZigkKHNlbGVjdG9yKVswXSk7CiAgfTsKCiAgJC5mbi5sYXN0ID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHRoaXMuZXEoLTEpOwogIH07CgogIGVhY2goWycnLCAnQWxsJywgJ1VudGlsJ10sIGZ1bmN0aW9uIChuYW1lSW5kZXgsIG5hbWUpIHsKICAgICQuZm5bIm5leHQiICsgbmFtZV0gPSBmdW5jdGlvbiAoc2VsZWN0b3IsIGZpbHRlcikgewogICAgICByZXR1cm4gZGlyKHRoaXMsIG5hbWVJbmRleCwgJ25leHRFbGVtZW50U2libGluZycsIHNlbGVjdG9yLCBmaWx0ZXIpOwogICAgfTsKICB9KTsKCiAgJC5mbi5ub3QgPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgIHZhciAkZXhjbHVkZXMgPSB0aGlzLmZpbHRlcihzZWxlY3Rvcik7CiAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKF8sIGVsZW1lbnQpIHsKICAgICAgcmV0dXJuICRleGNsdWRlcy5pbmRleChlbGVtZW50KSA+IC0xID8gdW5kZWZpbmVkIDogZWxlbWVudDsKICAgIH0pOwogIH07CiAgLyoqCiAgICog6L+U5Zue5pyA6L+R55qE55So5LqO5a6a5L2N55qE54i25YWD57SgCiAgICovCgoKICAkLmZuLm9mZnNldFBhcmVudCA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzLm1hcChmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBvZmZzZXRQYXJlbnQgPSB0aGlzLm9mZnNldFBhcmVudDsKCiAgICAgIHdoaWxlIChvZmZzZXRQYXJlbnQgJiYgJChvZmZzZXRQYXJlbnQpLmNzcygncG9zaXRpb24nKSA9PT0gJ3N0YXRpYycpIHsKICAgICAgICBvZmZzZXRQYXJlbnQgPSBvZmZzZXRQYXJlbnQub2Zmc2V0UGFyZW50OwogICAgICB9CgogICAgICByZXR1cm4gb2Zmc2V0UGFyZW50IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKICAgIH0pOwogIH07CgogIGZ1bmN0aW9uIGZsb2F0U3R5bGUoJGVsZW1lbnQsIG5hbWUpIHsKICAgIHJldHVybiBwYXJzZUZsb2F0KCRlbGVtZW50LmNzcyhuYW1lKSk7CiAgfQoKICAkLmZuLnBvc2l0aW9uID0gZnVuY3Rpb24gKCkgewogICAgaWYgKCF0aGlzLmxlbmd0aCkgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfQoKICAgIHZhciAkZWxlbWVudCA9IHRoaXMuZXEoMCk7CiAgICB2YXIgY3VycmVudE9mZnNldDsKICAgIHZhciBwYXJlbnRPZmZzZXQgPSB7CiAgICAgIGxlZnQ6IDAsCiAgICAgIHRvcDogMAogICAgfTsKCiAgICBpZiAoJGVsZW1lbnQuY3NzKCdwb3NpdGlvbicpID09PSAnZml4ZWQnKSB7CiAgICAgIGN1cnJlbnRPZmZzZXQgPSAkZWxlbWVudFswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIH0gZWxzZSB7CiAgICAgIGN1cnJlbnRPZmZzZXQgPSAkZWxlbWVudC5vZmZzZXQoKTsKICAgICAgdmFyICRvZmZzZXRQYXJlbnQgPSAkZWxlbWVudC5vZmZzZXRQYXJlbnQoKTsKICAgICAgcGFyZW50T2Zmc2V0ID0gJG9mZnNldFBhcmVudC5vZmZzZXQoKTsKICAgICAgcGFyZW50T2Zmc2V0LnRvcCArPSBmbG9hdFN0eWxlKCRvZmZzZXRQYXJlbnQsICdib3JkZXItdG9wLXdpZHRoJyk7CiAgICAgIHBhcmVudE9mZnNldC5sZWZ0ICs9IGZsb2F0U3R5bGUoJG9mZnNldFBhcmVudCwgJ2JvcmRlci1sZWZ0LXdpZHRoJyk7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgdG9wOiBjdXJyZW50T2Zmc2V0LnRvcCAtIHBhcmVudE9mZnNldC50b3AgLSBmbG9hdFN0eWxlKCRlbGVtZW50LCAnbWFyZ2luLXRvcCcpLAogICAgICBsZWZ0OiBjdXJyZW50T2Zmc2V0LmxlZnQgLSBwYXJlbnRPZmZzZXQubGVmdCAtIGZsb2F0U3R5bGUoJGVsZW1lbnQsICdtYXJnaW4tbGVmdCcpCiAgICB9OwogIH07CgogIGZ1bmN0aW9uIGdldCQxKGVsZW1lbnQpIHsKICAgIGlmICghZWxlbWVudC5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCkgewogICAgICByZXR1cm4gewogICAgICAgIHRvcDogMCwKICAgICAgICBsZWZ0OiAwCiAgICAgIH07CiAgICB9CgogICAgdmFyIHJlY3QgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgdmFyIHdpbiA9IGVsZW1lbnQub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldzsKICAgIHJldHVybiB7CiAgICAgIHRvcDogcmVjdC50b3AgKyB3aW4ucGFnZVlPZmZzZXQsCiAgICAgIGxlZnQ6IHJlY3QubGVmdCArIHdpbi5wYWdlWE9mZnNldAogICAgfTsKICB9CgogIGZ1bmN0aW9uIHNldCQxKGVsZW1lbnQsIHZhbHVlLCBpbmRleCkgewogICAgdmFyICRlbGVtZW50ID0gJChlbGVtZW50KTsKICAgIHZhciBwb3NpdGlvbiA9ICRlbGVtZW50LmNzcygncG9zaXRpb24nKTsKCiAgICBpZiAocG9zaXRpb24gPT09ICdzdGF0aWMnKSB7CiAgICAgICRlbGVtZW50LmNzcygncG9zaXRpb24nLCAncmVsYXRpdmUnKTsKICAgIH0KCiAgICB2YXIgY3VycmVudE9mZnNldCA9IGdldCQxKGVsZW1lbnQpOwogICAgdmFyIGN1cnJlbnRUb3BTdHJpbmcgPSAkZWxlbWVudC5jc3MoJ3RvcCcpOwogICAgdmFyIGN1cnJlbnRMZWZ0U3RyaW5nID0gJGVsZW1lbnQuY3NzKCdsZWZ0Jyk7CiAgICB2YXIgY3VycmVudFRvcDsKICAgIHZhciBjdXJyZW50TGVmdDsKICAgIHZhciBjYWxjdWxhdGVQb3NpdGlvbiA9IChwb3NpdGlvbiA9PT0gJ2Fic29sdXRlJyB8fCBwb3NpdGlvbiA9PT0gJ2ZpeGVkJykgJiYgKGN1cnJlbnRUb3BTdHJpbmcgKyBjdXJyZW50TGVmdFN0cmluZykuaW5kZXhPZignYXV0bycpID4gLTE7CgogICAgaWYgKGNhbGN1bGF0ZVBvc2l0aW9uKSB7CiAgICAgIHZhciBjdXJyZW50UG9zaXRpb24gPSAkZWxlbWVudC5wb3NpdGlvbigpOwogICAgICBjdXJyZW50VG9wID0gY3VycmVudFBvc2l0aW9uLnRvcDsKICAgICAgY3VycmVudExlZnQgPSBjdXJyZW50UG9zaXRpb24ubGVmdDsKICAgIH0gZWxzZSB7CiAgICAgIGN1cnJlbnRUb3AgPSBwYXJzZUZsb2F0KGN1cnJlbnRUb3BTdHJpbmcpOwogICAgICBjdXJyZW50TGVmdCA9IHBhcnNlRmxvYXQoY3VycmVudExlZnRTdHJpbmcpOwogICAgfQoKICAgIHZhciBjb21wdXRlZFZhbHVlID0gaXNGdW5jdGlvbih2YWx1ZSkgPyB2YWx1ZS5jYWxsKGVsZW1lbnQsIGluZGV4LCBleHRlbmQoe30sIGN1cnJlbnRPZmZzZXQpKSA6IHZhbHVlOwogICAgJGVsZW1lbnQuY3NzKHsKICAgICAgdG9wOiBjb21wdXRlZFZhbHVlLnRvcCAhPSBudWxsID8gY29tcHV0ZWRWYWx1ZS50b3AgLSBjdXJyZW50T2Zmc2V0LnRvcCArIGN1cnJlbnRUb3AgOiB1bmRlZmluZWQsCiAgICAgIGxlZnQ6IGNvbXB1dGVkVmFsdWUubGVmdCAhPSBudWxsID8gY29tcHV0ZWRWYWx1ZS5sZWZ0IC0gY3VycmVudE9mZnNldC5sZWZ0ICsgY3VycmVudExlZnQgOiB1bmRlZmluZWQKICAgIH0pOwogIH0KCiAgJC5mbi5vZmZzZXQgPSBmdW5jdGlvbiAodmFsdWUpIHsKICAgIC8vIOiOt+WPluWdkOaghwogICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSB7CiAgICAgIGlmICghdGhpcy5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICB9CgogICAgICByZXR1cm4gZ2V0JDEodGhpc1swXSk7CiAgICB9IC8vIOiuvue9ruWdkOaghwoKCiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChpbmRleCkgewogICAgICBzZXQkMSh0aGlzLCB2YWx1ZSwgaW5kZXgpOwogICAgfSk7CiAgfTsKCiAgJC5mbi5vbmUgPSBmdW5jdGlvbiAodHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBjYWxsYmFjaykgewogICAgLy8gQHRzLWlnbm9yZQogICAgcmV0dXJuIHRoaXMub24odHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBjYWxsYmFjaywgdHJ1ZSk7CiAgfTsKCiAgZWFjaChbJycsICdBbGwnLCAnVW50aWwnXSwgZnVuY3Rpb24gKG5hbWVJbmRleCwgbmFtZSkgewogICAgJC5mblsicHJldiIgKyBuYW1lXSA9IGZ1bmN0aW9uIChzZWxlY3RvciwgZmlsdGVyKSB7CiAgICAgIC8vIHByZXZBbGzjgIFwcmV2VW50aWwg6ZyA6KaB5oqK5YWD57Sg55qE6aG65bqP5YCS5bqP5aSE55CG77yM5Lul5L6/5ZKMIGpRdWVyeSDnmoTnu5PmnpzkuIDoh7QKICAgICAgdmFyICRub2RlcyA9ICFuYW1lSW5kZXggPyB0aGlzIDogJCh0aGlzLmdldCgpLnJldmVyc2UoKSk7CiAgICAgIHJldHVybiBkaXIoJG5vZGVzLCBuYW1lSW5kZXgsICdwcmV2aW91c0VsZW1lbnRTaWJsaW5nJywgc2VsZWN0b3IsIGZpbHRlcik7CiAgICB9OwogIH0pOwoKICAkLmZuLnJlbW92ZUF0dHIgPSBmdW5jdGlvbiAoYXR0cmlidXRlTmFtZSkgewogICAgdmFyIG5hbWVzID0gYXR0cmlidXRlTmFtZS5zcGxpdCgnICcpLmZpbHRlcihmdW5jdGlvbiAobmFtZSkgewogICAgICByZXR1cm4gbmFtZTsKICAgIH0pOwogICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgICBlYWNoKG5hbWVzLCBmdW5jdGlvbiAoXywgbmFtZSkgewogICAgICAgIHRoaXMkMS5yZW1vdmVBdHRyaWJ1dGUobmFtZSk7CiAgICAgIH0pOwogICAgfSk7CiAgfTsKCiAgJC5mbi5yZW1vdmVEYXRhID0gZnVuY3Rpb24gKG5hbWUpIHsKICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICByZW1vdmVEYXRhKHRoaXMsIG5hbWUpOwogICAgfSk7CiAgfTsKCiAgJC5mbi5yZW1vdmVQcm9wID0gZnVuY3Rpb24gKG5hbWUpIHsKICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICB0cnkgewogICAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgICBkZWxldGUgdGhpc1tuYW1lXTsKICAgICAgfSBjYXRjaCAoZSkge30KICAgIH0pOwogIH07CgogICQuZm4ucmVwbGFjZVdpdGggPSBmdW5jdGlvbiAobmV3Q29udGVudCkgewogICAgdGhpcy5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkgewogICAgICB2YXIgY29udGVudCA9IG5ld0NvbnRlbnQ7CgogICAgICBpZiAoaXNGdW5jdGlvbihjb250ZW50KSkgewogICAgICAgIGNvbnRlbnQgPSBjb250ZW50LmNhbGwoZWxlbWVudCwgaW5kZXgsIGVsZW1lbnQuaW5uZXJIVE1MKTsKICAgICAgfSBlbHNlIGlmIChpbmRleCAmJiAhaXNTdHJpbmcoY29udGVudCkpIHsKICAgICAgICBjb250ZW50ID0gJChjb250ZW50KS5jbG9uZSgpOwogICAgICB9CgogICAgICAkKGVsZW1lbnQpLmJlZm9yZShjb250ZW50KTsKICAgIH0pOwogICAgcmV0dXJuIHRoaXMucmVtb3ZlKCk7CiAgfTsKCiAgJC5mbi5yZXBsYWNlQWxsID0gZnVuY3Rpb24gKHRhcmdldCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CiAgICByZXR1cm4gJCh0YXJnZXQpLm1hcChmdW5jdGlvbiAoaW5kZXgsIGVsZW1lbnQpIHsKICAgICAgJChlbGVtZW50KS5yZXBsYWNlV2l0aChpbmRleCA/IHRoaXMkMS5jbG9uZSgpIDogdGhpcyQxKTsKICAgICAgcmV0dXJuIHRoaXMkMS5nZXQoKTsKICAgIH0pOwogIH07CiAgLyoqCiAgICog5bCG6KGo5Y2V5YWD57Sg55qE5YC857uE5ZCI5oiQ6ZSu5YC85a+55pWw57uECiAgICogQHJldHVybnMge0FycmF5fQogICAqLwoKCiAgJC5mbi5zZXJpYWxpemVBcnJheSA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciByZXN1bHQgPSBbXTsKICAgIHRoaXMuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICB2YXIgZWxlbWVudHMgPSBlbGVtZW50IGluc3RhbmNlb2YgSFRNTEZvcm1FbGVtZW50ID8gZWxlbWVudC5lbGVtZW50cyA6IFtlbGVtZW50XTsKICAgICAgJChlbGVtZW50cykuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICAgIHZhciAkZWxlbWVudCA9ICQoZWxlbWVudCk7CiAgICAgICAgdmFyIHR5cGUgPSBlbGVtZW50LnR5cGU7CiAgICAgICAgdmFyIG5vZGVOYW1lID0gZWxlbWVudC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwoKICAgICAgICBpZiAobm9kZU5hbWUgIT09ICdmaWVsZHNldCcgJiYgZWxlbWVudC5uYW1lICYmICFlbGVtZW50LmRpc2FibGVkICYmIFsnaW5wdXQnLCAnc2VsZWN0JywgJ3RleHRhcmVhJywgJ2tleWdlbiddLmluZGV4T2Yobm9kZU5hbWUpID4gLTEgJiYgWydzdWJtaXQnLCAnYnV0dG9uJywgJ2ltYWdlJywgJ3Jlc2V0JywgJ2ZpbGUnXS5pbmRleE9mKHR5cGUpID09PSAtMSAmJiAoWydyYWRpbycsICdjaGVja2JveCddLmluZGV4T2YodHlwZSkgPT09IC0xIHx8IGVsZW1lbnQuY2hlY2tlZCkpIHsKICAgICAgICAgIHZhciB2YWx1ZSA9ICRlbGVtZW50LnZhbCgpOwogICAgICAgICAgdmFyIHZhbHVlQXJyID0gQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyB2YWx1ZSA6IFt2YWx1ZV07CiAgICAgICAgICB2YWx1ZUFyci5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgICAgICByZXN1bHQucHVzaCh7CiAgICAgICAgICAgICAgbmFtZTogZWxlbWVudC5uYW1lLAogICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9KTsKICAgIHJldHVybiByZXN1bHQ7CiAgfTsKCiAgJC5mbi5zZXJpYWxpemUgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gcGFyYW0odGhpcy5zZXJpYWxpemVBcnJheSgpKTsKICB9OwoKICB2YXIgZWxlbWVudERpc3BsYXkgPSB7fTsKICAvKioKICAgKiDojrflj5blhYPntKDnmoTliJ3lp4sgZGlzcGxheSDlgLzvvIznlKjkuo4gLnNob3coKSDmlrnms5UKICAgKiBAcGFyYW0gbm9kZU5hbWUKICAgKi8KCiAgZnVuY3Rpb24gZGVmYXVsdERpc3BsYXkobm9kZU5hbWUpIHsKICAgIHZhciBlbGVtZW50OwogICAgdmFyIGRpc3BsYXk7CgogICAgaWYgKCFlbGVtZW50RGlzcGxheVtub2RlTmFtZV0pIHsKICAgICAgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobm9kZU5hbWUpOwogICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZW1lbnQpOwogICAgICBkaXNwbGF5ID0gZ2V0U3R5bGUoZWxlbWVudCwgJ2Rpc3BsYXknKTsKICAgICAgZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsZW1lbnQpOwoKICAgICAgaWYgKGRpc3BsYXkgPT09ICdub25lJykgewogICAgICAgIGRpc3BsYXkgPSAnYmxvY2snOwogICAgICB9CgogICAgICBlbGVtZW50RGlzcGxheVtub2RlTmFtZV0gPSBkaXNwbGF5OwogICAgfQoKICAgIHJldHVybiBlbGVtZW50RGlzcGxheVtub2RlTmFtZV07CiAgfQogIC8qKgogICAqIOaYvuekuuaMh+WumuWFg+e0oAogICAqIEByZXR1cm5zIHtKUX0KICAgKi8KCgogICQuZm4uc2hvdyA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICBpZiAodGhpcy5zdHlsZS5kaXNwbGF5ID09PSAnbm9uZScpIHsKICAgICAgICB0aGlzLnN0eWxlLmRpc3BsYXkgPSAnJzsKICAgICAgfQoKICAgICAgaWYgKGdldFN0eWxlKHRoaXMsICdkaXNwbGF5JykgPT09ICdub25lJykgewogICAgICAgIHRoaXMuc3R5bGUuZGlzcGxheSA9IGRlZmF1bHREaXNwbGF5KHRoaXMubm9kZU5hbWUpOwogICAgICB9CiAgICB9KTsKICB9OwogIC8qKgogICAqIOWPluW+l+WQjOi+iOWFg+e0oOeahOmbhuWQiAogICAqIEBwYXJhbSBzZWxlY3RvciB7U3RyaW5nPX0KICAgKiBAcmV0dXJucyB7SlF9CiAgICovCgoKICAkLmZuLnNpYmxpbmdzID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICByZXR1cm4gdGhpcy5wcmV2QWxsKHNlbGVjdG9yKS5hZGQodGhpcy5uZXh0QWxsKHNlbGVjdG9yKSk7CiAgfTsKICAvKioKICAgKiDliIfmjaLlhYPntKDnmoTmmL7npLrnirbmgIEKICAgKi8KCgogICQuZm4udG9nZ2xlID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgIGdldFN0eWxlKHRoaXMsICdkaXNwbGF5JykgPT09ICdub25lJyA/ICQodGhpcykuc2hvdygpIDogJCh0aGlzKS5oaWRlKCk7CiAgICB9KTsKICB9OwoKICAkLmZuLnJlZmxvdyA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcy5jbGllbnRMZWZ0OwogICAgfSk7CiAgfTsKCiAgJC5mbi50cmFuc2l0aW9uID0gZnVuY3Rpb24gKGR1cmF0aW9uKSB7CiAgICBpZiAoaXNOdW1iZXIoZHVyYXRpb24pKSB7CiAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24gKyAibXMiOwogICAgfQoKICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICB0aGlzLnN0eWxlLndlYmtpdFRyYW5zaXRpb25EdXJhdGlvbiA9IGR1cmF0aW9uOwogICAgICB0aGlzLnN0eWxlLnRyYW5zaXRpb25EdXJhdGlvbiA9IGR1cmF0aW9uOwogICAgfSk7CiAgfTsKCiAgJC5mbi50cmFuc2l0aW9uRW5kID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXRoaXMtYWxpYXMKICAgIHZhciB0aGF0ID0gdGhpczsKICAgIHZhciBldmVudHMgPSBbJ3dlYmtpdFRyYW5zaXRpb25FbmQnLCAndHJhbnNpdGlvbmVuZCddOwoKICAgIGZ1bmN0aW9uIGZpcmVDYWxsYmFjayhlKSB7CiAgICAgIGlmIChlLnRhcmdldCAhPT0gdGhpcykgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBAdHMtaWdub3JlCgoKICAgICAgY2FsbGJhY2suY2FsbCh0aGlzLCBlKTsKICAgICAgZWFjaChldmVudHMsIGZ1bmN0aW9uIChfLCBldmVudCkgewogICAgICAgIHRoYXQub2ZmKGV2ZW50LCBmaXJlQ2FsbGJhY2spOwogICAgICB9KTsKICAgIH0KCiAgICBlYWNoKGV2ZW50cywgZnVuY3Rpb24gKF8sIGV2ZW50KSB7CiAgICAgIHRoYXQub24oZXZlbnQsIGZpcmVDYWxsYmFjayk7CiAgICB9KTsKICAgIHJldHVybiB0aGlzOwogIH07CgogICQuZm4udHJhbnNmb3JtT3JpZ2luID0gZnVuY3Rpb24gKHRyYW5zZm9ybU9yaWdpbikgewogICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuc3R5bGUud2Via2l0VHJhbnNmb3JtT3JpZ2luID0gdHJhbnNmb3JtT3JpZ2luOwogICAgICB0aGlzLnN0eWxlLnRyYW5zZm9ybU9yaWdpbiA9IHRyYW5zZm9ybU9yaWdpbjsKICAgIH0pOwogIH07CgogICQuZm4udHJhbnNmb3JtID0gZnVuY3Rpb24gKHRyYW5zZm9ybSkgewogICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuc3R5bGUud2Via2l0VHJhbnNmb3JtID0gdHJhbnNmb3JtOwogICAgICB0aGlzLnN0eWxlLnRyYW5zZm9ybSA9IHRyYW5zZm9ybTsKICAgIH0pOwogIH07CiAgLyoqCiAgICogQ1NTIOmAieaLqeWZqOWSjOWIneWni+WMluWHveaVsOe7hOaIkOeahOWvueixoQogICAqLwoKCiAgdmFyIGVudHJpZXMgPSB7fTsKICAvKioKICAgKiDms6jlhozlubbmiafooYzliJ3lp4vljJblh73mlbAKICAgKiBAcGFyYW0gc2VsZWN0b3IgQ1NTIOmAieaLqeWZqAogICAqIEBwYXJhbSBhcGlJbml0IOWIneWni+WMluWHveaVsAogICAqIEBwYXJhbSBpIOWFg+e0oOe0ouW8lQogICAqIEBwYXJhbSBlbGVtZW50IOWFg+e0oAogICAqLwoKICBmdW5jdGlvbiBtdXRhdGlvbihzZWxlY3RvciwgYXBpSW5pdCwgaSwgZWxlbWVudCkgewogICAgdmFyIHNlbGVjdG9ycyA9IGRhdGEoZWxlbWVudCwgJ19tZHVpX211dGF0aW9uJyk7CgogICAgaWYgKCFzZWxlY3RvcnMpIHsKICAgICAgc2VsZWN0b3JzID0gW107CiAgICAgIGRhdGEoZWxlbWVudCwgJ19tZHVpX211dGF0aW9uJywgc2VsZWN0b3JzKTsKICAgIH0KCiAgICBpZiAoc2VsZWN0b3JzLmluZGV4T2Yoc2VsZWN0b3IpID09PSAtMSkgewogICAgICBzZWxlY3RvcnMucHVzaChzZWxlY3Rvcik7CiAgICAgIGFwaUluaXQuY2FsbChlbGVtZW50LCBpLCBlbGVtZW50KTsKICAgIH0KICB9CgogICQuZm4ubXV0YXRpb24gPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChpLCBlbGVtZW50KSB7CiAgICAgIHZhciAkdGhpcyA9ICQoZWxlbWVudCk7CiAgICAgIGVhY2goZW50cmllcywgZnVuY3Rpb24gKHNlbGVjdG9yLCBhcGlJbml0KSB7CiAgICAgICAgaWYgKCR0aGlzLmlzKHNlbGVjdG9yKSkgewogICAgICAgICAgbXV0YXRpb24oc2VsZWN0b3IsIGFwaUluaXQsIGksIGVsZW1lbnQpOwogICAgICAgIH0KCiAgICAgICAgJHRoaXMuZmluZChzZWxlY3RvcikuZWFjaChmdW5jdGlvbiAoaSwgZWxlbWVudCkgewogICAgICAgICAgbXV0YXRpb24oc2VsZWN0b3IsIGFwaUluaXQsIGksIGVsZW1lbnQpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pOwogIH07CgogICQuc2hvd092ZXJsYXkgPSBmdW5jdGlvbiAoekluZGV4KSB7CiAgICB2YXIgJG92ZXJsYXkgPSAkKCcubWR1aS1vdmVybGF5Jyk7CgogICAgaWYgKCRvdmVybGF5Lmxlbmd0aCkgewogICAgICAkb3ZlcmxheS5kYXRhKCdfb3ZlcmxheV9pc19kZWxldGVkJywgZmFsc2UpOwoKICAgICAgaWYgKCFpc1VuZGVmaW5lZCh6SW5kZXgpKSB7CiAgICAgICAgJG92ZXJsYXkuY3NzKCd6LWluZGV4JywgekluZGV4KTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKGlzVW5kZWZpbmVkKHpJbmRleCkpIHsKICAgICAgICB6SW5kZXggPSAyMDAwOwogICAgICB9CgogICAgICAkb3ZlcmxheSA9ICQoJzxkaXYgY2xhc3M9Im1kdWktb3ZlcmxheSI+JykuYXBwZW5kVG8oZG9jdW1lbnQuYm9keSkucmVmbG93KCkuY3NzKCd6LWluZGV4JywgekluZGV4KTsKICAgIH0KCiAgICB2YXIgbGV2ZWwgPSAkb3ZlcmxheS5kYXRhKCdfb3ZlcmxheV9sZXZlbCcpIHx8IDA7CiAgICByZXR1cm4gJG92ZXJsYXkuZGF0YSgnX292ZXJsYXlfbGV2ZWwnLCArK2xldmVsKS5hZGRDbGFzcygnbWR1aS1vdmVybGF5LXNob3cnKTsKICB9OwoKICAkLmhpZGVPdmVybGF5ID0gZnVuY3Rpb24gKGZvcmNlKSB7CiAgICBpZiAoZm9yY2UgPT09IHZvaWQgMCkgZm9yY2UgPSBmYWxzZTsKICAgIHZhciAkb3ZlcmxheSA9ICQoJy5tZHVpLW92ZXJsYXknKTsKCiAgICBpZiAoISRvdmVybGF5Lmxlbmd0aCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIGxldmVsID0gZm9yY2UgPyAxIDogJG92ZXJsYXkuZGF0YSgnX292ZXJsYXlfbGV2ZWwnKTsKCiAgICBpZiAobGV2ZWwgPiAxKSB7CiAgICAgICRvdmVybGF5LmRhdGEoJ19vdmVybGF5X2xldmVsJywgLS1sZXZlbCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICAkb3ZlcmxheS5kYXRhKCdfb3ZlcmxheV9sZXZlbCcsIDApLnJlbW92ZUNsYXNzKCdtZHVpLW92ZXJsYXktc2hvdycpLmRhdGEoJ19vdmVybGF5X2lzX2RlbGV0ZWQnLCB0cnVlKS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCRvdmVybGF5LmRhdGEoJ19vdmVybGF5X2lzX2RlbGV0ZWQnKSkgewogICAgICAgICRvdmVybGF5LnJlbW92ZSgpOwogICAgICB9CiAgICB9KTsKICB9OwoKICAkLmxvY2tTY3JlZW4gPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgJGJvZHkgPSAkKCdib2R5Jyk7IC8vIOS4jeebtOaOpeaKiiBib2R5IOiuvuS4uiBib3gtc2l6aW5nOiBib3JkZXItYm9477yM6YG/5YWN5rGh5p+T5YWo5bGA5qC35byPCgogICAgdmFyIG5ld0JvZHlXaWR0aCA9ICRib2R5LndpZHRoKCk7CiAgICB2YXIgbGV2ZWwgPSAkYm9keS5kYXRhKCdfbG9ja3NjcmVlbl9sZXZlbCcpIHx8IDA7CiAgICAkYm9keS5hZGRDbGFzcygnbWR1aS1sb2NrZWQnKS53aWR0aChuZXdCb2R5V2lkdGgpLmRhdGEoJ19sb2Nrc2NyZWVuX2xldmVsJywgKytsZXZlbCk7CiAgfTsKCiAgJC51bmxvY2tTY3JlZW4gPSBmdW5jdGlvbiAoZm9yY2UpIHsKICAgIGlmIChmb3JjZSA9PT0gdm9pZCAwKSBmb3JjZSA9IGZhbHNlOwogICAgdmFyICRib2R5ID0gJCgnYm9keScpOwogICAgdmFyIGxldmVsID0gZm9yY2UgPyAxIDogJGJvZHkuZGF0YSgnX2xvY2tzY3JlZW5fbGV2ZWwnKTsKCiAgICBpZiAobGV2ZWwgPiAxKSB7CiAgICAgICRib2R5LmRhdGEoJ19sb2Nrc2NyZWVuX2xldmVsJywgLS1sZXZlbCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICAkYm9keS5kYXRhKCdfbG9ja3NjcmVlbl9sZXZlbCcsIDApLnJlbW92ZUNsYXNzKCdtZHVpLWxvY2tlZCcpLndpZHRoKCcnKTsKICB9OwoKICAkLnRocm90dGxlID0gZnVuY3Rpb24gKGZuLCBkZWxheSkgewogICAgaWYgKGRlbGF5ID09PSB2b2lkIDApIGRlbGF5ID0gMTY7CiAgICB2YXIgdGltZXIgPSBudWxsOwogICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHRoaXMkMSA9IHRoaXM7CiAgICAgIHZhciBhcmdzID0gW10sCiAgICAgICAgICBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOwoKICAgICAgd2hpbGUgKGxlbi0tKSBhcmdzW2xlbl0gPSBhcmd1bWVudHNbbGVuXTsKCiAgICAgIGlmIChpc051bGwodGltZXIpKSB7CiAgICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGZuLmFwcGx5KHRoaXMkMSwgYXJncyk7CiAgICAgICAgICB0aW1lciA9IG51bGw7CiAgICAgICAgfSwgZGVsYXkpOwogICAgICB9CiAgICB9OwogIH07CgogIHZhciBHVUlEID0ge307CgogICQuZ3VpZCA9IGZ1bmN0aW9uIChuYW1lKSB7CiAgICBpZiAoIWlzVW5kZWZpbmVkKG5hbWUpICYmICFpc1VuZGVmaW5lZChHVUlEW25hbWVdKSkgewogICAgICByZXR1cm4gR1VJRFtuYW1lXTsKICAgIH0KCiAgICBmdW5jdGlvbiBzNCgpIHsKICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApLnRvU3RyaW5nKDE2KS5zdWJzdHJpbmcoMSk7CiAgICB9CgogICAgdmFyIGd1aWQgPSAnXycgKyBzNCgpICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyBzNCgpICsgczQoKTsKCiAgICBpZiAoIWlzVW5kZWZpbmVkKG5hbWUpKSB7CiAgICAgIEdVSURbbmFtZV0gPSBndWlkOwogICAgfQoKICAgIHJldHVybiBndWlkOwogIH07CgogIG1kdWkubXV0YXRpb24gPSBmdW5jdGlvbiAoc2VsZWN0b3IsIGFwaUluaXQpIHsKICAgIGlmIChpc1VuZGVmaW5lZChzZWxlY3RvcikgfHwgaXNVbmRlZmluZWQoYXBpSW5pdCkpIHsKICAgICAgJChkb2N1bWVudCkubXV0YXRpb24oKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGVudHJpZXNbc2VsZWN0b3JdID0gYXBpSW5pdDsKICAgICQoc2VsZWN0b3IpLmVhY2goZnVuY3Rpb24gKGksIGVsZW1lbnQpIHsKICAgICAgcmV0dXJuIG11dGF0aW9uKHNlbGVjdG9yLCBhcGlJbml0LCBpLCBlbGVtZW50KTsKICAgIH0pOwogIH07CiAgLyoqCiAgICog6Kem5Y+R57uE5Lu25LiK55qE5LqL5Lu2CiAgICogQHBhcmFtIGV2ZW50TmFtZSDkuovku7blkI0KICAgKiBAcGFyYW0gY29tcG9uZW50TmFtZSDnu4Tku7blkI0KICAgKiBAcGFyYW0gdGFyZ2V0IOWcqOivpeWFg+e0oOS4iuinpuWPkeS6i+S7tgogICAqIEBwYXJhbSBpbnN0YW5jZSDnu4Tku7blrp7kvosKICAgKiBAcGFyYW0gcGFyYW1ldGVycyDkuovku7blj4LmlbAKICAgKi8KCgogIGZ1bmN0aW9uIGNvbXBvbmVudEV2ZW50KGV2ZW50TmFtZSwgY29tcG9uZW50TmFtZSwgdGFyZ2V0LCBpbnN0YW5jZSwgcGFyYW1ldGVycykgewogICAgaWYgKCFwYXJhbWV0ZXJzKSB7CiAgICAgIHBhcmFtZXRlcnMgPSB7fTsKICAgIH0gLy8gQHRzLWlnbm9yZQoKCiAgICBwYXJhbWV0ZXJzLmluc3QgPSBpbnN0YW5jZTsKICAgIHZhciBmdWxsRXZlbnROYW1lID0gZXZlbnROYW1lICsgIi5tZHVpLiIgKyBjb21wb25lbnROYW1lOyAvLyBqUXVlcnkg5LqL5Lu2CiAgICAvLyBAdHMtaWdub3JlCgogICAgaWYgKHR5cGVvZiBqUXVlcnkgIT09ICd1bmRlZmluZWQnKSB7CiAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgalF1ZXJ5KHRhcmdldCkudHJpZ2dlcihmdWxsRXZlbnROYW1lLCBwYXJhbWV0ZXJzKTsKICAgIH0KCiAgICB2YXIgJHRhcmdldCA9ICQodGFyZ2V0KTsgLy8gbWR1aS5qcSDkuovku7YKCiAgICAkdGFyZ2V0LnRyaWdnZXIoZnVsbEV2ZW50TmFtZSwgcGFyYW1ldGVycyk7CiAgICB2YXIgZXZlbnRQYXJhbXMgPSB7CiAgICAgIGJ1YmJsZXM6IHRydWUsCiAgICAgIGNhbmNlbGFibGU6IHRydWUsCiAgICAgIGRldGFpbDogcGFyYW1ldGVycwogICAgfTsKICAgIHZhciBldmVudE9iamVjdCA9IG5ldyBDdXN0b21FdmVudChmdWxsRXZlbnROYW1lLCBldmVudFBhcmFtcyk7IC8vIEB0cy1pZ25vcmUKCiAgICBldmVudE9iamVjdC5fZGV0YWlsID0gcGFyYW1ldGVyczsKICAgICR0YXJnZXRbMF0uZGlzcGF0Y2hFdmVudChldmVudE9iamVjdCk7CiAgfQoKICB2YXIgJGRvY3VtZW50ID0gJChkb2N1bWVudCk7CiAgdmFyICR3aW5kb3cgPSAkKHdpbmRvdyk7CiAgdmFyICRib2R5ID0gJCgnYm9keScpOwogIHZhciBERUZBVUxUX09QVElPTlMgPSB7CiAgICB0b2xlcmFuY2U6IDUsCiAgICBvZmZzZXQ6IDAsCiAgICBpbml0aWFsQ2xhc3M6ICdtZHVpLWhlYWRyb29tJywKICAgIHBpbm5lZENsYXNzOiAnbWR1aS1oZWFkcm9vbS1waW5uZWQtdG9wJywKICAgIHVucGlubmVkQ2xhc3M6ICdtZHVpLWhlYWRyb29tLXVucGlubmVkLXRvcCcKICB9OwoKICB2YXIgSGVhZHJvb20gPSBmdW5jdGlvbiBIZWFkcm9vbShzZWxlY3Rvciwgb3B0aW9ucykgewogICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgb3B0aW9ucyA9IHt9OwogICAgLyoqCiAgICAgKiDphY3nva7lj4LmlbAKICAgICAqLwoKICAgIHRoaXMub3B0aW9ucyA9IGV4dGVuZCh7fSwgREVGQVVMVF9PUFRJT05TKTsKICAgIC8qKgogICAgICog5b2T5YmNIGhlYWRyb29tIOeahOeKtuaAgQogICAgICovCgogICAgdGhpcy5zdGF0ZSA9ICdwaW5uZWQnOwogICAgLyoqCiAgICAgKiDlvZPliY3mmK/lkKblkK/nlKgKICAgICAqLwoKICAgIHRoaXMuaXNFbmFibGUgPSBmYWxzZTsKICAgIC8qKgogICAgICog5LiK5qyh5rua5Yqo5ZCO77yM5Z6C55u05pa55ZCR55qE6Led56a7CiAgICAgKi8KCiAgICB0aGlzLmxhc3RTY3JvbGxZID0gMDsKICAgIC8qKgogICAgICogQW5pbWF0aW9uRnJhbWUgSUQKICAgICAqLwoKICAgIHRoaXMucmFmSWQgPSAwOwogICAgdGhpcy4kZWxlbWVudCA9ICQoc2VsZWN0b3IpLmZpcnN0KCk7CiAgICBleHRlbmQodGhpcy5vcHRpb25zLCBvcHRpb25zKTsgLy8gdG9sZXJhbmNlIOWPguaVsOiLpeS4uuaVsOWAvO+8jOi9rOaNouS4uuWvueixoQoKICAgIHZhciB0b2xlcmFuY2UgPSB0aGlzLm9wdGlvbnMudG9sZXJhbmNlOwoKICAgIGlmIChpc051bWJlcih0b2xlcmFuY2UpKSB7CiAgICAgIHRoaXMub3B0aW9ucy50b2xlcmFuY2UgPSB7CiAgICAgICAgZG93bjogdG9sZXJhbmNlLAogICAgICAgIHVwOiB0b2xlcmFuY2UKICAgICAgfTsKICAgIH0KCiAgICB0aGlzLmVuYWJsZSgpOwogIH07CiAgLyoqCiAgICog5rua5Yqo5pe255qE5aSE55CGCiAgICovCgoKICBIZWFkcm9vbS5wcm90b3R5cGUub25TY3JvbGwgPSBmdW5jdGlvbiBvblNjcm9sbCgpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgdGhpcy5yYWZJZCA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gKCkgewogICAgICB2YXIgY3VycmVudFNjcm9sbFkgPSB3aW5kb3cucGFnZVlPZmZzZXQ7CiAgICAgIHZhciBkaXJlY3Rpb24gPSBjdXJyZW50U2Nyb2xsWSA+IHRoaXMkMS5sYXN0U2Nyb2xsWSA/ICdkb3duJyA6ICd1cCc7CiAgICAgIHZhciB0b2xlcmFuY2UgPSB0aGlzJDEub3B0aW9ucy50b2xlcmFuY2VbZGlyZWN0aW9uXTsKICAgICAgdmFyIHNjcm9sbGVkID0gTWF0aC5hYnMoY3VycmVudFNjcm9sbFkgLSB0aGlzJDEubGFzdFNjcm9sbFkpOwogICAgICB2YXIgdG9sZXJhbmNlRXhjZWVkZWQgPSBzY3JvbGxlZCA+PSB0b2xlcmFuY2U7CgogICAgICBpZiAoY3VycmVudFNjcm9sbFkgPiB0aGlzJDEubGFzdFNjcm9sbFkgJiYgY3VycmVudFNjcm9sbFkgPj0gdGhpcyQxLm9wdGlvbnMub2Zmc2V0ICYmIHRvbGVyYW5jZUV4Y2VlZGVkKSB7CiAgICAgICAgdGhpcyQxLnVucGluKCk7CiAgICAgIH0gZWxzZSBpZiAoY3VycmVudFNjcm9sbFkgPCB0aGlzJDEubGFzdFNjcm9sbFkgJiYgdG9sZXJhbmNlRXhjZWVkZWQgfHwgY3VycmVudFNjcm9sbFkgPD0gdGhpcyQxLm9wdGlvbnMub2Zmc2V0KSB7CiAgICAgICAgdGhpcyQxLnBpbigpOwogICAgICB9CgogICAgICB0aGlzJDEubGFzdFNjcm9sbFkgPSBjdXJyZW50U2Nyb2xsWTsKICAgIH0pOwogIH07CiAgLyoqCiAgICog6Kem5Y+R57uE5Lu25LqL5Lu2CiAgICogQHBhcmFtIG5hbWUKICAgKi8KCgogIEhlYWRyb29tLnByb3RvdHlwZS50cmlnZ2VyRXZlbnQgPSBmdW5jdGlvbiB0cmlnZ2VyRXZlbnQobmFtZSkgewogICAgY29tcG9uZW50RXZlbnQobmFtZSwgJ2hlYWRyb29tJywgdGhpcy4kZWxlbWVudCwgdGhpcyk7CiAgfTsKICAvKioKICAgKiDliqjnlLvnu5PmnZ/nmoTlm57osIMKICAgKi8KCgogIEhlYWRyb29tLnByb3RvdHlwZS50cmFuc2l0aW9uRW5kID0gZnVuY3Rpb24gdHJhbnNpdGlvbkVuZCgpIHsKICAgIGlmICh0aGlzLnN0YXRlID09PSAncGlubmluZycpIHsKICAgICAgdGhpcy5zdGF0ZSA9ICdwaW5uZWQnOwogICAgICB0aGlzLnRyaWdnZXJFdmVudCgncGlubmVkJyk7CiAgICB9CgogICAgaWYgKHRoaXMuc3RhdGUgPT09ICd1bnBpbm5pbmcnKSB7CiAgICAgIHRoaXMuc3RhdGUgPSAndW5waW5uZWQnOwogICAgICB0aGlzLnRyaWdnZXJFdmVudCgndW5waW5uZWQnKTsKICAgIH0KICB9OwogIC8qKgogICAqIOS9v+WFg+e0oOWbuuWumuS9jwogICAqLwoKCiAgSGVhZHJvb20ucHJvdG90eXBlLnBpbiA9IGZ1bmN0aW9uIHBpbigpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwoKICAgIGlmICh0aGlzLnN0YXRlID09PSAncGlubmluZycgfHwgdGhpcy5zdGF0ZSA9PT0gJ3Bpbm5lZCcgfHwgIXRoaXMuJGVsZW1lbnQuaGFzQ2xhc3ModGhpcy5vcHRpb25zLmluaXRpYWxDbGFzcykpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMudHJpZ2dlckV2ZW50KCdwaW4nKTsKICAgIHRoaXMuc3RhdGUgPSAncGlubmluZyc7CiAgICB0aGlzLiRlbGVtZW50LnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy51bnBpbm5lZENsYXNzKS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMucGlubmVkQ2xhc3MpLnRyYW5zaXRpb25FbmQoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcyQxLnRyYW5zaXRpb25FbmQoKTsKICAgIH0pOwogIH07CiAgLyoqCiAgICog5L2/5YWD57Sg6ZqQ6JePCiAgICovCgoKICBIZWFkcm9vbS5wcm90b3R5cGUudW5waW4gPSBmdW5jdGlvbiB1bnBpbigpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwoKICAgIGlmICh0aGlzLnN0YXRlID09PSAndW5waW5uaW5nJyB8fCB0aGlzLnN0YXRlID09PSAndW5waW5uZWQnIHx8ICF0aGlzLiRlbGVtZW50Lmhhc0NsYXNzKHRoaXMub3B0aW9ucy5pbml0aWFsQ2xhc3MpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLnRyaWdnZXJFdmVudCgndW5waW4nKTsKICAgIHRoaXMuc3RhdGUgPSAndW5waW5uaW5nJzsKICAgIHRoaXMuJGVsZW1lbnQucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLnBpbm5lZENsYXNzKS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMudW5waW5uZWRDbGFzcykudHJhbnNpdGlvbkVuZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzJDEudHJhbnNpdGlvbkVuZCgpOwogICAgfSk7CiAgfTsKICAvKioKICAgKiDlkK/nlKggaGVhZHJvb20g5o+S5Lu2CiAgICovCgoKICBIZWFkcm9vbS5wcm90b3R5cGUuZW5hYmxlID0gZnVuY3Rpb24gZW5hYmxlKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CgogICAgaWYgKHRoaXMuaXNFbmFibGUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuaXNFbmFibGUgPSB0cnVlOwogICAgdGhpcy5zdGF0ZSA9ICdwaW5uZWQnOwogICAgdGhpcy4kZWxlbWVudC5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuaW5pdGlhbENsYXNzKS5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMucGlubmVkQ2xhc3MpLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy51bnBpbm5lZENsYXNzKTsKICAgIHRoaXMubGFzdFNjcm9sbFkgPSB3aW5kb3cucGFnZVlPZmZzZXQ7CiAgICAkd2luZG93Lm9uKCdzY3JvbGwnLCBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzJDEub25TY3JvbGwoKTsKICAgIH0pOwogIH07CiAgLyoqCiAgICog56aB55SoIGhlYWRyb29tIOaPkuS7tgogICAqLwoKCiAgSGVhZHJvb20ucHJvdG90eXBlLmRpc2FibGUgPSBmdW5jdGlvbiBkaXNhYmxlKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CgogICAgaWYgKCF0aGlzLmlzRW5hYmxlKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLmlzRW5hYmxlID0gZmFsc2U7CiAgICB0aGlzLiRlbGVtZW50LnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5pbml0aWFsQ2xhc3MpLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5waW5uZWRDbGFzcykucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLnVucGlubmVkQ2xhc3MpOwogICAgJHdpbmRvdy5vZmYoJ3Njcm9sbCcsIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMkMS5vblNjcm9sbCgpOwogICAgfSk7CiAgICB3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5yYWZJZCk7CiAgfTsKICAvKioKICAgKiDojrflj5blvZPliY3nirbmgIHjgILlhbHljIXlkKvlm5vnp43nirbmgIHvvJpgcGlubmluZ2DjgIFgcGlubmVkYOOAgWB1bnBpbm5pbmdg44CBYHVucGlubmVkYAogICAqLwoKCiAgSGVhZHJvb20ucHJvdG90eXBlLmdldFN0YXRlID0gZnVuY3Rpb24gZ2V0U3RhdGUoKSB7CiAgICByZXR1cm4gdGhpcy5zdGF0ZTsKICB9OwoKICBtZHVpLkhlYWRyb29tID0gSGVhZHJvb207CiAgLyoqCiAgICog6Kej5p6QIERBVEEgQVBJIOWPguaVsAogICAqIEBwYXJhbSBlbGVtZW50IOWFg+e0oAogICAqIEBwYXJhbSBuYW1lIOWxnuaAp+WQjQogICAqLwoKICBmdW5jdGlvbiBwYXJzZU9wdGlvbnMoZWxlbWVudCwgbmFtZSkgewogICAgdmFyIGF0dHIgPSAkKGVsZW1lbnQpLmF0dHIobmFtZSk7CgogICAgaWYgKCFhdHRyKSB7CiAgICAgIHJldHVybiB7fTsKICAgIH0KCiAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKCcnLCAidmFyIGpzb24gPSAiICsgYXR0ciArICI7IHJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGpzb24pKTsiKSgpOwogIH0KCiAgdmFyIGN1c3RvbUF0dHIgPSAnbWR1aS1oZWFkcm9vbSc7CiAgJChmdW5jdGlvbiAoKSB7CiAgICBtZHVpLm11dGF0aW9uKCJbIiArIGN1c3RvbUF0dHIgKyAiXSIsIGZ1bmN0aW9uICgpIHsKICAgICAgbmV3IG1kdWkuSGVhZHJvb20odGhpcywgcGFyc2VPcHRpb25zKHRoaXMsIGN1c3RvbUF0dHIpKTsKICAgIH0pOwogIH0pOwogIHZhciBERUZBVUxUX09QVElPTlMkMSA9IHsKICAgIGFjY29yZGlvbjogZmFsc2UKICB9OwoKICB2YXIgQ29sbGFwc2VBYnN0cmFjdCA9IGZ1bmN0aW9uIENvbGxhcHNlQWJzdHJhY3Qoc2VsZWN0b3IsIG9wdGlvbnMpIHsKICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIG9wdGlvbnMgPSB7fTsKICAgIC8qKgogICAgICog6YWN572u5Y+C5pWwCiAgICAgKi8KCiAgICB0aGlzLm9wdGlvbnMgPSBleHRlbmQoe30sIERFRkFVTFRfT1BUSU9OUyQxKTsgLy8gQ1NTIOexu+WQjQoKICAgIHZhciBjbGFzc1ByZWZpeCA9ICJtZHVpLSIgKyB0aGlzLmdldE5hbWVzcGFjZSgpICsgIi1pdGVtIjsKICAgIHRoaXMuY2xhc3NJdGVtID0gY2xhc3NQcmVmaXg7CiAgICB0aGlzLmNsYXNzSXRlbU9wZW4gPSBjbGFzc1ByZWZpeCArICItb3BlbiI7CiAgICB0aGlzLmNsYXNzSGVhZGVyID0gY2xhc3NQcmVmaXggKyAiLWhlYWRlciI7CiAgICB0aGlzLmNsYXNzQm9keSA9IGNsYXNzUHJlZml4ICsgIi1ib2R5IjsKICAgIHRoaXMuJGVsZW1lbnQgPSAkKHNlbGVjdG9yKS5maXJzdCgpOwogICAgZXh0ZW5kKHRoaXMub3B0aW9ucywgb3B0aW9ucyk7CiAgICB0aGlzLmJpbmRFdmVudCgpOwogIH07CiAgLyoqCiAgICog57uR5a6a5LqL5Lu2CiAgICovCgoKICBDb2xsYXBzZUFic3RyYWN0LnByb3RvdHlwZS5iaW5kRXZlbnQgPSBmdW5jdGlvbiBiaW5kRXZlbnQoKSB7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXRoaXMtYWxpYXMKICAgIHZhciB0aGF0ID0gdGhpczsgLy8g54K55Ye7IGhlYWRlciDml7bvvIzmiZPlvIAv5YWz6ZetIGl0ZW0KCiAgICB0aGlzLiRlbGVtZW50Lm9uKCdjbGljaycsICIuIiArIHRoaXMuY2xhc3NIZWFkZXIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyICRoZWFkZXIgPSAkKHRoaXMpOwogICAgICB2YXIgJGl0ZW0gPSAkaGVhZGVyLnBhcmVudCgpOwogICAgICB2YXIgJGl0ZW1zID0gdGhhdC5nZXRJdGVtcygpOwogICAgICAkaXRlbXMuZWFjaChmdW5jdGlvbiAoXywgaXRlbSkgewogICAgICAgIGlmICgkaXRlbS5pcyhpdGVtKSkgewogICAgICAgICAgdGhhdC50b2dnbGUoaXRlbSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOyAvLyDngrnlh7vlhbPpl63mjInpkq7ml7bvvIzlhbPpl60gaXRlbQoKICAgIHRoaXMuJGVsZW1lbnQub24oJ2NsaWNrJywgIlttZHVpLSIgKyB0aGlzLmdldE5hbWVzcGFjZSgpICsgIi1pdGVtLWNsb3NlXSIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyICR0YXJnZXQgPSAkKHRoaXMpOwogICAgICB2YXIgJGl0ZW0gPSAkdGFyZ2V0LnBhcmVudHMoIi4iICsgdGhhdC5jbGFzc0l0ZW0pLmZpcnN0KCk7CiAgICAgIHRoYXQuY2xvc2UoJGl0ZW0pOwogICAgfSk7CiAgfTsKICAvKioKICAgKiDmjIflrpogaXRlbSDmmK/lkKblpITkuo7miZPlvIDnirbmgIEKICAgKiBAcGFyYW0gJGl0ZW0KICAgKi8KCgogIENvbGxhcHNlQWJzdHJhY3QucHJvdG90eXBlLmlzT3BlbiA9IGZ1bmN0aW9uIGlzT3BlbigkaXRlbSkgewogICAgcmV0dXJuICRpdGVtLmhhc0NsYXNzKHRoaXMuY2xhc3NJdGVtT3Blbik7CiAgfTsKICAvKioKICAgKiDojrflj5bmiYDmnIkgaXRlbQogICAqLwoKCiAgQ29sbGFwc2VBYnN0cmFjdC5wcm90b3R5cGUuZ2V0SXRlbXMgPSBmdW5jdGlvbiBnZXRJdGVtcygpIHsKICAgIHJldHVybiB0aGlzLiRlbGVtZW50LmNoaWxkcmVuKCIuIiArIHRoaXMuY2xhc3NJdGVtKTsKICB9OwogIC8qKgogICAqIOiOt+WPluaMh+WumiBpdGVtCiAgICogQHBhcmFtIGl0ZW0KICAgKi8KCgogIENvbGxhcHNlQWJzdHJhY3QucHJvdG90eXBlLmdldEl0ZW0gPSBmdW5jdGlvbiBnZXRJdGVtKGl0ZW0pIHsKICAgIGlmIChpc051bWJlcihpdGVtKSkgewogICAgICByZXR1cm4gdGhpcy5nZXRJdGVtcygpLmVxKGl0ZW0pOwogICAgfQoKICAgIHJldHVybiAkKGl0ZW0pLmZpcnN0KCk7CiAgfTsKICAvKioKICAgKiDop6blj5Hnu4Tku7bkuovku7YKICAgKiBAcGFyYW0gbmFtZSDkuovku7blkI0KICAgKiBAcGFyYW0gJGl0ZW0g5LqL5Lu26Kem5Y+R55qE55uu5qCHIGl0ZW0KICAgKi8KCgogIENvbGxhcHNlQWJzdHJhY3QucHJvdG90eXBlLnRyaWdnZXJFdmVudCA9IGZ1bmN0aW9uIHRyaWdnZXJFdmVudChuYW1lLCAkaXRlbSkgewogICAgY29tcG9uZW50RXZlbnQobmFtZSwgdGhpcy5nZXROYW1lc3BhY2UoKSwgJGl0ZW0sIHRoaXMpOwogIH07CiAgLyoqCiAgICog5Yqo55S757uT5p2f5Zue6LCDCiAgICogQHBhcmFtICRjb250ZW50IGJvZHkg5YWD57SgCiAgICogQHBhcmFtICRpdGVtIGl0ZW0g5YWD57SgCiAgICovCgoKICBDb2xsYXBzZUFic3RyYWN0LnByb3RvdHlwZS50cmFuc2l0aW9uRW5kID0gZnVuY3Rpb24gdHJhbnNpdGlvbkVuZCgkY29udGVudCwgJGl0ZW0pIHsKICAgIGlmICh0aGlzLmlzT3BlbigkaXRlbSkpIHsKICAgICAgJGNvbnRlbnQudHJhbnNpdGlvbigwKS5oZWlnaHQoJ2F1dG8nKS5yZWZsb3coKS50cmFuc2l0aW9uKCcnKTsKICAgICAgdGhpcy50cmlnZ2VyRXZlbnQoJ29wZW5lZCcsICRpdGVtKTsKICAgIH0gZWxzZSB7CiAgICAgICRjb250ZW50LmhlaWdodCgnJyk7CiAgICAgIHRoaXMudHJpZ2dlckV2ZW50KCdjbG9zZWQnLCAkaXRlbSk7CiAgICB9CiAgfTsKICAvKioKICAgKiDmiZPlvIDmjIflrprpnaLmnb/pobkKICAgKiBAcGFyYW0gaXRlbSDpnaLmnb/pobnnmoTntKLlvJXlj7fjgIHmiJYgQ1NTIOmAieaLqeWZqOOAgeaIliBET00g5YWD57Sg44CB5oiWIEpRIOWvueixoQogICAqLwoKCiAgQ29sbGFwc2VBYnN0cmFjdC5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uIG9wZW4oaXRlbSkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CiAgICB2YXIgJGl0ZW0gPSB0aGlzLmdldEl0ZW0oaXRlbSk7CgogICAgaWYgKHRoaXMuaXNPcGVuKCRpdGVtKSkgewogICAgICByZXR1cm47CiAgICB9IC8vIOWFs+mXreWFtuS7lumhuQoKCiAgICBpZiAodGhpcy5vcHRpb25zLmFjY29yZGlvbikgewogICAgICB0aGlzLiRlbGVtZW50LmNoaWxkcmVuKCIuIiArIHRoaXMuY2xhc3NJdGVtT3BlbikuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICAgIHZhciAkZWxlbWVudCA9ICQoZWxlbWVudCk7CgogICAgICAgIGlmICghJGVsZW1lbnQuaXMoJGl0ZW0pKSB7CiAgICAgICAgICB0aGlzJDEuY2xvc2UoJGVsZW1lbnQpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogICAgdmFyICRjb250ZW50ID0gJGl0ZW0uY2hpbGRyZW4oIi4iICsgdGhpcy5jbGFzc0JvZHkpOwogICAgJGNvbnRlbnQuaGVpZ2h0KCRjb250ZW50WzBdLnNjcm9sbEhlaWdodCkudHJhbnNpdGlvbkVuZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzJDEudHJhbnNpdGlvbkVuZCgkY29udGVudCwgJGl0ZW0pOwogICAgfSk7CiAgICB0aGlzLnRyaWdnZXJFdmVudCgnb3BlbicsICRpdGVtKTsKICAgICRpdGVtLmFkZENsYXNzKHRoaXMuY2xhc3NJdGVtT3Blbik7CiAgfTsKICAvKioKICAgKiDlhbPpl63mjIflrprpnaLmnb/pobkKICAgKiBAcGFyYW0gaXRlbSDpnaLmnb/pobnnmoTntKLlvJXlj7fjgIHmiJYgQ1NTIOmAieaLqeWZqOOAgeaIliBET00g5YWD57Sg44CB5oiWIEpRIOWvueixoQogICAqLwoKCiAgQ29sbGFwc2VBYnN0cmFjdC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiBjbG9zZShpdGVtKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgIHZhciAkaXRlbSA9IHRoaXMuZ2V0SXRlbShpdGVtKTsKCiAgICBpZiAoIXRoaXMuaXNPcGVuKCRpdGVtKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyICRjb250ZW50ID0gJGl0ZW0uY2hpbGRyZW4oIi4iICsgdGhpcy5jbGFzc0JvZHkpOwogICAgdGhpcy50cmlnZ2VyRXZlbnQoJ2Nsb3NlJywgJGl0ZW0pOwogICAgJGl0ZW0ucmVtb3ZlQ2xhc3ModGhpcy5jbGFzc0l0ZW1PcGVuKTsKICAgICRjb250ZW50LnRyYW5zaXRpb24oMCkuaGVpZ2h0KCRjb250ZW50WzBdLnNjcm9sbEhlaWdodCkucmVmbG93KCkudHJhbnNpdGlvbignJykuaGVpZ2h0KCcnKS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMkMS50cmFuc2l0aW9uRW5kKCRjb250ZW50LCAkaXRlbSk7CiAgICB9KTsKICB9OwogIC8qKgogICAqIOWIh+aNouaMh+Wumumdouadv+mhueeahOaJk+W8gOeKtuaAgQogICAqIEBwYXJhbSBpdGVtIOmdouadv+mhueeahOe0ouW8leWPt+OAgeaIliBDU1Mg6YCJ5oup5Zmo44CB5oiWIERPTSDlhYPntKDjgIHmiJYgSlEg5a+56LGhCiAgICovCgoKICBDb2xsYXBzZUFic3RyYWN0LnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbiB0b2dnbGUoaXRlbSkgewogICAgdmFyICRpdGVtID0gdGhpcy5nZXRJdGVtKGl0ZW0pOwogICAgdGhpcy5pc09wZW4oJGl0ZW0pID8gdGhpcy5jbG9zZSgkaXRlbSkgOiB0aGlzLm9wZW4oJGl0ZW0pOwogIH07CiAgLyoqCiAgICog5omT5byA5omA5pyJ6Z2i5p2/6aG5CiAgICovCgoKICBDb2xsYXBzZUFic3RyYWN0LnByb3RvdHlwZS5vcGVuQWxsID0gZnVuY3Rpb24gb3BlbkFsbCgpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgdGhpcy5nZXRJdGVtcygpLmVhY2goZnVuY3Rpb24gKF8sIGVsZW1lbnQpIHsKICAgICAgcmV0dXJuIHRoaXMkMS5vcGVuKGVsZW1lbnQpOwogICAgfSk7CiAgfTsKICAvKioKICAgKiDlhbPpl63miYDmnInpnaLmnb/pobkKICAgKi8KCgogIENvbGxhcHNlQWJzdHJhY3QucHJvdG90eXBlLmNsb3NlQWxsID0gZnVuY3Rpb24gY2xvc2VBbGwoKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgIHRoaXMuZ2V0SXRlbXMoKS5lYWNoKGZ1bmN0aW9uIChfLCBlbGVtZW50KSB7CiAgICAgIHJldHVybiB0aGlzJDEuY2xvc2UoZWxlbWVudCk7CiAgICB9KTsKICB9OwoKICB2YXIgQ29sbGFwc2UgPSAvKkBfX1BVUkVfXyovZnVuY3Rpb24gKENvbGxhcHNlQWJzdHJhY3QpIHsKICAgIGZ1bmN0aW9uIENvbGxhcHNlKCkgewogICAgICBDb2xsYXBzZUFic3RyYWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CgogICAgaWYgKENvbGxhcHNlQWJzdHJhY3QpIENvbGxhcHNlLl9fcHJvdG9fXyA9IENvbGxhcHNlQWJzdHJhY3Q7CiAgICBDb2xsYXBzZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKENvbGxhcHNlQWJzdHJhY3QgJiYgQ29sbGFwc2VBYnN0cmFjdC5wcm90b3R5cGUpOwogICAgQ29sbGFwc2UucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ29sbGFwc2U7CgogICAgQ29sbGFwc2UucHJvdG90eXBlLmdldE5hbWVzcGFjZSA9IGZ1bmN0aW9uIGdldE5hbWVzcGFjZSgpIHsKICAgICAgcmV0dXJuICdjb2xsYXBzZSc7CiAgICB9OwoKICAgIHJldHVybiBDb2xsYXBzZTsKICB9KENvbGxhcHNlQWJzdHJhY3QpOwoKICBtZHVpLkNvbGxhcHNlID0gQ29sbGFwc2U7CiAgdmFyIGN1c3RvbUF0dHIkMSA9ICdtZHVpLWNvbGxhcHNlJzsKICAkKGZ1bmN0aW9uICgpIHsKICAgIG1kdWkubXV0YXRpb24oIlsiICsgY3VzdG9tQXR0ciQxICsgIl0iLCBmdW5jdGlvbiAoKSB7CiAgICAgIG5ldyBtZHVpLkNvbGxhcHNlKHRoaXMsIHBhcnNlT3B0aW9ucyh0aGlzLCBjdXN0b21BdHRyJDEpKTsKICAgIH0pOwogIH0pOwoKICB2YXIgUGFuZWwgPSAvKkBfX1BVUkVfXyovZnVuY3Rpb24gKENvbGxhcHNlQWJzdHJhY3QpIHsKICAgIGZ1bmN0aW9uIFBhbmVsKCkgewogICAgICBDb2xsYXBzZUFic3RyYWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CgogICAgaWYgKENvbGxhcHNlQWJzdHJhY3QpIFBhbmVsLl9fcHJvdG9fXyA9IENvbGxhcHNlQWJzdHJhY3Q7CiAgICBQYW5lbC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKENvbGxhcHNlQWJzdHJhY3QgJiYgQ29sbGFwc2VBYnN0cmFjdC5wcm90b3R5cGUpOwogICAgUGFuZWwucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUGFuZWw7CgogICAgUGFuZWwucHJvdG90eXBlLmdldE5hbWVzcGFjZSA9IGZ1bmN0aW9uIGdldE5hbWVzcGFjZSgpIHsKICAgICAgcmV0dXJuICdwYW5lbCc7CiAgICB9OwoKICAgIHJldHVybiBQYW5lbDsKICB9KENvbGxhcHNlQWJzdHJhY3QpOwoKICBtZHVpLlBhbmVsID0gUGFuZWw7CiAgdmFyIGN1c3RvbUF0dHIkMiA9ICdtZHVpLXBhbmVsJzsKICAkKGZ1bmN0aW9uICgpIHsKICAgIG1kdWkubXV0YXRpb24oIlsiICsgY3VzdG9tQXR0ciQyICsgIl0iLCBmdW5jdGlvbiAoKSB7CiAgICAgIG5ldyBtZHVpLlBhbmVsKHRoaXMsIHBhcnNlT3B0aW9ucyh0aGlzLCBjdXN0b21BdHRyJDIpKTsKICAgIH0pOwogIH0pOwoKICB2YXIgVGFibGUgPSBmdW5jdGlvbiBUYWJsZShzZWxlY3RvcikgewogICAgLyoqCiAgICAgKiDooajlpLQgdHIg5YWD57SgCiAgICAgKi8KICAgIHRoaXMuJHRoUm93ID0gJCgpOwogICAgLyoqCiAgICAgKiDooajmoLwgYm9keSDkuK3nmoQgdHIg5YWD57SgCiAgICAgKi8KCiAgICB0aGlzLiR0ZFJvd3MgPSAkKCk7CiAgICAvKioKICAgICAqIOihqOWktOeahCBjaGVja2JveCDlhYPntKAKICAgICAqLwoKICAgIHRoaXMuJHRoQ2hlY2tib3ggPSAkKCk7CiAgICAvKioKICAgICAqIOihqOagvCBib2R5IOS4reeahCBjaGVja2JveCDlhYPntKAKICAgICAqLwoKICAgIHRoaXMuJHRkQ2hlY2tib3hzID0gJCgpOwogICAgLyoqCiAgICAgKiDooajmoLzooYzmmK/lkKblj6/pgInmi6kKICAgICAqLwoKICAgIHRoaXMuc2VsZWN0YWJsZSA9IGZhbHNlOwogICAgLyoqCiAgICAgKiDlt7LpgInkuK3nmoTooYzmlbAKICAgICAqLwoKICAgIHRoaXMuc2VsZWN0ZWRSb3cgPSAwOwogICAgdGhpcy4kZWxlbWVudCA9ICQoc2VsZWN0b3IpLmZpcnN0KCk7CiAgICB0aGlzLmluaXQoKTsKICB9OwogIC8qKgogICAqIOWIneWni+WMluihqOagvAogICAqLwoKCiAgVGFibGUucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiBpbml0KCkgewogICAgdGhpcy4kdGhSb3cgPSB0aGlzLiRlbGVtZW50LmZpbmQoJ3RoZWFkIHRyJyk7CiAgICB0aGlzLiR0ZFJvd3MgPSB0aGlzLiRlbGVtZW50LmZpbmQoJ3Rib2R5IHRyJyk7CiAgICB0aGlzLnNlbGVjdGFibGUgPSB0aGlzLiRlbGVtZW50Lmhhc0NsYXNzKCdtZHVpLXRhYmxlLXNlbGVjdGFibGUnKTsKICAgIHRoaXMudXBkYXRlVGhDaGVja2JveCgpOwogICAgdGhpcy51cGRhdGVUZENoZWNrYm94KCk7CiAgICB0aGlzLnVwZGF0ZU51bWVyaWNDb2woKTsKICB9OwogIC8qKgogICAqIOeUn+aIkCBjaGVja2JveCDnmoQgSFRNTCDnu5PmnoQKICAgKiBAcGFyYW0gdGFnIOagh+etvuWQjQogICAqLwoKCiAgVGFibGUucHJvdG90eXBlLmNyZWF0ZUNoZWNrYm94SFRNTCA9IGZ1bmN0aW9uIGNyZWF0ZUNoZWNrYm94SFRNTCh0YWcpIHsKICAgIHJldHVybiAiPCIgKyB0YWcgKyAiIGNsYXNzPVwibWR1aS10YWJsZS1jZWxsLWNoZWNrYm94XCI+IiArICc8bGFiZWwgY2xhc3M9Im1kdWktY2hlY2tib3giPicgKyAnPGlucHV0IHR5cGU9ImNoZWNrYm94Ii8+JyArICc8aSBjbGFzcz0ibWR1aS1jaGVja2JveC1pY29uIj48L2k+JyArICc8L2xhYmVsPicgKyAiPC8iICsgdGFnICsgIj4iOwogIH07CiAgLyoqCiAgICog5pu05paw6KGo5aS0IGNoZWNrYm94IOeahOeKtuaAgQogICAqLwoKCiAgVGFibGUucHJvdG90eXBlLnVwZGF0ZVRoQ2hlY2tib3hTdGF0dXMgPSBmdW5jdGlvbiB1cGRhdGVUaENoZWNrYm94U3RhdHVzKCkgewogICAgdmFyIGNoZWNrYm94ID0gdGhpcy4kdGhDaGVja2JveFswXTsKICAgIHZhciBzZWxlY3RlZFJvdyA9IHRoaXMuc2VsZWN0ZWRSb3c7CiAgICB2YXIgdGRSb3dzTGVuZ3RoID0gdGhpcy4kdGRSb3dzLmxlbmd0aDsKICAgIGNoZWNrYm94LmNoZWNrZWQgPSBzZWxlY3RlZFJvdyA9PT0gdGRSb3dzTGVuZ3RoOwogICAgY2hlY2tib3guaW5kZXRlcm1pbmF0ZSA9ICEhc2VsZWN0ZWRSb3cgJiYgc2VsZWN0ZWRSb3cgIT09IHRkUm93c0xlbmd0aDsKICB9OwogIC8qKgogICAqIOabtOaWsOihqOagvOihjOeahCBjaGVja2JveAogICAqLwoKCiAgVGFibGUucHJvdG90eXBlLnVwZGF0ZVRkQ2hlY2tib3ggPSBmdW5jdGlvbiB1cGRhdGVUZENoZWNrYm94KCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CiAgICB2YXIgcm93U2VsZWN0ZWRDbGFzcyA9ICdtZHVpLXRhYmxlLXJvdy1zZWxlY3RlZCc7CiAgICB0aGlzLiR0ZFJvd3MuZWFjaChmdW5jdGlvbiAoXywgcm93KSB7CiAgICAgIHZhciAkcm93ID0gJChyb3cpOyAvLyDnp7vpmaTml6fnmoQgY2hlY2tib3gKCiAgICAgICRyb3cuZmluZCgnLm1kdWktdGFibGUtY2VsbC1jaGVja2JveCcpLnJlbW92ZSgpOwoKICAgICAgaWYgKCF0aGlzJDEuc2VsZWN0YWJsZSkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyDliJvlu7ogRE9NCgoKICAgICAgdmFyICRjaGVja2JveCA9ICQodGhpcyQxLmNyZWF0ZUNoZWNrYm94SFRNTCgndGQnKSkucHJlcGVuZFRvKCRyb3cpLmZpbmQoJ2lucHV0W3R5cGU9ImNoZWNrYm94Il0nKTsgLy8g6buY6K6k6YCJ5Lit55qE6KGMCgogICAgICBpZiAoJHJvdy5oYXNDbGFzcyhyb3dTZWxlY3RlZENsYXNzKSkgewogICAgICAgICRjaGVja2JveFswXS5jaGVja2VkID0gdHJ1ZTsKICAgICAgICB0aGlzJDEuc2VsZWN0ZWRSb3crKzsKICAgICAgfQoKICAgICAgdGhpcyQxLnVwZGF0ZVRoQ2hlY2tib3hTdGF0dXMoKTsgLy8g57uR5a6a5LqL5Lu2CgogICAgICAkY2hlY2tib3gub24oJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoJGNoZWNrYm94WzBdLmNoZWNrZWQpIHsKICAgICAgICAgICRyb3cuYWRkQ2xhc3Mocm93U2VsZWN0ZWRDbGFzcyk7CiAgICAgICAgICB0aGlzJDEuc2VsZWN0ZWRSb3crKzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgJHJvdy5yZW1vdmVDbGFzcyhyb3dTZWxlY3RlZENsYXNzKTsKICAgICAgICAgIHRoaXMkMS5zZWxlY3RlZFJvdy0tOwogICAgICAgIH0KCiAgICAgICAgdGhpcyQxLnVwZGF0ZVRoQ2hlY2tib3hTdGF0dXMoKTsKICAgICAgfSk7CiAgICAgIHRoaXMkMS4kdGRDaGVja2JveHMgPSB0aGlzJDEuJHRkQ2hlY2tib3hzLmFkZCgkY2hlY2tib3gpOwogICAgfSk7CiAgfTsKICAvKioKICAgKiDmm7TmlrDooajlpLTnmoQgY2hlY2tib3gKICAgKi8KCgogIFRhYmxlLnByb3RvdHlwZS51cGRhdGVUaENoZWNrYm94ID0gZnVuY3Rpb24gdXBkYXRlVGhDaGVja2JveCgpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOyAvLyDnp7vpmaTml6fnmoQgY2hlY2tib3gKCiAgICB0aGlzLiR0aFJvdy5maW5kKCcubWR1aS10YWJsZS1jZWxsLWNoZWNrYm94JykucmVtb3ZlKCk7CgogICAgaWYgKCF0aGlzLnNlbGVjdGFibGUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuJHRoQ2hlY2tib3ggPSAkKHRoaXMuY3JlYXRlQ2hlY2tib3hIVE1MKCd0aCcpKS5wcmVwZW5kVG8odGhpcy4kdGhSb3cpLmZpbmQoJ2lucHV0W3R5cGU9ImNoZWNrYm94Il0nKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkgewogICAgICB2YXIgaXNDaGVja2VkQWxsID0gdGhpcyQxLiR0aENoZWNrYm94WzBdLmNoZWNrZWQ7CiAgICAgIHRoaXMkMS5zZWxlY3RlZFJvdyA9IGlzQ2hlY2tlZEFsbCA/IHRoaXMkMS4kdGRSb3dzLmxlbmd0aCA6IDA7CiAgICAgIHRoaXMkMS4kdGRDaGVja2JveHMuZWFjaChmdW5jdGlvbiAoXywgY2hlY2tib3gpIHsKICAgICAgICBjaGVja2JveC5jaGVja2VkID0gaXNDaGVja2VkQWxsOwogICAgICB9KTsKICAgICAgdGhpcyQxLiR0ZFJvd3MuZWFjaChmdW5jdGlvbiAoXywgcm93KSB7CiAgICAgICAgaXNDaGVja2VkQWxsID8gJChyb3cpLmFkZENsYXNzKCdtZHVpLXRhYmxlLXJvdy1zZWxlY3RlZCcpIDogJChyb3cpLnJlbW92ZUNsYXNzKCdtZHVpLXRhYmxlLXJvdy1zZWxlY3RlZCcpOwogICAgICB9KTsKICAgIH0pOwogIH07CiAgLyoqCiAgICog5pu05paw5pWw5YC85YiXCiAgICovCgoKICBUYWJsZS5wcm90b3R5cGUudXBkYXRlTnVtZXJpY0NvbCA9IGZ1bmN0aW9uIHVwZGF0ZU51bWVyaWNDb2woKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgIHZhciBudW1lcmljQ2xhc3MgPSAnbWR1aS10YWJsZS1jb2wtbnVtZXJpYyc7CiAgICB0aGlzLiR0aFJvdy5maW5kKCd0aCcpLmVhY2goZnVuY3Rpb24gKGksIHRoKSB7CiAgICAgIHZhciBpc051bWVyaWNDb2wgPSAkKHRoKS5oYXNDbGFzcyhudW1lcmljQ2xhc3MpOwogICAgICB0aGlzJDEuJHRkUm93cy5lYWNoKGZ1bmN0aW9uIChfLCByb3cpIHsKICAgICAgICB2YXIgJHRkID0gJChyb3cpLmZpbmQoJ3RkJykuZXEoaSk7CiAgICAgICAgaXNOdW1lcmljQ29sID8gJHRkLmFkZENsYXNzKG51bWVyaWNDbGFzcykgOiAkdGQucmVtb3ZlQ2xhc3MobnVtZXJpY0NsYXNzKTsKICAgICAgfSk7CiAgICB9KTsKICB9OwoKICB2YXIgZGF0YU5hbWUgPSAnX21kdWlfdGFibGUnOwogICQoZnVuY3Rpb24gKCkgewogICAgbWR1aS5tdXRhdGlvbignLm1kdWktdGFibGUnLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciAkZWxlbWVudCA9ICQodGhpcyk7CgogICAgICBpZiAoISRlbGVtZW50LmRhdGEoZGF0YU5hbWUpKSB7CiAgICAgICAgJGVsZW1lbnQuZGF0YShkYXRhTmFtZSwgbmV3IFRhYmxlKCRlbGVtZW50KSk7CiAgICAgIH0KICAgIH0pOwogIH0pOwoKICBtZHVpLnVwZGF0ZVRhYmxlcyA9IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgdmFyICRlbGVtZW50cyA9IGlzVW5kZWZpbmVkKHNlbGVjdG9yKSA/ICQoJy5tZHVpLXRhYmxlJykgOiAkKHNlbGVjdG9yKTsKICAgICRlbGVtZW50cy5lYWNoKGZ1bmN0aW9uIChfLCBlbGVtZW50KSB7CiAgICAgIHZhciAkZWxlbWVudCA9ICQoZWxlbWVudCk7CiAgICAgIHZhciBpbnN0YW5jZSA9ICRlbGVtZW50LmRhdGEoZGF0YU5hbWUpOwoKICAgICAgaWYgKGluc3RhbmNlKSB7CiAgICAgICAgaW5zdGFuY2UuaW5pdCgpOwogICAgICB9IGVsc2UgewogICAgICAgICRlbGVtZW50LmRhdGEoZGF0YU5hbWUsIG5ldyBUYWJsZSgkZWxlbWVudCkpOwogICAgICB9CiAgICB9KTsKICB9OwogIC8qKgogICAqIHRvdWNoIOS6i+S7tuWQjueahCA1MDBtcyDlhoXnpoHnlKggbW91c2Vkb3duIOS6i+S7tgogICAqCiAgICog5LiN5pSv5oyB6Kem5o6n55qE5bGP5bmV5LiK5LqL5Lu26aG65bqP5Li6IG1vdXNlZG93biAtPiBtb3VzZXVwIC0+IGNsaWNrCiAgICog5pSv5oyB6Kem5o6n55qE5bGP5bmV5LiK5LqL5Lu26aG65bqP5Li6IHRvdWNoc3RhcnQgLT4gdG91Y2hlbmQgLT4gbW91c2Vkb3duIC0+IG1vdXNldXAgLT4gY2xpY2sKICAgKgogICAqIOWcqOavj+S4gOS4quS6i+S7tuS4remDveS9v+eUqCBUb3VjaEhhbmRsZXIuaXNBbGxvdyhldmVudCkg5Yik5pat5LqL5Lu25piv5ZCm5Y+v5omn6KGMCiAgICog5ZyoIHRvdWNoc3RhcnQg5ZKMIHRvdWNobW92ZeOAgXRvdWNoZW5k44CBdG91Y2hjYW5jZWwKICAgKgogICAqIChmdW5jdGlvbiAoKSB7CiAgICogICAkZG9jdW1lbnQKICAgKiAgICAgLm9uKHN0YXJ0LCBmdW5jdGlvbiAoZSkgewogICAqICAgICAgIGlmICghaXNBbGxvdyhlKSkgewogICAqICAgICAgICAgcmV0dXJuOwogICAqICAgICAgIH0KICAgKiAgICAgICByZWdpc3RlcihlKTsKICAgKiAgICAgICBjb25zb2xlLmxvZyhlLnR5cGUpOwogICAqICAgICB9KQogICAqICAgICAub24obW92ZSwgZnVuY3Rpb24gKGUpIHsKICAgKiAgICAgICBpZiAoIWlzQWxsb3coZSkpIHsKICAgKiAgICAgICAgIHJldHVybjsKICAgKiAgICAgICB9CiAgICogICAgICAgY29uc29sZS5sb2coZS50eXBlKTsKICAgKiAgICAgfSkKICAgKiAgICAgLm9uKGVuZCwgZnVuY3Rpb24gKGUpIHsKICAgKiAgICAgICBpZiAoIWlzQWxsb3coZSkpIHsKICAgKiAgICAgICAgIHJldHVybjsKICAgKiAgICAgICB9CiAgICogICAgICAgY29uc29sZS5sb2coZS50eXBlKTsKICAgKiAgICAgfSkKICAgKiAgICAgLm9uKHVubG9jaywgcmVnaXN0ZXIpOwogICAqIH0pKCk7CiAgICovCgoKICB2YXIgc3RhcnRFdmVudCA9ICd0b3VjaHN0YXJ0IG1vdXNlZG93bic7CiAgdmFyIG1vdmVFdmVudCA9ICd0b3VjaG1vdmUgbW91c2Vtb3ZlJzsKICB2YXIgZW5kRXZlbnQgPSAndG91Y2hlbmQgbW91c2V1cCc7CiAgdmFyIGNhbmNlbEV2ZW50ID0gJ3RvdWNoY2FuY2VsIG1vdXNlbGVhdmUnOwogIHZhciB1bmxvY2tFdmVudCA9ICd0b3VjaGVuZCB0b3VjaG1vdmUgdG91Y2hjYW5jZWwnOwogIHZhciB0b3VjaGVzID0gMDsKICAvKioKICAgKiDor6Xkuovku7bmmK/lkKbooqvlhYHorrjvvIzlnKjmiafooYzkuovku7bliY3osIPnlKjor6Xmlrnms5XliKTmlq3kuovku7bmmK/lkKblj6/ku6XmiafooYwKICAgKiDoi6Xlt7Lop6blj5EgdG91Y2gg5LqL5Lu277yM5YiZ6Zi75q2i5LmL5ZCO55qE6byg5qCH5LqL5Lu2CiAgICogQHBhcmFtIGV2ZW50CiAgICovCgogIGZ1bmN0aW9uIGlzQWxsb3coZXZlbnQpIHsKICAgIHJldHVybiAhKHRvdWNoZXMgJiYgWydtb3VzZWRvd24nLCAnbW91c2V1cCcsICdtb3VzZW1vdmUnLCAnY2xpY2snLCAnbW91c2VvdmVyJywgJ21vdXNlb3V0JywgJ21vdXNlZW50ZXInLCAnbW91c2VsZWF2ZSddLmluZGV4T2YoZXZlbnQudHlwZSkgPiAtMSk7CiAgfQogIC8qKgogICAqIOWcqCB0b3VjaHN0YXJ0IOWSjCB0b3VjaG1vdmXjgIF0b3VjaGVuZOOAgXRvdWNoY2FuY2VsIOS6i+S7tuS4reiwg+eUqOivpeaWueazleazqOWGjOS6i+S7tgogICAqIEBwYXJhbSBldmVudAogICAqLwoKCiAgZnVuY3Rpb24gcmVnaXN0ZXIoZXZlbnQpIHsKICAgIGlmIChldmVudC50eXBlID09PSAndG91Y2hzdGFydCcpIHsKICAgICAgLy8g6Kem5Y+R5LqGIHRvdWNoIOS6i+S7tgogICAgICB0b3VjaGVzICs9IDE7CiAgICB9IGVsc2UgaWYgKFsndG91Y2htb3ZlJywgJ3RvdWNoZW5kJywgJ3RvdWNoY2FuY2VsJ10uaW5kZXhPZihldmVudC50eXBlKSA+IC0xKSB7CiAgICAgIC8vIHRvdWNoIOS6i+S7tue7k+adnyA1MDBtcyDlkI7op6PpmaTlr7npvKDmoIfkuovku7bnmoTpmLvmraIKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRvdWNoZXMpIHsKICAgICAgICAgIHRvdWNoZXMgLT0gMTsKICAgICAgICB9CiAgICAgIH0sIDUwMCk7CiAgICB9CiAgfQogIC8qKgogICAqIEluc3BpcmVkIGJ5IGh0dHBzOi8vZ2l0aHViLmNvbS9ub2xpbWl0czR3ZWIvRnJhbWV3b3JrNy9ibG9iL21hc3Rlci9zcmMvanMvZmFzdC1jbGlja3MuanMKICAgKiBodHRwczovL2dpdGh1Yi5jb20vbm9saW1pdHM0d2ViL0ZyYW1ld29yazcvYmxvYi9tYXN0ZXIvTElDRU5TRQogICAqCiAgICogSW5zcGlyZWQgYnkgaHR0cHM6Ly9naXRodWIuY29tL2ZpYW5zL1dhdmVzCiAgICovCgogIC8qKgogICAqIOaYvuekuua2n+a8quWKqOeUuwogICAqIEBwYXJhbSBldmVudAogICAqIEBwYXJhbSAkcmlwcGxlCiAgICovCgoKICBmdW5jdGlvbiBzaG93KGV2ZW50LCAkcmlwcGxlKSB7CiAgICAvLyDpvKDmoIflj7PplK7kuI3kuqfnlJ/mtp/mvKoKICAgIGlmIChldmVudCBpbnN0YW5jZW9mIE1vdXNlRXZlbnQgJiYgZXZlbnQuYnV0dG9uID09PSAyKSB7CiAgICAgIHJldHVybjsKICAgIH0gLy8g54K55Ye75L2N572u5Z2Q5qCHCgoKICAgIHZhciB0b3VjaFBvc2l0aW9uID0gdHlwZW9mIFRvdWNoRXZlbnQgIT09ICd1bmRlZmluZWQnICYmIGV2ZW50IGluc3RhbmNlb2YgVG91Y2hFdmVudCAmJiBldmVudC50b3VjaGVzLmxlbmd0aCA/IGV2ZW50LnRvdWNoZXNbMF0gOiBldmVudDsKICAgIHZhciB0b3VjaFN0YXJ0WCA9IHRvdWNoUG9zaXRpb24ucGFnZVg7CiAgICB2YXIgdG91Y2hTdGFydFkgPSB0b3VjaFBvc2l0aW9uLnBhZ2VZOyAvLyDmtp/mvKrkvY3nva4KCiAgICB2YXIgb2Zmc2V0ID0gJHJpcHBsZS5vZmZzZXQoKTsKICAgIHZhciBoZWlnaHQgPSAkcmlwcGxlLmlubmVySGVpZ2h0KCk7CiAgICB2YXIgd2lkdGggPSAkcmlwcGxlLmlubmVyV2lkdGgoKTsKICAgIHZhciBjZW50ZXIgPSB7CiAgICAgIHg6IHRvdWNoU3RhcnRYIC0gb2Zmc2V0LmxlZnQsCiAgICAgIHk6IHRvdWNoU3RhcnRZIC0gb2Zmc2V0LnRvcAogICAgfTsKICAgIHZhciBkaWFtZXRlciA9IE1hdGgubWF4KE1hdGgucG93KE1hdGgucG93KGhlaWdodCwgMikgKyBNYXRoLnBvdyh3aWR0aCwgMiksIDAuNSksIDQ4KTsgLy8g5raf5ryq5omp5pWj5Yqo55S7CgogICAgdmFyIHRyYW5zbGF0ZSA9ICJ0cmFuc2xhdGUzZCgiICsgKC1jZW50ZXIueCArIHdpZHRoIC8gMikgKyAicHgsIiArICgtY2VudGVyLnkgKyBoZWlnaHQgLyAyKSArICJweCwgMCkgc2NhbGUoMSkiOyAvLyDmtp/mvKrnmoQgRE9NIOe7k+aehO+8jOW5tue8k+WtmOWKqOeUu+aViOaenAoKICAgICQoIjxkaXYgY2xhc3M9XCJtZHVpLXJpcHBsZS13YXZlXCIgIiArICJzdHlsZT1cIndpZHRoOiIgKyBkaWFtZXRlciArICJweDtoZWlnaHQ6IiArIGRpYW1ldGVyICsgInB4OyIgKyAibWFyZ2luLXRvcDotIiArIGRpYW1ldGVyIC8gMiArICJweDttYXJnaW4tbGVmdDotIiArIGRpYW1ldGVyIC8gMiArICJweDsiICsgImxlZnQ6IiArIGNlbnRlci54ICsgInB4O3RvcDoiICsgY2VudGVyLnkgKyAicHg7XCI+PC9kaXY+IikuZGF0YSgnX3JpcHBsZV93YXZlX3RyYW5zbGF0ZScsIHRyYW5zbGF0ZSkucHJlcGVuZFRvKCRyaXBwbGUpLnJlZmxvdygpLnRyYW5zZm9ybSh0cmFuc2xhdGUpOwogIH0KICAvKioKICAgKiDpmpDol4/lubbnp7vpmaTmtp/mvKoKICAgKiBAcGFyYW0gJHdhdmUKICAgKi8KCgogIGZ1bmN0aW9uIHJlbW92ZVJpcHBsZSgkd2F2ZSkgewogICAgaWYgKCEkd2F2ZS5sZW5ndGggfHwgJHdhdmUuZGF0YSgnX3JpcHBsZV93YXZlX3JlbW92ZWQnKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgJHdhdmUuZGF0YSgnX3JpcHBsZV93YXZlX3JlbW92ZWQnLCB0cnVlKTsKICAgIHZhciByZW1vdmVUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gJHdhdmUucmVtb3ZlKCk7CiAgICB9LCA0MDApOwogICAgdmFyIHRyYW5zbGF0ZSA9ICR3YXZlLmRhdGEoJ19yaXBwbGVfd2F2ZV90cmFuc2xhdGUnKTsKICAgICR3YXZlLmFkZENsYXNzKCdtZHVpLXJpcHBsZS13YXZlLWZpbGwnKS50cmFuc2Zvcm0odHJhbnNsYXRlLnJlcGxhY2UoJ3NjYWxlKDEpJywgJ3NjYWxlKDEuMDEpJykpLnRyYW5zaXRpb25FbmQoZnVuY3Rpb24gKCkgewogICAgICBjbGVhclRpbWVvdXQocmVtb3ZlVGltZXIpOwogICAgICAkd2F2ZS5hZGRDbGFzcygnbWR1aS1yaXBwbGUtd2F2ZS1vdXQnKS50cmFuc2Zvcm0odHJhbnNsYXRlLnJlcGxhY2UoJ3NjYWxlKDEpJywgJ3NjYWxlKDEuMDEpJykpOwogICAgICByZW1vdmVUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiAkd2F2ZS5yZW1vdmUoKTsKICAgICAgfSwgNzAwKTsKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgJHdhdmUudHJhbnNpdGlvbkVuZChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQocmVtb3ZlVGltZXIpOwogICAgICAgICAgJHdhdmUucmVtb3ZlKCk7CiAgICAgICAgfSk7CiAgICAgIH0sIDApOwogICAgfSk7CiAgfQogIC8qKgogICAqIOmakOiXj+a2n+a8quWKqOeUuwogICAqIEBwYXJhbSB0aGlzCiAgICovCgoKICBmdW5jdGlvbiBoaWRlKCkgewogICAgdmFyICRyaXBwbGUgPSAkKHRoaXMpOwogICAgJHJpcHBsZS5jaGlsZHJlbignLm1kdWktcmlwcGxlLXdhdmUnKS5lYWNoKGZ1bmN0aW9uIChfLCB3YXZlKSB7CiAgICAgIHJlbW92ZVJpcHBsZSgkKHdhdmUpKTsKICAgIH0pOwogICAgJHJpcHBsZS5vZmYobW92ZUV2ZW50ICsgIiAiICsgZW5kRXZlbnQgKyAiICIgKyBjYW5jZWxFdmVudCwgaGlkZSk7CiAgfQogIC8qKgogICAqIOaYvuekuua2n+a8qu+8jOW5tue7keWumiB0b3VjaGVuZCDnrYnkuovku7YKICAgKiBAcGFyYW0gZXZlbnQKICAgKi8KCgogIGZ1bmN0aW9uIHNob3dSaXBwbGUoZXZlbnQpIHsKICAgIGlmICghaXNBbGxvdyhldmVudCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHJlZ2lzdGVyKGV2ZW50KTsgLy8gQ2hyb21lIDU5IOeCueWHu+a7muWKqOadoeaXtu+8jOS8muWcqCBkb2N1bWVudCDkuIrop6blj5Hkuovku7YKCiAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSBkb2N1bWVudCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyICR0YXJnZXQgPSAkKGV2ZW50LnRhcmdldCk7IC8vIOiOt+WPluWQqyAubWR1aS1yaXBwbGUg57G755qE5YWD57SgCgogICAgdmFyICRyaXBwbGUgPSAkdGFyZ2V0Lmhhc0NsYXNzKCdtZHVpLXJpcHBsZScpID8gJHRhcmdldCA6ICR0YXJnZXQucGFyZW50cygnLm1kdWktcmlwcGxlJykuZmlyc3QoKTsKCiAgICBpZiAoISRyaXBwbGUubGVuZ3RoKSB7CiAgICAgIHJldHVybjsKICAgIH0gLy8g56aB55So54q25oCB55qE5YWD57Sg5LiK5LiN5Lqn55Sf5raf5ryq5pWI5p6cCgoKICAgIGlmICgkcmlwcGxlLnByb3AoJ2Rpc2FibGVkJykgfHwgIWlzVW5kZWZpbmVkKCRyaXBwbGUuYXR0cignZGlzYWJsZWQnKSkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChldmVudC50eXBlID09PSAndG91Y2hzdGFydCcpIHsKICAgICAgdmFyIGhpZGRlbiA9IGZhbHNlOyAvLyB0b3VjaHN0YXJ0IOinpuWPkeaMh+WumuaXtumXtOWQjuW8gOWni+a2n+a8quWKqOeUu++8jOmBv+WFjeaJi+aMh+a7keWKqOaXtuS5n+inpuWPkea2n+a8qgoKICAgICAgdmFyIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgdGltZXIgPSAwOwogICAgICAgIHNob3coZXZlbnQsICRyaXBwbGUpOwogICAgICB9LCAyMDApOwoKICAgICAgdmFyIGhpZGVSaXBwbGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgLy8g5aaC5p6c5omL5oyH5rKh5pyJ56e75Yqo77yM5LiU5raf5ryq5Yqo55S76L+Y5rKh5pyJ5byA5aeL77yM5YiZ5byA5aeL5raf5ryq5Yqo55S7CiAgICAgICAgaWYgKHRpbWVyKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpOwogICAgICAgICAgdGltZXIgPSAwOwogICAgICAgICAgc2hvdyhldmVudCwgJHJpcHBsZSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIWhpZGRlbikgewogICAgICAgICAgaGlkZGVuID0gdHJ1ZTsKICAgICAgICAgIGhpZGUuY2FsbCgkcmlwcGxlKTsKICAgICAgICB9CiAgICAgIH07IC8vIOaJi+aMh+enu+WKqOWQju+8jOenu+mZpOa2n+a8quWKqOeUuwoKCiAgICAgIHZhciB0b3VjaE1vdmUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRpbWVyKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpOwogICAgICAgICAgdGltZXIgPSAwOwogICAgICAgIH0KCiAgICAgICAgaGlkZVJpcHBsZSgpOwogICAgICB9OwoKICAgICAgJHJpcHBsZS5vbigndG91Y2htb3ZlJywgdG91Y2hNb3ZlKS5vbigndG91Y2hlbmQgdG91Y2hjYW5jZWwnLCBoaWRlUmlwcGxlKTsKICAgIH0gZWxzZSB7CiAgICAgIHNob3coZXZlbnQsICRyaXBwbGUpOwogICAgICAkcmlwcGxlLm9uKG1vdmVFdmVudCArICIgIiArIGVuZEV2ZW50ICsgIiAiICsgY2FuY2VsRXZlbnQsIGhpZGUpOwogICAgfQogIH0KCiAgJChmdW5jdGlvbiAoKSB7CiAgICAkZG9jdW1lbnQub24oc3RhcnRFdmVudCwgc2hvd1JpcHBsZSkub24odW5sb2NrRXZlbnQsIHJlZ2lzdGVyKTsKICB9KTsKICB2YXIgZGVmYXVsdERhdGEgPSB7CiAgICByZUluaXQ6IGZhbHNlLAogICAgZG9tTG9hZGVkRXZlbnQ6IGZhbHNlCiAgfTsKICAvKioKICAgKiDovpPlhaXmoYbkuovku7YKICAgKiBAcGFyYW0gZXZlbnQKICAgKiBAcGFyYW0gZGF0YQogICAqLwoKICBmdW5jdGlvbiBpbnB1dEV2ZW50KGV2ZW50LCBkYXRhKSB7CiAgICBpZiAoZGF0YSA9PT0gdm9pZCAwKSBkYXRhID0ge307CiAgICBkYXRhID0gZXh0ZW5kKHt9LCBkZWZhdWx0RGF0YSwgZGF0YSk7CiAgICB2YXIgaW5wdXQgPSBldmVudC50YXJnZXQ7CiAgICB2YXIgJGlucHV0ID0gJChpbnB1dCk7CiAgICB2YXIgZXZlbnRUeXBlID0gZXZlbnQudHlwZTsKICAgIHZhciB2YWx1ZSA9ICRpbnB1dC52YWwoKTsgLy8g5paH5pys5qGG57G75Z6LCgogICAgdmFyIGlucHV0VHlwZSA9ICRpbnB1dC5hdHRyKCd0eXBlJykgfHwgJyc7CgogICAgaWYgKFsnY2hlY2tib3gnLCAnYnV0dG9uJywgJ3N1Ym1pdCcsICdyYW5nZScsICdyYWRpbycsICdpbWFnZSddLmluZGV4T2YoaW5wdXRUeXBlKSA+IC0xKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgJHRleHRmaWVsZCA9ICRpbnB1dC5wYXJlbnQoJy5tZHVpLXRleHRmaWVsZCcpOyAvLyDovpPlhaXmoYbmmK/lkKbogZrnhKYKCiAgICBpZiAoZXZlbnRUeXBlID09PSAnZm9jdXMnKSB7CiAgICAgICR0ZXh0ZmllbGQuYWRkQ2xhc3MoJ21kdWktdGV4dGZpZWxkLWZvY3VzJyk7CiAgICB9CgogICAgaWYgKGV2ZW50VHlwZSA9PT0gJ2JsdXInKSB7CiAgICAgICR0ZXh0ZmllbGQucmVtb3ZlQ2xhc3MoJ21kdWktdGV4dGZpZWxkLWZvY3VzJyk7CiAgICB9IC8vIOi+k+WFpeahhuaYr+WQpuS4uuepugoKCiAgICBpZiAoZXZlbnRUeXBlID09PSAnYmx1cicgfHwgZXZlbnRUeXBlID09PSAnaW5wdXQnKSB7CiAgICAgIHZhbHVlID8gJHRleHRmaWVsZC5hZGRDbGFzcygnbWR1aS10ZXh0ZmllbGQtbm90LWVtcHR5JykgOiAkdGV4dGZpZWxkLnJlbW92ZUNsYXNzKCdtZHVpLXRleHRmaWVsZC1ub3QtZW1wdHknKTsKICAgIH0gLy8g6L6T5YWl5qGG5piv5ZCm56aB55SoCgoKICAgIGlucHV0LmRpc2FibGVkID8gJHRleHRmaWVsZC5hZGRDbGFzcygnbWR1aS10ZXh0ZmllbGQtZGlzYWJsZWQnKSA6ICR0ZXh0ZmllbGQucmVtb3ZlQ2xhc3MoJ21kdWktdGV4dGZpZWxkLWRpc2FibGVkJyk7IC8vIOihqOWNlemqjOivgQoKICAgIGlmICgoZXZlbnRUeXBlID09PSAnaW5wdXQnIHx8IGV2ZW50VHlwZSA9PT0gJ2JsdXInKSAmJiAhZGF0YS5kb21Mb2FkZWRFdmVudCAmJiBpbnB1dC52YWxpZGl0eSkgewogICAgICBpbnB1dC52YWxpZGl0eS52YWxpZCA/ICR0ZXh0ZmllbGQucmVtb3ZlQ2xhc3MoJ21kdWktdGV4dGZpZWxkLWludmFsaWQtaHRtbDUnKSA6ICR0ZXh0ZmllbGQuYWRkQ2xhc3MoJ21kdWktdGV4dGZpZWxkLWludmFsaWQtaHRtbDUnKTsKICAgIH0gLy8gdGV4dGFyZWEg6auY5bqm6Ieq5Yqo6LCD5pW0CgoKICAgIGlmICgkaW5wdXQuaXMoJ3RleHRhcmVhJykpIHsKICAgICAgLy8gSUUgYnVn77yadGV4dGFyZWEg55qE5YC85LuF5Li65aSa5Liq5o2i6KGM77yM5LiN5ZCr5YW25LuW5YaF5a655pe277yMdGV4dGFyZWEg55qE6auY5bqm5LiN5YeG56GuCiAgICAgIC8vICAgICAgICAg5q2k5pe277yM5Zyo6K6h566X6auY5bqm5YmN77yM5Zyo5YC855qE5byA5aS05Yqg5YWl5LiA5Liq56m65qC877yM6K6h566X5a6M5ZCO77yM56e76Zmk56m65qC8CiAgICAgIHZhciBpbnB1dFZhbHVlID0gdmFsdWU7CiAgICAgIHZhciBoYXNFeHRyYVNwYWNlID0gZmFsc2U7CgogICAgICBpZiAoaW5wdXRWYWx1ZS5yZXBsYWNlKC9bXHJcbl0vZywgJycpID09PSAnJykgewogICAgICAgICRpbnB1dC52YWwoJyAnICsgaW5wdXRWYWx1ZSk7CiAgICAgICAgaGFzRXh0cmFTcGFjZSA9IHRydWU7CiAgICAgIH0gLy8g6K6+572uIHRleHRhcmVhIOmrmOW6pgoKCiAgICAgICRpbnB1dC5vdXRlckhlaWdodCgnJyk7CiAgICAgIHZhciBoZWlnaHQgPSAkaW5wdXQub3V0ZXJIZWlnaHQoKTsKICAgICAgdmFyIHNjcm9sbEhlaWdodCA9IGlucHV0LnNjcm9sbEhlaWdodDsKCiAgICAgIGlmIChzY3JvbGxIZWlnaHQgPiBoZWlnaHQpIHsKICAgICAgICAkaW5wdXQub3V0ZXJIZWlnaHQoc2Nyb2xsSGVpZ2h0KTsKICAgICAgfSAvLyDorqHnrpflrozvvIzov5jljp8gdGV4dGFyZWEg55qE5YC8CgoKICAgICAgaWYgKGhhc0V4dHJhU3BhY2UpIHsKICAgICAgICAkaW5wdXQudmFsKGlucHV0VmFsdWUpOwogICAgICB9CiAgICB9IC8vIOWunuaXtuWtl+aVsOe7n+iuoQoKCiAgICBpZiAoZGF0YS5yZUluaXQpIHsKICAgICAgJHRleHRmaWVsZC5maW5kKCcubWR1aS10ZXh0ZmllbGQtY291bnRlcicpLnJlbW92ZSgpOwogICAgfQoKICAgIHZhciBtYXhMZW5ndGggPSAkaW5wdXQuYXR0cignbWF4bGVuZ3RoJyk7CgogICAgaWYgKG1heExlbmd0aCkgewogICAgICBpZiAoZGF0YS5yZUluaXQgfHwgZGF0YS5kb21Mb2FkZWRFdmVudCkgewogICAgICAgICQoJzxkaXYgY2xhc3M9Im1kdWktdGV4dGZpZWxkLWNvdW50ZXIiPicgKyAiPHNwYW4gY2xhc3M9XCJtZHVpLXRleHRmaWVsZC1jb3VudGVyLWlucHV0ZWRcIj48L3NwYW4+IC8gIiArIG1heExlbmd0aCArICc8L2Rpdj4nKS5hcHBlbmRUbygkdGV4dGZpZWxkKTsKICAgICAgfQoKICAgICAgJHRleHRmaWVsZC5maW5kKCcubWR1aS10ZXh0ZmllbGQtY291bnRlci1pbnB1dGVkJykudGV4dCh2YWx1ZS5sZW5ndGgudG9TdHJpbmcoKSk7CiAgICB9IC8vIOWQqyDluK7liqnmlofmnKzjgIHplJnor6/mj5DnpLrjgIHlrZfmlbDnu5/orqEg5pe277yM5aKe5Yqg5paH5pys5qGG5bqV6YOo5YaF6L656LedCgoKICAgIGlmICgkdGV4dGZpZWxkLmZpbmQoJy5tZHVpLXRleHRmaWVsZC1oZWxwZXInKS5sZW5ndGggfHwgJHRleHRmaWVsZC5maW5kKCcubWR1aS10ZXh0ZmllbGQtZXJyb3InKS5sZW5ndGggfHwgbWF4TGVuZ3RoKSB7CiAgICAgICR0ZXh0ZmllbGQuYWRkQ2xhc3MoJ21kdWktdGV4dGZpZWxkLWhhcy1ib3R0b20nKTsKICAgIH0KICB9CgogICQoZnVuY3Rpb24gKCkgewogICAgLy8g57uR5a6a5LqL5Lu2CiAgICAkZG9jdW1lbnQub24oJ2lucHV0IGZvY3VzIGJsdXInLCAnLm1kdWktdGV4dGZpZWxkLWlucHV0JywgewogICAgICB1c2VDYXB0dXJlOiB0cnVlCiAgICB9LCBpbnB1dEV2ZW50KTsgLy8g5Y+v5bGV5byA5paH5pys5qGG5bGV5byACgogICAgJGRvY3VtZW50Lm9uKCdjbGljaycsICcubWR1aS10ZXh0ZmllbGQtZXhwYW5kYWJsZSAubWR1aS10ZXh0ZmllbGQtaWNvbicsIGZ1bmN0aW9uICgpIHsKICAgICAgJCh0aGlzKS5wYXJlbnRzKCcubWR1aS10ZXh0ZmllbGQnKS5hZGRDbGFzcygnbWR1aS10ZXh0ZmllbGQtZXhwYW5kZWQnKS5maW5kKCcubWR1aS10ZXh0ZmllbGQtaW5wdXQnKVswXS5mb2N1cygpOwogICAgfSk7IC8vIOWPr+WxleW8gOaWh+acrOahhuWFs+mXrQoKICAgICRkb2N1bWVudC5vbignY2xpY2snLCAnLm1kdWktdGV4dGZpZWxkLWV4cGFuZGVkIC5tZHVpLXRleHRmaWVsZC1jbG9zZScsIGZ1bmN0aW9uICgpIHsKICAgICAgJCh0aGlzKS5wYXJlbnRzKCcubWR1aS10ZXh0ZmllbGQnKS5yZW1vdmVDbGFzcygnbWR1aS10ZXh0ZmllbGQtZXhwYW5kZWQnKS5maW5kKCcubWR1aS10ZXh0ZmllbGQtaW5wdXQnKS52YWwoJycpOwogICAgfSk7CiAgICAvKioKICAgICAqIOWIneWni+WMluaWh+acrOahhgogICAgICovCgogICAgbWR1aS5tdXRhdGlvbignLm1kdWktdGV4dGZpZWxkJywgZnVuY3Rpb24gKCkgewogICAgICAkKHRoaXMpLmZpbmQoJy5tZHVpLXRleHRmaWVsZC1pbnB1dCcpLnRyaWdnZXIoJ2lucHV0JywgewogICAgICAgIGRvbUxvYWRlZEV2ZW50OiB0cnVlCiAgICAgIH0pOwogICAgfSk7CiAgfSk7CgogIG1kdWkudXBkYXRlVGV4dEZpZWxkcyA9IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgdmFyICRlbGVtZW50cyA9IGlzVW5kZWZpbmVkKHNlbGVjdG9yKSA/ICQoJy5tZHVpLXRleHRmaWVsZCcpIDogJChzZWxlY3Rvcik7CiAgICAkZWxlbWVudHMuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICAkKGVsZW1lbnQpLmZpbmQoJy5tZHVpLXRleHRmaWVsZC1pbnB1dCcpLnRyaWdnZXIoJ2lucHV0JywgewogICAgICAgIHJlSW5pdDogdHJ1ZQogICAgICB9KTsKICAgIH0pOwogIH07CiAgLyoqCiAgICog5ruR5Z2X55qE5YC85pS55Y+Y5ZCO5L+u5pS55ruR5Z2X5qC35byPCiAgICogQHBhcmFtICRzbGlkZXIKICAgKi8KCgogIGZ1bmN0aW9uIHVwZGF0ZVZhbHVlU3R5bGUoJHNsaWRlcikgewogICAgdmFyIGRhdGEgPSAkc2xpZGVyLmRhdGEoKTsKICAgIHZhciAkdHJhY2sgPSBkYXRhLl9zbGlkZXJfJHRyYWNrOwogICAgdmFyICRmaWxsID0gZGF0YS5fc2xpZGVyXyRmaWxsOwogICAgdmFyICR0aHVtYiA9IGRhdGEuX3NsaWRlcl8kdGh1bWI7CiAgICB2YXIgJGlucHV0ID0gZGF0YS5fc2xpZGVyXyRpbnB1dDsKICAgIHZhciBtaW4gPSBkYXRhLl9zbGlkZXJfbWluOwogICAgdmFyIG1heCA9IGRhdGEuX3NsaWRlcl9tYXg7CiAgICB2YXIgaXNEaXNhYmxlZCA9IGRhdGEuX3NsaWRlcl9kaXNhYmxlZDsKICAgIHZhciBpc0Rpc2NyZXRlID0gZGF0YS5fc2xpZGVyX2Rpc2NyZXRlOwogICAgdmFyICR0aHVtYlRleHQgPSBkYXRhLl9zbGlkZXJfJHRodW1iVGV4dDsKICAgIHZhciB2YWx1ZSA9ICRpbnB1dC52YWwoKTsKICAgIHZhciBwZXJjZW50ID0gKHZhbHVlIC0gbWluKSAvIChtYXggLSBtaW4pICogMTAwOwogICAgJGZpbGwud2lkdGgocGVyY2VudCArICIlIik7CiAgICAkdHJhY2sud2lkdGgoMTAwIC0gcGVyY2VudCArICIlIik7CgogICAgaWYgKGlzRGlzYWJsZWQpIHsKICAgICAgJGZpbGwuY3NzKCdwYWRkaW5nLXJpZ2h0JywgJzZweCcpOwogICAgICAkdHJhY2suY3NzKCdwYWRkaW5nLWxlZnQnLCAnNnB4Jyk7CiAgICB9CgogICAgJHRodW1iLmNzcygnbGVmdCcsIHBlcmNlbnQgKyAiJSIpOwoKICAgIGlmIChpc0Rpc2NyZXRlKSB7CiAgICAgICR0aHVtYlRleHQudGV4dCh2YWx1ZSk7CiAgICB9CgogICAgcGVyY2VudCA9PT0gMCA/ICRzbGlkZXIuYWRkQ2xhc3MoJ21kdWktc2xpZGVyLXplcm8nKSA6ICRzbGlkZXIucmVtb3ZlQ2xhc3MoJ21kdWktc2xpZGVyLXplcm8nKTsKICB9CiAgLyoqCiAgICog6YeN5paw5Yid5aeL5YyW5ruR5Z2XCiAgICogQHBhcmFtICRzbGlkZXIKICAgKi8KCgogIGZ1bmN0aW9uIHJlSW5pdCgkc2xpZGVyKSB7CiAgICB2YXIgJHRyYWNrID0gJCgnPGRpdiBjbGFzcz0ibWR1aS1zbGlkZXItdHJhY2siPjwvZGl2PicpOwogICAgdmFyICRmaWxsID0gJCgnPGRpdiBjbGFzcz0ibWR1aS1zbGlkZXItZmlsbCI+PC9kaXY+Jyk7CiAgICB2YXIgJHRodW1iID0gJCgnPGRpdiBjbGFzcz0ibWR1aS1zbGlkZXItdGh1bWIiPjwvZGl2PicpOwogICAgdmFyICRpbnB1dCA9ICRzbGlkZXIuZmluZCgnaW5wdXRbdHlwZT0icmFuZ2UiXScpOwogICAgdmFyIGlzRGlzYWJsZWQgPSAkaW5wdXRbMF0uZGlzYWJsZWQ7CiAgICB2YXIgaXNEaXNjcmV0ZSA9ICRzbGlkZXIuaGFzQ2xhc3MoJ21kdWktc2xpZGVyLWRpc2NyZXRlJyk7IC8vIOemgeeUqOeKtuaAgQoKICAgIGlzRGlzYWJsZWQgPyAkc2xpZGVyLmFkZENsYXNzKCdtZHVpLXNsaWRlci1kaXNhYmxlZCcpIDogJHNsaWRlci5yZW1vdmVDbGFzcygnbWR1aS1zbGlkZXItZGlzYWJsZWQnKTsgLy8g6YeN5paw5aGr5YWFIEhUTUwKCiAgICAkc2xpZGVyLmZpbmQoJy5tZHVpLXNsaWRlci10cmFjaycpLnJlbW92ZSgpOwogICAgJHNsaWRlci5maW5kKCcubWR1aS1zbGlkZXItZmlsbCcpLnJlbW92ZSgpOwogICAgJHNsaWRlci5maW5kKCcubWR1aS1zbGlkZXItdGh1bWInKS5yZW1vdmUoKTsKICAgICRzbGlkZXIuYXBwZW5kKCR0cmFjaykuYXBwZW5kKCRmaWxsKS5hcHBlbmQoJHRodW1iKTsgLy8g6Ze057ut5Z6L5ruR5Z2XCgogICAgdmFyICR0aHVtYlRleHQgPSAkKCk7CgogICAgaWYgKGlzRGlzY3JldGUpIHsKICAgICAgJHRodW1iVGV4dCA9ICQoJzxzcGFuPjwvc3Bhbj4nKTsKICAgICAgJHRodW1iLmVtcHR5KCkuYXBwZW5kKCR0aHVtYlRleHQpOwogICAgfQoKICAgICRzbGlkZXIuZGF0YSgnX3NsaWRlcl8kdHJhY2snLCAkdHJhY2spOwogICAgJHNsaWRlci5kYXRhKCdfc2xpZGVyXyRmaWxsJywgJGZpbGwpOwogICAgJHNsaWRlci5kYXRhKCdfc2xpZGVyXyR0aHVtYicsICR0aHVtYik7CiAgICAkc2xpZGVyLmRhdGEoJ19zbGlkZXJfJGlucHV0JywgJGlucHV0KTsKICAgICRzbGlkZXIuZGF0YSgnX3NsaWRlcl9taW4nLCAkaW5wdXQuYXR0cignbWluJykpOwogICAgJHNsaWRlci5kYXRhKCdfc2xpZGVyX21heCcsICRpbnB1dC5hdHRyKCdtYXgnKSk7CiAgICAkc2xpZGVyLmRhdGEoJ19zbGlkZXJfZGlzYWJsZWQnLCBpc0Rpc2FibGVkKTsKICAgICRzbGlkZXIuZGF0YSgnX3NsaWRlcl9kaXNjcmV0ZScsIGlzRGlzY3JldGUpOwogICAgJHNsaWRlci5kYXRhKCdfc2xpZGVyXyR0aHVtYlRleHQnLCAkdGh1bWJUZXh0KTsgLy8g6K6+572u6buY6K6k5YC8CgogICAgdXBkYXRlVmFsdWVTdHlsZSgkc2xpZGVyKTsKICB9CgogIHZhciByYW5nZVNlbGVjdG9yID0gJy5tZHVpLXNsaWRlciBpbnB1dFt0eXBlPSJyYW5nZSJdJzsKICAkKGZ1bmN0aW9uICgpIHsKICAgIC8vIOa7keWdl+a7keWKqOS6i+S7tgogICAgJGRvY3VtZW50Lm9uKCdpbnB1dCBjaGFuZ2UnLCByYW5nZVNlbGVjdG9yLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciAkc2xpZGVyID0gJCh0aGlzKS5wYXJlbnQoKTsKICAgICAgdXBkYXRlVmFsdWVTdHlsZSgkc2xpZGVyKTsKICAgIH0pOyAvLyDlvIDlp4vop6bmkbjmu5HlnZfkuovku7YKCiAgICAkZG9jdW1lbnQub24oc3RhcnRFdmVudCwgcmFuZ2VTZWxlY3RvciwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIGlmICghaXNBbGxvdyhldmVudCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHJlZ2lzdGVyKGV2ZW50KTsKCiAgICAgIGlmICh0aGlzLmRpc2FibGVkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgJHNsaWRlciA9ICQodGhpcykucGFyZW50KCk7CiAgICAgICRzbGlkZXIuYWRkQ2xhc3MoJ21kdWktc2xpZGVyLWZvY3VzJyk7CiAgICB9KTsgLy8g57uT5p2f6Kem5pG45ruR5Z2X5LqL5Lu2CgogICAgJGRvY3VtZW50Lm9uKGVuZEV2ZW50LCByYW5nZVNlbGVjdG9yLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgaWYgKCFpc0FsbG93KGV2ZW50KSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciAkc2xpZGVyID0gJCh0aGlzKS5wYXJlbnQoKTsKICAgICAgJHNsaWRlci5yZW1vdmVDbGFzcygnbWR1aS1zbGlkZXItZm9jdXMnKTsKICAgIH0pOwogICAgJGRvY3VtZW50Lm9uKHVubG9ja0V2ZW50LCByYW5nZVNlbGVjdG9yLCByZWdpc3Rlcik7CiAgICAvKioKICAgICAqIOWIneWni+WMlua7keWdlwogICAgICovCgogICAgbWR1aS5tdXRhdGlvbignLm1kdWktc2xpZGVyJywgZnVuY3Rpb24gKCkgewogICAgICByZUluaXQoJCh0aGlzKSk7CiAgICB9KTsKICB9KTsKCiAgbWR1aS51cGRhdGVTbGlkZXJzID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICB2YXIgJGVsZW1lbnRzID0gaXNVbmRlZmluZWQoc2VsZWN0b3IpID8gJCgnLm1kdWktc2xpZGVyJykgOiAkKHNlbGVjdG9yKTsKICAgICRlbGVtZW50cy5lYWNoKGZ1bmN0aW9uIChfLCBlbGVtZW50KSB7CiAgICAgIHJlSW5pdCgkKGVsZW1lbnQpKTsKICAgIH0pOwogIH07CgogIHZhciBERUZBVUxUX09QVElPTlMkMiA9IHsKICAgIHRyaWdnZXI6ICdob3ZlcicKICB9OwoKICB2YXIgRmFiID0gZnVuY3Rpb24gRmFiKHNlbGVjdG9yLCBvcHRpb25zKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIG9wdGlvbnMgPSB7fTsKICAgIC8qKgogICAgICog6YWN572u5Y+C5pWwCiAgICAgKi8KCiAgICB0aGlzLm9wdGlvbnMgPSBleHRlbmQoe30sIERFRkFVTFRfT1BUSU9OUyQyKTsKICAgIC8qKgogICAgICog5b2T5YmNIGZhYiDnmoTnirbmgIEKICAgICAqLwoKICAgIHRoaXMuc3RhdGUgPSAnY2xvc2VkJzsKICAgIHRoaXMuJGVsZW1lbnQgPSAkKHNlbGVjdG9yKS5maXJzdCgpOwogICAgZXh0ZW5kKHRoaXMub3B0aW9ucywgb3B0aW9ucyk7CiAgICB0aGlzLiRidG4gPSB0aGlzLiRlbGVtZW50LmZpbmQoJy5tZHVpLWZhYicpOwogICAgdGhpcy4kZGlhbCA9IHRoaXMuJGVsZW1lbnQuZmluZCgnLm1kdWktZmFiLWRpYWwnKTsKICAgIHRoaXMuJGRpYWxCdG5zID0gdGhpcy4kZGlhbC5maW5kKCcubWR1aS1mYWInKTsKCiAgICBpZiAodGhpcy5vcHRpb25zLnRyaWdnZXIgPT09ICdob3ZlcicpIHsKICAgICAgdGhpcy4kYnRuLm9uKCd0b3VjaHN0YXJ0IG1vdXNlZW50ZXInLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMkMS5vcGVuKCk7CiAgICAgIH0pOwogICAgICB0aGlzLiRlbGVtZW50Lm9uKCdtb3VzZWxlYXZlJywgZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0aGlzJDEuY2xvc2UoKTsKICAgICAgfSk7CiAgICB9CgogICAgaWYgKHRoaXMub3B0aW9ucy50cmlnZ2VyID09PSAnY2xpY2snKSB7CiAgICAgIHRoaXMuJGJ0bi5vbihzdGFydEV2ZW50LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMkMS5vcGVuKCk7CiAgICAgIH0pOwogICAgfSAvLyDop6bmkbjlsY/luZXlhbbku5blnLDmlrnlhbPpl63lv6vpgJ/mi6jlj7cKCgogICAgJGRvY3VtZW50Lm9uKHN0YXJ0RXZlbnQsIGZ1bmN0aW9uIChldmVudCkgewogICAgICBpZiAoJChldmVudC50YXJnZXQpLnBhcmVudHMoJy5tZHVpLWZhYi13cmFwcGVyJykubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzJDEuY2xvc2UoKTsKICAgIH0pOwogIH07CiAgLyoqCiAgICog6Kem5Y+R57uE5Lu25LqL5Lu2CiAgICogQHBhcmFtIG5hbWUKICAgKi8KCgogIEZhYi5wcm90b3R5cGUudHJpZ2dlckV2ZW50ID0gZnVuY3Rpb24gdHJpZ2dlckV2ZW50KG5hbWUpIHsKICAgIGNvbXBvbmVudEV2ZW50KG5hbWUsICdmYWInLCB0aGlzLiRlbGVtZW50LCB0aGlzKTsKICB9OwogIC8qKgogICAqIOW9k+WJjeaYr+WQpuS4uuaJk+W8gOeKtuaAgQogICAqLwoKCiAgRmFiLnByb3RvdHlwZS5pc09wZW4gPSBmdW5jdGlvbiBpc09wZW4oKSB7CiAgICByZXR1cm4gdGhpcy5zdGF0ZSA9PT0gJ29wZW5pbmcnIHx8IHRoaXMuc3RhdGUgPT09ICdvcGVuZWQnOwogIH07CiAgLyoqCiAgICog5omT5byA5b+r6YCf5ouo5Y+36I+c5Y2VCiAgICovCgoKICBGYWIucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbiBvcGVuKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CgogICAgaWYgKHRoaXMuaXNPcGVuKCkpIHsKICAgICAgcmV0dXJuOwogICAgfSAvLyDkuLroj5zljZXkuK3nmoTmjInpkq7mt7vliqDkuI3lkIznmoQgdHJhbnNpdGlvbi1kZWxheQoKCiAgICB0aGlzLiRkaWFsQnRucy5lYWNoKGZ1bmN0aW9uIChpbmRleCwgYnRuKSB7CiAgICAgIHZhciBkZWxheSA9IDE1ICogKHRoaXMkMS4kZGlhbEJ0bnMubGVuZ3RoIC0gaW5kZXgpICsgIm1zIjsKICAgICAgYnRuLnN0eWxlLnRyYW5zaXRpb25EZWxheSA9IGRlbGF5OwogICAgICBidG4uc3R5bGUud2Via2l0VHJhbnNpdGlvbkRlbGF5ID0gZGVsYXk7CiAgICB9KTsKICAgIHRoaXMuJGRpYWwuY3NzKCdoZWlnaHQnLCAnYXV0bycpLmFkZENsYXNzKCdtZHVpLWZhYi1kaWFsLXNob3cnKTsgLy8g5aaC5p6c5oyJ6ZKu5Lit5a2Y5ZyoIC5tZHVpLWZhYi1vcGVuZWQg55qE5Zu+5qCH77yM5YiZ6L+b6KGM5Zu+5qCH5YiH5o2iCgogICAgaWYgKHRoaXMuJGJ0bi5maW5kKCcubWR1aS1mYWItb3BlbmVkJykubGVuZ3RoKSB7CiAgICAgIHRoaXMuJGJ0bi5hZGRDbGFzcygnbWR1aS1mYWItb3BlbmVkJyk7CiAgICB9CgogICAgdGhpcy5zdGF0ZSA9ICdvcGVuaW5nJzsKICAgIHRoaXMudHJpZ2dlckV2ZW50KCdvcGVuJyk7IC8vIOaJk+W8gOmhuuW6j+S4uuS7juS4i+WIsOS4iumAkOS4quaJk+W8gO+8jOacgOS4iumdoueahOaJk+W8gOWQjuaJjeihqOekuuWKqOeUu+WujOaIkAoKICAgIHRoaXMuJGRpYWxCdG5zLmZpcnN0KCkudHJhbnNpdGlvbkVuZChmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzJDEuJGJ0bi5oYXNDbGFzcygnbWR1aS1mYWItb3BlbmVkJykpIHsKICAgICAgICB0aGlzJDEuc3RhdGUgPSAnb3BlbmVkJzsKICAgICAgICB0aGlzJDEudHJpZ2dlckV2ZW50KCdvcGVuZWQnKTsKICAgICAgfQogICAgfSk7CiAgfTsKICAvKioKICAgKiDlhbPpl63lv6vpgJ/mi6jlj7foj5zljZUKICAgKi8KCgogIEZhYi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiBjbG9zZSgpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwoKICAgIGlmICghdGhpcy5pc09wZW4oKSkgewogICAgICByZXR1cm47CiAgICB9IC8vIOS4uuiPnOWNleS4reeahOaMiemSrua3u+WKoOS4jeWQjOeahCB0cmFuc2l0aW9uLWRlbGF5CgoKICAgIHRoaXMuJGRpYWxCdG5zLmVhY2goZnVuY3Rpb24gKGluZGV4LCBidG4pIHsKICAgICAgdmFyIGRlbGF5ID0gMTUgKiBpbmRleCArICJtcyI7CiAgICAgIGJ0bi5zdHlsZS50cmFuc2l0aW9uRGVsYXkgPSBkZWxheTsKICAgICAgYnRuLnN0eWxlLndlYmtpdFRyYW5zaXRpb25EZWxheSA9IGRlbGF5OwogICAgfSk7CiAgICB0aGlzLiRkaWFsLnJlbW92ZUNsYXNzKCdtZHVpLWZhYi1kaWFsLXNob3cnKTsKICAgIHRoaXMuJGJ0bi5yZW1vdmVDbGFzcygnbWR1aS1mYWItb3BlbmVkJyk7CiAgICB0aGlzLnN0YXRlID0gJ2Nsb3NpbmcnOwogICAgdGhpcy50cmlnZ2VyRXZlbnQoJ2Nsb3NlJyk7IC8vIOS7juS4iuW+gOS4i+S+neasoeWFs+mXre+8jOacgOWQjuS4gOS4quWFs+mXreWQjuaJjeihqOekuuWKqOeUu+WujOaIkAoKICAgIHRoaXMuJGRpYWxCdG5zLmxhc3QoKS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHRoaXMkMS4kYnRuLmhhc0NsYXNzKCdtZHVpLWZhYi1vcGVuZWQnKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcyQxLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICAgIHRoaXMkMS50cmlnZ2VyRXZlbnQoJ2Nsb3NlZCcpOwogICAgICB0aGlzJDEuJGRpYWwuY3NzKCdoZWlnaHQnLCAwKTsKICAgIH0pOwogIH07CiAgLyoqCiAgICog5YiH5o2i5b+r6YCf5ouo5Y+36I+c5Y2V55qE5omT5byA54q25oCBCiAgICovCgoKICBGYWIucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uIHRvZ2dsZSgpIHsKICAgIHRoaXMuaXNPcGVuKCkgPyB0aGlzLmNsb3NlKCkgOiB0aGlzLm9wZW4oKTsKICB9OwogIC8qKgogICAqIOS7peWKqOeUu+eahOW9ouW8j+aYvuekuuaVtOS4qua1ruWKqOaTjeS9nOaMiemSrgogICAqLwoKCiAgRmFiLnByb3RvdHlwZS5zaG93ID0gZnVuY3Rpb24gc2hvdygpIHsKICAgIHRoaXMuJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kdWktZmFiLWhpZGUnKTsKICB9OwogIC8qKgogICAqIOS7peWKqOeUu+eahOW9ouW8j+makOiXj+aVtOS4qua1ruWKqOaTjeS9nOaMiemSrgogICAqLwoKCiAgRmFiLnByb3RvdHlwZS5oaWRlID0gZnVuY3Rpb24gaGlkZSgpIHsKICAgIHRoaXMuJGVsZW1lbnQuYWRkQ2xhc3MoJ21kdWktZmFiLWhpZGUnKTsKICB9OwogIC8qKgogICAqIOi/lOWbnuW9k+WJjeW/q+mAn+aLqOWPt+iPnOWNleeahOaJk+W8gOeKtuaAgeOAguWFseWMheWQq+Wbm+enjeeKtuaAge+8mmBvcGVuaW5nYOOAgWBvcGVuZWRg44CBYGNsb3Npbmdg44CBYGNsb3NlZGAKICAgKi8KCgogIEZhYi5wcm90b3R5cGUuZ2V0U3RhdGUgPSBmdW5jdGlvbiBnZXRTdGF0ZSgpIHsKICAgIHJldHVybiB0aGlzLnN0YXRlOwogIH07CgogIG1kdWkuRmFiID0gRmFiOwogIHZhciBjdXN0b21BdHRyJDMgPSAnbWR1aS1mYWInOwogICQoZnVuY3Rpb24gKCkgewogICAgLy8gbW91c2VlbnRlciDkuI3lhpLms6HvvIzml6Dms5Xov5vooYzkuovku7blp5TmiZjvvIzov5nph4znlKggbW91c2VvdmVyIOS7o+abv+OAggogICAgLy8g5LiN566h5pivIGNsaWNrIOOAgSBtb3VzZW92ZXIg6L+Y5pivIHRvdWNoc3RhcnQg77yM6YO95YWI5Yid5aeL5YyW44CCCiAgICAkZG9jdW1lbnQub24oJ3RvdWNoc3RhcnQgbW91c2Vkb3duIG1vdXNlb3ZlcicsICJbIiArIGN1c3RvbUF0dHIkMyArICJdIiwgZnVuY3Rpb24gKCkgewogICAgICBuZXcgbWR1aS5GYWIodGhpcywgcGFyc2VPcHRpb25zKHRoaXMsIGN1c3RvbUF0dHIkMykpOwogICAgfSk7CiAgfSk7CiAgLyoqCiAgICog5pyA57uI55Sf5oiQ55qE5YWD57Sg57uT5p6E5Li677yaCiAgICogIDxzZWxlY3QgY2xhc3M9Im1kdWktc2VsZWN0IiBtZHVpLXNlbGVjdD0ie3Bvc2l0aW9uOiAndG9wJ30iIHN0eWxlPSJkaXNwbGF5OiBub25lOyI+IC8vICRuYXRpdmUKICAgKiAgICA8b3B0aW9uIHZhbHVlPSIxIj5TdGF0ZSAxPC9vcHRpb24+CiAgICogICAgPG9wdGlvbiB2YWx1ZT0iMiI+U3RhdGUgMjwvb3B0aW9uPgogICAqICAgIDxvcHRpb24gdmFsdWU9IjMiIGRpc2FibGVkPSIiPlN0YXRlIDM8L29wdGlvbj4KICAgKiAgPC9zZWxlY3Q+CiAgICogIDxkaXYgY2xhc3M9Im1kdWktc2VsZWN0IG1kdWktc2VsZWN0LXBvc2l0aW9uLXRvcCIgc3R5bGU9IiIgaWQ9Ijg4ZGVjMGU0LWQ0YTItYzZkMC0wZTdmLTFiYTQ1MDFlMDU1MyI+IC8vICRlbGVtZW50CiAgICogICAgPHNwYW4gY2xhc3M9Im1kdWktc2VsZWN0LXNlbGVjdGVkIj5TdGF0ZSAxPC9zcGFuPiAvLyAkc2VsZWN0ZWQKICAgKiAgICA8ZGl2IGNsYXNzPSJtZHVpLXNlbGVjdC1tZW51IiBzdHlsZT0idHJhbnNmb3JtLW9yaWdpbjogY2VudGVyIDEwMCUgMHB4OyI+IC8vICRtZW51CiAgICogICAgICA8ZGl2IGNsYXNzPSJtZHVpLXNlbGVjdC1tZW51LWl0ZW0gbWR1aS1yaXBwbGUiIHNlbGVjdGVkPSIiPlN0YXRlIDE8L2Rpdj4gLy8gJGl0ZW1zCiAgICogICAgICA8ZGl2IGNsYXNzPSJtZHVpLXNlbGVjdC1tZW51LWl0ZW0gbWR1aS1yaXBwbGUiPlN0YXRlIDI8L2Rpdj4KICAgKiAgICAgIDxkaXYgY2xhc3M9Im1kdWktc2VsZWN0LW1lbnUtaXRlbSBtZHVpLXJpcHBsZSIgZGlzYWJsZWQ9IiI+U3RhdGUgMzwvZGl2PgogICAqICAgIDwvZGl2PgogICAqICA8L2Rpdj4KICAgKi8KCiAgdmFyIERFRkFVTFRfT1BUSU9OUyQzID0gewogICAgcG9zaXRpb246ICdhdXRvJywKICAgIGd1dHRlcjogMTYKICB9OwoKICB2YXIgU2VsZWN0ID0gZnVuY3Rpb24gU2VsZWN0KHNlbGVjdG9yLCBvcHRpb25zKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIG9wdGlvbnMgPSB7fTsKICAgIC8qKgogICAgICog55Sf5oiQ55qEIGA8ZGl2IGNsYXNzPSJtZHVpLXNlbGVjdCI+YCDlhYPntKDnmoQgSlEg5a+56LGhCiAgICAgKi8KCiAgICB0aGlzLiRlbGVtZW50ID0gJCgpOwogICAgLyoqCiAgICAgKiDphY3nva7lj4LmlbAKICAgICAqLwoKICAgIHRoaXMub3B0aW9ucyA9IGV4dGVuZCh7fSwgREVGQVVMVF9PUFRJT05TJDMpOwogICAgLyoqCiAgICAgKiBzZWxlY3Qg55qEIHNpemUg5bGe5oCn55qE5YC877yM5qC55o2u6K+l5YC86K6+572uIHNlbGVjdCDnmoTpq5jluqYKICAgICAqLwoKICAgIHRoaXMuc2l6ZSA9IDA7CiAgICAvKioKICAgICAqIOWNoOS9jeWFg+e0oO+8jOaYvuekuuW3sumAieS4reiPnOWNlemhueeahOaWh+acrAogICAgICovCgogICAgdGhpcy4kc2VsZWN0ZWQgPSAkKCk7CiAgICAvKioKICAgICAqIOiPnOWNlemhueeahOWkluWxguWFg+e0oOeahCBKUSDlr7nosaEKICAgICAqLwoKICAgIHRoaXMuJG1lbnUgPSAkKCk7CiAgICAvKioKICAgICAqIOiPnOWNlemhueaVsOe7hOeahCBKUSDlr7nosaEKICAgICAqLwoKICAgIHRoaXMuJGl0ZW1zID0gJCgpOwogICAgLyoqCiAgICAgKiDlvZPliY3pgInkuK3nmoToj5zljZXpobnnmoTntKLlvJXlj7cKICAgICAqLwoKICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IDA7CiAgICAvKioKICAgICAqIOW9k+WJjemAieS4reiPnOWNlemhueeahOaWh+acrAogICAgICovCgogICAgdGhpcy5zZWxlY3RlZFRleHQgPSAnJzsKICAgIC8qKgogICAgICog5b2T5YmN6YCJ5Lit6I+c5Y2V6aG555qE5YC8CiAgICAgKi8KCiAgICB0aGlzLnNlbGVjdGVkVmFsdWUgPSAnJzsKICAgIC8qKgogICAgICog5b2T5YmNIHNlbGVjdCDnmoTnirbmgIEKICAgICAqLwoKICAgIHRoaXMuc3RhdGUgPSAnY2xvc2VkJzsKICAgIHRoaXMuJG5hdGl2ZSA9ICQoc2VsZWN0b3IpLmZpcnN0KCk7CiAgICB0aGlzLiRuYXRpdmUuaGlkZSgpOwogICAgZXh0ZW5kKHRoaXMub3B0aW9ucywgb3B0aW9ucyk7IC8vIOS4uuW9k+WJjSBzZWxlY3Qg55Sf5oiQ5ZSv5LiAIElECgogICAgdGhpcy51bmlxdWVJRCA9ICQuZ3VpZCgpOyAvLyDnlJ/miJAgc2VsZWN0CgogICAgdGhpcy5oYW5kbGVVcGRhdGUoKTsgLy8g54K55Ye7IHNlbGVjdCDlpJbpnaLljLrln5/lhbPpl60KCiAgICAkZG9jdW1lbnQub24oJ2NsaWNrIHRvdWNoc3RhcnQnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdmFyICR0YXJnZXQgPSAkKGV2ZW50LnRhcmdldCk7CgogICAgICBpZiAodGhpcyQxLmlzT3BlbigpICYmICEkdGFyZ2V0LmlzKHRoaXMkMS4kZWxlbWVudCkgJiYgIWNvbnRhaW5zKHRoaXMkMS4kZWxlbWVudFswXSwgJHRhcmdldFswXSkpIHsKICAgICAgICB0aGlzJDEuY2xvc2UoKTsKICAgICAgfQogICAgfSk7CiAgfTsKICAvKioKICAgKiDosIPmlbToj5zljZXkvY3nva4KICAgKi8KCgogIFNlbGVjdC5wcm90b3R5cGUucmVhZGp1c3RNZW51ID0gZnVuY3Rpb24gcmVhZGp1c3RNZW51KCkgewogICAgdmFyIHdpbmRvd0hlaWdodCA9ICR3aW5kb3cuaGVpZ2h0KCk7IC8vIG1kdWktc2VsZWN0IOmrmOW6pgoKICAgIHZhciBlbGVtZW50SGVpZ2h0ID0gdGhpcy4kZWxlbWVudC5oZWlnaHQoKTsgLy8g6I+c5Y2V6aG56auY5bqmCgogICAgdmFyICRpdGVtRmlyc3QgPSB0aGlzLiRpdGVtcy5maXJzdCgpOwogICAgdmFyIGl0ZW1IZWlnaHQgPSAkaXRlbUZpcnN0LmhlaWdodCgpOwogICAgdmFyIGl0ZW1NYXJnaW4gPSBwYXJzZUludCgkaXRlbUZpcnN0LmNzcygnbWFyZ2luLXRvcCcpKTsgLy8g6I+c5Y2V6auY5bqmCgogICAgdmFyIG1lbnVXaWR0aCA9IHRoaXMuJGVsZW1lbnQuaW5uZXJXaWR0aCgpICsgMC4wMTsgLy8g5b+F6aG75q+U55yf5a6e5a695bqm5aSa5LiA54K577yM5LiN54S25Lya5Ye6546w55yB55Wl5Y+3CgogICAgdmFyIG1lbnVIZWlnaHQgPSBpdGVtSGVpZ2h0ICogdGhpcy5zaXplICsgaXRlbU1hcmdpbiAqIDI7IC8vIG1kdWktc2VsZWN0IOWcqOeql+WPo+S4reeahOS9jee9rgoKICAgIHZhciBlbGVtZW50VG9wID0gdGhpcy4kZWxlbWVudFswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7CiAgICB2YXIgdHJhbnNmb3JtT3JpZ2luWTsKICAgIHZhciBtZW51TWFyZ2luVG9wOwoKICAgIGlmICh0aGlzLm9wdGlvbnMucG9zaXRpb24gPT09ICdib3R0b20nKSB7CiAgICAgIG1lbnVNYXJnaW5Ub3AgPSBlbGVtZW50SGVpZ2h0OwogICAgICB0cmFuc2Zvcm1PcmlnaW5ZID0gJzBweCc7CiAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy5wb3NpdGlvbiA9PT0gJ3RvcCcpIHsKICAgICAgbWVudU1hcmdpblRvcCA9IC1tZW51SGVpZ2h0IC0gMTsKICAgICAgdHJhbnNmb3JtT3JpZ2luWSA9ICcxMDAlJzsKICAgIH0gZWxzZSB7CiAgICAgIC8vIOiPnOWNlemrmOW6puS4jeiDvei2hei/h+eql+WPo+mrmOW6pgogICAgICB2YXIgbWVudU1heEhlaWdodCA9IHdpbmRvd0hlaWdodCAtIHRoaXMub3B0aW9ucy5ndXR0ZXIgKiAyOwoKICAgICAgaWYgKG1lbnVIZWlnaHQgPiBtZW51TWF4SGVpZ2h0KSB7CiAgICAgICAgbWVudUhlaWdodCA9IG1lbnVNYXhIZWlnaHQ7CiAgICAgIH0gLy8g6I+c5Y2V55qEIG1hcmdpbi10b3AKCgogICAgICBtZW51TWFyZ2luVG9wID0gLShpdGVtTWFyZ2luICsgdGhpcy5zZWxlY3RlZEluZGV4ICogaXRlbUhlaWdodCArIChpdGVtSGVpZ2h0IC0gZWxlbWVudEhlaWdodCkgLyAyKTsKICAgICAgdmFyIG1lbnVNYXhNYXJnaW5Ub3AgPSAtKGl0ZW1NYXJnaW4gKyAodGhpcy5zaXplIC0gMSkgKiBpdGVtSGVpZ2h0ICsgKGl0ZW1IZWlnaHQgLSBlbGVtZW50SGVpZ2h0KSAvIDIpOwoKICAgICAgaWYgKG1lbnVNYXJnaW5Ub3AgPCBtZW51TWF4TWFyZ2luVG9wKSB7CiAgICAgICAgbWVudU1hcmdpblRvcCA9IG1lbnVNYXhNYXJnaW5Ub3A7CiAgICAgIH0gLy8g6I+c5Y2V5LiN6IO96LaF5Ye656qX5Y+jCgoKICAgICAgdmFyIG1lbnVUb3AgPSBlbGVtZW50VG9wICsgbWVudU1hcmdpblRvcDsKCiAgICAgIGlmIChtZW51VG9wIDwgdGhpcy5vcHRpb25zLmd1dHRlcikgewogICAgICAgIC8vIOS4jeiDvei2heWHuueql+WPo+S4iuaWuQogICAgICAgIG1lbnVNYXJnaW5Ub3AgPSAtKGVsZW1lbnRUb3AgLSB0aGlzLm9wdGlvbnMuZ3V0dGVyKTsKICAgICAgfSBlbHNlIGlmIChtZW51VG9wICsgbWVudUhlaWdodCArIHRoaXMub3B0aW9ucy5ndXR0ZXIgPiB3aW5kb3dIZWlnaHQpIHsKICAgICAgICAvLyDkuI3og73otoXlh7rnqpflj6PkuIvmlrkKICAgICAgICBtZW51TWFyZ2luVG9wID0gLShlbGVtZW50VG9wICsgbWVudUhlaWdodCArIHRoaXMub3B0aW9ucy5ndXR0ZXIgLSB3aW5kb3dIZWlnaHQpOwogICAgICB9IC8vIHRyYW5zZm9ybSDnmoQgWSDovbTlnZDmoIcKCgogICAgICB0cmFuc2Zvcm1PcmlnaW5ZID0gdGhpcy5zZWxlY3RlZEluZGV4ICogaXRlbUhlaWdodCArIGl0ZW1IZWlnaHQgLyAyICsgaXRlbU1hcmdpbiArICJweCI7CiAgICB9IC8vIOiuvue9ruagt+W8jwoKCiAgICB0aGlzLiRlbGVtZW50LmlubmVyV2lkdGgobWVudVdpZHRoKTsKICAgIHRoaXMuJG1lbnUuaW5uZXJXaWR0aChtZW51V2lkdGgpLmhlaWdodChtZW51SGVpZ2h0KS5jc3MoewogICAgICAnbWFyZ2luLXRvcCc6IG1lbnVNYXJnaW5Ub3AgKyAncHgnLAogICAgICAndHJhbnNmb3JtLW9yaWdpbic6ICdjZW50ZXIgJyArIHRyYW5zZm9ybU9yaWdpblkgKyAnIDAnCiAgICB9KTsKICB9OwogIC8qKgogICAqIHNlbGVjdCDmmK/lkKbkuLrmiZPlvIDnirbmgIEKICAgKi8KCgogIFNlbGVjdC5wcm90b3R5cGUuaXNPcGVuID0gZnVuY3Rpb24gaXNPcGVuKCkgewogICAgcmV0dXJuIHRoaXMuc3RhdGUgPT09ICdvcGVuaW5nJyB8fCB0aGlzLnN0YXRlID09PSAnb3BlbmVkJzsKICB9OwogIC8qKgogICAqIOWvueWOn+eUnyBzZWxlY3Qg57uE5Lu26L+b6KGM5LqG5L+u5pS55ZCO77yM6ZyA6KaB6LCD55So6K+l5pa55rOVCiAgICovCgoKICBTZWxlY3QucHJvdG90eXBlLmhhbmRsZVVwZGF0ZSA9IGZ1bmN0aW9uIGhhbmRsZVVwZGF0ZSgpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwoKICAgIGlmICh0aGlzLmlzT3BlbigpKSB7CiAgICAgIHRoaXMuY2xvc2UoKTsKICAgIH0KCiAgICB0aGlzLnNlbGVjdGVkVmFsdWUgPSB0aGlzLiRuYXRpdmUudmFsKCk7CiAgICB2YXIgaXRlbXNEYXRhID0gW107CiAgICB0aGlzLiRpdGVtcyA9ICQoKTsgLy8g55Sf5oiQIEhUTUwKCiAgICB0aGlzLiRuYXRpdmUuZmluZCgnb3B0aW9uJykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIG9wdGlvbikgewogICAgICB2YXIgdGV4dCA9IG9wdGlvbi50ZXh0Q29udGVudCB8fCAnJzsKICAgICAgdmFyIHZhbHVlID0gb3B0aW9uLnZhbHVlOwogICAgICB2YXIgZGlzYWJsZWQgPSBvcHRpb24uZGlzYWJsZWQ7CiAgICAgIHZhciBzZWxlY3RlZCA9IHRoaXMkMS5zZWxlY3RlZFZhbHVlID09PSB2YWx1ZTsKICAgICAgaXRlbXNEYXRhLnB1c2goewogICAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgICB0ZXh0OiB0ZXh0LAogICAgICAgIGRpc2FibGVkOiBkaXNhYmxlZCwKICAgICAgICBzZWxlY3RlZDogc2VsZWN0ZWQsCiAgICAgICAgaW5kZXg6IGluZGV4CiAgICAgIH0pOwoKICAgICAgaWYgKHNlbGVjdGVkKSB7CiAgICAgICAgdGhpcyQxLnNlbGVjdGVkVGV4dCA9IHRleHQ7CiAgICAgICAgdGhpcyQxLnNlbGVjdGVkSW5kZXggPSBpbmRleDsKICAgICAgfQoKICAgICAgdGhpcyQxLiRpdGVtcyA9IHRoaXMkMS4kaXRlbXMuYWRkKCc8ZGl2IGNsYXNzPSJtZHVpLXNlbGVjdC1tZW51LWl0ZW0gbWR1aS1yaXBwbGUiJyArIChkaXNhYmxlZCA/ICcgZGlzYWJsZWQnIDogJycpICsgKHNlbGVjdGVkID8gJyBzZWxlY3RlZCcgOiAnJykgKyAiPiIgKyB0ZXh0ICsgIjwvZGl2PiIpOwogICAgfSk7CiAgICB0aGlzLiRzZWxlY3RlZCA9ICQoIjxzcGFuIGNsYXNzPVwibWR1aS1zZWxlY3Qtc2VsZWN0ZWRcIj4iICsgdGhpcy5zZWxlY3RlZFRleHQgKyAiPC9zcGFuPiIpOwogICAgdGhpcy4kZWxlbWVudCA9ICQoIjxkaXYgY2xhc3M9XCJtZHVpLXNlbGVjdCBtZHVpLXNlbGVjdC1wb3NpdGlvbi0iICsgdGhpcy5vcHRpb25zLnBvc2l0aW9uICsgIlwiICIgKyAic3R5bGU9XCIiICsgdGhpcy4kbmF0aXZlLmF0dHIoJ3N0eWxlJykgKyAiXCIgIiArICJpZD1cIiIgKyB0aGlzLnVuaXF1ZUlEICsgIlwiPjwvZGl2PiIpLnNob3coKS5hcHBlbmQodGhpcy4kc2VsZWN0ZWQpOwogICAgdGhpcy4kbWVudSA9ICQoJzxkaXYgY2xhc3M9Im1kdWktc2VsZWN0LW1lbnUiPjwvZGl2PicpLmFwcGVuZFRvKHRoaXMuJGVsZW1lbnQpLmFwcGVuZCh0aGlzLiRpdGVtcyk7CiAgICAkKCIjIiArIHRoaXMudW5pcXVlSUQpLnJlbW92ZSgpOwogICAgdGhpcy4kbmF0aXZlLmFmdGVyKHRoaXMuJGVsZW1lbnQpOyAvLyDmoLnmja4gc2VsZWN0IOeahCBzaXplIOWxnuaAp+iuvue9rumrmOW6pgoKICAgIHRoaXMuc2l6ZSA9IHBhcnNlSW50KHRoaXMuJG5hdGl2ZS5hdHRyKCdzaXplJykgfHwgJzAnKTsKCiAgICBpZiAodGhpcy5zaXplIDw9IDApIHsKICAgICAgdGhpcy5zaXplID0gdGhpcy4kaXRlbXMubGVuZ3RoOwoKICAgICAgaWYgKHRoaXMuc2l6ZSA+IDgpIHsKICAgICAgICB0aGlzLnNpemUgPSA4OwogICAgICB9CiAgICB9IC8vIOeCueWHu+mAiemhueaXtuWFs+mXreS4i+aLieiPnOWNlQogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby10aGlzLWFsaWFzCgoKICAgIHZhciB0aGF0ID0gdGhpczsKICAgIHRoaXMuJGl0ZW1zLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHRoYXQuc3RhdGUgPT09ICdjbG9zaW5nJykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyICRpdGVtID0gJCh0aGlzKTsKICAgICAgdmFyIGluZGV4ID0gJGl0ZW0uaW5kZXgoKTsKICAgICAgdmFyIGRhdGEgPSBpdGVtc0RhdGFbaW5kZXhdOwoKICAgICAgaWYgKGRhdGEuZGlzYWJsZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoYXQuJHNlbGVjdGVkLnRleHQoZGF0YS50ZXh0KTsKICAgICAgdGhhdC4kbmF0aXZlLnZhbChkYXRhLnZhbHVlKTsKICAgICAgdGhhdC4kaXRlbXMucmVtb3ZlQXR0cignc2VsZWN0ZWQnKTsKICAgICAgJGl0ZW0uYXR0cignc2VsZWN0ZWQnLCAnJyk7CiAgICAgIHRoYXQuc2VsZWN0ZWRJbmRleCA9IGRhdGEuaW5kZXg7CiAgICAgIHRoYXQuc2VsZWN0ZWRWYWx1ZSA9IGRhdGEudmFsdWU7CiAgICAgIHRoYXQuc2VsZWN0ZWRUZXh0ID0gZGF0YS50ZXh0OwogICAgICB0aGF0LiRuYXRpdmUudHJpZ2dlcignY2hhbmdlJyk7CiAgICAgIHRoYXQuY2xvc2UoKTsKICAgIH0pOyAvLyDngrnlh7sgJGVsZW1lbnQg5pe25omT5byA5LiL5ouJ6I+c5Y2VCgogICAgdGhpcy4kZWxlbWVudC5vbignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdmFyICR0YXJnZXQgPSAkKGV2ZW50LnRhcmdldCk7IC8vIOWcqOiPnOWNleS4iueCueWHu+aXtuS4jeaJk+W8gAoKICAgICAgaWYgKCR0YXJnZXQuaXMoJy5tZHVpLXNlbGVjdC1tZW51JykgfHwgJHRhcmdldC5pcygnLm1kdWktc2VsZWN0LW1lbnUtaXRlbScpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzJDEudG9nZ2xlKCk7CiAgICB9KTsKICB9OwogIC8qKgogICAqIOWKqOeUu+e7k+adn+eahOWbnuiwgwogICAqLwoKCiAgU2VsZWN0LnByb3RvdHlwZS50cmFuc2l0aW9uRW5kID0gZnVuY3Rpb24gdHJhbnNpdGlvbkVuZCgpIHsKICAgIHRoaXMuJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kdWktc2VsZWN0LWNsb3NpbmcnKTsKCiAgICBpZiAodGhpcy5zdGF0ZSA9PT0gJ29wZW5pbmcnKSB7CiAgICAgIHRoaXMuc3RhdGUgPSAnb3BlbmVkJzsKICAgICAgdGhpcy50cmlnZ2VyRXZlbnQoJ29wZW5lZCcpOwogICAgICB0aGlzLiRtZW51LmNzcygnb3ZlcmZsb3cteScsICdhdXRvJyk7CiAgICB9CgogICAgaWYgKHRoaXMuc3RhdGUgPT09ICdjbG9zaW5nJykgewogICAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICAgIHRoaXMudHJpZ2dlckV2ZW50KCdjbG9zZWQnKTsgLy8g5oGi5aSN5qC35byPCgogICAgICB0aGlzLiRlbGVtZW50LmlubmVyV2lkdGgoJycpOwogICAgICB0aGlzLiRtZW51LmNzcyh7CiAgICAgICAgJ21hcmdpbi10b3AnOiAnJywKICAgICAgICBoZWlnaHQ6ICcnLAogICAgICAgIHdpZHRoOiAnJwogICAgICB9KTsKICAgIH0KICB9OwogIC8qKgogICAqIOinpuWPkee7hOS7tuS6i+S7tgogICAqIEBwYXJhbSBuYW1lCiAgICovCgoKICBTZWxlY3QucHJvdG90eXBlLnRyaWdnZXJFdmVudCA9IGZ1bmN0aW9uIHRyaWdnZXJFdmVudChuYW1lKSB7CiAgICBjb21wb25lbnRFdmVudChuYW1lLCAnc2VsZWN0JywgdGhpcy4kbmF0aXZlLCB0aGlzKTsKICB9OwogIC8qKgogICAqIOWIh+aNouS4i+aLieiPnOWNleeahOaJk+W8gOeKtuaAgQogICAqLwoKCiAgU2VsZWN0LnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbiB0b2dnbGUoKSB7CiAgICB0aGlzLmlzT3BlbigpID8gdGhpcy5jbG9zZSgpIDogdGhpcy5vcGVuKCk7CiAgfTsKICAvKioKICAgKiDmiZPlvIDkuIvmi4noj5zljZUKICAgKi8KCgogIFNlbGVjdC5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uIG9wZW4oKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKCiAgICBpZiAodGhpcy5pc09wZW4oKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5zdGF0ZSA9ICdvcGVuaW5nJzsKICAgIHRoaXMudHJpZ2dlckV2ZW50KCdvcGVuJyk7CiAgICB0aGlzLnJlYWRqdXN0TWVudSgpOwogICAgdGhpcy4kZWxlbWVudC5hZGRDbGFzcygnbWR1aS1zZWxlY3Qtb3BlbicpOwogICAgdGhpcy4kbWVudS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMkMS50cmFuc2l0aW9uRW5kKCk7CiAgICB9KTsKICB9OwogIC8qKgogICAqIOWFs+mXreS4i+aLieiPnOWNlQogICAqLwoKCiAgU2VsZWN0LnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uIGNsb3NlKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CgogICAgaWYgKCF0aGlzLmlzT3BlbigpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLnN0YXRlID0gJ2Nsb3NpbmcnOwogICAgdGhpcy50cmlnZ2VyRXZlbnQoJ2Nsb3NlJyk7CiAgICB0aGlzLiRtZW51LmNzcygnb3ZlcmZsb3cteScsICcnKTsKICAgIHRoaXMuJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kdWktc2VsZWN0LW9wZW4nKS5hZGRDbGFzcygnbWR1aS1zZWxlY3QtY2xvc2luZycpOwogICAgdGhpcy4kbWVudS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMkMS50cmFuc2l0aW9uRW5kKCk7CiAgICB9KTsKICB9OwogIC8qKgogICAqIOiOt+WPluW9k+WJjeiPnOWNleeahOeKtuaAgeOAguWFseWMheWQq+Wbm+enjeeKtuaAge+8mmBvcGVuaW5nYOOAgWBvcGVuZWRg44CBYGNsb3Npbmdg44CBYGNsb3NlZGAKICAgKi8KCgogIFNlbGVjdC5wcm90b3R5cGUuZ2V0U3RhdGUgPSBmdW5jdGlvbiBnZXRTdGF0ZSgpIHsKICAgIHJldHVybiB0aGlzLnN0YXRlOwogIH07CgogIG1kdWkuU2VsZWN0ID0gU2VsZWN0OwogIHZhciBjdXN0b21BdHRyJDQgPSAnbWR1aS1zZWxlY3QnOwogICQoZnVuY3Rpb24gKCkgewogICAgbWR1aS5tdXRhdGlvbigiWyIgKyBjdXN0b21BdHRyJDQgKyAiXSIsIGZ1bmN0aW9uICgpIHsKICAgICAgbmV3IG1kdWkuU2VsZWN0KHRoaXMsIHBhcnNlT3B0aW9ucyh0aGlzLCBjdXN0b21BdHRyJDQpKTsKICAgIH0pOwogIH0pOwogICQoZnVuY3Rpb24gKCkgewogICAgLy8g5rua5Yqo5pe26ZqQ6JeP5bqU55So5qCPCiAgICBtZHVpLm11dGF0aW9uKCcubWR1aS1hcHBiYXItc2Nyb2xsLWhpZGUnLCBmdW5jdGlvbiAoKSB7CiAgICAgIG5ldyBtZHVpLkhlYWRyb29tKHRoaXMpOwogICAgfSk7IC8vIOa7muWKqOaXtuWPqumakOiXj+W6lOeUqOagj+S4reeahOW3peWFt+agjwoKICAgIG1kdWkubXV0YXRpb24oJy5tZHVpLWFwcGJhci1zY3JvbGwtdG9vbGJhci1oaWRlJywgZnVuY3Rpb24gKCkgewogICAgICBuZXcgbWR1aS5IZWFkcm9vbSh0aGlzLCB7CiAgICAgICAgcGlubmVkQ2xhc3M6ICdtZHVpLWhlYWRyb29tLXBpbm5lZC10b29sYmFyJywKICAgICAgICB1bnBpbm5lZENsYXNzOiAnbWR1aS1oZWFkcm9vbS11bnBpbm5lZC10b29sYmFyJwogICAgICB9KTsKICAgIH0pOwogIH0pOwogIHZhciBERUZBVUxUX09QVElPTlMkNCA9IHsKICAgIHRyaWdnZXI6ICdjbGljaycsCiAgICBsb29wOiBmYWxzZQogIH07CgogIHZhciBUYWIgPSBmdW5jdGlvbiBUYWIoc2VsZWN0b3IsIG9wdGlvbnMpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgb3B0aW9ucyA9IHt9OwogICAgLyoqCiAgICAgKiDphY3nva7lj4LmlbAKICAgICAqLwoKICAgIHRoaXMub3B0aW9ucyA9IGV4dGVuZCh7fSwgREVGQVVMVF9PUFRJT05TJDQpOwogICAgLyoqCiAgICAgKiDlvZPliY3mv4DmtLvnmoQgdGFiIOeahOe0ouW8leWPt+OAguS4uiAtMSDml7booajnpLrmsqHmnInmv4DmtLvnmoTpgInpobnljaHvvIzmiJbkuI3lrZjlnKjpgInpobnljaEKICAgICAqLwoKICAgIHRoaXMuYWN0aXZlSW5kZXggPSAtMTsKICAgIHRoaXMuJGVsZW1lbnQgPSAkKHNlbGVjdG9yKS5maXJzdCgpOwogICAgZXh0ZW5kKHRoaXMub3B0aW9ucywgb3B0aW9ucyk7CiAgICB0aGlzLiR0YWJzID0gdGhpcy4kZWxlbWVudC5jaGlsZHJlbignYScpOwogICAgdGhpcy4kaW5kaWNhdG9yID0gJCgnPGRpdiBjbGFzcz0ibWR1aS10YWItaW5kaWNhdG9yIj48L2Rpdj4nKS5hcHBlbmRUbyh0aGlzLiRlbGVtZW50KTsgLy8g5qC55o2uIHVybCBoYXNoIOiOt+WPlum7mOiupOa/gOa0u+eahOmAiemhueWNoQoKICAgIHZhciBoYXNoID0gd2luZG93LmxvY2F0aW9uLmhhc2g7CgogICAgaWYgKGhhc2gpIHsKICAgICAgdGhpcy4kdGFicy5lYWNoKGZ1bmN0aW9uIChpbmRleCwgdGFiKSB7CiAgICAgICAgaWYgKCQodGFiKS5hdHRyKCdocmVmJykgPT09IGhhc2gpIHsKICAgICAgICAgIHRoaXMkMS5hY3RpdmVJbmRleCA9IGluZGV4OwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0pOwogICAgfSAvLyDlkKsgLm1kdWktdGFiLWFjdGl2ZSDnmoTlhYPntKDpu5jorqTmv4DmtLsKCgogICAgaWYgKHRoaXMuYWN0aXZlSW5kZXggPT09IC0xKSB7CiAgICAgIHRoaXMuJHRhYnMuZWFjaChmdW5jdGlvbiAoaW5kZXgsIHRhYikgewogICAgICAgIGlmICgkKHRhYikuaGFzQ2xhc3MoJ21kdWktdGFiLWFjdGl2ZScpKSB7CiAgICAgICAgICB0aGlzJDEuYWN0aXZlSW5kZXggPSBpbmRleDsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9KTsKICAgIH0gLy8g5a2Y5Zyo6YCJ6aG55Y2h5pe277yM6buY6K6k5r+A5rS756ys5LiA5Liq6YCJ6aG55Y2hCgoKICAgIGlmICh0aGlzLiR0YWJzLmxlbmd0aCAmJiB0aGlzLmFjdGl2ZUluZGV4ID09PSAtMSkgewogICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gMDsKICAgIH0gLy8g6K6+572u5r+A5rS754q25oCB6YCJ6aG55Y2hCgoKICAgIHRoaXMuc2V0QWN0aXZlKCk7IC8vIOebkeWQrOeql+WPo+Wkp+Wwj+WPmOWMluS6i+S7tu+8jOiwg+aVtOaMh+ekuuWZqOS9jee9rgoKICAgICR3aW5kb3cub24oJ3Jlc2l6ZScsICQudGhyb3R0bGUoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcyQxLnNldEluZGljYXRvclBvc2l0aW9uKCk7CiAgICB9LCAxMDApKTsgLy8g55uR5ZCs54K55Ye76YCJ6aG55Y2h5LqL5Lu2CgogICAgdGhpcy4kdGFicy5lYWNoKGZ1bmN0aW9uIChfLCB0YWIpIHsKICAgICAgdGhpcyQxLmJpbmRUYWJFdmVudCh0YWIpOwogICAgfSk7CiAgfTsKICAvKioKICAgKiDmjIflrprpgInpobnljaHmmK/lkKblt7LnpoHnlKgKICAgKiBAcGFyYW0gJHRhYgogICAqLwoKCiAgVGFiLnByb3RvdHlwZS5pc0Rpc2FibGVkID0gZnVuY3Rpb24gaXNEaXNhYmxlZCgkdGFiKSB7CiAgICByZXR1cm4gJHRhYi5hdHRyKCdkaXNhYmxlZCcpICE9PSB1bmRlZmluZWQ7CiAgfTsKICAvKioKICAgKiDnu5HlrprlnKggVGFiIOS4iueCueWHu+aIluaCrOa1rueahOS6i+S7tgogICAqIEBwYXJhbSB0YWIKICAgKi8KCgogIFRhYi5wcm90b3R5cGUuYmluZFRhYkV2ZW50ID0gZnVuY3Rpb24gYmluZFRhYkV2ZW50KHRhYikgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CiAgICB2YXIgJHRhYiA9ICQodGFiKTsgLy8g54K55Ye75oiW6byg5qCH56e75YWl6Kem5Y+R55qE5LqL5Lu2CgogICAgdmFyIGNsaWNrRXZlbnQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIC8vIOemgeeUqOeKtuaAgeeahOmAiemhueWNoeaXoOazlemAieS4rQogICAgICBpZiAodGhpcyQxLmlzRGlzYWJsZWQoJHRhYikpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHRoaXMkMS5hY3RpdmVJbmRleCA9IHRoaXMkMS4kdGFicy5pbmRleCh0YWIpOwogICAgICB0aGlzJDEuc2V0QWN0aXZlKCk7CiAgICB9OyAvLyDml6DorrogdHJpZ2dlciDmmK8gY2xpY2sg6L+Y5pivIGhvdmVy77yM6YO95Lya5ZON5bqUIGNsaWNrIOS6i+S7tgoKCiAgICAkdGFiLm9uKCdjbGljaycsIGNsaWNrRXZlbnQpOyAvLyB0cmlnZ2VyIOS4uiBob3ZlciDml7bvvIzpop3lpJblk43lupQgbW91c2VlbnRlciDkuovku7YKCiAgICBpZiAodGhpcy5vcHRpb25zLnRyaWdnZXIgPT09ICdob3ZlcicpIHsKICAgICAgJHRhYi5vbignbW91c2VlbnRlcicsIGNsaWNrRXZlbnQpOwogICAgfSAvLyDpmLvmraLpk77mjqXnmoTpu5jorqTngrnlh7vliqjkvZwKCgogICAgJHRhYi5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICgoJHRhYi5hdHRyKCdocmVmJykgfHwgJycpLmluZGV4T2YoJyMnKSA9PT0gMCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSk7CiAgfTsKICAvKioKICAgKiDop6blj5Hnu4Tku7bkuovku7YKICAgKiBAcGFyYW0gbmFtZQogICAqIEBwYXJhbSAkZWxlbWVudAogICAqIEBwYXJhbSBwYXJhbWV0ZXJzCiAgICovCgoKICBUYWIucHJvdG90eXBlLnRyaWdnZXJFdmVudCA9IGZ1bmN0aW9uIHRyaWdnZXJFdmVudChuYW1lLCAkZWxlbWVudCwgcGFyYW1ldGVycykgewogICAgaWYgKHBhcmFtZXRlcnMgPT09IHZvaWQgMCkgcGFyYW1ldGVycyA9IHt9OwogICAgY29tcG9uZW50RXZlbnQobmFtZSwgJ3RhYicsICRlbGVtZW50LCB0aGlzLCBwYXJhbWV0ZXJzKTsKICB9OwogIC8qKgogICAqIOiuvue9rua/gOa0u+eKtuaAgeeahOmAiemhueWNoQogICAqLwoKCiAgVGFiLnByb3RvdHlwZS5zZXRBY3RpdmUgPSBmdW5jdGlvbiBzZXRBY3RpdmUoKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgIHRoaXMuJHRhYnMuZWFjaChmdW5jdGlvbiAoaW5kZXgsIHRhYikgewogICAgICB2YXIgJHRhYiA9ICQodGFiKTsKICAgICAgdmFyIHRhcmdldElkID0gJHRhYi5hdHRyKCdocmVmJykgfHwgJyc7IC8vIOiuvue9rumAiemhueWNoea/gOa0u+eKtuaAgQoKICAgICAgaWYgKGluZGV4ID09PSB0aGlzJDEuYWN0aXZlSW5kZXggJiYgIXRoaXMkMS5pc0Rpc2FibGVkKCR0YWIpKSB7CiAgICAgICAgaWYgKCEkdGFiLmhhc0NsYXNzKCdtZHVpLXRhYi1hY3RpdmUnKSkgewogICAgICAgICAgdGhpcyQxLnRyaWdnZXJFdmVudCgnY2hhbmdlJywgdGhpcyQxLiRlbGVtZW50LCB7CiAgICAgICAgICAgIGluZGV4OiB0aGlzJDEuYWN0aXZlSW5kZXgsCiAgICAgICAgICAgIGlkOiB0YXJnZXRJZC5zdWJzdHIoMSkKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcyQxLnRyaWdnZXJFdmVudCgnc2hvdycsICR0YWIpOwogICAgICAgICAgJHRhYi5hZGRDbGFzcygnbWR1aS10YWItYWN0aXZlJyk7CiAgICAgICAgfQoKICAgICAgICAkKHRhcmdldElkKS5zaG93KCk7CiAgICAgICAgdGhpcyQxLnNldEluZGljYXRvclBvc2l0aW9uKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgJHRhYi5yZW1vdmVDbGFzcygnbWR1aS10YWItYWN0aXZlJyk7CiAgICAgICAgJCh0YXJnZXRJZCkuaGlkZSgpOwogICAgICB9CiAgICB9KTsKICB9OwogIC8qKgogICAqIOiuvue9rumAiemhueWNoeaMh+ekuuWZqOeahOS9jee9rgogICAqLwoKCiAgVGFiLnByb3RvdHlwZS5zZXRJbmRpY2F0b3JQb3NpdGlvbiA9IGZ1bmN0aW9uIHNldEluZGljYXRvclBvc2l0aW9uKCkgewogICAgLy8g6YCJ6aG55Y2h5pWw6YeP5Li6IDAg5pe277yM5LiN5pi+56S65oyH56S65ZmoCiAgICBpZiAodGhpcy5hY3RpdmVJbmRleCA9PT0gLTEpIHsKICAgICAgdGhpcy4kaW5kaWNhdG9yLmNzcyh7CiAgICAgICAgbGVmdDogMCwKICAgICAgICB3aWR0aDogMAogICAgICB9KTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciAkYWN0aXZlVGFiID0gdGhpcy4kdGFicy5lcSh0aGlzLmFjdGl2ZUluZGV4KTsKCiAgICBpZiAodGhpcy5pc0Rpc2FibGVkKCRhY3RpdmVUYWIpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgYWN0aXZlVGFiT2Zmc2V0ID0gJGFjdGl2ZVRhYi5vZmZzZXQoKTsKICAgIHRoaXMuJGluZGljYXRvci5jc3MoewogICAgICBsZWZ0OiBhY3RpdmVUYWJPZmZzZXQubGVmdCArIHRoaXMuJGVsZW1lbnRbMF0uc2Nyb2xsTGVmdCAtIHRoaXMuJGVsZW1lbnRbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCArICJweCIsCiAgICAgIHdpZHRoOiAkYWN0aXZlVGFiLmlubmVyV2lkdGgoKSArICJweCIKICAgIH0pOwogIH07CiAgLyoqCiAgICog5YiH5o2i5Yiw5LiL5LiA5Liq6YCJ6aG55Y2hCiAgICovCgoKICBUYWIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiBuZXh0KCkgewogICAgaWYgKHRoaXMuYWN0aXZlSW5kZXggPT09IC0xKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAodGhpcy4kdGFicy5sZW5ndGggPiB0aGlzLmFjdGl2ZUluZGV4ICsgMSkgewogICAgICB0aGlzLmFjdGl2ZUluZGV4Kys7CiAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy5sb29wKSB7CiAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSAwOwogICAgfQoKICAgIHRoaXMuc2V0QWN0aXZlKCk7CiAgfTsKICAvKioKICAgKiDliIfmjaLliLDkuIrkuIDkuKrpgInpobnljaEKICAgKi8KCgogIFRhYi5wcm90b3R5cGUucHJldiA9IGZ1bmN0aW9uIHByZXYoKSB7CiAgICBpZiAodGhpcy5hY3RpdmVJbmRleCA9PT0gLTEpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICh0aGlzLmFjdGl2ZUluZGV4ID4gMCkgewogICAgICB0aGlzLmFjdGl2ZUluZGV4LS07CiAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy5sb29wKSB7CiAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSB0aGlzLiR0YWJzLmxlbmd0aCAtIDE7CiAgICB9CgogICAgdGhpcy5zZXRBY3RpdmUoKTsKICB9OwogIC8qKgogICAqIOaYvuekuuaMh+Wumue0ouW8leWPt+OAgeaIluaMh+Wummlk55qE6YCJ6aG55Y2hCiAgICogQHBhcmFtIGluZGV4IOe0ouW8leWPt+OAgeaIlmlkCiAgICovCgoKICBUYWIucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiBzaG93KGluZGV4KSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKCiAgICBpZiAodGhpcy5hY3RpdmVJbmRleCA9PT0gLTEpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChpc051bWJlcihpbmRleCkpIHsKICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IGluZGV4OwogICAgfSBlbHNlIHsKICAgICAgdGhpcy4kdGFicy5lYWNoKGZ1bmN0aW9uIChpLCB0YWIpIHsKICAgICAgICBpZiAodGFiLmlkID09PSBpbmRleCkgewogICAgICAgICAgdGhpcyQxLmFjdGl2ZUluZGV4ID09PSBpOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CgogICAgdGhpcy5zZXRBY3RpdmUoKTsKICB9OwogIC8qKgogICAqIOWcqOeItuWFg+e0oOeahOWuveW6puWPmOWMluaXtu+8jOmcgOimgeiwg+eUqOivpeaWueazlemHjeaWsOiwg+aVtOaMh+ekuuWZqOS9jee9rgogICAqIOWcqOa3u+WKoOaIluWIoOmZpOmAiemhueWNoeaXtu+8jOmcgOimgeiwg+eUqOivpeaWueazlQogICAqLwoKCiAgVGFiLnByb3RvdHlwZS5oYW5kbGVVcGRhdGUgPSBmdW5jdGlvbiBoYW5kbGVVcGRhdGUoKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgIHZhciAkb2xkVGFicyA9IHRoaXMuJHRhYnM7IC8vIOaXp+eahCB0YWJzIEpR5a+56LGhCgogICAgdmFyICRuZXdUYWJzID0gdGhpcy4kZWxlbWVudC5jaGlsZHJlbignYScpOyAvLyDmlrDnmoQgdGFicyBKUeWvueixoQoKICAgIHZhciBvbGRUYWJzRWxlbWVudCA9ICRvbGRUYWJzLmdldCgpOyAvLyDml6fnmoQgdGFicyDlhYPntKDmlbDnu4QKCiAgICB2YXIgbmV3VGFic0VsZW1lbnQgPSAkbmV3VGFicy5nZXQoKTsgLy8g5paw55qEIHRhYnMg5YWD57Sg5pWw57uECgogICAgaWYgKCEkbmV3VGFicy5sZW5ndGgpIHsKICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IC0xOwogICAgICB0aGlzLiR0YWJzID0gJG5ld1RhYnM7CiAgICAgIHRoaXMuc2V0SW5kaWNhdG9yUG9zaXRpb24oKTsKICAgICAgcmV0dXJuOwogICAgfSAvLyDph43mlrDpgY3ljobpgInpobnljaHvvIzmib7lh7rmlrDlop7nmoTpgInpobnljaEKCgogICAgJG5ld1RhYnMuZWFjaChmdW5jdGlvbiAoaW5kZXgsIHRhYikgewogICAgICAvLyDmnInmlrDlop7nmoTpgInpobnljaEKICAgICAgaWYgKG9sZFRhYnNFbGVtZW50LmluZGV4T2YodGFiKSA8IDApIHsKICAgICAgICB0aGlzJDEuYmluZFRhYkV2ZW50KHRhYik7CgogICAgICAgIGlmICh0aGlzJDEuYWN0aXZlSW5kZXggPT09IC0xKSB7CiAgICAgICAgICB0aGlzJDEuYWN0aXZlSW5kZXggPSAwOwogICAgICAgIH0gZWxzZSBpZiAoaW5kZXggPD0gdGhpcyQxLmFjdGl2ZUluZGV4KSB7CiAgICAgICAgICB0aGlzJDEuYWN0aXZlSW5kZXgrKzsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOyAvLyDmib7lh7rooqvnp7vpmaTnmoTpgInpobnljaEKCiAgICAkb2xkVGFicy5lYWNoKGZ1bmN0aW9uIChpbmRleCwgdGFiKSB7CiAgICAgIC8vIOacieiiq+enu+mZpOeahOmAiemhueWNoQogICAgICBpZiAobmV3VGFic0VsZW1lbnQuaW5kZXhPZih0YWIpIDwgMCkgewogICAgICAgIGlmIChpbmRleCA8IHRoaXMkMS5hY3RpdmVJbmRleCkgewogICAgICAgICAgdGhpcyQxLmFjdGl2ZUluZGV4LS07CiAgICAgICAgfSBlbHNlIGlmIChpbmRleCA9PT0gdGhpcyQxLmFjdGl2ZUluZGV4KSB7CiAgICAgICAgICB0aGlzJDEuYWN0aXZlSW5kZXggPSAwOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgICB0aGlzLiR0YWJzID0gJG5ld1RhYnM7CiAgICB0aGlzLnNldEFjdGl2ZSgpOwogIH07CgogIG1kdWkuVGFiID0gVGFiOwogIHZhciBjdXN0b21BdHRyJDUgPSAnbWR1aS10YWInOwogICQoZnVuY3Rpb24gKCkgewogICAgbWR1aS5tdXRhdGlvbigiWyIgKyBjdXN0b21BdHRyJDUgKyAiXSIsIGZ1bmN0aW9uICgpIHsKICAgICAgbmV3IG1kdWkuVGFiKHRoaXMsIHBhcnNlT3B0aW9ucyh0aGlzLCBjdXN0b21BdHRyJDUpKTsKICAgIH0pOwogIH0pOwogIC8qKgogICAqIOWcqOahjOmdouiuvuWkh+S4ium7mOiupOaYvuekuuaKveWxieagj++8jOS4jeaYvuekuumBrue9qeWxggogICAqIOWcqOaJi+acuuWSjOW5s+adv+iuvuWkh+S4ium7mOiupOS4jeaYvuekuuaKveWxieagj++8jOWni+e7iOaYvuekuumBrue9qeWxgu+8jOS4lOimhuebluWvvOiIquagjwogICAqLwoKICB2YXIgREVGQVVMVF9PUFRJT05TJDUgPSB7CiAgICBvdmVybGF5OiBmYWxzZSwKICAgIHN3aXBlOiBmYWxzZQogIH07CgogIHZhciBEcmF3ZXIgPSBmdW5jdGlvbiBEcmF3ZXIoc2VsZWN0b3IsIG9wdGlvbnMpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgb3B0aW9ucyA9IHt9OwogICAgLyoqCiAgICAgKiDphY3nva7lj4LmlbAKICAgICAqLwoKICAgIHRoaXMub3B0aW9ucyA9IGV4dGVuZCh7fSwgREVGQVVMVF9PUFRJT05TJDUpOwogICAgLyoqCiAgICAgKiDlvZPliY3mmK/lkKbmmL7npLrnnYDpga7nvanlsYIKICAgICAqLwoKICAgIHRoaXMub3ZlcmxheSA9IGZhbHNlOwogICAgdGhpcy4kZWxlbWVudCA9ICQoc2VsZWN0b3IpLmZpcnN0KCk7CiAgICBleHRlbmQodGhpcy5vcHRpb25zLCBvcHRpb25zKTsKICAgIHRoaXMucG9zaXRpb24gPSB0aGlzLiRlbGVtZW50Lmhhc0NsYXNzKCdtZHVpLWRyYXdlci1yaWdodCcpID8gJ3JpZ2h0JyA6ICdsZWZ0JzsKCiAgICBpZiAodGhpcy4kZWxlbWVudC5oYXNDbGFzcygnbWR1aS1kcmF3ZXItY2xvc2UnKSkgewogICAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICB9IGVsc2UgaWYgKHRoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ21kdWktZHJhd2VyLW9wZW4nKSkgewogICAgICB0aGlzLnN0YXRlID0gJ29wZW5lZCc7CiAgICB9IGVsc2UgaWYgKHRoaXMuaXNEZXNrdG9wKCkpIHsKICAgICAgdGhpcy5zdGF0ZSA9ICdvcGVuZWQnOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5zdGF0ZSA9ICdjbG9zZWQnOwogICAgfSAvLyDmtY/op4jlmajnqpflj6PlpKflsI/osIPmlbTml7YKCgogICAgJHdpbmRvdy5vbigncmVzaXplJywgJC50aHJvdHRsZShmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzJDEuaXNEZXNrdG9wKCkpIHsKICAgICAgICAvLyDnlLHmiYvmnLrlubPmnb/liIfmjaLliLDmoYzpnaLml7YKICAgICAgICAvLyDlpoLmnpzmmL7npLrnnYDpga7nvanvvIzliJnpmpDol4/pga7nvakKICAgICAgICBpZiAodGhpcyQxLm92ZXJsYXkgJiYgIXRoaXMkMS5vcHRpb25zLm92ZXJsYXkpIHsKICAgICAgICAgICQuaGlkZU92ZXJsYXkoKTsKICAgICAgICAgIHRoaXMkMS5vdmVybGF5ID0gZmFsc2U7CiAgICAgICAgICAkLnVubG9ja1NjcmVlbigpOwogICAgICAgIH0gLy8g5rKh5pyJ5by65Yi25YWz6Zet77yM5YiZ54q25oCB5Li65omT5byA54q25oCBCgoKICAgICAgICBpZiAoIXRoaXMkMS4kZWxlbWVudC5oYXNDbGFzcygnbWR1aS1kcmF3ZXItY2xvc2UnKSkgewogICAgICAgICAgdGhpcyQxLnN0YXRlID0gJ29wZW5lZCc7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKCF0aGlzJDEub3ZlcmxheSAmJiB0aGlzJDEuc3RhdGUgPT09ICdvcGVuZWQnKSB7CiAgICAgICAgLy8g55Sx5qGM6Z2i5YiH5o2i5Yiw5omL5py65bmz5p2/5pe244CC5aaC5p6c5oq95bGJ5qCP5piv5omT5byA552A55qE5LiU5rKh5pyJ6YGu572p5bGC77yM5YiZ5YWz6Zet5oq95bGJ5qCPCiAgICAgICAgaWYgKHRoaXMkMS4kZWxlbWVudC5oYXNDbGFzcygnbWR1aS1kcmF3ZXItb3BlbicpKSB7CiAgICAgICAgICAkLnNob3dPdmVybGF5KCk7CiAgICAgICAgICB0aGlzJDEub3ZlcmxheSA9IHRydWU7CiAgICAgICAgICAkLmxvY2tTY3JlZW4oKTsKICAgICAgICAgICQoJy5tZHVpLW92ZXJsYXknKS5vbmUoJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gdGhpcyQxLmNsb3NlKCk7CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcyQxLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICAgICAgfQogICAgICB9CiAgICB9LCAxMDApKTsgLy8g57uR5a6a5YWz6Zet5oyJ6ZKu5LqL5Lu2CgogICAgdGhpcy4kZWxlbWVudC5maW5kKCdbbWR1aS1kcmF3ZXItY2xvc2VdJykuZWFjaChmdW5jdGlvbiAoXywgY2xvc2UpIHsKICAgICAgJChjbG9zZSkub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0aGlzJDEuY2xvc2UoKTsKICAgICAgfSk7CiAgICB9KTsKICAgIHRoaXMuc3dpcGVTdXBwb3J0KCk7CiAgfTsKICAvKioKICAgKiDmmK/lkKbmmK/moYzpnaLorr7lpIcKICAgKi8KCgogIERyYXdlci5wcm90b3R5cGUuaXNEZXNrdG9wID0gZnVuY3Rpb24gaXNEZXNrdG9wKCkgewogICAgcmV0dXJuICR3aW5kb3cud2lkdGgoKSA+PSAxMDI0OwogIH07CiAgLyoqCiAgICog5ruR5Yqo5omL5Yq/5pSv5oyBCiAgICovCgoKICBEcmF3ZXIucHJvdG90eXBlLnN3aXBlU3VwcG9ydCA9IGZ1bmN0aW9uIHN3aXBlU3VwcG9ydCgpIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdGhpcy1hbGlhcwogICAgdmFyIHRoYXQgPSB0aGlzOyAvLyDmir3lsYnmoI/mu5HliqjmiYvlir/mjqfliLYKCiAgICB2YXIgb3Blbk5hdkV2ZW50SGFuZGxlcjsKICAgIHZhciB0b3VjaFN0YXJ0WDsKICAgIHZhciB0b3VjaFN0YXJ0WTsKICAgIHZhciBzd2lwZVN0YXJ0WDsKICAgIHZhciBzd2lwaW5nID0gbnVsbDsKICAgIHZhciBtYXliZVN3aXBpbmcgPSBmYWxzZTsKICAgIHZhciAkYm9keSA9ICQoJ2JvZHknKTsgLy8g5omL5Yq/6Kem5Y+R55qE6IyD5Zu0CgogICAgdmFyIHN3aXBlQXJlYVdpZHRoID0gMjQ7CgogICAgZnVuY3Rpb24gc2V0UG9zaXRpb24odHJhbnNsYXRlWCkgewogICAgICB2YXIgcnRsVHJhbnNsYXRlTXVsdGlwbGllciA9IHRoYXQucG9zaXRpb24gPT09ICdyaWdodCcgPyAtMSA6IDE7CiAgICAgIHZhciB0cmFuc2Zvcm1DU1MgPSAidHJhbnNsYXRlKCIgKyAtMSAqIHJ0bFRyYW5zbGF0ZU11bHRpcGxpZXIgKiB0cmFuc2xhdGVYICsgInB4LCAwKSAhaW1wb3J0YW50OyI7CiAgICAgIHZhciB0cmFuc2l0aW9uQ1NTID0gJ2luaXRpYWwgIWltcG9ydGFudDsnOwogICAgICB0aGF0LiRlbGVtZW50LmNzcygnY3NzVGV4dCcsICJ0cmFuc2Zvcm06ICIgKyB0cmFuc2Zvcm1DU1MgKyAiOyB0cmFuc2l0aW9uOiAiICsgdHJhbnNpdGlvbkNTUyArICI7Iik7CiAgICB9CgogICAgZnVuY3Rpb24gY2xlYW5Qb3NpdGlvbigpIHsKICAgICAgdGhhdC4kZWxlbWVudFswXS5zdHlsZS50cmFuc2Zvcm0gPSAnJzsKICAgICAgdGhhdC4kZWxlbWVudFswXS5zdHlsZS53ZWJraXRUcmFuc2Zvcm0gPSAnJzsKICAgICAgdGhhdC4kZWxlbWVudFswXS5zdHlsZS50cmFuc2l0aW9uID0gJyc7CiAgICAgIHRoYXQuJGVsZW1lbnRbMF0uc3R5bGUud2Via2l0VHJhbnNpdGlvbiA9ICcnOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldE1heFRyYW5zbGF0ZVgoKSB7CiAgICAgIHJldHVybiB0aGF0LiRlbGVtZW50LndpZHRoKCkgKyAxMDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRUcmFuc2xhdGVYKGN1cnJlbnRYKSB7CiAgICAgIHJldHVybiBNYXRoLm1pbihNYXRoLm1heChzd2lwaW5nID09PSAnY2xvc2luZycgPyBzd2lwZVN0YXJ0WCAtIGN1cnJlbnRYIDogZ2V0TWF4VHJhbnNsYXRlWCgpICsgc3dpcGVTdGFydFggLSBjdXJyZW50WCwgMCksIGdldE1heFRyYW5zbGF0ZVgoKSk7CiAgICB9CgogICAgZnVuY3Rpb24gb25Cb2R5VG91Y2hFbmQoZXZlbnQpIHsKICAgICAgaWYgKHN3aXBpbmcpIHsKICAgICAgICB2YXIgdG91Y2hYID0gZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVg7CgogICAgICAgIGlmICh0aGF0LnBvc2l0aW9uID09PSAncmlnaHQnKSB7CiAgICAgICAgICB0b3VjaFggPSAkYm9keS53aWR0aCgpIC0gdG91Y2hYOwogICAgICAgIH0KCiAgICAgICAgdmFyIHRyYW5zbGF0ZVJhdGlvID0gZ2V0VHJhbnNsYXRlWCh0b3VjaFgpIC8gZ2V0TWF4VHJhbnNsYXRlWCgpOwogICAgICAgIG1heWJlU3dpcGluZyA9IGZhbHNlOwogICAgICAgIHZhciBzd2lwaW5nU3RhdGUgPSBzd2lwaW5nOwogICAgICAgIHN3aXBpbmcgPSBudWxsOwoKICAgICAgICBpZiAoc3dpcGluZ1N0YXRlID09PSAnb3BlbmluZycpIHsKICAgICAgICAgIGlmICh0cmFuc2xhdGVSYXRpbyA8IDAuOTIpIHsKICAgICAgICAgICAgY2xlYW5Qb3NpdGlvbigpOwogICAgICAgICAgICB0aGF0Lm9wZW4oKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNsZWFuUG9zaXRpb24oKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHRyYW5zbGF0ZVJhdGlvID4gMC4wOCkgewogICAgICAgICAgICBjbGVhblBvc2l0aW9uKCk7CiAgICAgICAgICAgIHRoYXQuY2xvc2UoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNsZWFuUG9zaXRpb24oKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICQudW5sb2NrU2NyZWVuKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbWF5YmVTd2lwaW5nID0gZmFsc2U7CiAgICAgIH0KCiAgICAgICRib2R5Lm9mZih7CiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11c2UtYmVmb3JlLWRlZmluZQogICAgICAgIHRvdWNobW92ZTogb25Cb2R5VG91Y2hNb3ZlLAogICAgICAgIHRvdWNoZW5kOiBvbkJvZHlUb3VjaEVuZCwKICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVzZS1iZWZvcmUtZGVmaW5lCiAgICAgICAgdG91Y2hjYW5jZWw6IG9uQm9keVRvdWNoTW92ZQogICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBvbkJvZHlUb3VjaE1vdmUoZXZlbnQpIHsKICAgICAgdmFyIHRvdWNoWCA9IGV2ZW50LnRvdWNoZXNbMF0ucGFnZVg7CgogICAgICBpZiAodGhhdC5wb3NpdGlvbiA9PT0gJ3JpZ2h0JykgewogICAgICAgIHRvdWNoWCA9ICRib2R5LndpZHRoKCkgLSB0b3VjaFg7CiAgICAgIH0KCiAgICAgIHZhciB0b3VjaFkgPSBldmVudC50b3VjaGVzWzBdLnBhZ2VZOwoKICAgICAgaWYgKHN3aXBpbmcpIHsKICAgICAgICBzZXRQb3NpdGlvbihnZXRUcmFuc2xhdGVYKHRvdWNoWCkpOwogICAgICB9IGVsc2UgaWYgKG1heWJlU3dpcGluZykgewogICAgICAgIHZhciBkWEFicyA9IE1hdGguYWJzKHRvdWNoWCAtIHRvdWNoU3RhcnRYKTsKICAgICAgICB2YXIgZFlBYnMgPSBNYXRoLmFicyh0b3VjaFkgLSB0b3VjaFN0YXJ0WSk7CiAgICAgICAgdmFyIHRocmVzaG9sZCA9IDg7CgogICAgICAgIGlmIChkWEFicyA+IHRocmVzaG9sZCAmJiBkWUFicyA8PSB0aHJlc2hvbGQpIHsKICAgICAgICAgIHN3aXBlU3RhcnRYID0gdG91Y2hYOwogICAgICAgICAgc3dpcGluZyA9IHRoYXQuc3RhdGUgPT09ICdvcGVuZWQnID8gJ2Nsb3NpbmcnIDogJ29wZW5pbmcnOwogICAgICAgICAgJC5sb2NrU2NyZWVuKCk7CiAgICAgICAgICBzZXRQb3NpdGlvbihnZXRUcmFuc2xhdGVYKHRvdWNoWCkpOwogICAgICAgIH0gZWxzZSBpZiAoZFhBYnMgPD0gdGhyZXNob2xkICYmIGRZQWJzID4gdGhyZXNob2xkKSB7CiAgICAgICAgICBvbkJvZHlUb3VjaEVuZCgpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIG9uQm9keVRvdWNoU3RhcnQoZXZlbnQpIHsKICAgICAgdG91Y2hTdGFydFggPSBldmVudC50b3VjaGVzWzBdLnBhZ2VYOwoKICAgICAgaWYgKHRoYXQucG9zaXRpb24gPT09ICdyaWdodCcpIHsKICAgICAgICB0b3VjaFN0YXJ0WCA9ICRib2R5LndpZHRoKCkgLSB0b3VjaFN0YXJ0WDsKICAgICAgfQoKICAgICAgdG91Y2hTdGFydFkgPSBldmVudC50b3VjaGVzWzBdLnBhZ2VZOwoKICAgICAgaWYgKHRoYXQuc3RhdGUgIT09ICdvcGVuZWQnKSB7CiAgICAgICAgaWYgKHRvdWNoU3RhcnRYID4gc3dpcGVBcmVhV2lkdGggfHwgb3Blbk5hdkV2ZW50SGFuZGxlciAhPT0gb25Cb2R5VG91Y2hTdGFydCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQoKICAgICAgbWF5YmVTd2lwaW5nID0gdHJ1ZTsKICAgICAgJGJvZHkub24oewogICAgICAgIHRvdWNobW92ZTogb25Cb2R5VG91Y2hNb3ZlLAogICAgICAgIHRvdWNoZW5kOiBvbkJvZHlUb3VjaEVuZCwKICAgICAgICB0b3VjaGNhbmNlbDogb25Cb2R5VG91Y2hNb3ZlCiAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIGVuYWJsZVN3aXBlSGFuZGxpbmcoKSB7CiAgICAgIGlmICghb3Blbk5hdkV2ZW50SGFuZGxlcikgewogICAgICAgICRib2R5Lm9uKCd0b3VjaHN0YXJ0Jywgb25Cb2R5VG91Y2hTdGFydCk7CiAgICAgICAgb3Blbk5hdkV2ZW50SGFuZGxlciA9IG9uQm9keVRvdWNoU3RhcnQ7CiAgICAgIH0KICAgIH0KCiAgICBpZiAodGhpcy5vcHRpb25zLnN3aXBlKSB7CiAgICAgIGVuYWJsZVN3aXBlSGFuZGxpbmcoKTsKICAgIH0KICB9OwogIC8qKgogICAqIOinpuWPkee7hOS7tuS6i+S7tgogICAqIEBwYXJhbSBuYW1lCiAgICovCgoKICBEcmF3ZXIucHJvdG90eXBlLnRyaWdnZXJFdmVudCA9IGZ1bmN0aW9uIHRyaWdnZXJFdmVudChuYW1lKSB7CiAgICBjb21wb25lbnRFdmVudChuYW1lLCAnZHJhd2VyJywgdGhpcy4kZWxlbWVudCwgdGhpcyk7CiAgfTsKICAvKioKICAgKiDliqjnlLvnu5PmnZ/lm57osIMKICAgKi8KCgogIERyYXdlci5wcm90b3R5cGUudHJhbnNpdGlvbkVuZCA9IGZ1bmN0aW9uIHRyYW5zaXRpb25FbmQoKSB7CiAgICBpZiAodGhpcy4kZWxlbWVudC5oYXNDbGFzcygnbWR1aS1kcmF3ZXItb3BlbicpKSB7CiAgICAgIHRoaXMuc3RhdGUgPSAnb3BlbmVkJzsKICAgICAgdGhpcy50cmlnZ2VyRXZlbnQoJ29wZW5lZCcpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy5zdGF0ZSA9ICdjbG9zZWQnOwogICAgICB0aGlzLnRyaWdnZXJFdmVudCgnY2xvc2VkJyk7CiAgICB9CiAgfTsKICAvKioKICAgKiDmmK/lkKblpITkuo7miZPlvIDnirbmgIEKICAgKi8KCgogIERyYXdlci5wcm90b3R5cGUuaXNPcGVuID0gZnVuY3Rpb24gaXNPcGVuKCkgewogICAgcmV0dXJuIHRoaXMuc3RhdGUgPT09ICdvcGVuaW5nJyB8fCB0aGlzLnN0YXRlID09PSAnb3BlbmVkJzsKICB9OwogIC8qKgogICAqIOaJk+W8gOaKveWxieagjwogICAqLwoKCiAgRHJhd2VyLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gb3BlbigpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwoKICAgIGlmICh0aGlzLmlzT3BlbigpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLnN0YXRlID0gJ29wZW5pbmcnOwogICAgdGhpcy50cmlnZ2VyRXZlbnQoJ29wZW4nKTsKCiAgICBpZiAoIXRoaXMub3B0aW9ucy5vdmVybGF5KSB7CiAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygibWR1aS1kcmF3ZXItYm9keS0iICsgdGhpcy5wb3NpdGlvbik7CiAgICB9CgogICAgdGhpcy4kZWxlbWVudC5yZW1vdmVDbGFzcygnbWR1aS1kcmF3ZXItY2xvc2UnKS5hZGRDbGFzcygnbWR1aS1kcmF3ZXItb3BlbicpLnRyYW5zaXRpb25FbmQoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcyQxLnRyYW5zaXRpb25FbmQoKTsKICAgIH0pOwoKICAgIGlmICghdGhpcy5pc0Rlc2t0b3AoKSB8fCB0aGlzLm9wdGlvbnMub3ZlcmxheSkgewogICAgICB0aGlzLm92ZXJsYXkgPSB0cnVlOwogICAgICAkLnNob3dPdmVybGF5KCkub25lKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpcyQxLmNsb3NlKCk7CiAgICAgIH0pOwogICAgICAkLmxvY2tTY3JlZW4oKTsKICAgIH0KICB9OwogIC8qKgogICAqIOWFs+mXreaKveWxieagjwogICAqLwoKCiAgRHJhd2VyLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uIGNsb3NlKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CgogICAgaWYgKCF0aGlzLmlzT3BlbigpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLnN0YXRlID0gJ2Nsb3NpbmcnOwogICAgdGhpcy50cmlnZ2VyRXZlbnQoJ2Nsb3NlJyk7CgogICAgaWYgKCF0aGlzLm9wdGlvbnMub3ZlcmxheSkgewogICAgICAkKCdib2R5JykucmVtb3ZlQ2xhc3MoIm1kdWktZHJhd2VyLWJvZHktIiArIHRoaXMucG9zaXRpb24pOwogICAgfQoKICAgIHRoaXMuJGVsZW1lbnQuYWRkQ2xhc3MoJ21kdWktZHJhd2VyLWNsb3NlJykucmVtb3ZlQ2xhc3MoJ21kdWktZHJhd2VyLW9wZW4nKS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMkMS50cmFuc2l0aW9uRW5kKCk7CiAgICB9KTsKCiAgICBpZiAodGhpcy5vdmVybGF5KSB7CiAgICAgICQuaGlkZU92ZXJsYXkoKTsKICAgICAgdGhpcy5vdmVybGF5ID0gZmFsc2U7CiAgICAgICQudW5sb2NrU2NyZWVuKCk7CiAgICB9CiAgfTsKICAvKioKICAgKiDliIfmjaLmir3lsYnmoI/miZPlvIAv5YWz6Zet54q25oCBCiAgICovCgoKICBEcmF3ZXIucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uIHRvZ2dsZSgpIHsKICAgIHRoaXMuaXNPcGVuKCkgPyB0aGlzLmNsb3NlKCkgOiB0aGlzLm9wZW4oKTsKICB9OwogIC8qKgogICAqIOi/lOWbnuW9k+WJjeaKveWxieagj+eahOeKtuaAgeOAguWFseWMheWQq+Wbm+enjeeKtuaAge+8mmBvcGVuaW5nYOOAgWBvcGVuZWRg44CBYGNsb3Npbmdg44CBYGNsb3NlZGAKICAgKi8KCgogIERyYXdlci5wcm90b3R5cGUuZ2V0U3RhdGUgPSBmdW5jdGlvbiBnZXRTdGF0ZSgpIHsKICAgIHJldHVybiB0aGlzLnN0YXRlOwogIH07CgogIG1kdWkuRHJhd2VyID0gRHJhd2VyOwogIHZhciBjdXN0b21BdHRyJDYgPSAnbWR1aS1kcmF3ZXInOwogICQoZnVuY3Rpb24gKCkgewogICAgbWR1aS5tdXRhdGlvbigiWyIgKyBjdXN0b21BdHRyJDYgKyAiXSIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyICRlbGVtZW50ID0gJCh0aGlzKTsKICAgICAgdmFyIG9wdGlvbnMgPSBwYXJzZU9wdGlvbnModGhpcywgY3VzdG9tQXR0ciQ2KTsKICAgICAgdmFyIHNlbGVjdG9yID0gb3B0aW9ucy50YXJnZXQ7IC8vIEB0cy1pZ25vcmUKCiAgICAgIGRlbGV0ZSBvcHRpb25zLnRhcmdldDsKICAgICAgdmFyICRkcmF3ZXIgPSAkKHNlbGVjdG9yKS5maXJzdCgpOwogICAgICB2YXIgaW5zdGFuY2UgPSBuZXcgbWR1aS5EcmF3ZXIoJGRyYXdlciwgb3B0aW9ucyk7CiAgICAgICRlbGVtZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gaW5zdGFuY2UudG9nZ2xlKCk7CiAgICAgIH0pOwogICAgfSk7CiAgfSk7CiAgdmFyIGNvbnRhaW5lciA9IHt9OwoKICBmdW5jdGlvbiBxdWV1ZShuYW1lLCBmdW5jKSB7CiAgICBpZiAoaXNVbmRlZmluZWQoY29udGFpbmVyW25hbWVdKSkgewogICAgICBjb250YWluZXJbbmFtZV0gPSBbXTsKICAgIH0KCiAgICBpZiAoaXNVbmRlZmluZWQoZnVuYykpIHsKICAgICAgcmV0dXJuIGNvbnRhaW5lcltuYW1lXTsKICAgIH0KCiAgICBjb250YWluZXJbbmFtZV0ucHVzaChmdW5jKTsKICB9CiAgLyoqCiAgICog5LuO6Zif5YiX5Lit56e76Zmk56ys5LiA5Liq5Ye95pWw77yM5bm25omn6KGM6K+l5Ye95pWwCiAgICogQHBhcmFtIG5hbWUg6Zif5YiX5ruhCiAgICovCgoKICBmdW5jdGlvbiBkZXF1ZXVlKG5hbWUpIHsKICAgIGlmIChpc1VuZGVmaW5lZChjb250YWluZXJbbmFtZV0pKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoIWNvbnRhaW5lcltuYW1lXS5sZW5ndGgpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBmdW5jID0gY29udGFpbmVyW25hbWVdLnNoaWZ0KCk7CiAgICBmdW5jKCk7CiAgfQoKICB2YXIgREVGQVVMVF9PUFRJT05TJDYgPSB7CiAgICBoaXN0b3J5OiB0cnVlLAogICAgb3ZlcmxheTogdHJ1ZSwKICAgIG1vZGFsOiBmYWxzZSwKICAgIGNsb3NlT25Fc2M6IHRydWUsCiAgICBjbG9zZU9uQ2FuY2VsOiB0cnVlLAogICAgY2xvc2VPbkNvbmZpcm06IHRydWUsCiAgICBkZXN0cm95T25DbG9zZWQ6IGZhbHNlCiAgfTsKICAvKioKICAgKiDlvZPliY3mmL7npLrnmoTlr7nor53moYblrp7kvosKICAgKi8KCiAgdmFyIGN1cnJlbnRJbnN0ID0gbnVsbDsKICAvKioKICAgKiDpmJ/liJflkI0KICAgKi8KCiAgdmFyIHF1ZXVlTmFtZSA9ICdfbWR1aV9kaWFsb2cnOwogIC8qKgogICAqIOeql+WPo+aYr+WQpuW3sumUgeWumgogICAqLwoKICB2YXIgaXNMb2NrU2NyZWVuID0gZmFsc2U7CiAgLyoqCiAgICog6YGu572p5bGC5YWD57SgCiAgICovCgogIHZhciAkb3ZlcmxheTsKCiAgdmFyIERpYWxvZyA9IGZ1bmN0aW9uIERpYWxvZyhzZWxlY3Rvciwgb3B0aW9ucykgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CiAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSBvcHRpb25zID0ge307CiAgICAvKioKICAgICAqIOmFjee9ruWPguaVsAogICAgICovCgogICAgdGhpcy5vcHRpb25zID0gZXh0ZW5kKHt9LCBERUZBVUxUX09QVElPTlMkNik7CiAgICAvKioKICAgICAqIOW9k+WJjSBkaWFsb2cg55qE54q25oCBCiAgICAgKi8KCiAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICAvKioKICAgICAqIGRpYWxvZyDlhYPntKDmmK/lkKbmmK/liqjmgIHmt7vliqDnmoQKICAgICAqLwoKICAgIHRoaXMuYXBwZW5kID0gZmFsc2U7CiAgICB0aGlzLiRlbGVtZW50ID0gJChzZWxlY3RvcikuZmlyc3QoKTsgLy8g5aaC5p6c5a+56K+d5qGG5YWD57Sg5rKh5pyJ5Zyo5b2T5YmN5paH5qGj5Lit77yM5YiZ6ZyA6KaB5re75YqgCgogICAgaWYgKCFjb250YWlucyhkb2N1bWVudC5ib2R5LCB0aGlzLiRlbGVtZW50WzBdKSkgewogICAgICB0aGlzLmFwcGVuZCA9IHRydWU7CiAgICAgICQoJ2JvZHknKS5hcHBlbmQodGhpcy4kZWxlbWVudCk7CiAgICB9CgogICAgZXh0ZW5kKHRoaXMub3B0aW9ucywgb3B0aW9ucyk7IC8vIOe7keWumuWPlua2iOaMiemSruS6i+S7tgoKICAgIHRoaXMuJGVsZW1lbnQuZmluZCgnW21kdWktZGlhbG9nLWNhbmNlbF0nKS5lYWNoKGZ1bmN0aW9uIChfLCBjYW5jZWwpIHsKICAgICAgJChjYW5jZWwpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGlzJDEudHJpZ2dlckV2ZW50KCdjYW5jZWwnKTsKCiAgICAgICAgaWYgKHRoaXMkMS5vcHRpb25zLmNsb3NlT25DYW5jZWwpIHsKICAgICAgICAgIHRoaXMkMS5jbG9zZSgpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9KTsgLy8g57uR5a6a56Gu6K6k5oyJ6ZKu5LqL5Lu2CgogICAgdGhpcy4kZWxlbWVudC5maW5kKCdbbWR1aS1kaWFsb2ctY29uZmlybV0nKS5lYWNoKGZ1bmN0aW9uIChfLCBjb25maXJtKSB7CiAgICAgICQoY29uZmlybSkub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgIHRoaXMkMS50cmlnZ2VyRXZlbnQoJ2NvbmZpcm0nKTsKCiAgICAgICAgaWYgKHRoaXMkMS5vcHRpb25zLmNsb3NlT25Db25maXJtKSB7CiAgICAgICAgICB0aGlzJDEuY2xvc2UoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7IC8vIOe7keWumuWFs+mXreaMiemSruS6i+S7tgoKICAgIHRoaXMuJGVsZW1lbnQuZmluZCgnW21kdWktZGlhbG9nLWNsb3NlXScpLmVhY2goZnVuY3Rpb24gKF8sIGNsb3NlKSB7CiAgICAgICQoY2xvc2UpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpcyQxLmNsb3NlKCk7CiAgICAgIH0pOwogICAgfSk7CiAgfTsKICAvKioKICAgKiDop6blj5Hnu4Tku7bkuovku7YKICAgKiBAcGFyYW0gbmFtZQogICAqLwoKCiAgRGlhbG9nLnByb3RvdHlwZS50cmlnZ2VyRXZlbnQgPSBmdW5jdGlvbiB0cmlnZ2VyRXZlbnQobmFtZSkgewogICAgY29tcG9uZW50RXZlbnQobmFtZSwgJ2RpYWxvZycsIHRoaXMuJGVsZW1lbnQsIHRoaXMpOwogIH07CiAgLyoqCiAgICog56qX5Y+j5a695bqm5Y+Y5YyW77yM5oiW5a+56K+d5qGG5YaF5a655Y+Y5YyW5pe277yM6LCD5pW05a+56K+d5qGG5L2N572u5ZKM5a+56K+d5qGG5YaF55qE5rua5Yqo5p2hCiAgICovCgoKICBEaWFsb2cucHJvdG90eXBlLnJlYWRqdXN0ID0gZnVuY3Rpb24gcmVhZGp1c3QoKSB7CiAgICBpZiAoIWN1cnJlbnRJbnN0KSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgJGVsZW1lbnQgPSBjdXJyZW50SW5zdC4kZWxlbWVudDsKICAgIHZhciAkdGl0bGUgPSAkZWxlbWVudC5jaGlsZHJlbignLm1kdWktZGlhbG9nLXRpdGxlJyk7CiAgICB2YXIgJGNvbnRlbnQgPSAkZWxlbWVudC5jaGlsZHJlbignLm1kdWktZGlhbG9nLWNvbnRlbnQnKTsKICAgIHZhciAkYWN0aW9ucyA9ICRlbGVtZW50LmNoaWxkcmVuKCcubWR1aS1kaWFsb2ctYWN0aW9ucycpOyAvLyDosIPmlbQgZGlhbG9nIOeahCB0b3Ag5ZKMIGhlaWdodCDlgLwKCiAgICAkZWxlbWVudC5oZWlnaHQoJycpOwogICAgJGNvbnRlbnQuaGVpZ2h0KCcnKTsKICAgIHZhciBlbGVtZW50SGVpZ2h0ID0gJGVsZW1lbnQuaGVpZ2h0KCk7CiAgICAkZWxlbWVudC5jc3MoewogICAgICB0b3A6ICgkd2luZG93LmhlaWdodCgpIC0gZWxlbWVudEhlaWdodCkgLyAyICsgInB4IiwKICAgICAgaGVpZ2h0OiBlbGVtZW50SGVpZ2h0ICsgInB4IgogICAgfSk7IC8vIOiwg+aVtCBtZHVpLWRpYWxvZy1jb250ZW50IOeahOmrmOW6pgoKICAgICRjb250ZW50LmlubmVySGVpZ2h0KGVsZW1lbnRIZWlnaHQgLSAoJHRpdGxlLmlubmVySGVpZ2h0KCkgfHwgMCkgLSAoJGFjdGlvbnMuaW5uZXJIZWlnaHQoKSB8fCAwKSk7CiAgfTsKICAvKioKICAgKiBoYXNoY2hhbmdlIOS6i+S7tuinpuWPkeaXtuWFs+mXreWvueivneahhgogICAqLwoKCiAgRGlhbG9nLnByb3RvdHlwZS5oYXNoY2hhbmdlRXZlbnQgPSBmdW5jdGlvbiBoYXNoY2hhbmdlRXZlbnQoKSB7CiAgICBpZiAod2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpLmluZGV4T2YoJ21kdWktZGlhbG9nJykgPCAwKSB7CiAgICAgIGN1cnJlbnRJbnN0LmNsb3NlKHRydWUpOwogICAgfQogIH07CiAgLyoqCiAgICog54K55Ye76YGu572p5bGC5YWz6Zet5a+56K+d5qGGCiAgICogQHBhcmFtIGV2ZW50CiAgICovCgoKICBEaWFsb2cucHJvdG90eXBlLm92ZXJsYXlDbGljayA9IGZ1bmN0aW9uIG92ZXJsYXlDbGljayhldmVudCkgewogICAgaWYgKCQoZXZlbnQudGFyZ2V0KS5oYXNDbGFzcygnbWR1aS1vdmVybGF5JykgJiYgY3VycmVudEluc3QpIHsKICAgICAgY3VycmVudEluc3QuY2xvc2UoKTsKICAgIH0KICB9OwogIC8qKgogICAqIOWKqOeUu+e7k+adn+WbnuiwgwogICAqLwoKCiAgRGlhbG9nLnByb3RvdHlwZS50cmFuc2l0aW9uRW5kID0gZnVuY3Rpb24gdHJhbnNpdGlvbkVuZCgpIHsKICAgIGlmICh0aGlzLiRlbGVtZW50Lmhhc0NsYXNzKCdtZHVpLWRpYWxvZy1vcGVuJykpIHsKICAgICAgdGhpcy5zdGF0ZSA9ICdvcGVuZWQnOwogICAgICB0aGlzLnRyaWdnZXJFdmVudCgnb3BlbmVkJyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICAgIHRoaXMudHJpZ2dlckV2ZW50KCdjbG9zZWQnKTsKICAgICAgdGhpcy4kZWxlbWVudC5oaWRlKCk7IC8vIOaJgOacieWvueivneahhumDveWFs+mXre+8jOS4lOW9k+WJjeayoeacieaJk+W8gOeahOWvueivneahhuaXtu+8jOino+mUgeWxj+W5lQoKICAgICAgaWYgKCFxdWV1ZShxdWV1ZU5hbWUpLmxlbmd0aCAmJiAhY3VycmVudEluc3QgJiYgaXNMb2NrU2NyZWVuKSB7CiAgICAgICAgJC51bmxvY2tTY3JlZW4oKTsKICAgICAgICBpc0xvY2tTY3JlZW4gPSBmYWxzZTsKICAgICAgfQoKICAgICAgJHdpbmRvdy5vZmYoJ3Jlc2l6ZScsICQudGhyb3R0bGUodGhpcy5yZWFkanVzdCwgMTAwKSk7CgogICAgICBpZiAodGhpcy5vcHRpb25zLmRlc3Ryb3lPbkNsb3NlZCkgewogICAgICAgIHRoaXMuZGVzdHJveSgpOwogICAgICB9CiAgICB9CiAgfTsKICAvKioKICAgKiDmiZPlvIDmjIflrprlr7nor53moYYKICAgKi8KCgogIERpYWxvZy5wcm90b3R5cGUuZG9PcGVuID0gZnVuY3Rpb24gZG9PcGVuKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CiAgICBjdXJyZW50SW5zdCA9IHRoaXM7CgogICAgaWYgKCFpc0xvY2tTY3JlZW4pIHsKICAgICAgJC5sb2NrU2NyZWVuKCk7CiAgICAgIGlzTG9ja1NjcmVlbiA9IHRydWU7CiAgICB9CgogICAgdGhpcy4kZWxlbWVudC5zaG93KCk7CiAgICB0aGlzLnJlYWRqdXN0KCk7CiAgICAkd2luZG93Lm9uKCdyZXNpemUnLCAkLnRocm90dGxlKHRoaXMucmVhZGp1c3QsIDEwMCkpOyAvLyDmiZPlvIDmtojmga/moYYKCiAgICB0aGlzLnN0YXRlID0gJ29wZW5pbmcnOwogICAgdGhpcy50cmlnZ2VyRXZlbnQoJ29wZW4nKTsKICAgIHRoaXMuJGVsZW1lbnQuYWRkQ2xhc3MoJ21kdWktZGlhbG9nLW9wZW4nKS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMkMS50cmFuc2l0aW9uRW5kKCk7CiAgICB9KTsgLy8g5LiN5a2Y5Zyo6YGu572p5bGC5YWD57Sg5pe277yM5re75Yqg6YGu572p5bGCCgogICAgaWYgKCEkb3ZlcmxheSkgewogICAgICAkb3ZlcmxheSA9ICQuc2hvd092ZXJsYXkoNTEwMCk7CiAgICB9IC8vIOeCueWHu+mBrue9qeWxguaXtuaYr+WQpuWFs+mXreWvueivneahhgoKCiAgICBpZiAodGhpcy5vcHRpb25zLm1vZGFsKSB7CiAgICAgICRvdmVybGF5Lm9mZignY2xpY2snLCB0aGlzLm92ZXJsYXlDbGljayk7CiAgICB9IGVsc2UgewogICAgICAkb3ZlcmxheS5vbignY2xpY2snLCB0aGlzLm92ZXJsYXlDbGljayk7CiAgICB9IC8vIOaYr+WQpuaYvuekuumBrue9qeWxgu+8jOS4jeaYvuekuuaXtu+8jOaKiumBrue9qeWxguiDjOaZr+mAj+aYjgoKCiAgICAkb3ZlcmxheS5jc3MoJ29wYWNpdHknLCB0aGlzLm9wdGlvbnMub3ZlcmxheSA/ICcnIDogMCk7CgogICAgaWYgKHRoaXMub3B0aW9ucy5oaXN0b3J5KSB7CiAgICAgIC8vIOWmguaenCBoYXNoIOS4reWOn+adpeWwseaciSBtZHVpLWRpYWxvZ++8jOWFiOWIoOmZpO+8jOmBv+WFjeWQjumAgOWOhuWPsue6quW9leWQjuS7jeeEtuaciSBtZHVpLWRpYWxvZyDlr7zoh7Tml6Dms5XlhbPpl60KICAgICAgLy8g5YyF5ousIG1kdWktZGlhbG9nIOWSjCAmbWR1aS1kaWFsb2cg5ZKMID9tZHVpLWRpYWxvZwogICAgICB2YXIgaGFzaCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoLnN1YnN0cmluZygxKTsKCiAgICAgIGlmIChoYXNoLmluZGV4T2YoJ21kdWktZGlhbG9nJykgPiAtMSkgewogICAgICAgIGhhc2ggPSBoYXNoLnJlcGxhY2UoL1smP10/bWR1aS1kaWFsb2cvZywgJycpOwogICAgICB9IC8vIOWQjumAgOaMiemSruWFs+mXreWvueivneahhgoKCiAgICAgIGlmIChoYXNoKSB7CiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSAiIiArIGhhc2ggKyAoaGFzaC5pbmRleE9mKCc/JykgPiAtMSA/ICcmJyA6ICc/JykgKyAibWR1aS1kaWFsb2ciOwogICAgICB9IGVsc2UgewogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gJ21kdWktZGlhbG9nJzsKICAgICAgfQoKICAgICAgJHdpbmRvdy5vbignaGFzaGNoYW5nZScsIHRoaXMuaGFzaGNoYW5nZUV2ZW50KTsKICAgIH0KICB9OwogIC8qKgogICAqIOW9k+WJjeWvueivneahhuaYr+WQpuS4uuaJk+W8gOeKtuaAgQogICAqLwoKCiAgRGlhbG9nLnByb3RvdHlwZS5pc09wZW4gPSBmdW5jdGlvbiBpc09wZW4oKSB7CiAgICByZXR1cm4gdGhpcy5zdGF0ZSA9PT0gJ29wZW5pbmcnIHx8IHRoaXMuc3RhdGUgPT09ICdvcGVuZWQnOwogIH07CiAgLyoqCiAgICog5omT5byA5a+56K+d5qGGCiAgICovCgoKICBEaWFsb2cucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbiBvcGVuKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CgogICAgaWYgKHRoaXMuaXNPcGVuKCkpIHsKICAgICAgcmV0dXJuOwogICAgfSAvLyDlpoLmnpzlvZPliY3mnInmraPlnKjmiZPlvIDmiJblt7Lnu4/miZPlvIDnmoTlr7nor53moYYs5oiW6Zif5YiX5LiN5Li656m677yM5YiZ5YWI5Yqg5YWl6Zif5YiX77yM562J5pen5a+56K+d5qGG5byA5aeL5YWz6Zet5pe25YaN5omT5byACgoKICAgIGlmIChjdXJyZW50SW5zdCAmJiAoY3VycmVudEluc3Quc3RhdGUgPT09ICdvcGVuaW5nJyB8fCBjdXJyZW50SW5zdC5zdGF0ZSA9PT0gJ29wZW5lZCcpIHx8IHF1ZXVlKHF1ZXVlTmFtZSkubGVuZ3RoKSB7CiAgICAgIHF1ZXVlKHF1ZXVlTmFtZSwgZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0aGlzJDEuZG9PcGVuKCk7CiAgICAgIH0pOwogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5kb09wZW4oKTsKICB9OwogIC8qKgogICAqIOWFs+mXreWvueivneahhgogICAqLwoKCiAgRGlhbG9nLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uIGNsb3NlKGhpc3RvcnlCYWNrKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgIGlmIChoaXN0b3J5QmFjayA9PT0gdm9pZCAwKSBoaXN0b3J5QmFjayA9IGZhbHNlOyAvLyBoaXN0b3J5QmFjayDmmK/lkKbpnIDopoHlkI7pgIDljoblj7LnuqrlvZXvvIzpu5jorqTkuLogYGZhbHNlYOOAguivpeWPguaVsOS7heWGhemDqOS9v+eUqAogICAgLy8g5Li6IGBmYWxzZWAg5pe25piv6YCa6L+HIGpzIOWFs+mXre+8jOmcgOimgeWQjumAgOS4gOS4quWOhuWPsuiusOW9lQogICAgLy8g5Li6IGB0cnVlYCDml7bmmK/pgJrov4flkI7pgIDmjInpkq7lhbPpl63vvIzkuI3pnIDopoHlkI7pgIDljoblj7LorrDlvZUKICAgIC8vIHNldFRpbWVvdXQg55qE5L2c55So5piv77yaCiAgICAvLyDlvZPlkIzml7blhbPpl63kuIDkuKrlr7nor53moYbvvIzlubbmiZPlvIDlj6bkuIDkuKrlr7nor53moYbml7bvvIzkvb/miZPlvIDlr7nor53moYbnmoTmk43kvZzlhYjmiafooYzvvIzku6Xkvb/pnIDopoHmiZPlvIDnmoTlr7nor53moYblhYjliqDlhaXpmJ/liJcKCiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCF0aGlzJDEuaXNPcGVuKCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGN1cnJlbnRJbnN0ID0gbnVsbDsKICAgICAgdGhpcyQxLnN0YXRlID0gJ2Nsb3NpbmcnOwogICAgICB0aGlzJDEudHJpZ2dlckV2ZW50KCdjbG9zZScpOyAvLyDmiYDmnInlr7nor53moYbpg73lhbPpl63vvIzkuJTlvZPliY3msqHmnInmiZPlvIDnmoTlr7nor53moYbml7bvvIzpmpDol4/pga7nvakKCiAgICAgIGlmICghcXVldWUocXVldWVOYW1lKS5sZW5ndGggJiYgJG92ZXJsYXkpIHsKICAgICAgICAkLmhpZGVPdmVybGF5KCk7CiAgICAgICAgJG92ZXJsYXkgPSBudWxsOyAvLyDoi6Xku43lrZjlnKjpga7nvanvvIzmgaLlpI3pga7nvannmoQgei1pbmRleAoKICAgICAgICAkKCcubWR1aS1vdmVybGF5JykuY3NzKCd6LWluZGV4JywgMjAwMCk7CiAgICAgIH0KCiAgICAgIHRoaXMkMS4kZWxlbWVudC5yZW1vdmVDbGFzcygnbWR1aS1kaWFsb2ctb3BlbicpLnRyYW5zaXRpb25FbmQoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0aGlzJDEudHJhbnNpdGlvbkVuZCgpOwogICAgICB9KTsKCiAgICAgIGlmICh0aGlzJDEub3B0aW9ucy5oaXN0b3J5ICYmICFxdWV1ZShxdWV1ZU5hbWUpLmxlbmd0aCkgewogICAgICAgIGlmICghaGlzdG9yeUJhY2spIHsKICAgICAgICAgIHdpbmRvdy5oaXN0b3J5LmJhY2soKTsKICAgICAgICB9CgogICAgICAgICR3aW5kb3cub2ZmKCdoYXNoY2hhbmdlJywgdGhpcyQxLmhhc2hjaGFuZ2VFdmVudCk7CiAgICAgIH0gLy8g5YWz6Zet5pen5a+56K+d5qGG77yM5omT5byA5paw5a+56K+d5qGG44CCCiAgICAgIC8vIOWKoOS4gOeCueW7tui/n++8jOS7heS7heS4uuS6huinhuinieaViOaenOabtOWlveOAguS4jeWKoOW7tuaXtuS5n+S4jeW9seWTjeWKn+iDvQoKCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIGRlcXVldWUocXVldWVOYW1lKTsKICAgICAgfSwgMTAwKTsKICAgIH0pOwogIH07CiAgLyoqCiAgICog5YiH5o2i5a+56K+d5qGG5omT5byAL+WFs+mXreeKtuaAgQogICAqLwoKCiAgRGlhbG9nLnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbiB0b2dnbGUoKSB7CiAgICB0aGlzLmlzT3BlbigpID8gdGhpcy5jbG9zZSgpIDogdGhpcy5vcGVuKCk7CiAgfTsKICAvKioKICAgKiDojrflj5blr7nor53moYbnirbmgIHjgILlhbHljIXlkKvlm5vnp43nirbmgIHvvJpgb3BlbmluZ2DjgIFgb3BlbmVkYOOAgWBjbG9zaW5nYOOAgWBjbG9zZWRgCiAgICovCgoKICBEaWFsb2cucHJvdG90eXBlLmdldFN0YXRlID0gZnVuY3Rpb24gZ2V0U3RhdGUoKSB7CiAgICByZXR1cm4gdGhpcy5zdGF0ZTsKICB9OwogIC8qKgogICAqIOmUgOavgeWvueivneahhgogICAqLwoKCiAgRGlhbG9nLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gZGVzdHJveSgpIHsKICAgIGlmICh0aGlzLmFwcGVuZCkgewogICAgICB0aGlzLiRlbGVtZW50LnJlbW92ZSgpOwogICAgfQoKICAgIGlmICghcXVldWUocXVldWVOYW1lKS5sZW5ndGggJiYgIWN1cnJlbnRJbnN0KSB7CiAgICAgIGlmICgkb3ZlcmxheSkgewogICAgICAgICQuaGlkZU92ZXJsYXkoKTsKICAgICAgICAkb3ZlcmxheSA9IG51bGw7CiAgICAgIH0KCiAgICAgIGlmIChpc0xvY2tTY3JlZW4pIHsKICAgICAgICAkLnVubG9ja1NjcmVlbigpOwogICAgICAgIGlzTG9ja1NjcmVlbiA9IGZhbHNlOwogICAgICB9CiAgICB9CiAgfTsKICAvKioKICAgKiDlr7nor53moYblhoXlrrnlj5jljJbml7bvvIzpnIDopoHosIPnlKjor6Xmlrnms5XmnaXosIPmlbTlr7nor53moYbkvY3nva7lkozmu5rliqjmnaHpq5jluqYKICAgKi8KCgogIERpYWxvZy5wcm90b3R5cGUuaGFuZGxlVXBkYXRlID0gZnVuY3Rpb24gaGFuZGxlVXBkYXRlKCkgewogICAgdGhpcy5yZWFkanVzdCgpOwogIH07IC8vIGVzYyDmjInkuIvml7blhbPpl63lr7nor53moYYKCgogICRkb2N1bWVudC5vbigna2V5ZG93bicsIGZ1bmN0aW9uIChldmVudCkgewogICAgaWYgKGN1cnJlbnRJbnN0ICYmIGN1cnJlbnRJbnN0Lm9wdGlvbnMuY2xvc2VPbkVzYyAmJiBjdXJyZW50SW5zdC5zdGF0ZSA9PT0gJ29wZW5lZCcgJiYgZXZlbnQua2V5Q29kZSA9PT0gMjcpIHsKICAgICAgY3VycmVudEluc3QuY2xvc2UoKTsKICAgIH0KICB9KTsKICBtZHVpLkRpYWxvZyA9IERpYWxvZzsKICB2YXIgY3VzdG9tQXR0ciQ3ID0gJ21kdWktZGlhbG9nJzsKICB2YXIgZGF0YU5hbWUkMSA9ICdfbWR1aV9kaWFsb2cnOwogICQoZnVuY3Rpb24gKCkgewogICAgJGRvY3VtZW50Lm9uKCdjbGljaycsICJbIiArIGN1c3RvbUF0dHIkNyArICJdIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgb3B0aW9ucyA9IHBhcnNlT3B0aW9ucyh0aGlzLCBjdXN0b21BdHRyJDcpOwogICAgICB2YXIgc2VsZWN0b3IgPSBvcHRpb25zLnRhcmdldDsgLy8gQHRzLWlnbm9yZQoKICAgICAgZGVsZXRlIG9wdGlvbnMudGFyZ2V0OwogICAgICB2YXIgJGRpYWxvZyA9ICQoc2VsZWN0b3IpLmZpcnN0KCk7CiAgICAgIHZhciBpbnN0YW5jZSA9ICRkaWFsb2cuZGF0YShkYXRhTmFtZSQxKTsKCiAgICAgIGlmICghaW5zdGFuY2UpIHsKICAgICAgICBpbnN0YW5jZSA9IG5ldyBtZHVpLkRpYWxvZygkZGlhbG9nLCBvcHRpb25zKTsKICAgICAgICAkZGlhbG9nLmRhdGEoZGF0YU5hbWUkMSwgaW5zdGFuY2UpOwogICAgICB9CgogICAgICBpbnN0YW5jZS5vcGVuKCk7CiAgICB9KTsKICB9KTsKICB2YXIgREVGQVVMVF9CVVRUT04gPSB7CiAgICB0ZXh0OiAnJywKICAgIGJvbGQ6IGZhbHNlLAogICAgY2xvc2U6IHRydWUsCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uCiAgICBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7fQogIH07CiAgdmFyIERFRkFVTFRfT1BUSU9OUyQ3ID0gewogICAgdGl0bGU6ICcnLAogICAgY29udGVudDogJycsCiAgICBidXR0b25zOiBbXSwKICAgIHN0YWNrZWRCdXR0b25zOiBmYWxzZSwKICAgIGNzc0NsYXNzOiAnJywKICAgIGhpc3Rvcnk6IHRydWUsCiAgICBvdmVybGF5OiB0cnVlLAogICAgbW9kYWw6IGZhbHNlLAogICAgY2xvc2VPbkVzYzogdHJ1ZSwKICAgIGRlc3Ryb3lPbkNsb3NlZDogdHJ1ZSwKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb24KICAgIG9uT3BlbjogZnVuY3Rpb24gKCkge30sCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uCiAgICBvbk9wZW5lZDogZnVuY3Rpb24gKCkge30sCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uCiAgICBvbkNsb3NlOiBmdW5jdGlvbiAoKSB7fSwKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb24KICAgIG9uQ2xvc2VkOiBmdW5jdGlvbiAoKSB7fQogIH07CgogIG1kdWkuZGlhbG9nID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKICAgIHZhciBfYSwgX2I7IC8vIOWQiOW5tumFjee9ruWPguaVsAoKCiAgICBvcHRpb25zID0gZXh0ZW5kKHt9LCBERUZBVUxUX09QVElPTlMkNywgb3B0aW9ucyk7CiAgICBlYWNoKG9wdGlvbnMuYnV0dG9ucywgZnVuY3Rpb24gKGksIGJ1dHRvbikgewogICAgICBvcHRpb25zLmJ1dHRvbnNbaV0gPSBleHRlbmQoe30sIERFRkFVTFRfQlVUVE9OLCBidXR0b24pOwogICAgfSk7IC8vIOaMiemSrueahCBIVE1MCgogICAgdmFyIGJ1dHRvbnNIVE1MID0gJyc7CgogICAgaWYgKChfYSA9IG9wdGlvbnMuYnV0dG9ucykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmxlbmd0aCkgewogICAgICBidXR0b25zSFRNTCA9ICI8ZGl2IGNsYXNzPVwibWR1aS1kaWFsb2ctYWN0aW9ucyIgKyAob3B0aW9ucy5zdGFja2VkQnV0dG9ucyA/ICcgbWR1aS1kaWFsb2ctYWN0aW9ucy1zdGFja2VkJyA6ICcnKSArICJcIj4iOwogICAgICBlYWNoKG9wdGlvbnMuYnV0dG9ucywgZnVuY3Rpb24gKF8sIGJ1dHRvbikgewogICAgICAgIGJ1dHRvbnNIVE1MICs9ICc8YSBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCkiICcgKyAiY2xhc3M9XCJtZHVpLWJ0biBtZHVpLXJpcHBsZSBtZHVpLXRleHQtY29sb3ItcHJpbWFyeSAiICsgKGJ1dHRvbi5ib2xkID8gJ21kdWktYnRuLWJvbGQnIDogJycpICsgIlwiPiIgKyBidXR0b24udGV4dCArICI8L2E+IjsKICAgICAgfSk7CiAgICAgIGJ1dHRvbnNIVE1MICs9ICc8L2Rpdj4nOwogICAgfSAvLyBEaWFsb2cg55qEIEhUTUwKCgogICAgdmFyIEhUTUwgPSAiPGRpdiBjbGFzcz1cIm1kdWktZGlhbG9nICIgKyBvcHRpb25zLmNzc0NsYXNzICsgIlwiPiIgKyAob3B0aW9ucy50aXRsZSA/ICI8ZGl2IGNsYXNzPVwibWR1aS1kaWFsb2ctdGl0bGVcIj4iICsgb3B0aW9ucy50aXRsZSArICI8L2Rpdj4iIDogJycpICsgKG9wdGlvbnMuY29udGVudCA/ICI8ZGl2IGNsYXNzPVwibWR1aS1kaWFsb2ctY29udGVudFwiPiIgKyBvcHRpb25zLmNvbnRlbnQgKyAiPC9kaXY+IiA6ICcnKSArIGJ1dHRvbnNIVE1MICsgJzwvZGl2Pic7IC8vIOWunuS+i+WMliBEaWFsb2cKCiAgICB2YXIgaW5zdGFuY2UgPSBuZXcgbWR1aS5EaWFsb2coSFRNTCwgewogICAgICBoaXN0b3J5OiBvcHRpb25zLmhpc3RvcnksCiAgICAgIG92ZXJsYXk6IG9wdGlvbnMub3ZlcmxheSwKICAgICAgbW9kYWw6IG9wdGlvbnMubW9kYWwsCiAgICAgIGNsb3NlT25Fc2M6IG9wdGlvbnMuY2xvc2VPbkVzYywKICAgICAgZGVzdHJveU9uQ2xvc2VkOiBvcHRpb25zLmRlc3Ryb3lPbkNsb3NlZAogICAgfSk7IC8vIOe7keWumuaMiemSruS6i+S7tgoKICAgIGlmICgoX2IgPSBvcHRpb25zLmJ1dHRvbnMpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5sZW5ndGgpIHsKICAgICAgaW5zdGFuY2UuJGVsZW1lbnQuZmluZCgnLm1kdWktZGlhbG9nLWFjdGlvbnMgLm1kdWktYnRuJykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGJ1dHRvbikgewogICAgICAgICQoYnV0dG9uKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBvcHRpb25zLmJ1dHRvbnNbaW5kZXhdLm9uQ2xpY2soaW5zdGFuY2UpOwoKICAgICAgICAgIGlmIChvcHRpb25zLmJ1dHRvbnNbaW5kZXhdLmNsb3NlKSB7CiAgICAgICAgICAgIGluc3RhbmNlLmNsb3NlKCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSAvLyDnu5HlrprmiZPlvIDlhbPpl63kuovku7YKCgogICAgaW5zdGFuY2UuJGVsZW1lbnQub24oJ29wZW4ubWR1aS5kaWFsb2cnLCBmdW5jdGlvbiAoKSB7CiAgICAgIG9wdGlvbnMub25PcGVuKGluc3RhbmNlKTsKICAgIH0pLm9uKCdvcGVuZWQubWR1aS5kaWFsb2cnLCBmdW5jdGlvbiAoKSB7CiAgICAgIG9wdGlvbnMub25PcGVuZWQoaW5zdGFuY2UpOwogICAgfSkub24oJ2Nsb3NlLm1kdWkuZGlhbG9nJywgZnVuY3Rpb24gKCkgewogICAgICBvcHRpb25zLm9uQ2xvc2UoaW5zdGFuY2UpOwogICAgfSkub24oJ2Nsb3NlZC5tZHVpLmRpYWxvZycsIGZ1bmN0aW9uICgpIHsKICAgICAgb3B0aW9ucy5vbkNsb3NlZChpbnN0YW5jZSk7CiAgICB9KTsKICAgIGluc3RhbmNlLm9wZW4oKTsKICAgIHJldHVybiBpbnN0YW5jZTsKICB9OwoKICB2YXIgREVGQVVMVF9PUFRJT05TJDggPSB7CiAgICBjb25maXJtVGV4dDogJ29rJywKICAgIGhpc3Rvcnk6IHRydWUsCiAgICBtb2RhbDogZmFsc2UsCiAgICBjbG9zZU9uRXNjOiB0cnVlLAogICAgY2xvc2VPbkNvbmZpcm06IHRydWUKICB9OwoKICBtZHVpLmFsZXJ0ID0gZnVuY3Rpb24gKHRleHQsIHRpdGxlLCBvbkNvbmZpcm0sIG9wdGlvbnMpIHsKICAgIGlmIChpc0Z1bmN0aW9uKHRpdGxlKSkgewogICAgICBvcHRpb25zID0gb25Db25maXJtOwogICAgICBvbkNvbmZpcm0gPSB0aXRsZTsKICAgICAgdGl0bGUgPSAnJzsKICAgIH0KCiAgICBpZiAoaXNVbmRlZmluZWQob25Db25maXJtKSkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uCiAgICAgIG9uQ29uZmlybSA9IGZ1bmN0aW9uICgpIHt9OwogICAgfQoKICAgIGlmIChpc1VuZGVmaW5lZChvcHRpb25zKSkgewogICAgICBvcHRpb25zID0ge307CiAgICB9CgogICAgb3B0aW9ucyA9IGV4dGVuZCh7fSwgREVGQVVMVF9PUFRJT05TJDgsIG9wdGlvbnMpOwogICAgcmV0dXJuIG1kdWkuZGlhbG9nKHsKICAgICAgdGl0bGU6IHRpdGxlLAogICAgICBjb250ZW50OiB0ZXh0LAogICAgICBidXR0b25zOiBbewogICAgICAgIHRleHQ6IG9wdGlvbnMuY29uZmlybVRleHQsCiAgICAgICAgYm9sZDogZmFsc2UsCiAgICAgICAgY2xvc2U6IG9wdGlvbnMuY2xvc2VPbkNvbmZpcm0sCiAgICAgICAgb25DbGljazogb25Db25maXJtCiAgICAgIH1dLAogICAgICBjc3NDbGFzczogJ21kdWktZGlhbG9nLWFsZXJ0JywKICAgICAgaGlzdG9yeTogb3B0aW9ucy5oaXN0b3J5LAogICAgICBtb2RhbDogb3B0aW9ucy5tb2RhbCwKICAgICAgY2xvc2VPbkVzYzogb3B0aW9ucy5jbG9zZU9uRXNjCiAgICB9KTsKICB9OwoKICB2YXIgREVGQVVMVF9PUFRJT05TJDkgPSB7CiAgICBjb25maXJtVGV4dDogJ29rJywKICAgIGNhbmNlbFRleHQ6ICdjYW5jZWwnLAogICAgaGlzdG9yeTogdHJ1ZSwKICAgIG1vZGFsOiBmYWxzZSwKICAgIGNsb3NlT25Fc2M6IHRydWUsCiAgICBjbG9zZU9uQ2FuY2VsOiB0cnVlLAogICAgY2xvc2VPbkNvbmZpcm06IHRydWUKICB9OwoKICBtZHVpLmNvbmZpcm0gPSBmdW5jdGlvbiAodGV4dCwgdGl0bGUsIG9uQ29uZmlybSwgb25DYW5jZWwsIG9wdGlvbnMpIHsKICAgIGlmIChpc0Z1bmN0aW9uKHRpdGxlKSkgewogICAgICBvcHRpb25zID0gb25DYW5jZWw7CiAgICAgIG9uQ2FuY2VsID0gb25Db25maXJtOwogICAgICBvbkNvbmZpcm0gPSB0aXRsZTsKICAgICAgdGl0bGUgPSAnJzsKICAgIH0KCiAgICBpZiAoaXNVbmRlZmluZWQob25Db25maXJtKSkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uCiAgICAgIG9uQ29uZmlybSA9IGZ1bmN0aW9uICgpIHt9OwogICAgfQoKICAgIGlmIChpc1VuZGVmaW5lZChvbkNhbmNlbCkpIHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvbgogICAgICBvbkNhbmNlbCA9IGZ1bmN0aW9uICgpIHt9OwogICAgfQoKICAgIGlmIChpc1VuZGVmaW5lZChvcHRpb25zKSkgewogICAgICBvcHRpb25zID0ge307CiAgICB9CgogICAgb3B0aW9ucyA9IGV4dGVuZCh7fSwgREVGQVVMVF9PUFRJT05TJDksIG9wdGlvbnMpOwogICAgcmV0dXJuIG1kdWkuZGlhbG9nKHsKICAgICAgdGl0bGU6IHRpdGxlLAogICAgICBjb250ZW50OiB0ZXh0LAogICAgICBidXR0b25zOiBbewogICAgICAgIHRleHQ6IG9wdGlvbnMuY2FuY2VsVGV4dCwKICAgICAgICBib2xkOiBmYWxzZSwKICAgICAgICBjbG9zZTogb3B0aW9ucy5jbG9zZU9uQ2FuY2VsLAogICAgICAgIG9uQ2xpY2s6IG9uQ2FuY2VsCiAgICAgIH0sIHsKICAgICAgICB0ZXh0OiBvcHRpb25zLmNvbmZpcm1UZXh0LAogICAgICAgIGJvbGQ6IGZhbHNlLAogICAgICAgIGNsb3NlOiBvcHRpb25zLmNsb3NlT25Db25maXJtLAogICAgICAgIG9uQ2xpY2s6IG9uQ29uZmlybQogICAgICB9XSwKICAgICAgY3NzQ2xhc3M6ICdtZHVpLWRpYWxvZy1jb25maXJtJywKICAgICAgaGlzdG9yeTogb3B0aW9ucy5oaXN0b3J5LAogICAgICBtb2RhbDogb3B0aW9ucy5tb2RhbCwKICAgICAgY2xvc2VPbkVzYzogb3B0aW9ucy5jbG9zZU9uRXNjCiAgICB9KTsKICB9OwoKICB2YXIgREVGQVVMVF9PUFRJT05TJGEgPSB7CiAgICBjb25maXJtVGV4dDogJ29rJywKICAgIGNhbmNlbFRleHQ6ICdjYW5jZWwnLAogICAgaGlzdG9yeTogdHJ1ZSwKICAgIG1vZGFsOiBmYWxzZSwKICAgIGNsb3NlT25Fc2M6IHRydWUsCiAgICBjbG9zZU9uQ2FuY2VsOiB0cnVlLAogICAgY2xvc2VPbkNvbmZpcm06IHRydWUsCiAgICB0eXBlOiAndGV4dCcsCiAgICBtYXhsZW5ndGg6IDAsCiAgICBkZWZhdWx0VmFsdWU6ICcnLAogICAgY29uZmlybU9uRW50ZXI6IGZhbHNlCiAgfTsKCiAgbWR1aS5wcm9tcHQgPSBmdW5jdGlvbiAobGFiZWwsIHRpdGxlLCBvbkNvbmZpcm0sIG9uQ2FuY2VsLCBvcHRpb25zKSB7CiAgICBpZiAoaXNGdW5jdGlvbih0aXRsZSkpIHsKICAgICAgb3B0aW9ucyA9IG9uQ2FuY2VsOwogICAgICBvbkNhbmNlbCA9IG9uQ29uZmlybTsKICAgICAgb25Db25maXJtID0gdGl0bGU7CiAgICAgIHRpdGxlID0gJyc7CiAgICB9CgogICAgaWYgKGlzVW5kZWZpbmVkKG9uQ29uZmlybSkpIHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvbgogICAgICBvbkNvbmZpcm0gPSBmdW5jdGlvbiAoKSB7fTsKICAgIH0KCiAgICBpZiAoaXNVbmRlZmluZWQob25DYW5jZWwpKSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb24KICAgICAgb25DYW5jZWwgPSBmdW5jdGlvbiAoKSB7fTsKICAgIH0KCiAgICBpZiAoaXNVbmRlZmluZWQob3B0aW9ucykpIHsKICAgICAgb3B0aW9ucyA9IHt9OwogICAgfQoKICAgIG9wdGlvbnMgPSBleHRlbmQoe30sIERFRkFVTFRfT1BUSU9OUyRhLCBvcHRpb25zKTsKICAgIHZhciBjb250ZW50ID0gJzxkaXYgY2xhc3M9Im1kdWktdGV4dGZpZWxkIj4nICsgKGxhYmVsID8gIjxsYWJlbCBjbGFzcz1cIm1kdWktdGV4dGZpZWxkLWxhYmVsXCI+IiArIGxhYmVsICsgIjwvbGFiZWw+IiA6ICcnKSArIChvcHRpb25zLnR5cGUgPT09ICd0ZXh0JyA/ICI8aW5wdXQgY2xhc3M9XCJtZHVpLXRleHRmaWVsZC1pbnB1dFwiIHR5cGU9XCJ0ZXh0XCIgdmFsdWU9XCIiICsgb3B0aW9ucy5kZWZhdWx0VmFsdWUgKyAiXCIgIiArIChvcHRpb25zLm1heGxlbmd0aCA/ICdtYXhsZW5ndGg9IicgKyBvcHRpb25zLm1heGxlbmd0aCArICciJyA6ICcnKSArICIvPiIgOiAnJykgKyAob3B0aW9ucy50eXBlID09PSAndGV4dGFyZWEnID8gIjx0ZXh0YXJlYSBjbGFzcz1cIm1kdWktdGV4dGZpZWxkLWlucHV0XCIgIiArIChvcHRpb25zLm1heGxlbmd0aCA/ICdtYXhsZW5ndGg9IicgKyBvcHRpb25zLm1heGxlbmd0aCArICciJyA6ICcnKSArICI+IiArIG9wdGlvbnMuZGVmYXVsdFZhbHVlICsgIjwvdGV4dGFyZWE+IiA6ICcnKSArICc8L2Rpdj4nOwoKICAgIHZhciBvbkNhbmNlbENsaWNrID0gZnVuY3Rpb24gKGRpYWxvZykgewogICAgICB2YXIgdmFsdWUgPSBkaWFsb2cuJGVsZW1lbnQuZmluZCgnLm1kdWktdGV4dGZpZWxkLWlucHV0JykudmFsKCk7CiAgICAgIG9uQ2FuY2VsKHZhbHVlLCBkaWFsb2cpOwogICAgfTsKCiAgICB2YXIgb25Db25maXJtQ2xpY2sgPSBmdW5jdGlvbiAoZGlhbG9nKSB7CiAgICAgIHZhciB2YWx1ZSA9IGRpYWxvZy4kZWxlbWVudC5maW5kKCcubWR1aS10ZXh0ZmllbGQtaW5wdXQnKS52YWwoKTsKICAgICAgb25Db25maXJtKHZhbHVlLCBkaWFsb2cpOwogICAgfTsKCiAgICByZXR1cm4gbWR1aS5kaWFsb2coewogICAgICB0aXRsZTogdGl0bGUsCiAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsCiAgICAgIGJ1dHRvbnM6IFt7CiAgICAgICAgdGV4dDogb3B0aW9ucy5jYW5jZWxUZXh0LAogICAgICAgIGJvbGQ6IGZhbHNlLAogICAgICAgIGNsb3NlOiBvcHRpb25zLmNsb3NlT25DYW5jZWwsCiAgICAgICAgb25DbGljazogb25DYW5jZWxDbGljawogICAgICB9LCB7CiAgICAgICAgdGV4dDogb3B0aW9ucy5jb25maXJtVGV4dCwKICAgICAgICBib2xkOiBmYWxzZSwKICAgICAgICBjbG9zZTogb3B0aW9ucy5jbG9zZU9uQ29uZmlybSwKICAgICAgICBvbkNsaWNrOiBvbkNvbmZpcm1DbGljawogICAgICB9XSwKICAgICAgY3NzQ2xhc3M6ICdtZHVpLWRpYWxvZy1wcm9tcHQnLAogICAgICBoaXN0b3J5OiBvcHRpb25zLmhpc3RvcnksCiAgICAgIG1vZGFsOiBvcHRpb25zLm1vZGFsLAogICAgICBjbG9zZU9uRXNjOiBvcHRpb25zLmNsb3NlT25Fc2MsCiAgICAgIG9uT3BlbjogZnVuY3Rpb24gKGRpYWxvZykgewogICAgICAgIC8vIOWIneWni+WMlui+k+WFpeahhgogICAgICAgIHZhciAkaW5wdXQgPSBkaWFsb2cuJGVsZW1lbnQuZmluZCgnLm1kdWktdGV4dGZpZWxkLWlucHV0Jyk7CiAgICAgICAgbWR1aS51cGRhdGVUZXh0RmllbGRzKCRpbnB1dCk7IC8vIOiBmueEpuWIsOi+k+WFpeahhgoKICAgICAgICAkaW5wdXRbMF0uZm9jdXMoKTsgLy8g5o2V5o2J5paH5pys5qGG5Zue6L2m6ZSu77yM5Zyo5Y2V6KGM5paH5pys5qGG55qE5oOF5Ya15LiL6Kem5Y+R5Zue6LCDCgogICAgICAgIGlmIChvcHRpb25zLnR5cGUgIT09ICd0ZXh0YXJlYScgJiYgb3B0aW9ucy5jb25maXJtT25FbnRlciA9PT0gdHJ1ZSkgewogICAgICAgICAgJGlucHV0Lm9uKCdrZXlkb3duJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAxMykgewogICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGRpYWxvZy4kZWxlbWVudC5maW5kKCcubWR1aS10ZXh0ZmllbGQtaW5wdXQnKS52YWwoKTsKICAgICAgICAgICAgICBvbkNvbmZpcm0odmFsdWUsIGRpYWxvZyk7CgogICAgICAgICAgICAgIGlmIChvcHRpb25zLmNsb3NlT25Db25maXJtKSB7CiAgICAgICAgICAgICAgICBkaWFsb2cuY2xvc2UoKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfSk7CiAgICAgICAgfSAvLyDlpoLmnpzmmK/lpJrooYzovpPlhaXmoYbvvIznm5HlkKzovpPlhaXmoYbnmoQgaW5wdXQg5LqL5Lu277yM5pu05paw5a+56K+d5qGG6auY5bqmCgoKICAgICAgICBpZiAob3B0aW9ucy50eXBlID09PSAndGV4dGFyZWEnKSB7CiAgICAgICAgICAkaW5wdXQub24oJ2lucHV0JywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gZGlhbG9nLmhhbmRsZVVwZGF0ZSgpOwogICAgICAgICAgfSk7CiAgICAgICAgfSAvLyDmnInlrZfnrKbmlbDpmZDliLbml7bvvIzliqDovb3lrozmlofmnKzmoYblkI4gRE9NIOS8muWPmOWMlu+8jOmcgOimgeabtOaWsOWvueivneahhumrmOW6pgoKCiAgICAgICAgaWYgKG9wdGlvbnMubWF4bGVuZ3RoKSB7CiAgICAgICAgICBkaWFsb2cuaGFuZGxlVXBkYXRlKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9OwoKICB2YXIgREVGQVVMVF9PUFRJT05TJGIgPSB7CiAgICBwb3NpdGlvbjogJ2F1dG8nLAogICAgZGVsYXk6IDAsCiAgICBjb250ZW50OiAnJwogIH07CgogIHZhciBUb29sdGlwID0gZnVuY3Rpb24gVG9vbHRpcChzZWxlY3Rvciwgb3B0aW9ucykgewogICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgb3B0aW9ucyA9IHt9OwogICAgLyoqCiAgICAgKiDphY3nva7lj4LmlbAKICAgICAqLwoKICAgIHRoaXMub3B0aW9ucyA9IGV4dGVuZCh7fSwgREVGQVVMVF9PUFRJT05TJGIpOwogICAgLyoqCiAgICAgKiDlvZPliY0gdG9vbHRpcCDnmoTnirbmgIEKICAgICAqLwoKICAgIHRoaXMuc3RhdGUgPSAnY2xvc2VkJzsKICAgIC8qKgogICAgICogc2V0VGltZW91dCDnmoTov5Tlm57lgLwKICAgICAqLwoKICAgIHRoaXMudGltZW91dElkID0gbnVsbDsKICAgIHRoaXMuJHRhcmdldCA9ICQoc2VsZWN0b3IpLmZpcnN0KCk7CiAgICBleHRlbmQodGhpcy5vcHRpb25zLCBvcHRpb25zKTsgLy8g5Yib5bu6IFRvb2x0aXAgSFRNTAoKICAgIHRoaXMuJGVsZW1lbnQgPSAkKCI8ZGl2IGNsYXNzPVwibWR1aS10b29sdGlwXCIgaWQ9XCIiICsgJC5ndWlkKCkgKyAiXCI+IiArIHRoaXMub3B0aW9ucy5jb250ZW50ICsgIjwvZGl2PiIpLmFwcGVuZFRvKGRvY3VtZW50LmJvZHkpOyAvLyDnu5Hlrprkuovku7bjgILlhYPntKDlpITkuo4gZGlzYWJsZWQg54q25oCB5pe25peg5rOV6Kem5Y+R6byg5qCH5LqL5Lu277yM5Li65LqG57uf5LiA77yM5oqKIHRvdWNoIOS6i+S7tuS5n+emgeeUqAogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby10aGlzLWFsaWFzCgogICAgdmFyIHRoYXQgPSB0aGlzOwogICAgdGhpcy4kdGFyZ2V0Lm9uKCd0b3VjaHN0YXJ0IG1vdXNlZW50ZXInLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgaWYgKHRoYXQuaXNEaXNhYmxlZCh0aGlzKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCFpc0FsbG93KGV2ZW50KSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgcmVnaXN0ZXIoZXZlbnQpOwogICAgICB0aGF0Lm9wZW4oKTsKICAgIH0pLm9uKCd0b3VjaGVuZCBtb3VzZWxlYXZlJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIGlmICh0aGF0LmlzRGlzYWJsZWQodGhpcykpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghaXNBbGxvdyhldmVudCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoYXQuY2xvc2UoKTsKICAgIH0pLm9uKHVubG9ja0V2ZW50LCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgaWYgKHRoYXQuaXNEaXNhYmxlZCh0aGlzKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgcmVnaXN0ZXIoZXZlbnQpOwogICAgfSk7CiAgfTsKICAvKioKICAgKiDlhYPntKDmmK/lkKblt7LnpoHnlKgKICAgKiBAcGFyYW0gZWxlbWVudAogICAqLwoKCiAgVG9vbHRpcC5wcm90b3R5cGUuaXNEaXNhYmxlZCA9IGZ1bmN0aW9uIGlzRGlzYWJsZWQoZWxlbWVudCkgewogICAgcmV0dXJuIGVsZW1lbnQuZGlzYWJsZWQgfHwgJChlbGVtZW50KS5hdHRyKCdkaXNhYmxlZCcpICE9PSB1bmRlZmluZWQ7CiAgfTsKICAvKioKICAgKiDmmK/lkKbmmK/moYzpnaLorr7lpIcKICAgKi8KCgogIFRvb2x0aXAucHJvdG90eXBlLmlzRGVza3RvcCA9IGZ1bmN0aW9uIGlzRGVza3RvcCgpIHsKICAgIHJldHVybiAkd2luZG93LndpZHRoKCkgPiAxMDI0OwogIH07CiAgLyoqCiAgICog6K6+572uIFRvb2x0aXAg55qE5L2N572uCiAgICovCgoKICBUb29sdGlwLnByb3RvdHlwZS5zZXRQb3NpdGlvbiA9IGZ1bmN0aW9uIHNldFBvc2l0aW9uKCkgewogICAgdmFyIG1hcmdpbkxlZnQ7CiAgICB2YXIgbWFyZ2luVG9wOyAvLyDop6blj5HnmoTlhYPntKAKCiAgICB2YXIgdGFyZ2V0UHJvcHMgPSB0aGlzLiR0YXJnZXRbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7IC8vIOinpuWPkeeahOWFg+e0oOWSjCBUb29sdGlwIOS5i+mXtOeahOi3neemuwoKICAgIHZhciB0YXJnZXRNYXJnaW4gPSB0aGlzLmlzRGVza3RvcCgpID8gMTQgOiAyNDsgLy8gVG9vbHRpcCDnmoTlrr3luqblkozpq5jluqYKCiAgICB2YXIgdG9vbHRpcFdpZHRoID0gdGhpcy4kZWxlbWVudFswXS5vZmZzZXRXaWR0aDsKICAgIHZhciB0b29sdGlwSGVpZ2h0ID0gdGhpcy4kZWxlbWVudFswXS5vZmZzZXRIZWlnaHQ7IC8vIFRvb2x0aXAg55qE5pa55ZCRCgogICAgdmFyIHBvc2l0aW9uID0gdGhpcy5vcHRpb25zLnBvc2l0aW9uOyAvLyDoh6rliqjliKTmlq3kvY3nva7vvIzliqAgMnB477yM5L2/IFRvb2x0aXAg6Led56a756qX5Y+j6L655qGG6Iez5bCR5pyJIDJweCDnmoTpl7Tot50KCiAgICBpZiAocG9zaXRpb24gPT09ICdhdXRvJykgewogICAgICBpZiAodGFyZ2V0UHJvcHMudG9wICsgdGFyZ2V0UHJvcHMuaGVpZ2h0ICsgdGFyZ2V0TWFyZ2luICsgdG9vbHRpcEhlaWdodCArIDIgPCAkd2luZG93LmhlaWdodCgpKSB7CiAgICAgICAgcG9zaXRpb24gPSAnYm90dG9tJzsKICAgICAgfSBlbHNlIGlmICh0YXJnZXRNYXJnaW4gKyB0b29sdGlwSGVpZ2h0ICsgMiA8IHRhcmdldFByb3BzLnRvcCkgewogICAgICAgIHBvc2l0aW9uID0gJ3RvcCc7CiAgICAgIH0gZWxzZSBpZiAodGFyZ2V0TWFyZ2luICsgdG9vbHRpcFdpZHRoICsgMiA8IHRhcmdldFByb3BzLmxlZnQpIHsKICAgICAgICBwb3NpdGlvbiA9ICdsZWZ0JzsKICAgICAgfSBlbHNlIGlmICh0YXJnZXRQcm9wcy53aWR0aCArIHRhcmdldE1hcmdpbiArIHRvb2x0aXBXaWR0aCArIDIgPCAkd2luZG93LndpZHRoKCkgLSB0YXJnZXRQcm9wcy5sZWZ0KSB7CiAgICAgICAgcG9zaXRpb24gPSAncmlnaHQnOwogICAgICB9IGVsc2UgewogICAgICAgIHBvc2l0aW9uID0gJ2JvdHRvbSc7CiAgICAgIH0KICAgIH0gLy8g6K6+572u5L2N572uCgoKICAgIHN3aXRjaCAocG9zaXRpb24pIHsKICAgICAgY2FzZSAnYm90dG9tJzoKICAgICAgICBtYXJnaW5MZWZ0ID0gLTEgKiAodG9vbHRpcFdpZHRoIC8gMik7CiAgICAgICAgbWFyZ2luVG9wID0gdGFyZ2V0UHJvcHMuaGVpZ2h0IC8gMiArIHRhcmdldE1hcmdpbjsKICAgICAgICB0aGlzLiRlbGVtZW50LnRyYW5zZm9ybU9yaWdpbigndG9wIGNlbnRlcicpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAndG9wJzoKICAgICAgICBtYXJnaW5MZWZ0ID0gLTEgKiAodG9vbHRpcFdpZHRoIC8gMik7CiAgICAgICAgbWFyZ2luVG9wID0gLTEgKiAodG9vbHRpcEhlaWdodCArIHRhcmdldFByb3BzLmhlaWdodCAvIDIgKyB0YXJnZXRNYXJnaW4pOwogICAgICAgIHRoaXMuJGVsZW1lbnQudHJhbnNmb3JtT3JpZ2luKCdib3R0b20gY2VudGVyJyk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdsZWZ0JzoKICAgICAgICBtYXJnaW5MZWZ0ID0gLTEgKiAodG9vbHRpcFdpZHRoICsgdGFyZ2V0UHJvcHMud2lkdGggLyAyICsgdGFyZ2V0TWFyZ2luKTsKICAgICAgICBtYXJnaW5Ub3AgPSAtMSAqICh0b29sdGlwSGVpZ2h0IC8gMik7CiAgICAgICAgdGhpcy4kZWxlbWVudC50cmFuc2Zvcm1PcmlnaW4oJ2NlbnRlciByaWdodCcpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAncmlnaHQnOgogICAgICAgIG1hcmdpbkxlZnQgPSB0YXJnZXRQcm9wcy53aWR0aCAvIDIgKyB0YXJnZXRNYXJnaW47CiAgICAgICAgbWFyZ2luVG9wID0gLTEgKiAodG9vbHRpcEhlaWdodCAvIDIpOwogICAgICAgIHRoaXMuJGVsZW1lbnQudHJhbnNmb3JtT3JpZ2luKCdjZW50ZXIgbGVmdCcpOwogICAgICAgIGJyZWFrOwogICAgfQoKICAgIHZhciB0YXJnZXRPZmZzZXQgPSB0aGlzLiR0YXJnZXQub2Zmc2V0KCk7CiAgICB0aGlzLiRlbGVtZW50LmNzcyh7CiAgICAgIHRvcDogdGFyZ2V0T2Zmc2V0LnRvcCArIHRhcmdldFByb3BzLmhlaWdodCAvIDIgKyAicHgiLAogICAgICBsZWZ0OiB0YXJnZXRPZmZzZXQubGVmdCArIHRhcmdldFByb3BzLndpZHRoIC8gMiArICJweCIsCiAgICAgICdtYXJnaW4tbGVmdCc6IG1hcmdpbkxlZnQgKyAicHgiLAogICAgICAnbWFyZ2luLXRvcCc6IG1hcmdpblRvcCArICJweCIKICAgIH0pOwogIH07CiAgLyoqCiAgICog6Kem5Y+R57uE5Lu25LqL5Lu2CiAgICogQHBhcmFtIG5hbWUKICAgKi8KCgogIFRvb2x0aXAucHJvdG90eXBlLnRyaWdnZXJFdmVudCA9IGZ1bmN0aW9uIHRyaWdnZXJFdmVudChuYW1lKSB7CiAgICBjb21wb25lbnRFdmVudChuYW1lLCAndG9vbHRpcCcsIHRoaXMuJHRhcmdldCwgdGhpcyk7CiAgfTsKICAvKioKICAgKiDliqjnlLvnu5PmnZ/lm57osIMKICAgKi8KCgogIFRvb2x0aXAucHJvdG90eXBlLnRyYW5zaXRpb25FbmQgPSBmdW5jdGlvbiB0cmFuc2l0aW9uRW5kKCkgewogICAgaWYgKHRoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ21kdWktdG9vbHRpcC1vcGVuJykpIHsKICAgICAgdGhpcy5zdGF0ZSA9ICdvcGVuZWQnOwogICAgICB0aGlzLnRyaWdnZXJFdmVudCgnb3BlbmVkJyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICAgIHRoaXMudHJpZ2dlckV2ZW50KCdjbG9zZWQnKTsKICAgIH0KICB9OwogIC8qKgogICAqIOW9k+WJjSB0b29sdGlwIOaYr+WQpuS4uuaJk+W8gOeKtuaAgQogICAqLwoKCiAgVG9vbHRpcC5wcm90b3R5cGUuaXNPcGVuID0gZnVuY3Rpb24gaXNPcGVuKCkgewogICAgcmV0dXJuIHRoaXMuc3RhdGUgPT09ICdvcGVuaW5nJyB8fCB0aGlzLnN0YXRlID09PSAnb3BlbmVkJzsKICB9OwogIC8qKgogICAqIOaJp+ihjOaJk+W8gCB0b29sdGlwCiAgICovCgoKICBUb29sdGlwLnByb3RvdHlwZS5kb09wZW4gPSBmdW5jdGlvbiBkb09wZW4oKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgIHRoaXMuc3RhdGUgPSAnb3BlbmluZyc7CiAgICB0aGlzLnRyaWdnZXJFdmVudCgnb3BlbicpOwogICAgdGhpcy4kZWxlbWVudC5hZGRDbGFzcygnbWR1aS10b29sdGlwLW9wZW4nKS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMkMS50cmFuc2l0aW9uRW5kKCk7CiAgICB9KTsKICB9OwogIC8qKgogICAqIOaJk+W8gCBUb29sdGlwCiAgICogQHBhcmFtIG9wdGlvbnMg5YWB6K645q+P5qyh5omT5byA5pe26K6+572u5LiN5ZCM55qE5Y+C5pWwCiAgICovCgoKICBUb29sdGlwLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gb3BlbihvcHRpb25zKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKCiAgICBpZiAodGhpcy5pc09wZW4oKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIG9sZE9wdGlvbnMgPSBleHRlbmQoe30sIHRoaXMub3B0aW9ucyk7CgogICAgaWYgKG9wdGlvbnMpIHsKICAgICAgZXh0ZW5kKHRoaXMub3B0aW9ucywgb3B0aW9ucyk7CiAgICB9IC8vIHRvb2x0aXAg55qE5YaF5a655pyJ5pu05pawCgoKICAgIGlmIChvbGRPcHRpb25zLmNvbnRlbnQgIT09IHRoaXMub3B0aW9ucy5jb250ZW50KSB7CiAgICAgIHRoaXMuJGVsZW1lbnQuaHRtbCh0aGlzLm9wdGlvbnMuY29udGVudCk7CiAgICB9CgogICAgdGhpcy5zZXRQb3NpdGlvbigpOwoKICAgIGlmICh0aGlzLm9wdGlvbnMuZGVsYXkpIHsKICAgICAgdGhpcy50aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpcyQxLmRvT3BlbigpOwogICAgICB9LCB0aGlzLm9wdGlvbnMuZGVsYXkpOwogICAgfSBlbHNlIHsKICAgICAgdGhpcy50aW1lb3V0SWQgPSBudWxsOwogICAgICB0aGlzLmRvT3BlbigpOwogICAgfQogIH07CiAgLyoqCiAgICog5YWz6ZetIFRvb2x0aXAKICAgKi8KCgogIFRvb2x0aXAucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gY2xvc2UoKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKCiAgICBpZiAodGhpcy50aW1lb3V0SWQpIHsKICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dElkKTsKICAgICAgdGhpcy50aW1lb3V0SWQgPSBudWxsOwogICAgfQoKICAgIGlmICghdGhpcy5pc09wZW4oKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5zdGF0ZSA9ICdjbG9zaW5nJzsKICAgIHRoaXMudHJpZ2dlckV2ZW50KCdjbG9zZScpOwogICAgdGhpcy4kZWxlbWVudC5yZW1vdmVDbGFzcygnbWR1aS10b29sdGlwLW9wZW4nKS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMkMS50cmFuc2l0aW9uRW5kKCk7CiAgICB9KTsKICB9OwogIC8qKgogICAqIOWIh+aNoiBUb29sdGlwIOeahOaJk+W8gOeKtuaAgQogICAqLwoKCiAgVG9vbHRpcC5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24gdG9nZ2xlKCkgewogICAgdGhpcy5pc09wZW4oKSA/IHRoaXMuY2xvc2UoKSA6IHRoaXMub3BlbigpOwogIH07CiAgLyoqCiAgICog6I635Y+WIFRvb2x0aXAg54q25oCB44CC5YWx5YyF5ZCr5Zub56eN54q25oCB77yaYG9wZW5pbmdg44CBYG9wZW5lZGDjgIFgY2xvc2luZ2DjgIFgY2xvc2VkYAogICAqLwoKCiAgVG9vbHRpcC5wcm90b3R5cGUuZ2V0U3RhdGUgPSBmdW5jdGlvbiBnZXRTdGF0ZSgpIHsKICAgIHJldHVybiB0aGlzLnN0YXRlOwogIH07CgogIG1kdWkuVG9vbHRpcCA9IFRvb2x0aXA7CiAgdmFyIGN1c3RvbUF0dHIkOCA9ICdtZHVpLXRvb2x0aXAnOwogIHZhciBkYXRhTmFtZSQyID0gJ19tZHVpX3Rvb2x0aXAnOwogICQoZnVuY3Rpb24gKCkgewogICAgLy8gbW91c2VlbnRlciDkuI3og73lhpLms6HvvIzmiYDku6Xov5nph4znlKggbW91c2VvdmVyIOS7o+abvwogICAgJGRvY3VtZW50Lm9uKCd0b3VjaHN0YXJ0IG1vdXNlb3ZlcicsICJbIiArIGN1c3RvbUF0dHIkOCArICJdIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgJHRhcmdldCA9ICQodGhpcyk7CiAgICAgIHZhciBpbnN0YW5jZSA9ICR0YXJnZXQuZGF0YShkYXRhTmFtZSQyKTsKCiAgICAgIGlmICghaW5zdGFuY2UpIHsKICAgICAgICBpbnN0YW5jZSA9IG5ldyBtZHVpLlRvb2x0aXAodGhpcywgcGFyc2VPcHRpb25zKHRoaXMsIGN1c3RvbUF0dHIkOCkpOwogICAgICAgICR0YXJnZXQuZGF0YShkYXRhTmFtZSQyLCBpbnN0YW5jZSk7CiAgICAgIH0KICAgIH0pOwogIH0pOwogIHZhciBERUZBVUxUX09QVElPTlMkYyA9IHsKICAgIG1lc3NhZ2U6ICcnLAogICAgdGltZW91dDogNDAwMCwKICAgIHBvc2l0aW9uOiAnYm90dG9tJywKICAgIGJ1dHRvblRleHQ6ICcnLAogICAgYnV0dG9uQ29sb3I6ICcnLAogICAgY2xvc2VPbkJ1dHRvbkNsaWNrOiB0cnVlLAogICAgY2xvc2VPbk91dHNpZGVDbGljazogdHJ1ZSwKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb24KICAgIG9uQ2xpY2s6IGZ1bmN0aW9uICgpIHt9LAogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvbgogICAgb25CdXR0b25DbGljazogZnVuY3Rpb24gKCkge30sCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uCiAgICBvbk9wZW46IGZ1bmN0aW9uICgpIHt9LAogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvbgogICAgb25PcGVuZWQ6IGZ1bmN0aW9uICgpIHt9LAogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvbgogICAgb25DbG9zZTogZnVuY3Rpb24gKCkge30sCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uCiAgICBvbkNsb3NlZDogZnVuY3Rpb24gKCkge30KICB9OwogIC8qKgogICAqIOW9k+WJjeaJk+W8gOedgOeahCBTbmFja2JhcgogICAqLwoKICB2YXIgY3VycmVudEluc3QkMSA9IG51bGw7CiAgLyoqCiAgICog6Zif5YiX5ZCNCiAgICovCgogIHZhciBxdWV1ZU5hbWUkMSA9ICdfbWR1aV9zbmFja2Jhcic7CgogIHZhciBTbmFja2JhciA9IGZ1bmN0aW9uIFNuYWNrYmFyKG9wdGlvbnMpIHsKICAgIC8qKgogICAgICog6YWN572u5Y+C5pWwCiAgICAgKi8KICAgIHRoaXMub3B0aW9ucyA9IGV4dGVuZCh7fSwgREVGQVVMVF9PUFRJT05TJGMpOwogICAgLyoqCiAgICAgKiDlvZPliY0gU25hY2tiYXIg55qE54q25oCBCiAgICAgKi8KCiAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICAvKioKICAgICAqIHNldFRpbWVvdXQg55qEIElECiAgICAgKi8KCiAgICB0aGlzLnRpbWVvdXRJZCA9IG51bGw7CiAgICBleHRlbmQodGhpcy5vcHRpb25zLCBvcHRpb25zKTsgLy8g5oyJ6ZKu6aKc6ImyCgogICAgdmFyIGJ1dHRvbkNvbG9yU3R5bGUgPSAnJzsKICAgIHZhciBidXR0b25Db2xvckNsYXNzID0gJyc7CgogICAgaWYgKHRoaXMub3B0aW9ucy5idXR0b25Db2xvci5pbmRleE9mKCcjJykgPT09IDAgfHwgdGhpcy5vcHRpb25zLmJ1dHRvbkNvbG9yLmluZGV4T2YoJ3JnYicpID09PSAwKSB7CiAgICAgIGJ1dHRvbkNvbG9yU3R5bGUgPSAic3R5bGU9XCJjb2xvcjoiICsgdGhpcy5vcHRpb25zLmJ1dHRvbkNvbG9yICsgIlwiIjsKICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25zLmJ1dHRvbkNvbG9yICE9PSAnJykgewogICAgICBidXR0b25Db2xvckNsYXNzID0gIm1kdWktdGV4dC1jb2xvci0iICsgdGhpcy5vcHRpb25zLmJ1dHRvbkNvbG9yOwogICAgfSAvLyDmt7vliqAgSFRNTAoKCiAgICB0aGlzLiRlbGVtZW50ID0gJCgnPGRpdiBjbGFzcz0ibWR1aS1zbmFja2JhciI+JyArICI8ZGl2IGNsYXNzPVwibWR1aS1zbmFja2Jhci10ZXh0XCI+IiArIHRoaXMub3B0aW9ucy5tZXNzYWdlICsgIjwvZGl2PiIgKyAodGhpcy5vcHRpb25zLmJ1dHRvblRleHQgPyAiPGEgaHJlZj1cImphdmFzY3JpcHQ6dm9pZCgwKVwiIGNsYXNzPVwibWR1aS1zbmFja2Jhci1hY3Rpb24gbWR1aS1idG4gbWR1aS1yaXBwbGUgbWR1aS1yaXBwbGUtd2hpdGUgIiArIGJ1dHRvbkNvbG9yQ2xhc3MgKyAiXCIgIiArIGJ1dHRvbkNvbG9yU3R5bGUgKyAiPiIgKyB0aGlzLm9wdGlvbnMuYnV0dG9uVGV4dCArICI8L2E+IiA6ICcnKSArICc8L2Rpdj4nKS5hcHBlbmRUbyhkb2N1bWVudC5ib2R5KTsgLy8g6K6+572u5L2N572uCgogICAgdGhpcy5zZXRQb3NpdGlvbignY2xvc2UnKTsKICAgIHRoaXMuJGVsZW1lbnQucmVmbG93KCkuYWRkQ2xhc3MoIm1kdWktc25hY2tiYXItIiArIHRoaXMub3B0aW9ucy5wb3NpdGlvbik7CiAgfTsKICAvKioKICAgKiDngrnlh7sgU25hY2tiYXIg5aSW6Z2i55qE5Yy65Z+f5YWz6ZetCiAgICogQHBhcmFtIGV2ZW50CiAgICovCgoKICBTbmFja2Jhci5wcm90b3R5cGUuY2xvc2VPbk91dHNpZGVDbGljayA9IGZ1bmN0aW9uIGNsb3NlT25PdXRzaWRlQ2xpY2soZXZlbnQpIHsKICAgIHZhciAkdGFyZ2V0ID0gJChldmVudC50YXJnZXQpOwoKICAgIGlmICghJHRhcmdldC5oYXNDbGFzcygnbWR1aS1zbmFja2JhcicpICYmICEkdGFyZ2V0LnBhcmVudHMoJy5tZHVpLXNuYWNrYmFyJykubGVuZ3RoKSB7CiAgICAgIGN1cnJlbnRJbnN0JDEuY2xvc2UoKTsKICAgIH0KICB9OwogIC8qKgogICAqIOiuvue9riBTbmFja2JhciDnmoTkvY3nva4KICAgKiBAcGFyYW0gc3RhdGUKICAgKi8KCgogIFNuYWNrYmFyLnByb3RvdHlwZS5zZXRQb3NpdGlvbiA9IGZ1bmN0aW9uIHNldFBvc2l0aW9uKHN0YXRlKSB7CiAgICB2YXIgc25hY2tiYXJIZWlnaHQgPSB0aGlzLiRlbGVtZW50WzBdLmNsaWVudEhlaWdodDsKICAgIHZhciBwb3NpdGlvbiA9IHRoaXMub3B0aW9ucy5wb3NpdGlvbjsKICAgIHZhciB0cmFuc2xhdGVYOwogICAgdmFyIHRyYW5zbGF0ZVk7IC8vIHRyYW5zbGF0ZVgKCiAgICBpZiAocG9zaXRpb24gPT09ICdib3R0b20nIHx8IHBvc2l0aW9uID09PSAndG9wJykgewogICAgICB0cmFuc2xhdGVYID0gJy01MCUnOwogICAgfSBlbHNlIHsKICAgICAgdHJhbnNsYXRlWCA9ICcwJzsKICAgIH0gLy8gdHJhbnNsYXRlWQoKCiAgICBpZiAoc3RhdGUgPT09ICdvcGVuJykgewogICAgICB0cmFuc2xhdGVZID0gJzAnOwogICAgfSBlbHNlIHsKICAgICAgaWYgKHBvc2l0aW9uID09PSAnYm90dG9tJykgewogICAgICAgIHRyYW5zbGF0ZVkgPSBzbmFja2JhckhlaWdodDsKICAgICAgfQoKICAgICAgaWYgKHBvc2l0aW9uID09PSAndG9wJykgewogICAgICAgIHRyYW5zbGF0ZVkgPSAtc25hY2tiYXJIZWlnaHQ7CiAgICAgIH0KCiAgICAgIGlmIChwb3NpdGlvbiA9PT0gJ2xlZnQtdG9wJyB8fCBwb3NpdGlvbiA9PT0gJ3JpZ2h0LXRvcCcpIHsKICAgICAgICB0cmFuc2xhdGVZID0gLXNuYWNrYmFySGVpZ2h0IC0gMjQ7CiAgICAgIH0KCiAgICAgIGlmIChwb3NpdGlvbiA9PT0gJ2xlZnQtYm90dG9tJyB8fCBwb3NpdGlvbiA9PT0gJ3JpZ2h0LWJvdHRvbScpIHsKICAgICAgICB0cmFuc2xhdGVZID0gc25hY2tiYXJIZWlnaHQgKyAyNDsKICAgICAgfQogICAgfQoKICAgIHRoaXMuJGVsZW1lbnQudHJhbnNmb3JtKCJ0cmFuc2xhdGUoIiArIHRyYW5zbGF0ZVggKyAiLCIgKyB0cmFuc2xhdGVZICsgInB4Iik7CiAgfTsKICAvKioKICAgKiDmiZPlvIAgU25hY2tiYXIKICAgKi8KCgogIFNuYWNrYmFyLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gb3BlbigpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwoKICAgIGlmICh0aGlzLnN0YXRlID09PSAnb3BlbmluZycgfHwgdGhpcy5zdGF0ZSA9PT0gJ29wZW5lZCcpIHsKICAgICAgcmV0dXJuOwogICAgfSAvLyDlpoLmnpzlvZPliY3mnInmraPlnKjmmL7npLrnmoQgU25hY2tiYXLvvIzliJnlhYjliqDlhaXpmJ/liJfvvIznrYnml6cgU25hY2tiYXIg5YWz6Zet5ZCO5YaN5omT5byACgoKICAgIGlmIChjdXJyZW50SW5zdCQxKSB7CiAgICAgIHF1ZXVlKHF1ZXVlTmFtZSQxLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMkMS5vcGVuKCk7CiAgICAgIH0pOwogICAgICByZXR1cm47CiAgICB9CgogICAgY3VycmVudEluc3QkMSA9IHRoaXM7IC8vIOW8gOWni+aJk+W8gAoKICAgIHRoaXMuc3RhdGUgPSAnb3BlbmluZyc7CiAgICB0aGlzLm9wdGlvbnMub25PcGVuKHRoaXMpOwogICAgdGhpcy5zZXRQb3NpdGlvbignb3BlbicpOwogICAgdGhpcy4kZWxlbWVudC50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHRoaXMkMS5zdGF0ZSAhPT0gJ29wZW5pbmcnKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzJDEuc3RhdGUgPSAnb3BlbmVkJzsKICAgICAgdGhpcyQxLm9wdGlvbnMub25PcGVuZWQodGhpcyQxKTsgLy8g5pyJ5oyJ6ZKu5pe257uR5a6a5LqL5Lu2CgogICAgICBpZiAodGhpcyQxLm9wdGlvbnMuYnV0dG9uVGV4dCkgewogICAgICAgIHRoaXMkMS4kZWxlbWVudC5maW5kKCcubWR1aS1zbmFja2Jhci1hY3Rpb24nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB0aGlzJDEub3B0aW9ucy5vbkJ1dHRvbkNsaWNrKHRoaXMkMSk7CgogICAgICAgICAgaWYgKHRoaXMkMS5vcHRpb25zLmNsb3NlT25CdXR0b25DbGljaykgewogICAgICAgICAgICB0aGlzJDEuY2xvc2UoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSAvLyDngrnlh7sgc25hY2tiYXIg55qE5LqL5Lu2CgoKICAgICAgdGhpcyQxLiRlbGVtZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgIGlmICghJChldmVudC50YXJnZXQpLmhhc0NsYXNzKCdtZHVpLXNuYWNrYmFyLWFjdGlvbicpKSB7CiAgICAgICAgICB0aGlzJDEub3B0aW9ucy5vbkNsaWNrKHRoaXMkMSk7CiAgICAgICAgfQogICAgICB9KTsgLy8g54K55Ye7IFNuYWNrYmFyIOWklumdoueahOWMuuWfn+WFs+mXrQoKICAgICAgaWYgKHRoaXMkMS5vcHRpb25zLmNsb3NlT25PdXRzaWRlQ2xpY2spIHsKICAgICAgICAkZG9jdW1lbnQub24oc3RhcnRFdmVudCwgdGhpcyQxLmNsb3NlT25PdXRzaWRlQ2xpY2spOwogICAgICB9IC8vIOi2heaXtuWQjuiHquWKqOWFs+mXrQoKCiAgICAgIGlmICh0aGlzJDEub3B0aW9ucy50aW1lb3V0KSB7CiAgICAgICAgdGhpcyQxLnRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIHRoaXMkMS5jbG9zZSgpOwogICAgICAgIH0sIHRoaXMkMS5vcHRpb25zLnRpbWVvdXQpOwogICAgICB9CiAgICB9KTsKICB9OwogIC8qKgogICAqIOWFs+mXrSBTbmFja2JhcgogICAqLwoKCiAgU25hY2tiYXIucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gY2xvc2UoKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKCiAgICBpZiAodGhpcy5zdGF0ZSA9PT0gJ2Nsb3NpbmcnIHx8IHRoaXMuc3RhdGUgPT09ICdjbG9zZWQnKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAodGhpcy50aW1lb3V0SWQpIHsKICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dElkKTsKICAgIH0KCiAgICBpZiAodGhpcy5vcHRpb25zLmNsb3NlT25PdXRzaWRlQ2xpY2spIHsKICAgICAgJGRvY3VtZW50Lm9mZihzdGFydEV2ZW50LCB0aGlzLmNsb3NlT25PdXRzaWRlQ2xpY2spOwogICAgfQoKICAgIHRoaXMuc3RhdGUgPSAnY2xvc2luZyc7CiAgICB0aGlzLm9wdGlvbnMub25DbG9zZSh0aGlzKTsKICAgIHRoaXMuc2V0UG9zaXRpb24oJ2Nsb3NlJyk7CiAgICB0aGlzLiRlbGVtZW50LnRyYW5zaXRpb25FbmQoZnVuY3Rpb24gKCkgewogICAgICBpZiAodGhpcyQxLnN0YXRlICE9PSAnY2xvc2luZycpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGN1cnJlbnRJbnN0JDEgPSBudWxsOwogICAgICB0aGlzJDEuc3RhdGUgPSAnY2xvc2VkJzsKICAgICAgdGhpcyQxLm9wdGlvbnMub25DbG9zZWQodGhpcyQxKTsKICAgICAgdGhpcyQxLiRlbGVtZW50LnJlbW92ZSgpOwogICAgICBkZXF1ZXVlKHF1ZXVlTmFtZSQxKTsKICAgIH0pOwogIH07CgogIG1kdWkuc25hY2tiYXIgPSBmdW5jdGlvbiAobWVzc2FnZSwgb3B0aW9ucykgewogICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgb3B0aW9ucyA9IHt9OwoKICAgIGlmIChpc1N0cmluZyhtZXNzYWdlKSkgewogICAgICBvcHRpb25zLm1lc3NhZ2UgPSBtZXNzYWdlOwogICAgfSBlbHNlIHsKICAgICAgb3B0aW9ucyA9IG1lc3NhZ2U7CiAgICB9CgogICAgdmFyIGluc3RhbmNlID0gbmV3IFNuYWNrYmFyKG9wdGlvbnMpOwogICAgaW5zdGFuY2Uub3BlbigpOwogICAgcmV0dXJuIGluc3RhbmNlOwogIH07CgogICQoZnVuY3Rpb24gKCkgewogICAgLy8g5YiH5o2i5a+86Iiq6aG5CiAgICAkZG9jdW1lbnQub24oJ2NsaWNrJywgJy5tZHVpLWJvdHRvbS1uYXY+YScsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyICRpdGVtID0gJCh0aGlzKTsKICAgICAgdmFyICRib3R0b21OYXYgPSAkaXRlbS5wYXJlbnQoKTsKICAgICAgJGJvdHRvbU5hdi5jaGlsZHJlbignYScpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBpdGVtKSB7CiAgICAgICAgdmFyIGlzVGhpcyA9ICRpdGVtLmlzKGl0ZW0pOwoKICAgICAgICBpZiAoaXNUaGlzKSB7CiAgICAgICAgICBjb21wb25lbnRFdmVudCgnY2hhbmdlJywgJ2JvdHRvbU5hdicsICRib3R0b21OYXZbMF0sIHVuZGVmaW5lZCwgewogICAgICAgICAgICBpbmRleDogaW5kZXgKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaXNUaGlzID8gJChpdGVtKS5hZGRDbGFzcygnbWR1aS1ib3R0b20tbmF2LWFjdGl2ZScpIDogJChpdGVtKS5yZW1vdmVDbGFzcygnbWR1aS1ib3R0b20tbmF2LWFjdGl2ZScpOwogICAgICB9KTsKICAgIH0pOyAvLyDmu5rliqjml7bpmpDol48gbWR1aS1ib3R0b20tbmF2LXNjcm9sbC1oaWRlCgogICAgbWR1aS5tdXRhdGlvbignLm1kdWktYm90dG9tLW5hdi1zY3JvbGwtaGlkZScsIGZ1bmN0aW9uICgpIHsKICAgICAgbmV3IG1kdWkuSGVhZHJvb20odGhpcywgewogICAgICAgIHBpbm5lZENsYXNzOiAnbWR1aS1oZWFkcm9vbS1waW5uZWQtZG93bicsCiAgICAgICAgdW5waW5uZWRDbGFzczogJ21kdWktaGVhZHJvb20tdW5waW5uZWQtZG93bicKICAgICAgfSk7CiAgICB9KTsKICB9KTsKICAvKioKICAgKiBsYXllciDnmoQgSFRNTCDnu5PmnoQKICAgKiBAcGFyYW0gaW5kZXgKICAgKi8KCiAgZnVuY3Rpb24gbGF5ZXJIVE1MKGluZGV4KSB7CiAgICBpZiAoaW5kZXggPT09IHZvaWQgMCkgaW5kZXggPSBmYWxzZTsKICAgIHJldHVybiAiPGRpdiBjbGFzcz1cIm1kdWktc3Bpbm5lci1sYXllciAiICsgKGluZGV4ID8gIm1kdWktc3Bpbm5lci1sYXllci0iICsgaW5kZXggOiAnJykgKyAiXCI+IiArICc8ZGl2IGNsYXNzPSJtZHVpLXNwaW5uZXItY2lyY2xlLWNsaXBwZXIgbWR1aS1zcGlubmVyLWxlZnQiPicgKyAnPGRpdiBjbGFzcz0ibWR1aS1zcGlubmVyLWNpcmNsZSI+PC9kaXY+JyArICc8L2Rpdj4nICsgJzxkaXYgY2xhc3M9Im1kdWktc3Bpbm5lci1nYXAtcGF0Y2giPicgKyAnPGRpdiBjbGFzcz0ibWR1aS1zcGlubmVyLWNpcmNsZSI+PC9kaXY+JyArICc8L2Rpdj4nICsgJzxkaXYgY2xhc3M9Im1kdWktc3Bpbm5lci1jaXJjbGUtY2xpcHBlciBtZHVpLXNwaW5uZXItcmlnaHQiPicgKyAnPGRpdiBjbGFzcz0ibWR1aS1zcGlubmVyLWNpcmNsZSI+PC9kaXY+JyArICc8L2Rpdj4nICsgJzwvZGl2Pic7CiAgfQogIC8qKgogICAqIOWhq+WFhSBIVE1MCiAgICogQHBhcmFtIHNwaW5uZXIKICAgKi8KCgogIGZ1bmN0aW9uIGZpbGxIVE1MKHNwaW5uZXIpIHsKICAgIHZhciAkc3Bpbm5lciA9ICQoc3Bpbm5lcik7CiAgICB2YXIgbGF5ZXIgPSAkc3Bpbm5lci5oYXNDbGFzcygnbWR1aS1zcGlubmVyLWNvbG9yZnVsJykgPyBsYXllckhUTUwoMSkgKyBsYXllckhUTUwoMikgKyBsYXllckhUTUwoMykgKyBsYXllckhUTUwoNCkgOiBsYXllckhUTUwoKTsKICAgICRzcGlubmVyLmh0bWwobGF5ZXIpOwogIH0KCiAgJChmdW5jdGlvbiAoKSB7CiAgICAvLyDpobXpnaLliqDovb3lrozlkI7oh6rliqjloavlhYUgSFRNTCDnu5PmnoQKICAgIG1kdWkubXV0YXRpb24oJy5tZHVpLXNwaW5uZXInLCBmdW5jdGlvbiAoKSB7CiAgICAgIGZpbGxIVE1MKHRoaXMpOwogICAgfSk7CiAgfSk7CgogIG1kdWkudXBkYXRlU3Bpbm5lcnMgPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgIHZhciAkZWxlbWVudHMgPSBpc1VuZGVmaW5lZChzZWxlY3RvcikgPyAkKCcubWR1aS1zcGlubmVyJykgOiAkKHNlbGVjdG9yKTsKICAgICRlbGVtZW50cy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgZmlsbEhUTUwodGhpcyk7CiAgICB9KTsKICB9OwoKICB2YXIgREVGQVVMVF9PUFRJT05TJGQgPSB7CiAgICBwb3NpdGlvbjogJ2F1dG8nLAogICAgYWxpZ246ICdhdXRvJywKICAgIGd1dHRlcjogMTYsCiAgICBmaXhlZDogZmFsc2UsCiAgICBjb3ZlcmVkOiAnYXV0bycsCiAgICBzdWJNZW51VHJpZ2dlcjogJ2hvdmVyJywKICAgIHN1Yk1lbnVEZWxheTogMjAwCiAgfTsKCiAgdmFyIE1lbnUgPSBmdW5jdGlvbiBNZW51KGFuY2hvclNlbGVjdG9yLCBtZW51U2VsZWN0b3IsIG9wdGlvbnMpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgb3B0aW9ucyA9IHt9OwogICAgLyoqCiAgICAgKiDphY3nva7lj4LmlbAKICAgICAqLwoKICAgIHRoaXMub3B0aW9ucyA9IGV4dGVuZCh7fSwgREVGQVVMVF9PUFRJT05TJGQpOwogICAgLyoqCiAgICAgKiDlvZPliY3oj5zljZXnirbmgIEKICAgICAqLwoKICAgIHRoaXMuc3RhdGUgPSAnY2xvc2VkJzsKICAgIHRoaXMuJGFuY2hvciA9ICQoYW5jaG9yU2VsZWN0b3IpLmZpcnN0KCk7CiAgICB0aGlzLiRlbGVtZW50ID0gJChtZW51U2VsZWN0b3IpLmZpcnN0KCk7IC8vIOinpuWPkeiPnOWNleeahOWFg+e0oCDlkowg6I+c5Y2V5b+F6aG75piv5ZCM57qn55qE5YWD57Sg77yM5ZCm5YiZ6I+c5Y2V5Y+v6IO95LiN6IO95a6a5L2NCgogICAgaWYgKCF0aGlzLiRhbmNob3IucGFyZW50KCkuaXModGhpcy4kZWxlbWVudC5wYXJlbnQoKSkpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdhbmNob3JTZWxlY3RvciBhbmQgbWVudVNlbGVjdG9yIG11c3QgYmUgc2libGluZ3MnKTsKICAgIH0KCiAgICBleHRlbmQodGhpcy5vcHRpb25zLCBvcHRpb25zKTsgLy8g5piv5ZCm5piv57qn6IGU6I+c5Y2VCgogICAgdGhpcy5pc0Nhc2NhZGUgPSB0aGlzLiRlbGVtZW50Lmhhc0NsYXNzKCdtZHVpLW1lbnUtY2FzY2FkZScpOyAvLyBjb3ZlcmVkIOWPguaVsOWkhOeQhgoKICAgIHRoaXMuaXNDb3ZlcmVkID0gdGhpcy5vcHRpb25zLmNvdmVyZWQgPT09ICdhdXRvJyA/ICF0aGlzLmlzQ2FzY2FkZSA6IHRoaXMub3B0aW9ucy5jb3ZlcmVkOyAvLyDngrnlh7vop6blj5Hoj5zljZXliIfmjaIKCiAgICB0aGlzLiRhbmNob3Iub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcyQxLnRvZ2dsZSgpOwogICAgfSk7IC8vIOeCueWHu+iPnOWNleWklumdouWMuuWfn+WFs+mXreiPnOWNlQoKICAgICRkb2N1bWVudC5vbignY2xpY2sgdG91Y2hzdGFydCcsIGZ1bmN0aW9uIChldmVudCkgewogICAgICB2YXIgJHRhcmdldCA9ICQoZXZlbnQudGFyZ2V0KTsKCiAgICAgIGlmICh0aGlzJDEuaXNPcGVuKCkgJiYgISR0YXJnZXQuaXModGhpcyQxLiRlbGVtZW50KSAmJiAhY29udGFpbnModGhpcyQxLiRlbGVtZW50WzBdLCAkdGFyZ2V0WzBdKSAmJiAhJHRhcmdldC5pcyh0aGlzJDEuJGFuY2hvcikgJiYgIWNvbnRhaW5zKHRoaXMkMS4kYW5jaG9yWzBdLCAkdGFyZ2V0WzBdKSkgewogICAgICAgIHRoaXMkMS5jbG9zZSgpOwogICAgICB9CiAgICB9KTsgLy8g54K55Ye75LiN5ZCr5a2Q6I+c5Y2V55qE6I+c5Y2V5p2h55uu5YWz6Zet6I+c5Y2VCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXRoaXMtYWxpYXMKCiAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAkZG9jdW1lbnQub24oJ2NsaWNrJywgJy5tZHVpLW1lbnUtaXRlbScsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyICRpdGVtID0gJCh0aGlzKTsKCiAgICAgIGlmICghJGl0ZW0uZmluZCgnLm1kdWktbWVudScpLmxlbmd0aCAmJiAkaXRlbS5hdHRyKCdkaXNhYmxlZCcpID09PSB1bmRlZmluZWQpIHsKICAgICAgICB0aGF0LmNsb3NlKCk7CiAgICAgIH0KICAgIH0pOyAvLyDnu5Hlrprngrnlh7vmiJbpvKDmoIfnp7vlhaXlkKvlrZDoj5zljZXnmoTmnaHnm67nmoTkuovku7YKCiAgICB0aGlzLmJpbmRTdWJNZW51RXZlbnQoKTsgLy8g56qX5Y+j5aSn5bCP5Y+Y5YyW5pe277yM6YeN5paw6LCD5pW06I+c5Y2V5L2N572uCgogICAgJHdpbmRvdy5vbigncmVzaXplJywgJC50aHJvdHRsZShmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzJDEucmVhZGp1c3QoKTsKICAgIH0sIDEwMCkpOwogIH07CiAgLyoqCiAgICog5piv5ZCm5Li65omT5byA54q25oCBCiAgICovCgoKICBNZW51LnByb3RvdHlwZS5pc09wZW4gPSBmdW5jdGlvbiBpc09wZW4oKSB7CiAgICByZXR1cm4gdGhpcy5zdGF0ZSA9PT0gJ29wZW5pbmcnIHx8IHRoaXMuc3RhdGUgPT09ICdvcGVuZWQnOwogIH07CiAgLyoqCiAgICog6Kem5Y+R57uE5Lu25LqL5Lu2CiAgICogQHBhcmFtIG5hbWUKICAgKi8KCgogIE1lbnUucHJvdG90eXBlLnRyaWdnZXJFdmVudCA9IGZ1bmN0aW9uIHRyaWdnZXJFdmVudChuYW1lKSB7CiAgICBjb21wb25lbnRFdmVudChuYW1lLCAnbWVudScsIHRoaXMuJGVsZW1lbnQsIHRoaXMpOwogIH07CiAgLyoqCiAgICog6LCD5pW05Li76I+c5Y2V5L2N572uCiAgICovCgoKICBNZW51LnByb3RvdHlwZS5yZWFkanVzdCA9IGZ1bmN0aW9uIHJlYWRqdXN0KCkgewogICAgdmFyIG1lbnVMZWZ0OwogICAgdmFyIG1lbnVUb3A7IC8vIOiPnOWNleS9jee9ruWSjOaWueWQkQoKICAgIHZhciBwb3NpdGlvbjsKICAgIHZhciBhbGlnbjsgLy8gd2luZG93IOeql+WPo+eahOWuveW6puWSjOmrmOW6pgoKICAgIHZhciB3aW5kb3dIZWlnaHQgPSAkd2luZG93LmhlaWdodCgpOwogICAgdmFyIHdpbmRvd1dpZHRoID0gJHdpbmRvdy53aWR0aCgpOyAvLyDphY3nva7lj4LmlbAKCiAgICB2YXIgZ3V0dGVyID0gdGhpcy5vcHRpb25zLmd1dHRlcjsKICAgIHZhciBpc0NvdmVyZWQgPSB0aGlzLmlzQ292ZXJlZDsKICAgIHZhciBpc0ZpeGVkID0gdGhpcy5vcHRpb25zLmZpeGVkOyAvLyDliqjnlLvmlrnlkJHlj4LmlbAKCiAgICB2YXIgdHJhbnNmb3JtT3JpZ2luWDsKICAgIHZhciB0cmFuc2Zvcm1PcmlnaW5ZOyAvLyDoj5zljZXnmoTljp/lp4vlrr3luqblkozpq5jluqYKCiAgICB2YXIgbWVudVdpZHRoID0gdGhpcy4kZWxlbWVudC53aWR0aCgpOwogICAgdmFyIG1lbnVIZWlnaHQgPSB0aGlzLiRlbGVtZW50LmhlaWdodCgpOyAvLyDop6blj5Hoj5zljZXnmoTlhYPntKDlnKjnqpflj6PkuK3nmoTkvY3nva4KCiAgICB2YXIgYW5jaG9yUmVjdCA9IHRoaXMuJGFuY2hvclswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIHZhciBhbmNob3JUb3AgPSBhbmNob3JSZWN0LnRvcDsKICAgIHZhciBhbmNob3JMZWZ0ID0gYW5jaG9yUmVjdC5sZWZ0OwogICAgdmFyIGFuY2hvckhlaWdodCA9IGFuY2hvclJlY3QuaGVpZ2h0OwogICAgdmFyIGFuY2hvcldpZHRoID0gYW5jaG9yUmVjdC53aWR0aDsKICAgIHZhciBhbmNob3JCb3R0b20gPSB3aW5kb3dIZWlnaHQgLSBhbmNob3JUb3AgLSBhbmNob3JIZWlnaHQ7CiAgICB2YXIgYW5jaG9yUmlnaHQgPSB3aW5kb3dXaWR0aCAtIGFuY2hvckxlZnQgLSBhbmNob3JXaWR0aDsgLy8g6Kem5Y+R5YWD57Sg55u45a+55YW25oul5pyJ5a6a5L2N5bGe5oCn55qE54i25YWD57Sg55qE5L2N572uCgogICAgdmFyIGFuY2hvck9mZnNldFRvcCA9IHRoaXMuJGFuY2hvclswXS5vZmZzZXRUb3A7CiAgICB2YXIgYW5jaG9yT2Zmc2V0TGVmdCA9IHRoaXMuJGFuY2hvclswXS5vZmZzZXRMZWZ0OyAvLyDoh6rliqjliKTmlq3oj5zljZXkvY3nva4KCiAgICBpZiAodGhpcy5vcHRpb25zLnBvc2l0aW9uID09PSAnYXV0bycpIHsKICAgICAgaWYgKGFuY2hvckJvdHRvbSArIChpc0NvdmVyZWQgPyBhbmNob3JIZWlnaHQgOiAwKSA+IG1lbnVIZWlnaHQgKyBndXR0ZXIpIHsKICAgICAgICAvLyDliKTmlq3kuIvmlrnmmK/lkKbmlL7lvpfkuIvoj5zljZUKICAgICAgICBwb3NpdGlvbiA9ICdib3R0b20nOwogICAgICB9IGVsc2UgaWYgKGFuY2hvclRvcCArIChpc0NvdmVyZWQgPyBhbmNob3JIZWlnaHQgOiAwKSA+IG1lbnVIZWlnaHQgKyBndXR0ZXIpIHsKICAgICAgICAvLyDliKTmlq3kuIrmlrnmmK/lkKbmlL7lvpfkuIvoj5zljZUKICAgICAgICBwb3NpdGlvbiA9ICd0b3AnOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIOS4iuS4i+mDveaUvuS4jeS4i++8jOWxheS4reaYvuekugogICAgICAgIHBvc2l0aW9uID0gJ2NlbnRlcic7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHBvc2l0aW9uID0gdGhpcy5vcHRpb25zLnBvc2l0aW9uOwogICAgfSAvLyDoh6rliqjliKTmlq3oj5zljZXlr7npvZDmlrnlvI8KCgogICAgaWYgKHRoaXMub3B0aW9ucy5hbGlnbiA9PT0gJ2F1dG8nKSB7CiAgICAgIGlmIChhbmNob3JSaWdodCArIGFuY2hvcldpZHRoID4gbWVudVdpZHRoICsgZ3V0dGVyKSB7CiAgICAgICAgLy8g5Yik5pat5Y+z5L6n5piv5ZCm5pS+5b6X5LiL6I+c5Y2VCiAgICAgICAgYWxpZ24gPSAnbGVmdCc7CiAgICAgIH0gZWxzZSBpZiAoYW5jaG9yTGVmdCArIGFuY2hvcldpZHRoID4gbWVudVdpZHRoICsgZ3V0dGVyKSB7CiAgICAgICAgLy8g5Yik5pat5bem5L6n5piv5ZCm5pS+5b6X5LiL6I+c5Y2VCiAgICAgICAgYWxpZ24gPSAncmlnaHQnOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIOW3puWPs+mDveaUvuS4jeS4i++8jOWxheS4reaYvuekugogICAgICAgIGFsaWduID0gJ2NlbnRlcic7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGFsaWduID0gdGhpcy5vcHRpb25zLmFsaWduOwogICAgfSAvLyDorr7nva7oj5zljZXkvY3nva4KCgogICAgaWYgKHBvc2l0aW9uID09PSAnYm90dG9tJykgewogICAgICB0cmFuc2Zvcm1PcmlnaW5ZID0gJzAnOwogICAgICBtZW51VG9wID0gKGlzQ292ZXJlZCA/IDAgOiBhbmNob3JIZWlnaHQpICsgKGlzRml4ZWQgPyBhbmNob3JUb3AgOiBhbmNob3JPZmZzZXRUb3ApOwogICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gJ3RvcCcpIHsKICAgICAgdHJhbnNmb3JtT3JpZ2luWSA9ICcxMDAlJzsKICAgICAgbWVudVRvcCA9IChpc0NvdmVyZWQgPyBhbmNob3JIZWlnaHQgOiAwKSArIChpc0ZpeGVkID8gYW5jaG9yVG9wIC0gbWVudUhlaWdodCA6IGFuY2hvck9mZnNldFRvcCAtIG1lbnVIZWlnaHQpOwogICAgfSBlbHNlIHsKICAgICAgdHJhbnNmb3JtT3JpZ2luWSA9ICc1MCUnOyAvLyA9PT09PT09PT09PT09PT09PT09PT3lnKjnqpflj6PkuK3lsYXkuK0KICAgICAgLy8g5pi+56S655qE6I+c5Y2V55qE6auY5bqm77yM566A5Y2V6I+c5Y2V6auY5bqm5LiN6LaF6L+H56qX5Y+j6auY5bqm77yM6Iul6LaF6L+H5LqG5YiZ5Zyo6I+c5Y2V5YaF6YOo5pi+56S65rua5Yqo5p2hCiAgICAgIC8vIOe6p+iBlOiPnOWNleWGhemDqOS4jeWFgeiuuOWHuueOsOa7muWKqOadoQoKICAgICAgdmFyIG1lbnVIZWlnaHRUZW1wID0gbWVudUhlaWdodDsgLy8g566A5Y2V6I+c5Y2V5q+U56qX5Y+j6auY5pe277yM6ZmQ5Yi26I+c5Y2V6auY5bqmCgogICAgICBpZiAoIXRoaXMuaXNDYXNjYWRlKSB7CiAgICAgICAgaWYgKG1lbnVIZWlnaHQgKyBndXR0ZXIgKiAyID4gd2luZG93SGVpZ2h0KSB7CiAgICAgICAgICBtZW51SGVpZ2h0VGVtcCA9IHdpbmRvd0hlaWdodCAtIGd1dHRlciAqIDI7CiAgICAgICAgICB0aGlzLiRlbGVtZW50LmhlaWdodChtZW51SGVpZ2h0VGVtcCk7CiAgICAgICAgfQogICAgICB9CgogICAgICBtZW51VG9wID0gKHdpbmRvd0hlaWdodCAtIG1lbnVIZWlnaHRUZW1wKSAvIDIgKyAoaXNGaXhlZCA/IDAgOiBhbmNob3JPZmZzZXRUb3AgLSBhbmNob3JUb3ApOwogICAgfQoKICAgIHRoaXMuJGVsZW1lbnQuY3NzKCd0b3AnLCBtZW51VG9wICsgInB4Iik7IC8vIOiuvue9ruiPnOWNleWvuem9kOaWueW8jwoKICAgIGlmIChhbGlnbiA9PT0gJ2xlZnQnKSB7CiAgICAgIHRyYW5zZm9ybU9yaWdpblggPSAnMCc7CiAgICAgIG1lbnVMZWZ0ID0gaXNGaXhlZCA/IGFuY2hvckxlZnQgOiBhbmNob3JPZmZzZXRMZWZ0OwogICAgfSBlbHNlIGlmIChhbGlnbiA9PT0gJ3JpZ2h0JykgewogICAgICB0cmFuc2Zvcm1PcmlnaW5YID0gJzEwMCUnOwogICAgICBtZW51TGVmdCA9IGlzRml4ZWQgPyBhbmNob3JMZWZ0ICsgYW5jaG9yV2lkdGggLSBtZW51V2lkdGggOiBhbmNob3JPZmZzZXRMZWZ0ICsgYW5jaG9yV2lkdGggLSBtZW51V2lkdGg7CiAgICB9IGVsc2UgewogICAgICB0cmFuc2Zvcm1PcmlnaW5YID0gJzUwJSc7IC8vPT09PT09PT09PT09PT09PT09PT09PT3lnKjnqpflj6PkuK3lsYXkuK0KICAgICAgLy8g5pi+56S655qE6I+c5Y2V55qE5a695bqm77yM6I+c5Y2V5a695bqm5LiN6IO96LaF6L+H56qX5Y+j5a695bqmCgogICAgICB2YXIgbWVudVdpZHRoVGVtcCA9IG1lbnVXaWR0aDsgLy8g6I+c5Y2V5q+U56qX5Y+j5a6977yM6ZmQ5Yi26I+c5Y2V5a695bqmCgogICAgICBpZiAobWVudVdpZHRoICsgZ3V0dGVyICogMiA+IHdpbmRvd1dpZHRoKSB7CiAgICAgICAgbWVudVdpZHRoVGVtcCA9IHdpbmRvd1dpZHRoIC0gZ3V0dGVyICogMjsKICAgICAgICB0aGlzLiRlbGVtZW50LndpZHRoKG1lbnVXaWR0aFRlbXApOwogICAgICB9CgogICAgICBtZW51TGVmdCA9ICh3aW5kb3dXaWR0aCAtIG1lbnVXaWR0aFRlbXApIC8gMiArIChpc0ZpeGVkID8gMCA6IGFuY2hvck9mZnNldExlZnQgLSBhbmNob3JMZWZ0KTsKICAgIH0KCiAgICB0aGlzLiRlbGVtZW50LmNzcygnbGVmdCcsIG1lbnVMZWZ0ICsgInB4Iik7IC8vIOiuvue9ruiPnOWNleWKqOeUu+aWueWQkQoKICAgIHRoaXMuJGVsZW1lbnQudHJhbnNmb3JtT3JpZ2luKHRyYW5zZm9ybU9yaWdpblggKyAiICIgKyB0cmFuc2Zvcm1PcmlnaW5ZKTsKICB9OwogIC8qKgogICAqIOiwg+aVtOWtkOiPnOWNleeahOS9jee9rgogICAqIEBwYXJhbSAkc3VibWVudQogICAqLwoKCiAgTWVudS5wcm90b3R5cGUucmVhZGp1c3RTdWJtZW51ID0gZnVuY3Rpb24gcmVhZGp1c3RTdWJtZW51KCRzdWJtZW51KSB7CiAgICB2YXIgJGl0ZW0gPSAkc3VibWVudS5wYXJlbnQoJy5tZHVpLW1lbnUtaXRlbScpOwogICAgdmFyIHN1Ym1lbnVUb3A7CiAgICB2YXIgc3VibWVudUxlZnQ7IC8vIOWtkOiPnOWNleS9jee9ruWSjOaWueWQkQoKICAgIHZhciBwb3NpdGlvbjsKICAgIHZhciBhbGlnbjsgLy8gd2luZG93IOeql+WPo+eahOWuveW6puWSjOmrmOW6pgoKICAgIHZhciB3aW5kb3dIZWlnaHQgPSAkd2luZG93LmhlaWdodCgpOwogICAgdmFyIHdpbmRvd1dpZHRoID0gJHdpbmRvdy53aWR0aCgpOyAvLyDliqjnlLvmlrnlkJHlj4LmlbAKCiAgICB2YXIgdHJhbnNmb3JtT3JpZ2luWDsKICAgIHZhciB0cmFuc2Zvcm1PcmlnaW5ZOyAvLyDlrZDoj5zljZXnmoTljp/lp4vlrr3luqblkozpq5jluqYKCiAgICB2YXIgc3VibWVudVdpZHRoID0gJHN1Ym1lbnUud2lkdGgoKTsKICAgIHZhciBzdWJtZW51SGVpZ2h0ID0gJHN1Ym1lbnUuaGVpZ2h0KCk7IC8vIOinpuWPkeWtkOiPnOWNleeahOiPnOWNlemhueeahOWuveW6pumrmOW6pgoKICAgIHZhciBpdGVtUmVjdCA9ICRpdGVtWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgdmFyIGl0ZW1XaWR0aCA9IGl0ZW1SZWN0LndpZHRoOwogICAgdmFyIGl0ZW1IZWlnaHQgPSBpdGVtUmVjdC5oZWlnaHQ7CiAgICB2YXIgaXRlbUxlZnQgPSBpdGVtUmVjdC5sZWZ0OwogICAgdmFyIGl0ZW1Ub3AgPSBpdGVtUmVjdC50b3A7IC8vIOWIpOaWreiPnOWNleS4iuS4i+S9jee9rgoKICAgIGlmICh3aW5kb3dIZWlnaHQgLSBpdGVtVG9wID4gc3VibWVudUhlaWdodCkgewogICAgICAvLyDliKTmlq3kuIvmlrnmmK/lkKbmlL7lvpfkuIvoj5zljZUKICAgICAgcG9zaXRpb24gPSAnYm90dG9tJzsKICAgIH0gZWxzZSBpZiAoaXRlbVRvcCArIGl0ZW1IZWlnaHQgPiBzdWJtZW51SGVpZ2h0KSB7CiAgICAgIC8vIOWIpOaWreS4iuaWueaYr+WQpuaUvuW+l+S4i+iPnOWNlQogICAgICBwb3NpdGlvbiA9ICd0b3AnOwogICAgfSBlbHNlIHsKICAgICAgLy8g6buY6K6k5pS+5Zyo5LiL5pa5CiAgICAgIHBvc2l0aW9uID0gJ2JvdHRvbSc7CiAgICB9IC8vIOWIpOaWreiPnOWNleW3puWPs+S9jee9rgoKCiAgICBpZiAod2luZG93V2lkdGggLSBpdGVtTGVmdCAtIGl0ZW1XaWR0aCA+IHN1Ym1lbnVXaWR0aCkgewogICAgICAvLyDliKTmlq3lj7PkvqfmmK/lkKbmlL7lvpfkuIvoj5zljZUKICAgICAgYWxpZ24gPSAnbGVmdCc7CiAgICB9IGVsc2UgaWYgKGl0ZW1MZWZ0ID4gc3VibWVudVdpZHRoKSB7CiAgICAgIC8vIOWIpOaWreW3puS+p+aYr+WQpuaUvuW+l+S4i+iPnOWNlQogICAgICBhbGlnbiA9ICdyaWdodCc7CiAgICB9IGVsc2UgewogICAgICAvLyDpu5jorqTmlL7lnKjlj7PkvqcKICAgICAgYWxpZ24gPSAnbGVmdCc7CiAgICB9IC8vIOiuvue9ruiPnOWNleS9jee9rgoKCiAgICBpZiAocG9zaXRpb24gPT09ICdib3R0b20nKSB7CiAgICAgIHRyYW5zZm9ybU9yaWdpblkgPSAnMCc7CiAgICAgIHN1Ym1lbnVUb3AgPSAnMCc7CiAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSAndG9wJykgewogICAgICB0cmFuc2Zvcm1PcmlnaW5ZID0gJzEwMCUnOwogICAgICBzdWJtZW51VG9wID0gLXN1Ym1lbnVIZWlnaHQgKyBpdGVtSGVpZ2h0OwogICAgfQoKICAgICRzdWJtZW51LmNzcygndG9wJywgc3VibWVudVRvcCArICJweCIpOyAvLyDorr7nva7oj5zljZXlr7npvZDmlrnlvI8KCiAgICBpZiAoYWxpZ24gPT09ICdsZWZ0JykgewogICAgICB0cmFuc2Zvcm1PcmlnaW5YID0gJzAnOwogICAgICBzdWJtZW51TGVmdCA9IGl0ZW1XaWR0aDsKICAgIH0gZWxzZSBpZiAoYWxpZ24gPT09ICdyaWdodCcpIHsKICAgICAgdHJhbnNmb3JtT3JpZ2luWCA9ICcxMDAlJzsKICAgICAgc3VibWVudUxlZnQgPSAtc3VibWVudVdpZHRoOwogICAgfQoKICAgICRzdWJtZW51LmNzcygnbGVmdCcsIHN1Ym1lbnVMZWZ0ICsgInB4Iik7IC8vIOiuvue9ruiPnOWNleWKqOeUu+aWueWQkQoKICAgICRzdWJtZW51LnRyYW5zZm9ybU9yaWdpbih0cmFuc2Zvcm1PcmlnaW5YICsgIiAiICsgdHJhbnNmb3JtT3JpZ2luWSk7CiAgfTsKICAvKioKICAgKiDmiZPlvIDlrZDoj5zljZUKICAgKiBAcGFyYW0gJHN1Ym1lbnUKICAgKi8KCgogIE1lbnUucHJvdG90eXBlLm9wZW5TdWJNZW51ID0gZnVuY3Rpb24gb3BlblN1Yk1lbnUoJHN1Ym1lbnUpIHsKICAgIHRoaXMucmVhZGp1c3RTdWJtZW51KCRzdWJtZW51KTsKICAgICRzdWJtZW51LmFkZENsYXNzKCdtZHVpLW1lbnUtb3BlbicpLnBhcmVudCgnLm1kdWktbWVudS1pdGVtJykuYWRkQ2xhc3MoJ21kdWktbWVudS1pdGVtLWFjdGl2ZScpOwogIH07CiAgLyoqCiAgICog5YWz6Zet5a2Q6I+c5Y2V77yM5Y+K5YW25bWM5aWX55qE5a2Q6I+c5Y2VCiAgICogQHBhcmFtICRzdWJtZW51CiAgICovCgoKICBNZW51LnByb3RvdHlwZS5jbG9zZVN1Yk1lbnUgPSBmdW5jdGlvbiBjbG9zZVN1Yk1lbnUoJHN1Ym1lbnUpIHsKICAgIC8vIOWFs+mXreWtkOiPnOWNlQogICAgJHN1Ym1lbnUucmVtb3ZlQ2xhc3MoJ21kdWktbWVudS1vcGVuJykuYWRkQ2xhc3MoJ21kdWktbWVudS1jbG9zaW5nJykudHJhbnNpdGlvbkVuZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiAkc3VibWVudS5yZW1vdmVDbGFzcygnbWR1aS1tZW51LWNsb3NpbmcnKTsKICAgIH0pIC8vIOenu+mZpOa/gOa0u+eKtuaAgeeahOagt+W8jwogICAgLnBhcmVudCgnLm1kdWktbWVudS1pdGVtJykucmVtb3ZlQ2xhc3MoJ21kdWktbWVudS1pdGVtLWFjdGl2ZScpOyAvLyDlvqrnjq/lhbPpl63ltYzlpZfnmoTlrZDoj5zljZUKCiAgICAkc3VibWVudS5maW5kKCcubWR1aS1tZW51JykuZWFjaChmdW5jdGlvbiAoXywgbWVudSkgewogICAgICB2YXIgJHN1YlN1Ym1lbnUgPSAkKG1lbnUpOwogICAgICAkc3ViU3VibWVudS5yZW1vdmVDbGFzcygnbWR1aS1tZW51LW9wZW4nKS5hZGRDbGFzcygnbWR1aS1tZW51LWNsb3NpbmcnKS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gJHN1YlN1Ym1lbnUucmVtb3ZlQ2xhc3MoJ21kdWktbWVudS1jbG9zaW5nJyk7CiAgICAgIH0pLnBhcmVudCgnLm1kdWktbWVudS1pdGVtJykucmVtb3ZlQ2xhc3MoJ21kdWktbWVudS1pdGVtLWFjdGl2ZScpOwogICAgfSk7CiAgfTsKICAvKioKICAgKiDliIfmjaLlrZDoj5zljZXnirbmgIEKICAgKiBAcGFyYW0gJHN1Ym1lbnUKICAgKi8KCgogIE1lbnUucHJvdG90eXBlLnRvZ2dsZVN1Yk1lbnUgPSBmdW5jdGlvbiB0b2dnbGVTdWJNZW51KCRzdWJtZW51KSB7CiAgICAkc3VibWVudS5oYXNDbGFzcygnbWR1aS1tZW51LW9wZW4nKSA/IHRoaXMuY2xvc2VTdWJNZW51KCRzdWJtZW51KSA6IHRoaXMub3BlblN1Yk1lbnUoJHN1Ym1lbnUpOwogIH07CiAgLyoqCiAgICog57uR5a6a5a2Q6I+c5Y2V5LqL5Lu2CiAgICovCgoKICBNZW51LnByb3RvdHlwZS5iaW5kU3ViTWVudUV2ZW50ID0gZnVuY3Rpb24gYmluZFN1Yk1lbnVFdmVudCgpIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdGhpcy1hbGlhcwogICAgdmFyIHRoYXQgPSB0aGlzOyAvLyDngrnlh7vmiZPlvIDlrZDoj5zljZUKCiAgICB0aGlzLiRlbGVtZW50Lm9uKCdjbGljaycsICcubWR1aS1tZW51LWl0ZW0nLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdmFyICRpdGVtID0gJCh0aGlzKTsKICAgICAgdmFyICR0YXJnZXQgPSAkKGV2ZW50LnRhcmdldCk7IC8vIOemgeeUqOeKtuaAgeiPnOWNleS4jeaTjeS9nAoKICAgICAgaWYgKCRpdGVtLmF0dHIoJ2Rpc2FibGVkJykgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyDmsqHmnInngrnlh7vlnKjlrZDoj5zljZXnmoToj5zljZXpobnkuIrml7bvvIzkuI3mk43kvZzvvIjngrnlnKjkuoblrZDoj5zljZXnmoTnqbrnmb3ljLrln5/jgIHmiJbliIbpmpTnur/kuIrvvIkKCgogICAgICBpZiAoJHRhcmdldC5pcygnLm1kdWktbWVudScpIHx8ICR0YXJnZXQuaXMoJy5tZHVpLWRpdmlkZXInKSkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyDpmLvmraLlhpLms6HvvIzngrnlh7voj5zljZXpobnml7blj6rlnKjmnIDlkI7kuIDnuqfnmoQgbWR1aS1tZW51LWl0ZW0g5LiK55Sf5pWI77yM5LiN5ZCR5LiK5YaS5rOhCgoKICAgICAgaWYgKCEkdGFyZ2V0LnBhcmVudHMoJy5tZHVpLW1lbnUtaXRlbScpLmZpcnN0KCkuaXMoJGl0ZW0pKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIOW9k+WJjeiPnOWNleeahOWtkOiPnOWNlQoKCiAgICAgIHZhciAkc3VibWVudSA9ICRpdGVtLmNoaWxkcmVuKCcubWR1aS1tZW51Jyk7IC8vIOWFiOWFs+mXremZpOW9k+WJjeWtkOiPnOWNleWklueahOaJgOacieWQjOe6p+WtkOiPnOWNlQoKICAgICAgJGl0ZW0ucGFyZW50KCcubWR1aS1tZW51JykuY2hpbGRyZW4oJy5tZHVpLW1lbnUtaXRlbScpLmVhY2goZnVuY3Rpb24gKF8sIGl0ZW0pIHsKICAgICAgICB2YXIgJHRtcFN1Ym1lbnUgPSAkKGl0ZW0pLmNoaWxkcmVuKCcubWR1aS1tZW51Jyk7CgogICAgICAgIGlmICgkdG1wU3VibWVudS5sZW5ndGggJiYgKCEkc3VibWVudS5sZW5ndGggfHwgISR0bXBTdWJtZW51LmlzKCRzdWJtZW51KSkpIHsKICAgICAgICAgIHRoYXQuY2xvc2VTdWJNZW51KCR0bXBTdWJtZW51KTsKICAgICAgICB9CiAgICAgIH0pOyAvLyDliIfmjaLlvZPliY3lrZDoj5zljZUKCiAgICAgIGlmICgkc3VibWVudS5sZW5ndGgpIHsKICAgICAgICB0aGF0LnRvZ2dsZVN1Yk1lbnUoJHN1Ym1lbnUpOwogICAgICB9CiAgICB9KTsKCiAgICBpZiAodGhpcy5vcHRpb25zLnN1Yk1lbnVUcmlnZ2VyID09PSAnaG92ZXInKSB7CiAgICAgIC8vIOS4tOaXtuWtmOWCqCBzZXRUaW1lb3V0IOWvueixoQogICAgICB2YXIgdGltZW91dCA9IG51bGw7CiAgICAgIHZhciB0aW1lb3V0T3BlbiA9IG51bGw7CiAgICAgIHRoaXMuJGVsZW1lbnQub24oJ21vdXNlb3ZlciBtb3VzZW91dCcsICcubWR1aS1tZW51LWl0ZW0nLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICB2YXIgJGl0ZW0gPSAkKHRoaXMpOwogICAgICAgIHZhciBldmVudFR5cGUgPSBldmVudC50eXBlOwogICAgICAgIHZhciAkcmVsYXRlZFRhcmdldCA9ICQoZXZlbnQucmVsYXRlZFRhcmdldCk7IC8vIOemgeeUqOeKtuaAgeeahOiPnOWNleS4jeaTjeS9nAoKICAgICAgICBpZiAoJGl0ZW0uYXR0cignZGlzYWJsZWQnKSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSAvLyDnlKggbW91c2VvdmVyIOaooeaLnyBtb3VzZWVudGVyCgoKICAgICAgICBpZiAoZXZlbnRUeXBlID09PSAnbW91c2VvdmVyJykgewogICAgICAgICAgaWYgKCEkaXRlbS5pcygkcmVsYXRlZFRhcmdldCkgJiYgY29udGFpbnMoJGl0ZW1bMF0sICRyZWxhdGVkVGFyZ2V0WzBdKSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfSAvLyDnlKggbW91c2VvdXQg5qih5oufIG1vdXNlbGVhdmUKICAgICAgICBlbHNlIGlmIChldmVudFR5cGUgPT09ICdtb3VzZW91dCcpIHsKICAgICAgICAgICAgaWYgKCRpdGVtLmlzKCRyZWxhdGVkVGFyZ2V0KSB8fCBjb250YWlucygkaXRlbVswXSwgJHJlbGF0ZWRUYXJnZXRbMF0pKSB7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICB9IC8vIOW9k+WJjeiPnOWNlemhueS4i+eahOWtkOiPnOWNle+8jOacquW/heWtmOWcqAoKCiAgICAgICAgdmFyICRzdWJtZW51ID0gJGl0ZW0uY2hpbGRyZW4oJy5tZHVpLW1lbnUnKTsgLy8g6byg5qCH56e75YWl6I+c5Y2V6aG55pe277yM5pi+56S66I+c5Y2V6aG55LiL55qE5a2Q6I+c5Y2VCgogICAgICAgIGlmIChldmVudFR5cGUgPT09ICdtb3VzZW92ZXInKSB7CiAgICAgICAgICBpZiAoJHN1Ym1lbnUubGVuZ3RoKSB7CiAgICAgICAgICAgIC8vIOW9k+WJjeWtkOiPnOWNleWHhuWkh+aJk+W8gOaXtu+8jOWmguaenOW9k+WJjeWtkOiPnOWNleato+WHhuWkh+edgOWFs+mXre+8jOS4jeeUqOWGjeWFs+mXreS6hgogICAgICAgICAgICB2YXIgdG1wQ2xvc2UgPSAkc3VibWVudS5kYXRhKCd0aW1lb3V0Q2xvc2UubWR1aS5tZW51Jyk7CgogICAgICAgICAgICBpZiAodG1wQ2xvc2UpIHsKICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodG1wQ2xvc2UpOwogICAgICAgICAgICB9IC8vIOWmguaenOW9k+WJjeWtkOiPnOWNleW3sue7j+aJk+W8gO+8jOS4jeaTjeS9nAoKCiAgICAgICAgICAgIGlmICgkc3VibWVudS5oYXNDbGFzcygnbWR1aS1tZW51LW9wZW4nKSkgewogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfSAvLyDlvZPliY3lrZDoj5zljZXlh4blpIfmiZPlvIDml7bvvIzlhbbku5blh4blpIfmiZPlvIDnmoTlrZDoj5zljZXkuI3nlKjlho3miZPlvIDkuoYKCgogICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dE9wZW4pOyAvLyDlh4blpIfmiZPlvIDlvZPliY3lrZDoj5zljZUKCiAgICAgICAgICAgIHRpbWVvdXQgPSB0aW1lb3V0T3BlbiA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiB0aGF0Lm9wZW5TdWJNZW51KCRzdWJtZW51KTsKICAgICAgICAgICAgfSwgdGhhdC5vcHRpb25zLnN1Yk1lbnVEZWxheSk7CiAgICAgICAgICAgICRzdWJtZW51LmRhdGEoJ3RpbWVvdXRPcGVuLm1kdWkubWVudScsIHRpbWVvdXQpOwogICAgICAgICAgfQogICAgICAgIH0gLy8g6byg5qCH56e75Ye66I+c5Y2V6aG55pe277yM5YWz6Zet6I+c5Y2V6aG55LiL55qE5a2Q6I+c5Y2VCiAgICAgICAgZWxzZSBpZiAoZXZlbnRUeXBlID09PSAnbW91c2VvdXQnKSB7CiAgICAgICAgICAgIGlmICgkc3VibWVudS5sZW5ndGgpIHsKICAgICAgICAgICAgICAvLyDpvKDmoIfnp7vlh7roj5zljZXpobnml7bvvIzlpoLmnpzlvZPliY3oj5zljZXpobnkuIvnmoTlrZDoj5zljZXmraPlh4blpIfmiZPlvIDvvIzkuI3nlKjlho3miZPlvIDkuoYKICAgICAgICAgICAgICB2YXIgdG1wT3BlbiA9ICRzdWJtZW51LmRhdGEoJ3RpbWVvdXRPcGVuLm1kdWkubWVudScpOwoKICAgICAgICAgICAgICBpZiAodG1wT3BlbikgewogICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRtcE9wZW4pOwogICAgICAgICAgICAgIH0gLy8g5YeG5aSH5YWz6Zet5b2T5YmN5a2Q6I+c5Y2VCgoKICAgICAgICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhhdC5jbG9zZVN1Yk1lbnUoJHN1Ym1lbnUpOwogICAgICAgICAgICAgIH0sIHRoYXQub3B0aW9ucy5zdWJNZW51RGVsYXkpOwogICAgICAgICAgICAgICRzdWJtZW51LmRhdGEoJ3RpbWVvdXRDbG9zZS5tZHVpLm1lbnUnLCB0aW1lb3V0KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9OwogIC8qKgogICAqIOWKqOeUu+e7k+adn+WbnuiwgwogICAqLwoKCiAgTWVudS5wcm90b3R5cGUudHJhbnNpdGlvbkVuZCA9IGZ1bmN0aW9uIHRyYW5zaXRpb25FbmQoKSB7CiAgICB0aGlzLiRlbGVtZW50LnJlbW92ZUNsYXNzKCdtZHVpLW1lbnUtY2xvc2luZycpOwoKICAgIGlmICh0aGlzLnN0YXRlID09PSAnb3BlbmluZycpIHsKICAgICAgdGhpcy5zdGF0ZSA9ICdvcGVuZWQnOwogICAgICB0aGlzLnRyaWdnZXJFdmVudCgnb3BlbmVkJyk7CiAgICB9CgogICAgaWYgKHRoaXMuc3RhdGUgPT09ICdjbG9zaW5nJykgewogICAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICAgIHRoaXMudHJpZ2dlckV2ZW50KCdjbG9zZWQnKTsgLy8g5YWz6Zet5ZCO77yM5oGi5aSN6I+c5Y2V5qC35byP5Yiw6buY6K6k54q25oCB77yM5bm25oGi5aSNIGZpeGVkIOWumuS9jQoKICAgICAgdGhpcy4kZWxlbWVudC5jc3MoewogICAgICAgIHRvcDogJycsCiAgICAgICAgbGVmdDogJycsCiAgICAgICAgd2lkdGg6ICcnLAogICAgICAgIHBvc2l0aW9uOiAnZml4ZWQnCiAgICAgIH0pOwogICAgfQogIH07CiAgLyoqCiAgICog5YiH5o2i6I+c5Y2V54q25oCBCiAgICovCgoKICBNZW51LnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbiB0b2dnbGUoKSB7CiAgICB0aGlzLmlzT3BlbigpID8gdGhpcy5jbG9zZSgpIDogdGhpcy5vcGVuKCk7CiAgfTsKICAvKioKICAgKiDmiZPlvIDoj5zljZUKICAgKi8KCgogIE1lbnUucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbiBvcGVuKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CgogICAgaWYgKHRoaXMuaXNPcGVuKCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuc3RhdGUgPSAnb3BlbmluZyc7CiAgICB0aGlzLnRyaWdnZXJFdmVudCgnb3BlbicpOwogICAgdGhpcy5yZWFkanVzdCgpOwogICAgdGhpcy4kZWxlbWVudCAvLyDoj5zljZXpmpDol4/nirbmgIHkvb/nlKjkvb/nlKggZml4ZWQg5a6a5L2N44CCCiAgICAuY3NzKCdwb3NpdGlvbicsIHRoaXMub3B0aW9ucy5maXhlZCA/ICdmaXhlZCcgOiAnYWJzb2x1dGUnKS5hZGRDbGFzcygnbWR1aS1tZW51LW9wZW4nKS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMkMS50cmFuc2l0aW9uRW5kKCk7CiAgICB9KTsKICB9OwogIC8qKgogICAqIOWFs+mXreiPnOWNlQogICAqLwoKCiAgTWVudS5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiBjbG9zZSgpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwoKICAgIGlmICghdGhpcy5pc09wZW4oKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5zdGF0ZSA9ICdjbG9zaW5nJzsKICAgIHRoaXMudHJpZ2dlckV2ZW50KCdjbG9zZScpOyAvLyDoj5zljZXlvIDlp4vlhbPpl63ml7bvvIzlhbPpl63miYDmnInlrZDoj5zljZUKCiAgICB0aGlzLiRlbGVtZW50LmZpbmQoJy5tZHVpLW1lbnUnKS5lYWNoKGZ1bmN0aW9uIChfLCBzdWJtZW51KSB7CiAgICAgIHRoaXMkMS5jbG9zZVN1Yk1lbnUoJChzdWJtZW51KSk7CiAgICB9KTsKICAgIHRoaXMuJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kdWktbWVudS1vcGVuJykuYWRkQ2xhc3MoJ21kdWktbWVudS1jbG9zaW5nJykudHJhbnNpdGlvbkVuZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzJDEudHJhbnNpdGlvbkVuZCgpOwogICAgfSk7CiAgfTsKCiAgbWR1aS5NZW51ID0gTWVudTsKICB2YXIgY3VzdG9tQXR0ciQ5ID0gJ21kdWktbWVudSc7CiAgdmFyIGRhdGFOYW1lJDMgPSAnX21kdWlfbWVudSc7CiAgJChmdW5jdGlvbiAoKSB7CiAgICAkZG9jdW1lbnQub24oJ2NsaWNrJywgIlsiICsgY3VzdG9tQXR0ciQ5ICsgIl0iLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7CiAgICAgIHZhciBpbnN0YW5jZSA9ICR0aGlzLmRhdGEoZGF0YU5hbWUkMyk7CgogICAgICBpZiAoIWluc3RhbmNlKSB7CiAgICAgICAgdmFyIG9wdGlvbnMgPSBwYXJzZU9wdGlvbnModGhpcywgY3VzdG9tQXR0ciQ5KTsKICAgICAgICB2YXIgbWVudVNlbGVjdG9yID0gb3B0aW9ucy50YXJnZXQ7IC8vIEB0cy1pZ25vcmUKCiAgICAgICAgZGVsZXRlIG9wdGlvbnMudGFyZ2V0OwogICAgICAgIGluc3RhbmNlID0gbmV3IG1kdWkuTWVudSgkdGhpcywgbWVudVNlbGVjdG9yLCBvcHRpb25zKTsKICAgICAgICAkdGhpcy5kYXRhKGRhdGFOYW1lJDMsIGluc3RhbmNlKTsKICAgICAgICBpbnN0YW5jZS50b2dnbGUoKTsKICAgICAgfQogICAgfSk7CiAgfSk7CiAgcmV0dXJuIG1kdWk7Cn0pOw=="},{"version":3,"sources":["../../node_modules/mdn-polyfills/MouseEvent.js","../../node_modules/mdn-polyfills/CustomEvent.js","../../node_modules/promise-polyfill/src/finally.js","../../node_modules/promise-polyfill/src/allSettled.js","../../node_modules/promise-polyfill/src/index.js","../../node_modules/promise-polyfill/src/polyfill.js","../../node_modules/mdui.jq/es/utils.js","../../node_modules/mdui.jq/es/functions/each.js","../../node_modules/mdui.jq/es/JQ.js","../../node_modules/mdui.jq/es/$.js","../../src/mdui.ts","../../node_modules/mdui.jq/es/methods/each.js","../../node_modules/mdui.jq/es/functions/contains.js","../../node_modules/mdui.jq/es/functions/merge.js","../../node_modules/mdui.jq/es/methods/get.js","../../node_modules/mdui.jq/es/methods/find.js","../../node_modules/mdui.jq/es/methods/utils/event.js","../../node_modules/mdui.jq/es/methods/trigger.js","../../node_modules/mdui.jq/es/functions/extend.js","../../node_modules/mdui.jq/es/functions/param.js","../../node_modules/mdui.jq/es/functions/utils/ajax.js","../../node_modules/mdui.jq/es/functions/ajax.js","../../node_modules/mdui.jq/es/static/ajax.js","../../node_modules/mdui.jq/es/functions/ajaxSetup.js","../../node_modules/mdui.jq/es/static/ajaxSetup.js","../../node_modules/mdui.jq/es/static/contains.js","../../node_modules/mdui.jq/es/functions/utils/data.js","../../node_modules/mdui.jq/es/functions/data.js","../../node_modules/mdui.jq/es/static/data.js","../../node_modules/mdui.jq/es/static/each.js","../../node_modules/mdui.jq/es/static/extend.js","../../node_modules/mdui.jq/es/functions/map.js","../../node_modules/mdui.jq/es/static/map.js","../../node_modules/mdui.jq/es/static/merge.js","../../node_modules/mdui.jq/es/static/param.js","../../node_modules/mdui.jq/es/functions/removeData.js","../../node_modules/mdui.jq/es/static/removeData.js","../../node_modules/mdui.jq/es/functions/unique.js","../../node_modules/mdui.jq/es/static/unique.js","../../node_modules/mdui.jq/es/methods/add.js","../../node_modules/mdui.jq/es/methods/addClass.js","../../node_modules/mdui.jq/es/methods/insertBefore.js","../../node_modules/mdui.jq/es/methods/before.js","../../node_modules/mdui.jq/es/methods/off.js","../../node_modules/mdui.jq/es/methods/on.js","../../node_modules/mdui.jq/es/methods/ajaxStart.js","../../node_modules/mdui.jq/es/methods/map.js","../../node_modules/mdui.jq/es/methods/clone.js","../../node_modules/mdui.jq/es/methods/is.js","../../node_modules/mdui.jq/es/methods/remove.js","../../node_modules/mdui.jq/es/methods/append.js","../../node_modules/mdui.jq/es/methods/appendTo.js","../../node_modules/mdui.jq/es/methods/attr.js","../../node_modules/mdui.jq/es/methods/children.js","../../node_modules/mdui.jq/es/methods/slice.js","../../node_modules/mdui.jq/es/methods/eq.js","../../node_modules/mdui.jq/es/methods/utils/dir.js","../../node_modules/mdui.jq/es/methods/parent.js","../../node_modules/mdui.jq/es/methods/closest.js","../../node_modules/mdui.jq/es/methods/data.js","../../node_modules/mdui.jq/es/methods/empty.js","../../node_modules/mdui.jq/es/methods/extend.js","../../node_modules/mdui.jq/es/methods/filter.js","../../node_modules/mdui.jq/es/methods/first.js","../../node_modules/mdui.jq/es/methods/has.js","../../node_modules/mdui.jq/es/methods/hasClass.js","../../node_modules/mdui.jq/es/methods/width.js","../../node_modules/mdui.jq/es/methods/hide.js","../../node_modules/mdui.jq/es/methods/val.js","../../node_modules/mdui.jq/es/methods/index.js","../../node_modules/mdui.jq/es/methods/last.js","../../node_modules/mdui.jq/es/methods/next.js","../../node_modules/mdui.jq/es/methods/not.js","../../node_modules/mdui.jq/es/methods/offsetParent.js","../../node_modules/mdui.jq/es/methods/position.js","../../node_modules/mdui.jq/es/methods/offset.js","../../node_modules/mdui.jq/es/methods/one.js","../../node_modules/mdui.jq/es/methods/prev.js","../../node_modules/mdui.jq/es/methods/removeAttr.js","../../node_modules/mdui.jq/es/methods/removeData.js","../../node_modules/mdui.jq/es/methods/removeProp.js","../../node_modules/mdui.jq/es/methods/replaceWith.js","../../node_modules/mdui.jq/es/methods/replaceAll.js","../../node_modules/mdui.jq/es/methods/serializeArray.js","../../node_modules/mdui.jq/es/methods/serialize.js","../../node_modules/mdui.jq/es/methods/show.js","../../node_modules/mdui.jq/es/methods/siblings.js","../../node_modules/mdui.jq/es/methods/toggle.js","../../src/jq_extends/methods/reflow.ts","../../src/jq_extends/methods/transition.ts","../../src/jq_extends/methods/transitionEnd.ts","../../src/jq_extends/methods/transformOrigin.ts","../../src/jq_extends/methods/transform.ts","../../src/utils/mutation.ts","../../src/jq_extends/methods/mutation.ts","../../src/jq_extends/static/showOverlay.ts","../../src/jq_extends/static/hideOverlay.ts","../../src/jq_extends/static/lockScreen.ts","../../src/jq_extends/static/unlockScreen.ts","../../src/jq_extends/static/throttle.ts","../../src/jq_extends/static/guid.ts","../../src/global/mutation.ts","../../src/utils/componentEvent.ts","../../src/utils/dom.ts","../../src/components/headroom/index.ts","../../src/utils/parseOptions.ts","../../src/components/headroom/customAttr.ts","../../src/components/collapse/collapseAbstract.ts","../../src/components/collapse/index.ts","../../src/components/collapse/customAttr.ts","../../src/components/panel/index.ts","../../src/components/panel/customAttr.ts","../../src/components/table/index.ts","../../src/utils/touchHandler.ts","../../src/components/ripple/index.ts","../../src/components/textfield/index.ts","../../src/components/slider/index.ts","../../src/components/fab/index.ts","../../src/components/fab/customAttr.ts","../../src/components/select/index.ts","../../src/components/select/customAttr.ts","../../src/components/appbar/index.ts","../../src/components/tab/index.ts","../../src/components/tab/customAttr.ts","../../src/components/drawer/index.ts","../../src/components/drawer/customAttr.ts","../../src/utils/queue.ts","../../src/components/dialog/class.ts","../../src/components/dialog/index.ts","../../src/components/dialog/customAttr.ts","../../src/components/dialog/dialog.ts","../../src/components/dialog/alert.ts","../../src/components/dialog/confirm.ts","../../src/components/dialog/prompt.ts","../../src/components/tooltip/index.ts","../../src/components/tooltip/customAttr.ts","../../src/components/snackbar/index.ts","../../src/components/bottom_nav/index.ts","../../src/components/progress/spinner.ts","../../src/components/menu/index.ts","../../src/components/menu/customAttr.ts"],"names":["e","Promise","promiseFinally","const","let","i","this","get","set","DEFAULT_OPTIONS","customAttr","dataName","currentInst","queueName"],"mappings":";;;;;;;;;;AAAA,GAAC,YAAU;AAAC,QAAG;AAAC,aAAO,IAAI,UAAJ,CAAe,MAAf,CAAP;AAA8B,KAAlC,CAAkC,OAAMA,GAAN,EAAQ,CAAE;;AAAA,QAAI,CAAC,GAAC,UAAS,CAAT,EAAW,CAAX,EAAa;AAAC,MAAA,CAAC,GAAC,CAAC,IAAE;AAAC,QAAA,OAAO,EAAC,CAAC,CAAV;AAAY,QAAA,UAAU,EAAC,CAAC;AAAxB,OAAL;AAAgC,UAAI,CAAC,GAAC,QAAQ,CAAC,WAAT,CAAqB,YAArB,CAAN;AAAyC,aAAO,CAAC,CAAC,cAAF,CAAiB,CAAjB,EAAmB,CAAC,CAAC,OAArB,EAA6B,CAAC,CAAC,UAA/B,EAA0C,MAA1C,EAAiD,CAAjD,EAAmD,CAAC,CAAC,OAAF,IAAW,CAA9D,EAAgE,CAAC,CAAC,OAAF,IAAW,CAA3E,EAA6E,CAAC,CAAC,OAAF,IAAW,CAAxF,EAA0F,CAAC,CAAC,OAAF,IAAW,CAArG,EAAuG,CAAC,CAAC,OAAF,IAAW,CAAC,CAAnH,EAAqH,CAAC,CAAC,MAAF,IAAU,CAAC,CAAhI,EAAkI,CAAC,CAAC,QAAF,IAAY,CAAC,CAA/I,EAAiJ,CAAC,CAAC,OAAF,IAAW,CAAC,CAA7J,EAA+J,CAAC,CAAC,MAAF,IAAU,CAAzK,EAA2K,CAAC,CAAC,aAAF,IAAiB,IAA5L,GAAkM,CAAzM;AAA2M,KAAxS;;AAAyS,IAAA,CAAC,CAAC,SAAF,GAAY,KAAK,CAAC,SAAlB,EAA4B,MAAM,CAAC,UAAP,GAAkB,CAA9C;AAAgD,GAAhZ,EAAD;ACAA,GAAC,YAAU;AAAC,aAAS,CAAT,CAAW,CAAX,EAAa,CAAb,EAAe;AAAC,MAAA,CAAC,GAAC,CAAC,IAAE;AAAC,QAAA,OAAO,EAAC,CAAC,CAAV;AAAY,QAAA,UAAU,EAAC,CAAC,CAAxB;AAA0B,QAAA,MAAM,EAAC,KAAK;AAAtC,OAAL;AAA8C,UAAI,CAAC,GAAC,QAAQ,CAAC,WAAT,CAAqB,aAArB,CAAN;AAA0C,aAAO,CAAC,CAAC,eAAF,CAAkB,CAAlB,EAAoB,CAAC,CAAC,OAAtB,EAA8B,CAAC,CAAC,UAAhC,EAA2C,CAAC,CAAC,MAA7C,GAAqD,CAA5D;AAA8D;;AAAA,kBAAY,OAAO,MAAM,CAAC,WAA1B,KAAwC,CAAC,CAAC,SAAF,GAAY,MAAM,CAAC,KAAP,CAAa,SAAzB,EAAmC,MAAM,CAAC,WAAP,GAAmB,CAA9F;AAAiG,GAAlR,EAAD;ACAA;AACA;AACA;;AACA,WAAS,kBAAT,CAA4B,QAA5B,EAAsC;AACpC,QAAI,WAAW,GAAG,KAAK,WAAvB;AACA,WAAO,KAAK,IAAL,CACL,UAAS,KAAT,EAAgB;AACpB;AACM,aAAO,WAAW,CAAC,OAAZ,CAAoB,QAAQ,EAA5B,EAAgC,IAAhC,CAAqC,YAAW;AACrD,eAAO,KAAP;AACD,OAFM,CAAP;AAGD,KANI,EAOL,UAAS,MAAT,EAAiB;AACrB;AACM,aAAO,WAAW,CAAC,OAAZ,CAAoB,QAAQ,EAA5B,EAAgC,IAAhC,CAAqC,YAAW;AAC7D;AACQ,eAAO,WAAW,CAAC,MAAZ,CAAmB,MAAnB,CAAP;AACD,OAHM,CAAP;AAID,KAbI,CAAP;AAeF;;ACpBA,WAAS,UAAT,CAAoB,GAApB,EAAyB;AACvB,QAAI,CAAC,GAAG,IAAR;AACA,WAAO,IAAI,CAAJ,CAAM,UAAS,OAAT,EAAkB,MAAlB,EAA0B;AACrC,UAAI,EAAE,GAAG,IAAI,OAAO,GAAG,CAAC,MAAX,KAAsB,WAA/B,CAAJ,EAAiD;AAC/C,eAAO,MAAM,CACX,IAAI,SAAJ,CACE,OAAO,GAAP,GACE,GADF,GAEE,GAFF,GAGE,gEAJJ,CADW,CAAb;AAQD;;AACD,UAAI,IAAI,GAAG,KAAK,CAAC,SAAN,CAAgB,KAAhB,CAAsB,IAAtB,CAA2B,GAA3B,CAAX;;AACA,UAAI,IAAI,CAAC,MAAL,KAAgB,CAApB,EAAqB;AAAE,eAAO,OAAO,CAAC,EAAD,CAAd;AAAmB;;AAC1C,UAAI,SAAS,GAAG,IAAI,CAAC,MAArB;;AAEA,eAAS,GAAT,CAAa,CAAb,EAAgB,GAAhB,EAAqB;AACnB,YAAI,GAAG,KAAK,OAAO,GAAP,KAAe,QAAf,IAA2B,OAAO,GAAP,KAAe,UAA/C,CAAP,EAAmE;AACjE,cAAI,IAAI,GAAG,GAAG,CAAC,IAAf;;AACA,cAAI,OAAO,IAAP,KAAgB,UAApB,EAAgC;AAC9B,YAAA,IAAI,CAAC,IAAL,CACE,GADF,EAEE,UAAS,GAAT,EAAc;AACZ,cAAA,GAAG,CAAC,CAAD,EAAI,GAAJ,CAAH;AACD,aAJH,EAKE,UAAS,CAAT,EAAY;AACV,cAAA,IAAI,CAAC,CAAD,CAAJ,GAAU;AAAE,gBAAA,MAAM,EAAE,UAAV;AAAsB,gBAAA,MAAM,EAAE;AAA9B,eAAV;;AACA,kBAAI,EAAE,SAAF,KAAgB,CAApB,EAAuB;AACrB,gBAAA,OAAO,CAAC,IAAD,CAAP;AACD;AACF,aAVH;AAYA;AACD;AACF;;AACD,QAAA,IAAI,CAAC,CAAD,CAAJ,GAAU;AAAE,UAAA,MAAM,EAAE,WAAV;AAAuB,UAAA,KAAK,EAAE;AAA9B,SAAV;;AACA,YAAI,EAAE,SAAF,KAAgB,CAApB,EAAuB;AACrB,UAAA,OAAO,CAAC,IAAD,CAAP;AACD;AACF;;AAED,WAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,IAAI,CAAC,MAAzB,EAAiC,CAAC,EAAlC,EAAsC;AACpC,QAAA,GAAG,CAAC,CAAD,EAAI,IAAI,CAAC,CAAD,CAAR,CAAH;AACD;AACF,KA3CM,CAAP;AA4CF,G,CC3CA;AACA;;;AACA,MAAI,cAAc,GAAG,UAArB;;AAEA,WAAS,OAAT,CAAiB,CAAjB,EAAoB;AAClB,WAAO,OAAO,CAAC,CAAC,IAAI,OAAO,CAAC,CAAC,MAAT,KAAoB,WAA1B,CAAd;AACD;;AAED,WAAS,IAAT,GAAgB,CAAE,C,CAElB;;;AACA,WAAS,IAAT,CAAc,EAAd,EAAkB,OAAlB,EAA2B;AACzB,WAAO,YAAW;AAChB,MAAA,EAAE,CAAC,KAAH,CAAS,OAAT,EAAkB,SAAlB;AACD,KAFD;AAGD;AAED;AACA;AACA;AACA;;;AACA,WAASC,SAAT,CAAiB,EAAjB,EAAqB;AACnB,QAAI,EAAE,gBAAgBA,SAAlB,CAAJ,EACF;AAAI,YAAM,IAAI,SAAJ,CAAc,sCAAd,CAAN;AAA4D;;AAC9D,QAAI,OAAO,EAAP,KAAc,UAAlB,EAA4B;AAAE,YAAM,IAAI,SAAJ,CAAc,gBAAd,CAAN;AAAsC;AACtE;;;AACE,SAAK,MAAL,GAAc,CAAd;AACF;;AACE,SAAK,QAAL,GAAgB,KAAhB;AACF;;AACE,SAAK,MAAL,GAAc,SAAd;AACF;;AACE,SAAK,UAAL,GAAkB,EAAlB;AAEA,IAAA,SAAS,CAAC,EAAD,EAAK,IAAL,CAAT;AACD;;AAED,WAAS,MAAT,CAAgB,IAAhB,EAAsB,QAAtB,EAAgC;AAC9B,WAAO,IAAI,CAAC,MAAL,KAAgB,CAAvB,EAA0B;AACxB,MAAA,IAAI,GAAG,IAAI,CAAC,MAAZ;AACD;;AACD,QAAI,IAAI,CAAC,MAAL,KAAgB,CAApB,EAAuB;AACrB,MAAA,IAAI,CAAC,UAAL,CAAgB,IAAhB,CAAqB,QAArB;;AACA;AACD;;AACD,IAAA,IAAI,CAAC,QAAL,GAAgB,IAAhB;;AACAA,IAAAA,SAAO,CAAC,YAARA,CAAqB,YAAW;AAC9B,UAAI,EAAE,GAAG,IAAI,CAAC,MAAL,KAAgB,CAAhB,GAAoB,QAAQ,CAAC,WAA7B,GAA2C,QAAQ,CAAC,UAA7D;;AACA,UAAI,EAAE,KAAK,IAAX,EAAiB;AACf,SAAC,IAAI,CAAC,MAAL,KAAgB,CAAhB,GAAoB,OAApB,GAA8B,MAA/B,EAAuC,QAAQ,CAAC,OAAhD,EAAyD,IAAI,CAAC,MAA9D;AACA;AACD;;AACD,UAAI,GAAJ;;AACA,UAAI;AACF,QAAA,GAAG,GAAG,EAAE,CAAC,IAAI,CAAC,MAAN,CAAR;AACD,OAFD,CAEE,OAAO,CAAP,EAAU;AACV,QAAA,MAAM,CAAC,QAAQ,CAAC,OAAV,EAAmB,CAAnB,CAAN;AACA;AACD;;AACD,MAAA,OAAO,CAAC,QAAQ,CAAC,OAAV,EAAmB,GAAnB,CAAP;AACD,KAdDA;AAeD;;AAED,WAAS,OAAT,CAAiB,IAAjB,EAAuB,QAAvB,EAAiC;AAC/B,QAAI;AACN;AACI,UAAI,QAAQ,KAAK,IAAjB,EACJ;AAAM,cAAM,IAAI,SAAJ,CAAc,2CAAd,CAAN;AAAiE;;AACnE,UACE,QAAQ,KACP,OAAO,QAAP,KAAoB,QAApB,IAAgC,OAAO,QAAP,KAAoB,UAD7C,CADV,EAGE;AACA,YAAI,IAAI,GAAG,QAAQ,CAAC,IAApB;;AACA,YAAI,QAAQ,YAAYA,SAAxB,EAAiC;AAC/B,UAAA,IAAI,CAAC,MAAL,GAAc,CAAd;AACA,UAAA,IAAI,CAAC,MAAL,GAAc,QAAd;AACA,UAAA,MAAM,CAAC,IAAD,CAAN;AACA;AACD,SALD,MAKO,IAAI,OAAO,IAAP,KAAgB,UAApB,EAAgC;AACrC,UAAA,SAAS,CAAC,IAAI,CAAC,IAAD,EAAO,QAAP,CAAL,EAAuB,IAAvB,CAAT;AACA;AACD;AACF;;AACD,MAAA,IAAI,CAAC,MAAL,GAAc,CAAd;AACA,MAAA,IAAI,CAAC,MAAL,GAAc,QAAd;AACA,MAAA,MAAM,CAAC,IAAD,CAAN;AACD,KAtBD,CAsBE,OAAO,CAAP,EAAU;AACV,MAAA,MAAM,CAAC,IAAD,EAAO,CAAP,CAAN;AACD;AACF;;AAED,WAAS,MAAT,CAAgB,IAAhB,EAAsB,QAAtB,EAAgC;AAC9B,IAAA,IAAI,CAAC,MAAL,GAAc,CAAd;AACA,IAAA,IAAI,CAAC,MAAL,GAAc,QAAd;AACA,IAAA,MAAM,CAAC,IAAD,CAAN;AACD;;AAED,WAAS,MAAT,CAAgB,IAAhB,EAAsB;AACpB,QAAI,IAAI,CAAC,MAAL,KAAgB,CAAhB,IAAqB,IAAI,CAAC,UAAL,CAAgB,MAAhB,KAA2B,CAApD,EAAuD;AACrDA,MAAAA,SAAO,CAAC,YAARA,CAAqB,YAAW;AAC9B,YAAI,CAAC,IAAI,CAAC,QAAV,EAAoB;AAClBA,UAAAA,SAAO,CAAC,qBAARA,CAA8B,IAAI,CAAC,MAAnCA;AACD;AACF,OAJDA;AAKD;;AAED,SAAK,IAAI,CAAC,GAAG,CAAR,EAAW,GAAG,GAAG,IAAI,CAAC,UAAL,CAAgB,MAAtC,EAA8C,CAAC,GAAG,GAAlD,EAAuD,CAAC,EAAxD,EAA4D;AAC1D,MAAA,MAAM,CAAC,IAAD,EAAO,IAAI,CAAC,UAAL,CAAgB,CAAhB,CAAP,CAAN;AACD;;AACD,IAAA,IAAI,CAAC,UAAL,GAAkB,IAAlB;AACD;AAED;AACA;AACA;;;AACA,WAAS,OAAT,CAAiB,WAAjB,EAA8B,UAA9B,EAA0C,OAA1C,EAAmD;AACjD,SAAK,WAAL,GAAmB,OAAO,WAAP,KAAuB,UAAvB,GAAoC,WAApC,GAAkD,IAArE;AACA,SAAK,UAAL,GAAkB,OAAO,UAAP,KAAsB,UAAtB,GAAmC,UAAnC,GAAgD,IAAlE;AACA,SAAK,OAAL,GAAe,OAAf;AACD;AAED;AACA;AACA;AACA;AACA;AACA;;;AACA,WAAS,SAAT,CAAmB,EAAnB,EAAuB,IAAvB,EAA6B;AAC3B,QAAI,IAAI,GAAG,KAAX;;AACA,QAAI;AACF,MAAA,EAAE,CACA,UAAS,KAAT,EAAgB;AACd,YAAI,IAAJ,EAAQ;AAAE;AAAO;;AACjB,QAAA,IAAI,GAAG,IAAP;AACA,QAAA,OAAO,CAAC,IAAD,EAAO,KAAP,CAAP;AACD,OALD,EAMA,UAAS,MAAT,EAAiB;AACf,YAAI,IAAJ,EAAQ;AAAE;AAAO;;AACjB,QAAA,IAAI,GAAG,IAAP;AACA,QAAA,MAAM,CAAC,IAAD,EAAO,MAAP,CAAN;AACD,OAVD,CAAF;AAYD,KAbD,CAaE,OAAO,EAAP,EAAW;AACX,UAAI,IAAJ,EAAQ;AAAE;AAAO;;AACjB,MAAA,IAAI,GAAG,IAAP;AACA,MAAA,MAAM,CAAC,IAAD,EAAO,EAAP,CAAN;AACD;AACF;;AAEDA,EAAAA,SAAO,CAAC,SAARA,CAAkB,OAAlBA,IAA6B,UAAS,UAAT,EAAqB;AAChD,WAAO,KAAK,IAAL,CAAU,IAAV,EAAgB,UAAhB,CAAP;AACD,GAFDA;;AAIAA,EAAAA,SAAO,CAAC,SAARA,CAAkB,IAAlBA,GAAyB,UAAS,WAAT,EAAsB,UAAtB,EAAkC;AAC3D;AACE,QAAI,IAAI,GAAG,IAAI,KAAK,WAAT,CAAqB,IAArB,CAAX;AAEA,IAAA,MAAM,CAAC,IAAD,EAAO,IAAI,OAAJ,CAAY,WAAZ,EAAyB,UAAzB,EAAqC,IAArC,CAAP,CAAN;AACA,WAAO,IAAP;AACD,GANDA;;AAQAA,EAAAA,SAAO,CAAC,SAARA,CAAkB,SAAlBA,IAA+BC,kBAA/BD;;AAEAA,EAAAA,SAAO,CAAC,GAARA,GAAc,UAAS,GAAT,EAAc;AAC1B,WAAO,IAAIA,SAAJ,CAAY,UAAS,OAAT,EAAkB,MAAlB,EAA0B;AAC3C,UAAI,CAAC,OAAO,CAAC,GAAD,CAAZ,EAAmB;AACjB,eAAO,MAAM,CAAC,IAAI,SAAJ,CAAc,8BAAd,CAAD,CAAb;AACD;;AAED,UAAI,IAAI,GAAG,KAAK,CAAC,SAAN,CAAgB,KAAhB,CAAsB,IAAtB,CAA2B,GAA3B,CAAX;;AACA,UAAI,IAAI,CAAC,MAAL,KAAgB,CAApB,EAAqB;AAAE,eAAO,OAAO,CAAC,EAAD,CAAd;AAAmB;;AAC1C,UAAI,SAAS,GAAG,IAAI,CAAC,MAArB;;AAEA,eAAS,GAAT,CAAa,CAAb,EAAgB,GAAhB,EAAqB;AACnB,YAAI;AACF,cAAI,GAAG,KAAK,OAAO,GAAP,KAAe,QAAf,IAA2B,OAAO,GAAP,KAAe,UAA/C,CAAP,EAAmE;AACjE,gBAAI,IAAI,GAAG,GAAG,CAAC,IAAf;;AACA,gBAAI,OAAO,IAAP,KAAgB,UAApB,EAAgC;AAC9B,cAAA,IAAI,CAAC,IAAL,CACE,GADF,EAEE,UAAS,GAAT,EAAc;AACZ,gBAAA,GAAG,CAAC,CAAD,EAAI,GAAJ,CAAH;AACD,eAJH,EAKE,MALF;AAOA;AACD;AACF;;AACD,UAAA,IAAI,CAAC,CAAD,CAAJ,GAAU,GAAV;;AACA,cAAI,EAAE,SAAF,KAAgB,CAApB,EAAuB;AACrB,YAAA,OAAO,CAAC,IAAD,CAAP;AACD;AACF,SAlBD,CAkBE,OAAO,EAAP,EAAW;AACX,UAAA,MAAM,CAAC,EAAD,CAAN;AACD;AACF;;AAED,WAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,IAAI,CAAC,MAAzB,EAAiC,CAAC,EAAlC,EAAsC;AACpC,QAAA,GAAG,CAAC,CAAD,EAAI,IAAI,CAAC,CAAD,CAAR,CAAH;AACD;AACF,KApCM,CAAP;AAqCD,GAtCDA;;AAwCAA,EAAAA,SAAO,CAAC,UAARA,GAAqB,UAArBA;;AAEAA,EAAAA,SAAO,CAAC,OAARA,GAAkB,UAAS,KAAT,EAAgB;AAChC,QAAI,KAAK,IAAI,OAAO,KAAP,KAAiB,QAA1B,IAAsC,KAAK,CAAC,WAAN,KAAsBA,SAAhE,EAAyE;AACvE,aAAO,KAAP;AACD;;AAED,WAAO,IAAIA,SAAJ,CAAY,UAAS,OAAT,EAAkB;AACnC,MAAA,OAAO,CAAC,KAAD,CAAP;AACD,KAFM,CAAP;AAGD,GARDA;;AAUAA,EAAAA,SAAO,CAAC,MAARA,GAAiB,UAAS,KAAT,EAAgB;AAC/B,WAAO,IAAIA,SAAJ,CAAY,UAAS,OAAT,EAAkB,MAAlB,EAA0B;AAC3C,MAAA,MAAM,CAAC,KAAD,CAAN;AACD,KAFM,CAAP;AAGD,GAJDA;;AAMAA,EAAAA,SAAO,CAAC,IAARA,GAAe,UAAS,GAAT,EAAc;AAC3B,WAAO,IAAIA,SAAJ,CAAY,UAAS,OAAT,EAAkB,MAAlB,EAA0B;AAC3C,UAAI,CAAC,OAAO,CAAC,GAAD,CAAZ,EAAmB;AACjB,eAAO,MAAM,CAAC,IAAI,SAAJ,CAAc,+BAAd,CAAD,CAAb;AACD;;AAED,WAAK,IAAI,CAAC,GAAG,CAAR,EAAW,GAAG,GAAG,GAAG,CAAC,MAA1B,EAAkC,CAAC,GAAG,GAAtC,EAA2C,CAAC,EAA5C,EAAgD;AAC9CA,QAAAA,SAAO,CAAC,OAARA,CAAgB,GAAG,CAAC,CAAD,CAAnBA,EAAwB,IAAxBA,CAA6B,OAA7BA,EAAsC,MAAtCA;AACD;AACF,KARM,CAAP;AASD,GAVDA,C,CAYA;;;AACAA,EAAAA,SAAO,CAAC,YAARA,GACA;AACG,SAAO,YAAP,KAAwB,UAAxB,IACC,UAAS,EAAT,EAAa;AACjB;AACM,IAAA,YAAY,CAAC,EAAD,CAAZ;AACD,GAJH,IAKA,UAAS,EAAT,EAAa;AACX,IAAA,cAAc,CAAC,EAAD,EAAK,CAAL,CAAd;AACD,GATHA;;AAWAA,EAAAA,SAAO,CAAC,qBAARA,GAAgC,SAAS,qBAAT,CAA+B,GAA/B,EAAoC;AAClE,QAAI,OAAO,OAAP,KAAmB,WAAnB,IAAkC,OAAtC,EAA+C;AAC7C,MAAA,OAAO,CAAC,IAAR,CAAa,uCAAb,EAAsD,GAAtD,EAD6C,CACc;AAC5D;AACF,GAJDA;ACpPA;;;AACA,MAAI,QAAQ,GAAI,YAAW;AAC3B;AACA;AACA;AACE,QAAI,OAAO,IAAP,KAAgB,WAApB,EAAiC;AAC/B,aAAO,IAAP;AACD;;AACD,QAAI,OAAO,MAAP,KAAkB,WAAtB,EAAmC;AACjC,aAAO,MAAP;AACD;;AACD,QAAI,OAAO,MAAP,KAAkB,WAAtB,EAAmC;AACjC,aAAO,MAAP;AACD;;AACD,UAAM,IAAI,KAAJ,CAAU,gCAAV,CAAN;AACD,GAdc,EAAf,C,CAgBA;AACA;AACA;AACA;;;AACA,MAAI,OAAO,QAAQ,CAAC,SAAD,CAAf,KAA+B,UAAnC,EAA+C;AAC7C,IAAA,QAAQ,CAAC,SAAD,CAAR,GAAsBA,SAAtB;AACD,GAFD,MAEO,IAAI,CAAC,QAAQ,CAAC,OAAT,CAAiB,SAAjB,CAA2B,SAA3B,CAAL,EAA4C;AACjD,IAAA,QAAQ,CAAC,OAAT,CAAiB,SAAjB,CAA2B,SAA3B,IAAwCC,kBAAxC;AACD,GAFM,MAEA,IAAI,CAAC,QAAQ,CAAC,OAAT,CAAiB,UAAtB,EAAkC;AACvC,IAAA,QAAQ,CAAC,OAAT,CAAiB,UAAjB,GAA8B,UAA9B;AACF;;AC5BA,WAAS,UAAT,CAAoB,MAApB,EAA4B;AACxB,WAAO,OAAO,MAAP,KAAkB,UAAzB;AACH;;AACD,WAAS,QAAT,CAAkB,MAAlB,EAA0B;AACtB,WAAO,OAAO,MAAP,KAAkB,QAAzB;AACH;;AACD,WAAS,QAAT,CAAkB,MAAlB,EAA0B;AACtB,WAAO,OAAO,MAAP,KAAkB,QAAzB;AACH;;AACD,WAAS,SAAT,CAAmB,MAAnB,EAA2B;AACvB,WAAO,OAAO,MAAP,KAAkB,SAAzB;AACH;;AACD,WAAS,WAAT,CAAqB,MAArB,EAA6B;AACzB,WAAO,OAAO,MAAP,KAAkB,WAAzB;AACH;;AACD,WAAS,MAAT,CAAgB,MAAhB,EAAwB;AACpB,WAAO,MAAM,KAAK,IAAlB;AACH;;AACD,WAAS,QAAT,CAAkB,MAAlB,EAA0B;AACtB,WAAO,MAAM,YAAY,MAAzB;AACH;;AACD,WAAS,UAAT,CAAoB,MAApB,EAA4B;AACxB,WAAO,MAAM,YAAY,QAAzB;AACH;;AACD,WAAS,SAAT,CAAmB,MAAnB,EAA2B;AACvB,WAAO,MAAM,YAAY,OAAzB;AACH;;AACD,WAAS,MAAT,CAAgB,MAAhB,EAAwB;AACpB,WAAO,MAAM,YAAY,IAAzB;AACH;AACD;AACA;AACA;;;AACA,WAAS,IAAT,GAAgB;AAChB;AACI,WAAO,CAAC,CAAC,MAAM,CAAC,QAAP,CAAgB,YAAzB;AACH;;AACD,WAAS,WAAT,CAAqB,MAArB,EAA6B;AACzB,QAAI,UAAU,CAAC,MAAD,CAAV,IAAsB,QAAQ,CAAC,MAAD,CAAlC,EAA4C;AACxC,aAAO,KAAP;AACH;;AACD,WAAO,QAAQ,CAAC,MAAM,CAAC,MAAR,CAAf;AACH;;AACD,WAAS,YAAT,CAAsB,MAAtB,EAA8B;AAC1B,WAAO,OAAO,MAAP,KAAkB,QAAlB,IAA8B,MAAM,KAAK,IAAhD;AACH;;AACD,WAAS,SAAT,CAAmB,MAAnB,EAA2B;AACvB,WAAO,UAAU,CAAC,MAAD,CAAV,GAAqB,MAAM,CAAC,eAA5B,GAA8C,MAArD;AACH;AACD;AACA;AACA;AACA;;;AACA,WAAS,WAAT,CAAqB,MAArB,EAA6B;AACzB,WAAO,MAAM,CACR,OADE,CACM,OADN,EACe,KADf,EAEF,OAFE,CAEM,WAFN,EAEiB,UAAG,CAAH,EAAM,MAAN,EAAY;AAAA,aAAK,MAAM,CAAC,WAAP,EAAL;AAAyB,KAFtD,CAAP;AAGH;AACD;AACA;AACA;AACA;;;AACA,WAAS,WAAT,CAAqB,MAArB,EAA6B;AACzB,WAAO,MAAM,CAAC,OAAP,CAAe,QAAf,EAAuB,UAAG,QAAH,EAAW;AAAA,aAAK,MAAM,QAAQ,CAAC,WAAT,EAAX;AAAiC,KAAnE,CAAP;AACH;AACD;AACA;AACA;AACA;AACA;;;AACA,WAAS,qBAAT,CAA+B,OAA/B,EAAwC,IAAxC,EAA8C;AAC1C,WAAO,MAAM,CAAC,gBAAP,CAAwB,OAAxB,EAAiC,gBAAjC,CAAkD,WAAW,CAAC,IAAD,CAA7D,CAAP;AACH;AACD;AACA;AACA;AACA;;;AACA,WAAS,WAAT,CAAqB,OAArB,EAA8B;AAC1B,WAAO,qBAAqB,CAAC,OAAD,EAAU,YAAV,CAArB,KAAiD,YAAxD;AACH;AACD;AACA;AACA;AACA;AACA;AACA;;;AACA,WAAS,aAAT,CAAuB,OAAvB,EAAgC,SAAhC,EAA2C,KAA3C,EAAkD;AAC9CC,QAAM,QAAQ,GAAG,SAAS,KAAK,OAAd,GAAwB,CAAC,MAAD,EAAS,OAAT,CAAxB,GAA4C,CAAC,KAAD,EAAQ,QAAR,CAA7DA;AACA,WAAO,CAAC,CAAD,EAAI,CAAJ,EAAO,MAAP,CAAa,UAAE,IAAF,EAAQ,CAAR,EAAW,KAAX,EAAqB;AACrCC,UAAI,IAAI,GAAG,KAAK,GAAG,QAAQ,CAAC,KAAD,CAA3BA;;AACA,UAAI,KAAK,KAAK,QAAd,EAAwB;AACpB,QAAA,IAAI,IAAI,OAAR;AACH;;AACD,aAAO,IAAI,GAAG,UAAU,CAAC,qBAAqB,CAAC,OAAD,EAAU,IAAV,CAArB,IAAwC,GAAzC,CAAxB;AACH,KANM,EAMJ,CANI,CAAP;AAOH;AACD;AACA;AACA;AACA;AACA;;;AACA,WAAS,QAAT,CAAkB,OAAlB,EAA2B,IAA3B,EAAiC;AACjC;AACI,QAAI,IAAI,KAAK,OAAT,IAAoB,IAAI,KAAK,QAAjC,EAA2C;AACvCD,UAAM,WAAW,GAAG,OAAO,CAAC,qBAAR,GAAgC,IAAhC,CAApBA;;AACA,UAAI,WAAW,CAAC,OAAD,CAAf,EAA0B;AACtB,eAAU,WAAW,GAAA,IAArB;AACH;;AACD,aAAU,WAAW,GACjB,aAAa,CAAC,OAAD,EAAU,IAAV,EAAgB,QAAhB,CADP,GAEN,aAAa,CAAC,OAAD,EAAU,IAAV,EAAgB,SAAhB,CAFjB,GAE0C,IAF1C;AAGH;;AACD,WAAO,qBAAqB,CAAC,OAAD,EAAU,IAAV,CAA5B;AACH;AACD;AACA;AACA;AACA;AACA;;;AACA,WAAS,kBAAT,CAA4B,MAA5B,EAAoC,MAApC,EAA4C;AACxCA,QAAM,UAAU,GAAG,QAAQ,CAAC,aAAT,CAAuB,MAAvB,CAAnBA;AACA,IAAA,UAAU,CAAC,SAAX,GAAuB,MAAvB;AACA,WAAO,GAAG,KAAH,CAAS,IAAT,CAAc,UAAU,CAAC,UAAzB,CAAP;AACH;AACD;AACA;AACA;;;AACA,WAAS,WAAT,GAAuB;AACnB,WAAO,KAAP;AACH;AACD;AACA;AACA;;;AACAA,MAAM,SAAS,GAAG,CACd,yBADc,EAEd,aAFc,EAGd,aAHc,EAId,UAJc,EAKd,YALc,EAMd,YANc,EAOd,UAPc,EAQd,YARc,EASd,eATc,EAUd,iBAVc,EAWd,SAXc,EAYd,YAZc,EAad,cAbc,EAcd,YAdc,EAed,SAfc,EAgBd,OAhBc,EAiBd,SAjBc,EAkBd,QAlBc,EAmBd,QAnBc,EAoBd,MApBc,CAAlBA;;ACvIA,WAAS,IAAT,CAAc,MAAd,EAAsB,QAAtB,EAAgC;AAC5B,QAAI,WAAW,CAAC,MAAD,CAAf,EAAyB;AACrB,WAAKC,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,MAAM,CAAC,MAA3B,EAAmC,CAAC,IAAI,CAAxC,EAA2C;AACvC,YAAI,QAAQ,CAAC,IAAT,CAAc,MAAM,CAAC,CAAD,CAApB,EAAyB,CAAzB,EAA4B,MAAM,CAAC,CAAD,CAAlC,MAA2C,KAA/C,EAAsD;AAClD,iBAAO,MAAP;AACH;AACJ;AACJ,KAND,MAOK;AACDD,UAAM,IAAI,GAAG,MAAM,CAAC,IAAP,CAAY,MAAZ,CAAbA;;AACA,WAAKC,IAAIC,GAAC,GAAG,CAAb,EAAgBA,GAAC,GAAG,IAAI,CAAC,MAAzB,EAAiCA,GAAC,IAAI,CAAtC,EAAyC;AACrC,YAAI,QAAQ,CAAC,IAAT,CAAc,MAAM,CAAC,IAAI,CAACA,GAAD,CAAL,CAApB,EAA+B,IAAI,CAACA,GAAD,CAAnC,EAAwC,MAAM,CAAC,IAAI,CAACA,GAAD,CAAL,CAA9C,MAA6D,KAAjE,EAAwE;AACpE,iBAAO,MAAP;AACH;AACJ;AACJ;;AACD,WAAO,MAAP;AACJ;ACjBA;AACA;AACA;;;AACO,MAAM,EAAE,GACX,SAAA,EAAA,CAAY,GAAZ,EAAiB;;AACb,SAAK,MAAL,GAAc,CAAd;;AACA,QAAI,CAAC,GAAL,EAAU;AACN,aAAO,IAAP;AACH;;AACD,IAAA,IAAI,CAAC,GAAD,EAAI,UAAG,CAAH,EAAM,IAAN,EAAe;AAC/B;AACYC,MAAAA,MAAI,CAAC,CAAD,CAAJA,GAAU,IAAVA;AACH,KAHG,CAAJ;AAIA,SAAK,MAAL,GAAc,GAAG,CAAC,MAAlB;AACA,WAAO,IAAP;AACJ,GAZG;;ACDP,WAAS,IAAT,GAAgB;AACZH,QAAM,CAAC,GAAG,UAAU,QAAV,EAAoB;AAC1B,UAAI,CAAC,QAAL,EAAe;AACX,eAAO,IAAI,EAAJ,EAAP;AACH,OAHyB,CAIlC;;;AACQ,UAAI,QAAQ,YAAY,EAAxB,EAA4B;AACxB,eAAO,QAAP;AACH,OAPyB,CAQlC;;;AACQ,UAAI,UAAU,CAAC,QAAD,CAAd,EAA0B;AACtB,YAAI,8BAA8B,IAA9B,CAAmC,QAAQ,CAAC,UAA5C,KACA,QAAQ,CAAC,IADb,EACmB;AACf,UAAA,QAAQ,CAAC,IAAT,CAAc,QAAd,EAAwB,CAAxB;AACH,SAHD,MAIK;AACD,UAAA,QAAQ,CAAC,gBAAT,CAA0B,kBAA1B,EAA4C,YAAA;AAAA,mBAAQ,QAAQ,CAAC,IAAT,CAAc,QAAd,EAAwB,CAAxB,CAAR;AAAkC,WAA9E,EAAgF,KAAhF;AACH;;AACD,eAAO,IAAI,EAAJ,CAAO,CAAC,QAAD,CAAP,CAAP;AACH,OAlByB,CAmBlC;;;AACQ,UAAI,QAAQ,CAAC,QAAD,CAAZ,EAAwB;AACpBA,YAAM,IAAI,GAAG,QAAQ,CAAC,IAAT,EAAbA,CADoB,CAEhC;;AACY,YAAI,IAAI,CAAC,CAAD,CAAJ,KAAY,GAAZ,IAAmB,IAAI,CAAC,IAAI,CAAC,MAAL,GAAc,CAAf,CAAJ,KAA0B,GAAjD,EAAsD;AAClDC,cAAI,QAAQ,GAAG,KAAfA;AACAD,cAAM,IAAI,GAAG;AACT,YAAA,EAAE,EAAE,IADK;AAET,YAAA,EAAE,EAAE,OAFK;AAGT,YAAA,EAAE,EAAE,IAHK;AAIT,YAAA,EAAE,EAAE,IAJK;AAKT,YAAA,KAAK,EAAE,OALE;AAMT,YAAA,MAAM,EAAE;AANC,WAAbA;AAQA,UAAA,IAAI,CAAC,IAAD,EAAK,UAAG,QAAH,EAAa,SAAb,EAA2B;AAChC,gBAAI,IAAI,CAAC,OAAL,CAAY,MAAK,QAAjB,MAAiC,CAArC,EAAwC;AACpC,cAAA,QAAQ,GAAG,SAAX;AACA,qBAAO,KAAP;AACH;;AACD;AACH,WANG,CAAJ;AAOA,iBAAO,IAAI,EAAJ,CAAO,kBAAkB,CAAC,IAAD,EAAO,QAAP,CAAzB,CAAP;AACH,SArBmB,CAsBhC;;;AACYA,YAAM,YAAY,GAAG,QAAQ,CAAC,CAAD,CAAR,KAAgB,GAAhB,IAAuB,CAAC,QAAQ,CAAC,KAAT,CAAe,UAAf,CAA7CA;;AACA,YAAI,CAAC,YAAL,EAAmB;AACf,iBAAO,IAAI,EAAJ,CAAO,QAAQ,CAAC,gBAAT,CAA0B,QAA1B,CAAP,CAAP;AACH;;AACDA,YAAM,OAAO,GAAG,QAAQ,CAAC,cAAT,CAAwB,QAAQ,CAAC,KAAT,CAAe,CAAf,CAAxB,CAAhBA;;AACA,YAAI,OAAJ,EAAa;AACT,iBAAO,IAAI,EAAJ,CAAO,CAAC,OAAD,CAAP,CAAP;AACH;;AACD,eAAO,IAAI,EAAJ,EAAP;AACH;;AACD,UAAI,WAAW,CAAC,QAAD,CAAX,IAAyB,CAAC,MAAM,CAAC,QAAD,CAApC,EAAgD;AAC5C,eAAO,IAAI,EAAJ,CAAO,QAAP,CAAP;AACH;;AACD,aAAO,IAAI,EAAJ,CAAO,CAAC,QAAD,CAAP,CAAP;AACH,KAzDDA;;AA0DA,IAAA,CAAC,CAAC,EAAF,GAAO,EAAE,CAAC,SAAV;AACA,WAAO,CAAP;AACH;;AACDA,MAAM,CAAC,GAAG,IAAI,EAAdA,C,CC9DA;AACA;;AACA,EAAA,UAAU,CAAA,YAAA;AAAA,WAAO,CAAC,CAAC,MAAD,CAAD,CAAU,QAAV,CAAmB,aAAnB,CAAP;AAAwC,GAAxC,CAAV;MAEM,IAAI,GAAG;AACX,IAAA,CAAC,EAAE;AADQ,G;;ACLb,EAAA,CAAC,CAAC,EAAF,CAAK,IAAL,GAAY,UAAU,QAAV,EAAoB;AAC5B,WAAO,IAAI,CAAC,IAAD,EAAO,QAAP,CAAX;AACH,GAFD;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,WAAS,QAAT,CAAkB,SAAlB,EAA6B,QAA7B,EAAuC;AACnC,WAAO,SAAS,KAAK,QAAd,IAA0B,SAAS,CAAC,SAAD,CAAT,CAAqB,QAArB,CAA8B,QAA9B,CAAjC;AACJ;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,WAAS,KAAT,CAAe,KAAf,EAAsB,MAAtB,EAA8B;AAC1B,IAAA,IAAI,CAAC,MAAD,EAAO,UAAG,CAAH,EAAM,KAAN,EAAgB;AACvB,MAAA,KAAK,CAAC,IAAN,CAAW,KAAX;AACH,KAFG,CAAJ;AAGA,WAAO,KAAP;AACJ;;ACfA,EAAA,CAAC,CAAC,EAAF,CAAK,GAAL,GAAW,UAAU,KAAV,EAAiB;AACxB,WAAO,KAAK,KAAK,SAAV,GACD,GAAG,KAAH,CAAS,IAAT,CAAc,IAAd,CADC,GAED,KAAK,KAAK,IAAI,CAAT,GAAa,KAAb,GAAqB,KAAK,GAAG,KAAK,MAAvC,CAFN;AAGH,GAJD;;ACIA,EAAA,CAAC,CAAC,EAAF,CAAK,IAAL,GAAY,UAAU,QAAV,EAAoB;AAC5BA,QAAM,aAAa,GAAG,EAAtBA;AACA,SAAK,IAAL,CAAS,UAAE,CAAF,EAAK,OAAL,EAAiB;AACtB,MAAA,KAAK,CAAC,aAAD,EAAgB,CAAC,CAAC,OAAO,CAAC,gBAAR,CAAyB,QAAzB,CAAD,CAAD,CAAsC,GAAtC,EAAhB,CAAL;AACH,KAFD;AAGA,WAAO,IAAI,EAAJ,CAAO,aAAP,CAAP;AACH,GAND,C,CCDA;;;AACAA,MAAM,QAAQ,GAAG,EAAjBA,C,CACA;;AACAC,MAAI,aAAa,GAAG,CAApBA;AACA;AACA;AACA;;AACA,WAAS,YAAT,CAAsB,OAAtB,EAA+B;AAC3BD,QAAM,GAAG,GAAG,cAAZA,CAD2B,CAE/B;;AACI,QAAI,CAAC,OAAO,CAAC,GAAD,CAAZ,EAAmB;AACvB;AACQ,MAAA,OAAO,CAAC,GAAD,CAAP,GAAe,EAAE,aAAjB;AACH,KAN0B,CAO/B;;;AACI,WAAO,OAAO,CAAC,GAAD,CAAd;AACH;AACD;AACA;AACA;;;AACA,WAAS,KAAT,CAAe,IAAf,EAAqB;AACjBA,QAAM,KAAK,GAAG,IAAI,CAAC,KAAL,CAAW,GAAX,CAAdA;AACA,WAAO;AACH,MAAA,IAAI,EAAE,KAAK,CAAC,CAAD,CADR;AAEH,MAAA,EAAE,EAAE,KAAK,CAAC,KAAN,CAAY,CAAZ,EAAe,IAAf,GAAsB,IAAtB,CAA2B,GAA3B;AAFD,KAAP;AAIH;AACD;AACA;AACA;;;AACA,WAAS,UAAT,CAAoB,EAApB,EAAwB;AACpB,WAAO,IAAI,MAAJ,CAAW,YAAY,EAAE,CAAC,OAAH,CAAW,GAAX,EAAgB,OAAhB,CAAZ,GAAuC,SAAlD,CAAP;AACH;AACD;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,WAAS,WAAT,CAAqB,OAArB,EAA8B,IAA9B,EAAoC,IAApC,EAA0C,QAA1C,EAAoD;AAChDA,QAAM,KAAK,GAAG,KAAK,CAAC,IAAD,CAAnBA;AACA,WAAO,CAAC,QAAQ,CAAC,YAAY,CAAC,OAAD,CAAb,CAAR,IAAmC,EAApC,EAAwC,MAAxC,CAA8C,UAAE,OAAF,EAAS;AAAA,aAAK,OAAO,KACrE,CAAC,KAAK,CAAC,IAAP,IAAe,OAAO,CAAC,IAAR,KAAiB,KAAK,CAAC,IAD+B,CAAP,KAE9D,CAAC,KAAK,CAAC,EAAP,IAAa,UAAU,CAAC,KAAK,CAAC,EAAP,CAAV,CAAqB,IAArB,CAA0B,OAAO,CAAC,EAAlC,CAFiD,MAG9D,CAAC,IAAD,IAAS,YAAY,CAAC,OAAO,CAAC,IAAT,CAAZ,KAA+B,YAAY,CAAC,IAAD,CAHU,MAI9D,CAAC,QAAD,IAAa,OAAO,CAAC,QAAR,KAAqB,QAJ4B,CAAL;AAId,KAJzC,CAAP;AAKH;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,WAAS,GAAT,CAAa,OAAb,EAAsB,KAAtB,EAA6B,IAA7B,EAAmC,IAAnC,EAAyC,QAAzC,EAAmD;AAC/CA,QAAM,SAAS,GAAG,YAAY,CAAC,OAAD,CAA9BA;;AACA,QAAI,CAAC,QAAQ,CAAC,SAAD,CAAb,EAA0B;AACtB,MAAA,QAAQ,CAAC,SAAD,CAAR,GAAsB,EAAtB;AACH,KAJ8C,CAKnD;;;AACIC,QAAI,UAAU,GAAG,KAAjBA;;AACA,QAAI,YAAY,CAAC,IAAD,CAAZ,IAAsB,IAAI,CAAC,UAA/B,EAA2C;AACvC,MAAA,UAAU,GAAG,IAAb;AACH;;AACD,IAAA,KAAK,CAAC,KAAN,CAAY,GAAZ,EAAiB,OAAjB,CAAwB,UAAE,IAAF,EAAW;AAC/B,UAAI,CAAC,IAAL,EAAW;AACP;AACH;;AACDD,UAAM,KAAK,GAAG,KAAK,CAAC,IAAD,CAAnBA;;AACA,eAAS,MAAT,CAAgB,CAAhB,EAAmB,IAAnB,EAAyB;AACjC;AACYA,YAAM,MAAM,GAAG,IAAI,CAAC,KAAL,CAAW,IAAX,EAC3B;AACY,QAAA,CAAC,CAAC,OAAF,KAAc,SAAd,GAA0B,CAAC,CAAD,CAA1B,GAAgC,CAAC,CAAD,EAAI,MAAJ,CAAW,CAAC,CAAC,OAAb,CAFjB,CAAfA;;AAGA,YAAI,MAAM,KAAK,KAAf,EAAsB;AAClB,UAAA,CAAC,CAAC,cAAF;AACA,UAAA,CAAC,CAAC,eAAF;AACH;AACJ;;AACD,eAAS,OAAT,CAAiB,CAAjB,EAAoB;AAC5B;AACY,YAAI,CAAC,CAAC,GAAF,IAAS,CAAC,UAAU,CAAC,CAAC,CAAC,GAAH,CAAV,CAAkB,IAAlB,CAAuB,KAAK,CAAC,EAA7B,CAAd,EAAgD;AAC5C;AACH,SAJe,CAK5B;;;AACY,QAAA,CAAC,CAAC,KAAF,GAAU,IAAV;;AACA,YAAI,QAAJ,EAAc;AAC1B;AACgB,UAAA,CAAC,CAAC,OAAD,CAAD,CACK,IADL,CACU,QADV,EAEK,GAFL,GAGK,OAHL,GAIK,OAJL,CAIY,UAAE,IAAF,EAAW;AACnB,gBAAI,IAAI,KAAK,CAAC,CAAC,MAAX,IACA,QAAQ,CAAC,IAAD,EAAO,CAAC,CAAC,MAAT,CADZ,EAC8B;AAC1B,cAAA,MAAM,CAAC,CAAD,EAAI,IAAJ,CAAN;AACH;AACJ,WATD;AAUH,SAZD,MAaK;AACjB;AACgB,UAAA,MAAM,CAAC,CAAD,EAAI,OAAJ,CAAN;AACH;AACJ;;AACDA,UAAM,OAAO,GAAG;AACZ,QAAA,IAAI,EAAE,KAAK,CAAC,IADA;AAEZ,QAAA,EAAE,EAAE,KAAK,CAAC,EAFE;AAGxB,QAAA,IAAA,EAAY,IAHY;AAIxB,QAAA,QAAA,EAAY,QAJY;AAKZ,QAAA,EAAE,EAAE,QAAQ,CAAC,SAAD,CAAR,CAAoB,MALZ;AAMZ,QAAA,KAAK,EAAE;AANK,OAAhBA;AAQA,MAAA,QAAQ,CAAC,SAAD,CAAR,CAAoB,IAApB,CAAyB,OAAzB;AACA,MAAA,OAAO,CAAC,gBAAR,CAAyB,OAAO,CAAC,IAAjC,EAAuC,OAAvC,EAAgD,UAAhD;AACH,KAlDD;AAmDH;AACD;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,WAAS,MAAT,CAAgB,OAAhB,EAAyB,KAAzB,EAAgC,IAAhC,EAAsC,QAAtC,EAAgD;AAC5CA,QAAM,iBAAiB,GAAG,QAAQ,CAAC,YAAY,CAAC,OAAD,CAAb,CAAR,IAAmC,EAA7DA;;AACAA,QAAM,WAAW,GAAA,UAAI,OAAJ,EAAgB;AAC7B,aAAO,iBAAiB,CAAC,OAAO,CAAC,EAAT,CAAxB;AACA,MAAA,OAAO,CAAC,mBAAR,CAA4B,OAAO,CAAC,IAApC,EAA0C,OAAO,CAAC,KAAlD,EAAyD,KAAzD;AACH,KAHDA;;AAIA,QAAI,CAAC,KAAL,EAAY;AACR,MAAA,iBAAiB,CAAC,OAAlB,CAAyB,UAAE,OAAF,EAAS;AAAA,eAAK,WAAW,CAAC,OAAD,CAAhB;AAAyB,OAA3D;AACH,KAFD,MAGK;AACD,MAAA,KAAK,CAAC,KAAN,CAAY,GAAZ,EAAiB,OAAjB,CAAwB,UAAE,IAAF,EAAW;AAC/B,YAAI,IAAJ,EAAU;AACN,UAAA,WAAW,CAAC,OAAD,EAAU,IAAV,EAAgB,IAAhB,EAAsB,QAAtB,CAAX,CAA2C,OAA3C,CAAkD,UAAE,OAAF,EAAS;AAAA,mBAAK,WAAW,CAAC,OAAD,CAAhB;AAAyB,WAApF;AACH;AACJ,OAJD;AAKH;AACL;;AC9IA,EAAA,CAAC,CAAC,EAAF,CAAK,OAAL,GAAe,UAAU,IAAV,EAAgB,eAAhB,EAAiC;AAC5CA,QAAM,KAAK,GAAG,KAAK,CAAC,IAAD,CAAnBA;AACAC,QAAI,WAAJA;AACAD,QAAM,WAAW,GAAG;AAChB,MAAA,OAAO,EAAE,IADO;AAEhB,MAAA,UAAU,EAAE;AAFI,KAApBA;AAIAA,QAAM,YAAY,GAAG,CAAC,OAAD,EAAU,WAAV,EAAuB,SAAvB,EAAkC,WAAlC,EAA+C,OAA/C,CAAuD,KAAK,CAAC,IAA7D,IAAqE,CAAC,CAA3FA;;AACA,QAAI,YAAJ,EAAkB;AACtB;AACQ,MAAA,WAAW,GAAG,IAAI,UAAJ,CAAe,KAAK,CAAC,IAArB,EAA2B,WAA3B,CAAd;AACH,KAHD,MAIK;AACD,MAAA,WAAW,CAAC,MAAZ,GAAqB,eAArB;AACA,MAAA,WAAW,GAAG,IAAI,WAAJ,CAAgB,KAAK,CAAC,IAAtB,EAA4B,WAA5B,CAAd;AACH,KAf2C,CAgBhD;;;AACI,IAAA,WAAW,CAAC,OAAZ,GAAsB,eAAtB,CAjB4C,CAkBhD;;AACI,IAAA,WAAW,CAAC,GAAZ,GAAkB,KAAK,CAAC,EAAxB;AACA,WAAO,KAAK,IAAL,CAAU,YAAY;AACzB,WAAK,aAAL,CAAmB,WAAnB;AACH,KAFM,CAAP;AAGH,GAvBD;;ACDA,WAAS,MAAT,CAAgB,MAAhB,EAAwB,OAAxB,EAA6C;;;;;;AACzC,IAAA,OAAO,CAAC,OAAR,CAAgB,OAAhB;AACA,IAAA,IAAI,CAAC,OAAD,EAAQ,UAAG,CAAH,EAAM,MAAN,EAAiB;AACzB,MAAA,IAAI,CAAC,MAAD,EAAO,UAAG,IAAH,EAAS,KAAT,EAAmB;AAC1B,YAAI,CAAC,WAAW,CAAC,KAAD,CAAhB,EAAyB;AACrB,UAAA,MAAM,CAAC,IAAD,CAAN,GAAe,KAAf;AACH;AACJ,OAJG,CAAJ;AAKH,KANG,CAAJ;AAOA,WAAO,MAAP;AACJ;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,WAAS,KAAT,CAAe,GAAf,EAAoB;AAChB,QAAI,CAAC,YAAY,CAAC,GAAD,CAAb,IAAsB,CAAC,KAAK,CAAC,OAAN,CAAc,GAAd,CAA3B,EAA+C;AAC3C,aAAO,EAAP;AACH;;AACDA,QAAM,IAAI,GAAG,EAAbA;;AACA,aAAS,WAAT,CAAqB,GAArB,EAA0B,KAA1B,EAAiC;AAC7BC,UAAI,MAAJA;;AACA,UAAI,YAAY,CAAC,KAAD,CAAhB,EAAyB;AACrB,QAAA,IAAI,CAAC,KAAD,EAAM,UAAG,CAAH,EAAM,CAAN,EAAY;AAClB,cAAI,KAAK,CAAC,OAAN,CAAc,KAAd,KAAwB,CAAC,YAAY,CAAC,CAAD,CAAzC,EAA8C;AAC1C,YAAA,MAAM,GAAG,EAAT;AACH,WAFD,MAGK;AACD,YAAA,MAAM,GAAG,CAAT;AACH;;AACD,UAAA,WAAW,CAAI,GAAG,GAAA,GAAH,GAAO,MAAP,GAAa,GAAjB,EAAsB,CAAtB,CAAX;AACH,SARG,CAAJ;AASH,OAVD,MAWK;AACD,YAAI,KAAK,IAAI,IAAT,IAAiB,KAAK,KAAK,EAA/B,EAAmC;AAC/B,UAAA,MAAM,GAAG,GAAT;AACH,SAFD,MAGK;AACD,UAAA,MAAM,GAAG,MAAI,kBAAkB,CAAC,KAAD,CAA/B;AACH;;AACD,QAAA,IAAI,CAAC,IAAL,CAAU,kBAAkB,CAAC,GAAD,CAAlB,GAA0B,MAApC;AACH;AACJ;;AACD,QAAI,KAAK,CAAC,OAAN,CAAc,GAAd,CAAJ,EAAwB;AACpB,MAAA,IAAI,CAAC,GAAD,EAAM,YAAY;AAClB,QAAA,WAAW,CAAC,KAAK,IAAN,EAAY,KAAK,KAAjB,CAAX;AACH,OAFG,CAAJ;AAGH,KAJD,MAKK;AACD,MAAA,IAAI,CAAC,GAAD,EAAM,WAAN,CAAJ;AACH;;AACD,WAAO,IAAI,CAAC,IAAL,CAAU,GAAV,CAAP;AACJ,G,CCpEA;;;AACAD,MAAM,aAAa,GAAG,EAAtBA,C,CACA;;AACAA,MAAM,UAAU,GAAG;AACf,IAAA,SAAS,EAAE,iBADI;AAEf,IAAA,WAAW,EAAE,mBAFE;AAGf,IAAA,SAAS,EAAE,iBAHI;AAIf,IAAA,YAAY,EAAE;AAJC,GAAnBA;ACIA;AACA;AACA;AACA;;AACA,WAAS,iBAAT,CAA2B,MAA3B,EAAmC;AAC/B,WAAO,CAAC,KAAD,EAAQ,MAAR,EAAgB,OAAhB,CAAwB,MAAxB,KAAmC,CAA1C;AACH;AACD;AACA;AACA;AACA;AACA;;;AACA,WAAS,WAAT,CAAqB,GAArB,EAA0B,KAA1B,EAAiC;AAC7B,WAAA,CAAU,GAAG,GAAA,GAAH,GAAO,KAAjB,EAAyB,OAAzB,CAAiC,WAAjC,EAA8C,GAA9C,CAAA;AACH;AACD;AACA;AACA;AACA;;;AACA,WAAS,YAAT,CAAsB,OAAtB,EAA+B;AAC/B;AACIA,QAAM,QAAQ,GAAG;AACb,MAAA,GAAG,EAAE,EADQ;AAEb,MAAA,MAAM,EAAE,KAFK;AAGb,MAAA,IAAI,EAAE,EAHO;AAIb,MAAA,WAAW,EAAE,IAJA;AAKb,MAAA,KAAK,EAAE,IALM;AAMb,MAAA,KAAK,EAAE,IANM;AAOb,MAAA,QAAQ,EAAE,EAPG;AAQb,MAAA,QAAQ,EAAE,EARG;AASb,MAAA,OAAO,EAAE,EATI;AAUb,MAAA,SAAS,EAAE,EAVE;AAWb,MAAA,UAAU,EAAE,EAXC;AAYb,MAAA,QAAQ,EAAE,MAZG;AAab,MAAA,WAAW,EAAE,mCAbA;AAcb,MAAA,OAAO,EAAE,CAdI;AAeb,MAAA,MAAM,EAAE;AAfK,KAAjBA,CAF2B,CAmB/B;;AACI,IAAA,IAAI,CAAC,aAAD,EAAc,UAAG,GAAH,EAAQ,KAAR,EAAkB;AAChCA,UAAM,SAAS,GAAG,CACd,YADc,EAEd,SAFc,EAGd,OAHc,EAId,UAJc,EAKd,YALc,CAAlBA,CADgC,CAQxC;;AACQ,UAAI,SAAS,CAAC,OAAV,CAAkB,GAAlB,IAAyB,CAAzB,IAA8B,CAAC,WAAW,CAAC,KAAD,CAA9C,EAAuD;AACnD,QAAA,QAAQ,CAAC,GAAD,CAAR,GAAgB,KAAhB;AACH;AACJ,KAZG,CAAJ;AAaA,WAAO,MAAM,CAAC,EAAD,EAAK,QAAL,EAAe,OAAf,CAAb;AACH;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,WAAS,IAAT,CAAc,OAAd,EAAuB;AACvB;AACIC,QAAI,UAAU,GAAG,KAAjBA,CAFmB,CAGvB;;AACID,QAAM,WAAW,GAAG,EAApBA,CAJmB,CAKvB;;AACIA,QAAM,aAAa,GAAG,YAAY,CAAC,OAAD,CAAlCA;AACAC,QAAI,GAAG,GAAG,aAAa,CAAC,GAAd,IAAqB,MAAM,CAAC,QAAP,CAAgB,QAAhB,EAA/BA;AACAD,QAAM,MAAM,GAAG,aAAa,CAAC,MAAd,CAAqB,WAArB,EAAfA;AACAC,QAAI,IAAI,GAAG,aAAa,CAAC,IAAzBA;AACAD,QAAM,WAAW,GAAG,aAAa,CAAC,WAAlCA;AACAA,QAAM,KAAK,GAAG,aAAa,CAAC,KAA5BA;AACAA,QAAM,KAAK,GAAG,aAAa,CAAC,KAA5BA;AACAA,QAAM,QAAQ,GAAG,aAAa,CAAC,QAA/BA;AACAA,QAAM,QAAQ,GAAG,aAAa,CAAC,QAA/BA;AACAA,QAAM,OAAO,GAAG,aAAa,CAAC,OAA9BA;AACAA,QAAM,SAAS,GAAG,aAAa,CAAC,SAAhCA;AACAA,QAAM,UAAU,GAAG,aAAa,CAAC,UAAjCA;AACAA,QAAM,QAAQ,GAAG,aAAa,CAAC,QAA/BA;AACAA,QAAM,WAAW,GAAG,aAAa,CAAC,WAAlCA;AACAA,QAAM,OAAO,GAAG,aAAa,CAAC,OAA9BA;AACAA,QAAM,MAAM,GAAG,aAAa,CAAC,MAA7BA,CArBmB,CAsBvB;AACA;;AACI,QAAI,IAAI,KACH,iBAAiB,CAAC,MAAD,CAAjB,IAA6B,WAD1B,CAAJ,IAEA,CAAC,QAAQ,CAAC,IAAD,CAFT,IAGA,EAAE,IAAI,YAAY,WAAlB,CAHA,IAIA,EAAE,IAAI,YAAY,IAAlB,CAJA,IAKA,EAAE,IAAI,YAAY,QAAlB,CALA,IAMA,EAAE,IAAI,YAAY,QAAlB,CANJ,EAMiC;AAC7B,MAAA,IAAI,GAAG,KAAK,CAAC,IAAD,CAAZ;AACH,KAhCkB,CAiCvB;;;AACI,QAAI,IAAI,IAAI,iBAAiB,CAAC,MAAD,CAA7B,EAAuC;AAC3C;AACQ,MAAA,GAAG,GAAG,WAAW,CAAC,GAAD,EAAM,IAAN,CAAjB;AACA,MAAA,IAAI,GAAG,IAAP;AACH;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;;AACI,aAAS,OAAT,CAAiB,KAAjB,EAAwB,MAAxB,EAAgC,QAAhC,EAAmD;;;;uDAAA,CACvD;;;AACQ,UAAI,MAAJ,EAAY;AACR,QAAA,CAAC,CAAC,QAAD,CAAD,CAAY,OAAZ,CAAoB,KAApB,EAA2B,MAA3B;AACH,OAJ8C,CAKvD;;;AACQC,UAAI,OAAJA;AACAA,UAAI,OAAJA;;AACA,UAAI,QAAJ,EAAc;AACtB;AACY,YAAI,QAAQ,IAAI,aAAhB,EAA+B;AAC3C;AACgB,UAAA,OAAO,GAAG,aAAa,CAAC,QAAD,CAAb,CAAsB,KAAtB,CAAuB,aAAvB,EAA2B,IAA3B,CAAV;AACH,SALS,CAMtB;;;AACY,YAAI,aAAa,CAAC,QAAD,CAAjB,EAA6B;AACzC;AACgB,UAAA,OAAO,GAAG,aAAa,CAAC,QAAD,CAAb,CAAsB,KAAtB,CAAuB,aAAvB,EAA2B,IAA3B,CAAV;AACH,SAVS,CAWtB;;;AACY,YAAI,QAAQ,KAAK,YAAb,KACC,OAAO,KAAK,KAAZ,IAAqB,OAAO,KAAK,KADlC,CAAJ,EAC8C;AAC1C,UAAA,UAAU,GAAG,IAAb;AACH;AACJ;AACJ,KAvEkB,CAwEvB;;;AACI,aAAS,GAAT,GAAe;AACXA,UAAI,UAAJA;AACA,aAAO,IAAI,OAAJ,CAAW,UAAE,OAAF,EAAW,MAAX,EAAsB;AAChD;AACY,YAAI,iBAAiB,CAAC,MAAD,CAAjB,IAA6B,CAAC,KAAlC,EAAyC;AACrC,UAAA,GAAG,GAAG,WAAW,CAAC,GAAD,EAAI,OAAO,IAAI,CAAC,GAAL,EAAX,CAAjB;AACH,SAJmC,CAKhD;;;AACYD,YAAM,GAAG,GAAG,IAAI,cAAJ,EAAZA;AACA,QAAA,GAAG,CAAC,IAAJ,CAAS,MAAT,EAAiB,GAAjB,EAAsB,KAAtB,EAA6B,QAA7B,EAAuC,QAAvC;;AACA,YAAI,WAAW,IACV,IAAI,IAAI,CAAC,iBAAiB,CAAC,MAAD,CAA1B,IAAsC,WAAW,KAAK,KAD3D,EACmE;AAC/D,UAAA,GAAG,CAAC,gBAAJ,CAAqB,cAArB,EAAqC,WAArC;AACH,SAXmC,CAYhD;;;AACY,YAAI,QAAQ,KAAK,MAAjB,EAAyB;AACrB,UAAA,GAAG,CAAC,gBAAJ,CAAqB,QAArB,EAA+B,mCAA/B;AACH,SAfmC,CAgBhD;;;AACY,YAAI,OAAJ,EAAa;AACT,UAAA,IAAI,CAAC,OAAD,EAAQ,UAAG,GAAH,EAAQ,KAAR,EAAkB;AAC9C;AACoB,gBAAI,CAAC,WAAW,CAAC,KAAD,CAAhB,EAAyB;AACrB,cAAA,GAAG,CAAC,gBAAJ,CAAqB,GAArB,EAA0B,KAAK,GAAG,EAAlC,EADqB,CACiB;AACzC;AACJ,WALG,CAAJ;AAMH,SAxBmC,CAyBhD;;;AACYA,YAAM,WAAW,GAAG,yBAAyB,IAAzB,CAA8B,GAA9B,KAChB,MAAM,CAAC,EAAP,KAAc,MAAM,CAAC,QAAP,CAAgB,IADlCA;;AAEA,YAAI,CAAC,WAAL,EAAkB;AACd,UAAA,GAAG,CAAC,gBAAJ,CAAqB,kBAArB,EAAyC,gBAAzC;AACH;;AACD,YAAI,SAAJ,EAAe;AACX,UAAA,IAAI,CAAC,SAAD,EAAU,UAAG,GAAH,EAAQ,KAAR,EAAkB;AAChD;AACoB,YAAA,GAAG,CAAC,GAAD,CAAH,GAAW,KAAX;AACH,WAHG,CAAJ;AAIH;;AACD,QAAA,WAAW,CAAC,GAAZ,GAAkB,GAAlB;AACA,QAAA,WAAW,CAAC,OAAZ,GAAsB,aAAtB;AACAC,YAAI,UAAJA;;AACA,QAAA,GAAG,CAAC,MAAJ,GAAa,YAAY;AACrB,cAAI,UAAJ,EAAgB;AACZ,YAAA,YAAY,CAAC,UAAD,CAAZ;AACH,WAHoB,CAIrC;;;AACgBD,cAAM,mBAAmB,GAAI,GAAG,CAAC,MAAJ,IAAc,GAAd,IAAqB,GAAG,CAAC,MAAJ,GAAa,GAAnC,IACxB,GAAG,CAAC,MAAJ,KAAe,GADS,IAExB,GAAG,CAAC,MAAJ,KAAe,CAFnBA;AAGAC,cAAI,YAAJA;;AACA,cAAI,mBAAJ,EAAyB;AACrB,gBAAI,GAAG,CAAC,MAAJ,KAAe,GAAf,IAAsB,MAAM,KAAK,MAArC,EAA6C;AACzC,cAAA,UAAU,GAAG,WAAb;AACH,aAFD,MAGK,IAAI,GAAG,CAAC,MAAJ,KAAe,GAAnB,EAAwB;AACzB,cAAA,UAAU,GAAG,aAAb;AACH,aAFI,MAGA;AACD,cAAA,UAAU,GAAG,SAAb;AACH;;AACD,gBAAI,QAAQ,KAAK,MAAjB,EAAyB;AACrB,kBAAI;AACA,gBAAA,YAAY,GACR,MAAM,KAAK,MAAX,GAAoB,SAApB,GAAgC,IAAI,CAAC,KAAL,CAAW,GAAG,CAAC,YAAf,CADpC;AAEA,gBAAA,WAAW,CAAC,IAAZ,GAAmB,YAAnB;AACH,eAJD,CAKA,OAAO,GAAP,EAAY;AACR,gBAAA,UAAU,GAAG,aAAb;AACA,gBAAA,OAAO,CAAC,UAAU,CAAC,SAAZ,EAAuB,WAAvB,EAAoC,OAApC,EAA6C,GAA7C,EAAkD,UAAlD,CAAP;AACA,gBAAA,MAAM,CAAC,IAAI,KAAJ,CAAU,UAAV,CAAD,CAAN;AACH;;AACD,kBAAI,UAAU,KAAK,aAAnB,EAAkC;AAC9B,gBAAA,OAAO,CAAC,UAAU,CAAC,WAAZ,EAAyB,WAAzB,EAAsC,SAAtC,EAAiD,YAAjD,EAA+D,UAA/D,EAA2E,GAA3E,CAAP;AACA,gBAAA,OAAO,CAAC,YAAD,CAAP;AACH;AACJ,aAfD,MAgBK;AACD,cAAA,YAAY,GACR,MAAM,KAAK,MAAX,GACM,SADN,GAEM,GAAG,CAAC,YAAJ,KAAqB,MAArB,IAA+B,GAAG,CAAC,YAAJ,KAAqB,EAApD,GACI,GAAG,CAAC,YADR,GAEI,GAAG,CAAC,QALlB;AAMA,cAAA,WAAW,CAAC,IAAZ,GAAmB,YAAnB;AACA,cAAA,OAAO,CAAC,UAAU,CAAC,WAAZ,EAAyB,WAAzB,EAAsC,SAAtC,EAAiD,YAAjD,EAA+D,UAA/D,EAA2E,GAA3E,CAAP;AACA,cAAA,OAAO,CAAC,YAAD,CAAP;AACH;AACJ,WArCD,MAsCK;AACD,YAAA,UAAU,GAAG,OAAb;AACA,YAAA,OAAO,CAAC,UAAU,CAAC,SAAZ,EAAuB,WAAvB,EAAoC,OAApC,EAA6C,GAA7C,EAAkD,UAAlD,CAAP;AACA,YAAA,MAAM,CAAC,IAAI,KAAJ,CAAU,UAAV,CAAD,CAAN;AACH,WAnDoB,CAoDrC;;;AACgB,UAAA,IAAI,CAAC,CAAC,aAAa,CAAC,UAAf,EAA2B,UAA3B,CAAD,EAAuC,UAAG,CAAH,EAAM,IAAN,EAAe;AACtD,gBAAI,IAAI,IAAI,IAAI,CAAC,GAAG,CAAC,MAAL,CAAhB,EAA8B;AAC1B,kBAAI,mBAAJ,EAAyB;AACrB,gBAAA,IAAI,CAAC,GAAG,CAAC,MAAL,CAAJ,CAAiB,YAAjB,EAA+B,UAA/B,EAA2C,GAA3C;AACH,eAFD,MAGK;AACD,gBAAA,IAAI,CAAC,GAAG,CAAC,MAAL,CAAJ,CAAiB,GAAjB,EAAsB,UAAtB;AACH;AACJ;AACJ,WATG,CAAJ;AAUA,UAAA,OAAO,CAAC,UAAU,CAAC,YAAZ,EAA0B,WAA1B,EAAuC,UAAvC,EAAmD,GAAnD,EAAwD,UAAxD,CAAP;AACH,SAhED;;AAiEA,QAAA,GAAG,CAAC,OAAJ,GAAc,YAAY;AACtB,cAAI,UAAJ,EAAgB;AACZ,YAAA,YAAY,CAAC,UAAD,CAAZ;AACH;;AACD,UAAA,OAAO,CAAC,UAAU,CAAC,SAAZ,EAAuB,WAAvB,EAAoC,OAApC,EAA6C,GAA7C,EAAkD,GAAG,CAAC,UAAtD,CAAP;AACA,UAAA,OAAO,CAAC,UAAU,CAAC,YAAZ,EAA0B,WAA1B,EAAuC,UAAvC,EAAmD,GAAnD,EAAwD,OAAxD,CAAP;AACA,UAAA,MAAM,CAAC,IAAI,KAAJ,CAAU,GAAG,CAAC,UAAd,CAAD,CAAN;AACH,SAPD;;AAQA,QAAA,GAAG,CAAC,OAAJ,GAAc,YAAY;AACtBA,cAAI,UAAU,GAAG,OAAjBA;;AACA,cAAI,UAAJ,EAAgB;AACZ,YAAA,UAAU,GAAG,SAAb;AACA,YAAA,YAAY,CAAC,UAAD,CAAZ;AACH;;AACD,UAAA,OAAO,CAAC,UAAU,CAAC,SAAZ,EAAuB,WAAvB,EAAoC,OAApC,EAA6C,GAA7C,EAAkD,UAAlD,CAAP;AACA,UAAA,OAAO,CAAC,UAAU,CAAC,YAAZ,EAA0B,WAA1B,EAAuC,UAAvC,EAAmD,GAAnD,EAAwD,UAAxD,CAAP;AACA,UAAA,MAAM,CAAC,IAAI,KAAJ,CAAU,UAAV,CAAD,CAAN;AACH,SATD,CAjHoC,CA2HhD;;;AACY,QAAA,OAAO,CAAC,UAAU,CAAC,SAAZ,EAAuB,WAAvB,EAAoC,YAApC,EAAkD,GAAlD,CAAP;;AACA,YAAI,UAAJ,EAAgB;AACZ,UAAA,MAAM,CAAC,IAAI,KAAJ,CAAU,QAAV,CAAD,CAAN;AACA;AACH,SAhImC,CAiIhD;;;AACY,YAAI,OAAO,GAAG,CAAd,EAAiB;AACb,UAAA,UAAU,GAAG,UAAU,CAAA,YAAO;AAC1B,YAAA,GAAG,CAAC,KAAJ;AACH,WAFsB,EAEpB,OAFoB,CAAvB;AAGH,SAtImC,CAuIhD;;;AACY,QAAA,GAAG,CAAC,IAAJ,CAAS,IAAT;AACH,OAzIM,CAAP;AA0IH;;AACD,WAAO,GAAG,EAAV;AACJ;;AChSA,EAAA,CAAC,CAAC,IAAF,GAAS,IAAT;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,WAAS,SAAT,CAAmB,OAAnB,EAA4B;AACxB,WAAO,MAAM,CAAC,aAAD,EAAgB,OAAhB,CAAb;AACJ;;ACbA,EAAA,CAAC,CAAC,SAAF,GAAc,SAAd;ACAA,EAAA,CAAC,CAAC,QAAF,GAAa,QAAb;ACFAD,MAAM,MAAM,GAAG,yBAAfA;ACGA;AACA;AACA;AACA;AACA;;AACA,WAAS,kBAAT,CAA4B,OAA5B,EAAqC,MAArC,EAA6C;AAC7C;AACI,QAAI,CAAC,OAAO,CAAC,MAAD,CAAZ,EAAsB;AAC1B;AACQ,MAAA,OAAO,CAAC,MAAD,CAAP,GAAkB,EAAlB;AACH;;AACD,IAAA,IAAI,CAAC,MAAD,EAAO,UAAG,GAAH,EAAQ,KAAR,EAAkB;AACjC;AACQ,MAAA,OAAO,CAAC,MAAD,CAAP,CAAgB,WAAW,CAAC,GAAD,CAA3B,IAAoC,KAApC;AACH,KAHG,CAAJ;AAIH;;AACD,WAAS,IAAT,CAAc,OAAd,EAAuB,GAAvB,EAA4B,KAA5B,EAAmC;YAAA,CACnC;AACA;;AACI,QAAI,YAAY,CAAC,GAAD,CAAhB,EAAuB;AACnB,MAAA,kBAAkB,CAAC,OAAD,EAAU,GAAV,CAAlB;AACA,aAAO,GAAP;AACH,KAN8B,CAOnC;AACA;;;AACI,QAAI,CAAC,WAAW,CAAC,KAAD,CAAhB,EAAyB;AACrB,MAAA,kBAAkB,CAAC,OAAD,GAAQ,GAAA,GAAE,EAAF,EAAG,GAAC,CAAC,GAAD,CAAD,GAAQ,KAAX,EAAW,GAAnB,EAAlB;AACA,aAAO,KAAP;AACH,KAZ8B,CAanC;AACA;;;AACI,QAAI,WAAW,CAAC,GAAD,CAAf,EAAsB;AAC1B;AACQ,aAAO,OAAO,CAAC,MAAD,CAAP,GAAkB,OAAO,CAAC,MAAD,CAAzB,GAAoC,EAA3C;AACH,KAlB8B,CAmBnC;AACA;;;AACI,IAAA,GAAG,GAAG,WAAW,CAAC,GAAD,CAAjB,CArB+B,CAsBnC;;AACI,QAAI,OAAO,CAAC,MAAD,CAAP,IAAmB,GAAG,IAAI,OAAO,CAAC,MAAD,CAArC,EAA+C;AACnD;AACQ,aAAO,OAAO,CAAC,MAAD,CAAP,CAAgB,GAAhB,CAAP;AACH;;AACD,WAAO,SAAP;AACJ;;AC7CA,EAAA,CAAC,CAAC,IAAF,GAAS,IAAT;ACAA,EAAA,CAAC,CAAC,IAAF,GAAS,IAAT;;ACCA,EAAA,CAAC,CAAC,MAAF,GAAW,YAAsB;;;;;;;AAC7B,QAAI,OAAO,CAAC,MAAR,KAAmB,CAAvB,EAA0B;AACtB,MAAA,IAAI,CAAC,OAAO,CAAC,CAAD,CAAR,EAAW,UAAG,IAAH,EAAS,KAAT,EAAmB;AAC9BG,QAAAA,MAAI,CAAC,IAAD,CAAJA,GAAa,KAAbA;AACH,OAFG,CAAJ;AAGA,aAAO,IAAP;AACH;;AACD,WAAO,MAAA,CAAA,KAAA,CAAM,KAAA,CAAN,EAAM,CAAC,OAAO,CAAC,KAAR,EAAD,EAAkB,OAAO,CAAC,KAAR,EAAlB,EAAiC,MAAjC,CAAsC,OAAtC,CAAN,CAAP;AACH,GARD;;ACFA,WAAS,GAAT,CAAa,QAAb,EAAuB,QAAvB,EAAiC;;AAC7BF,QAAI,KAAJA;AACAD,QAAM,GAAG,GAAG,EAAZA;AACA,IAAA,IAAI,CAAC,QAAD,EAAS,UAAG,CAAH,EAAM,OAAN,EAAkB;AAC3B,MAAA,KAAK,GAAG,QAAQ,CAAC,IAAT,CAAc,MAAd,EAAsB,OAAtB,EAA+B,CAA/B,CAAR;;AACA,UAAI,KAAK,IAAI,IAAb,EAAmB;AACf,QAAA,GAAG,CAAC,IAAJ,CAAS,KAAT;AACH;AACJ,KALG,CAAJ;AAMA,WAAA,CAAA,GAAA,GAAO,EAAP,EAAU,MAAV,CAAU,KAAV,CAAgB,GAAhB,EAAoB,GAApB,CAAA;AACJ;;ACTA,EAAA,CAAC,CAAC,GAAF,GAAQ,GAAR;ACAA,EAAA,CAAC,CAAC,KAAF,GAAU,KAAV;ACAA,EAAA,CAAC,CAAC,KAAF,GAAU,KAAV;ACCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,WAAS,UAAT,CAAoB,OAApB,EAA6B,IAA7B,EAAmC;AACnC;AACI,QAAI,CAAC,OAAO,CAAC,MAAD,CAAZ,EAAsB;AAClB;AACH;;AACDA,QAAM,MAAM,GAAA,UAAI,QAAJ,EAAiB;AACzB,MAAA,QAAQ,GAAG,WAAW,CAAC,QAAD,CAAtB,CADyB,CAEjC;;AACQ,UAAI,OAAO,CAAC,MAAD,CAAP,CAAgB,QAAhB,CAAJ,EAA+B;AACvC;AACY,QAAA,OAAO,CAAC,MAAD,CAAP,CAAgB,QAAhB,IAA4B,IAA5B,CAF2B,CAGvC;;AACY,eAAO,OAAO,CAAC,MAAD,CAAP,CAAgB,QAAhB,CAAP;AACH;AACJ,KATDA;;AAUA,QAAI,WAAW,CAAC,IAAD,CAAf,EAAuB;AAC3B;AACQ,MAAA,OAAO,CAAC,MAAD,CAAP,GAAkB,IAAlB,CAFmB,CAG3B;;AACQ,aAAO,OAAO,CAAC,MAAD,CAAd,CAJmB,CAK3B;AACK,KAND,MAOK,IAAI,QAAQ,CAAC,IAAD,CAAZ,EAAoB;AACrB,MAAA,IAAI,CACC,KADL,CACW,GADX,EAEK,MAFL,CAEW,UAAE,QAAF,EAAU;AAAA,eAAK,QAAL;AAAa,OAFlC,EAGK,OAHL,CAGY,UAAE,QAAF,EAAU;AAAA,eAAK,MAAM,CAAC,QAAD,CAAX;AAAqB,OAH3C;AAIH,KALI,MAMA;AACD,MAAA,IAAI,CAAC,IAAD,EAAK,UAAG,CAAH,EAAM,QAAN,EAAc;AAAA,eAAK,MAAM,CAAC,QAAD,CAAX;AAAqB,OAAxC,CAAJ;AACH;AACL;;AC9DA,EAAA,CAAC,CAAC,UAAF,GAAe,UAAf;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,WAAS,MAAT,CAAgB,GAAhB,EAAqB;AACjBA,QAAM,MAAM,GAAG,EAAfA;AACA,IAAA,IAAI,CAAC,GAAD,EAAI,UAAG,CAAH,EAAM,GAAN,EAAc;AAClB,UAAI,MAAM,CAAC,OAAP,CAAe,GAAf,MAAwB,CAAC,CAA7B,EAAgC;AAC5B,QAAA,MAAM,CAAC,IAAP,CAAY,GAAZ;AACH;AACJ,KAJG,CAAJ;AAKA,WAAO,MAAP;AACJ;;AChBA,EAAA,CAAC,CAAC,MAAF,GAAW,MAAX;;ACGA,EAAA,CAAC,CAAC,EAAF,CAAK,GAAL,GAAW,UAAU,QAAV,EAAoB;AAC3B,WAAO,IAAI,EAAJ,CAAO,MAAM,CAAC,KAAK,CAAC,KAAK,GAAL,EAAD,EAAa,CAAC,CAAC,QAAD,CAAD,CAAY,GAAZ,EAAb,CAAN,CAAb,CAAP;AACH,GAFD;;ACDA,EAAA,IAAI,CAAC,CAAC,KAAD,EAAQ,QAAR,EAAkB,QAAlB,CAAD,EAA4B,UAAG,CAAH,EAAM,IAAN,EAAe;AAC3C,IAAA,CAAC,CAAC,EAAF,CAAQ,IAAI,GAAA,OAAZ,IAAuB,UAAU,SAAV,EAAqB;AACxC,UAAI,IAAI,KAAK,QAAT,IAAqB,CAAC,SAAS,CAAC,MAApC,EAA4C;AACxC,eAAO,KAAK,IAAL,CAAS,UAAE,CAAF,EAAK,OAAL,EAAiB;AAC7B,UAAA,OAAO,CAAC,YAAR,CAAqB,OAArB,EAA8B,EAA9B;AACH,SAFM,CAAP;AAGH;;AACD,aAAO,KAAK,IAAL,CAAS,UAAE,CAAF,EAAK,OAAL,EAAiB;AAC7B,YAAI,CAAC,SAAS,CAAC,OAAD,CAAd,EAAyB;AACrB;AACH;;AACDA,YAAM,OAAO,GAAG,CAAC,UAAU,CAAC,SAAD,CAAV,GACX,SAAS,CAAC,IAAV,CAAe,OAAf,EAAwB,CAAxB,EAA2B,OAAO,CAAC,YAAR,CAAqB,OAArB,KAAiC,EAA5D,CADW,GAEX,SAFU,EAGX,KAHW,CAGL,GAHK,EAIX,MAJW,CAIL,UAAE,IAAF,EAAM;AAAA,iBAAK,IAAL;AAAS,SAJV,CAAhBA;AAKA,QAAA,IAAI,CAAC,OAAD,EAAQ,UAAG,CAAH,EAAM,GAAN,EAAc;AACtB,UAAA,OAAO,CAAC,SAAR,CAAkB,IAAlB,EAAwB,GAAxB;AACH,SAFG,CAAJ;AAGH,OAZM,CAAP;AAaH,KAnBD;AAoBH,GArBG,CAAJ;ACDA,EAAA,IAAI,CAAC,CAAC,cAAD,EAAiB,aAAjB,CAAD,EAAgC,UAAG,SAAH,EAAc,IAAd,EAAuB;AACvD,IAAA,CAAC,CAAC,EAAF,CAAK,IAAL,IAAa,UAAU,MAAV,EAAkB;AAC3BA,UAAM,QAAQ,GAAG,SAAS,GAAG,CAAC,CAAC,KAAK,GAAL,GAAW,OAAX,EAAD,CAAJ,GAA6B,IAAvDA,CAD2B,CACiC;;AAC5DA,UAAM,OAAO,GAAG,CAAC,CAAC,MAAD,CAAjBA;AACAA,UAAM,MAAM,GAAG,EAAfA;AACA,MAAA,OAAO,CAAC,IAAR,CAAY,UAAE,KAAF,EAAS,MAAT,EAAoB;AAC5B,YAAI,CAAC,MAAM,CAAC,UAAZ,EAAwB;AACpB;AACH;;AACD,QAAA,QAAQ,CAAC,IAAT,CAAa,UAAE,CAAF,EAAK,OAAL,EAAiB;AAC1BA,cAAM,OAAO,GAAG,KAAK,GACf,OAAO,CAAC,SAAR,CAAkB,IAAlB,CADe,GAEf,OAFNA;AAGAA,cAAM,YAAY,GAAG,SAAS,GAAG,MAAM,CAAC,WAAV,GAAwB,MAAtDA;AACA,UAAA,MAAM,CAAC,IAAP,CAAY,OAAZ;AACA,UAAA,MAAM,CAAC,UAAP,CAAkB,YAAlB,CAA+B,OAA/B,EAAwC,YAAxC;AACH,SAPD;AAQH,OAZD;AAaA,aAAO,CAAC,CAAC,SAAS,GAAG,MAAM,CAAC,OAAP,EAAH,GAAsB,MAAhC,CAAR;AACH,KAlBD;AAmBH,GApBG,CAAJ;ACGA;AACA;AACA;AACA;;AACA,WAAS,WAAT,CAAqB,MAArB,EAA6B;AACzB,WAAQ,QAAQ,CAAC,MAAD,CAAR,KAAqB,MAAM,CAAC,CAAD,CAAN,KAAc,GAAd,IAAqB,MAAM,CAAC,MAAM,CAAC,MAAP,GAAgB,CAAjB,CAAN,KAA8B,GAAxE,CAAR;AACH;;AACD,EAAA,IAAI,CAAC,CAAC,QAAD,EAAW,OAAX,CAAD,EAAoB,UAAG,SAAH,EAAc,IAAd,EAAuB;AAC3C,IAAA,CAAC,CAAC,EAAF,CAAK,IAAL,IAAa,YAAmB;;;;+CAAA,CACpC;;;AACQ,UAAI,SAAS,KAAK,CAAlB,EAAqB;AACjB,QAAA,IAAI,GAAG,IAAI,CAAC,OAAL,EAAP;AACH;;AACD,aAAO,KAAK,IAAL,CAAS,UAAE,KAAF,EAAS,OAAT,EAAqB;AACjCA,YAAM,OAAO,GAAG,UAAU,CAAC,IAAI,CAAC,CAAD,CAAL,CAAV,GACV,CAAC,IAAI,CAAC,CAAD,CAAJ,CAAQ,IAAR,CAAa,OAAb,EAAsB,KAAtB,EAA6B,OAAO,CAAC,SAArC,CAAD,CADU,GAEV,IAFNA;AAGA,QAAA,IAAI,CAAC,OAAD,EAAQ,UAAG,CAAH,EAAM,MAAN,EAAiB;AACzBC,cAAI,OAAJA;;AACA,cAAI,WAAW,CAAC,MAAD,CAAf,EAAyB;AACrB,YAAA,OAAO,GAAG,CAAC,CAAC,kBAAkB,CAAC,MAAD,EAAS,KAAT,CAAnB,CAAX;AACH,WAFD,MAGK,IAAI,KAAK,IAAI,SAAS,CAAC,MAAD,CAAtB,EAAgC;AACjC,YAAA,OAAO,GAAG,CAAC,CAAC,MAAM,CAAC,SAAP,CAAiB,IAAjB,CAAD,CAAX;AACH,WAFI,MAGA;AACD,YAAA,OAAO,GAAG,CAAC,CAAC,MAAD,CAAX;AACH;;AACD,UAAA,OAAO,CAAC,SAAS,GAAG,aAAH,GAAmB,cAA7B,CAAP,CAAoD,OAApD;AACH,SAZG,CAAJ;AAaH,OAjBM,CAAP;AAkBH,KAvBD;AAwBH,GAzBG,CAAJ;;ACRA,EAAA,CAAC,CAAC,EAAF,CAAK,GAAL,GAAW,UAAU,KAAV,EAAiB,QAAjB,EAA2B,QAA3B,EAAqC;sBAAA,CAChD;;AACI,QAAI,YAAY,CAAC,KAAD,CAAhB,EAAyB;AACrB,MAAA,IAAI,CAAC,KAAD,EAAM,UAAG,IAAH,EAAS,EAAT,EAAgB;AAClC;AACA;AACYE,QAAAA,MAAI,CAAC,GAALA,CAAS,IAATA,EAAe,QAAfA,EAAyB,EAAzBA;AACH,OAJG,CAAJ;AAKA,aAAO,IAAP;AACH,KAT2C,CAUhD;;;AACI,QAAI,QAAQ,KAAK,KAAb,IAAsB,UAAU,CAAC,QAAD,CAApC,EAAgD;AAC5C,MAAA,QAAQ,GAAG,QAAX;AACA,MAAA,QAAQ,GAAG,SAAX,CAF4C,CAGpD;AACK,KAf2C,CAgBhD;;;AACI,QAAI,QAAQ,KAAK,KAAjB,EAAwB;AACpB,MAAA,QAAQ,GAAG,WAAX;AACH;;AACD,WAAO,KAAK,IAAL,CAAU,YAAY;AACzB,MAAA,MAAM,CAAC,IAAD,EAAO,KAAP,EAAc,QAAd,EAAwB,QAAxB,CAAN;AACH,KAFM,CAAP;AAGH,GAvBD;;ACCA,EAAA,CAAC,CAAC,EAAF,CAAK,EAAL,GAAU,UAAU,KAAV,EAAiB,QAAjB,EAA2B,IAA3B,EAAiC,QAAjC,EAA2C,GAA3C,EAAgD;sBAAA,CAC1D;;AACI,QAAI,YAAY,CAAC,KAAD,CAAhB,EAAyB;AAC7B;AACQ,UAAI,CAAC,QAAQ,CAAC,QAAD,CAAb,EAAyB;AACjC;AACY,QAAA,IAAI,GAAG,IAAI,IAAI,QAAf;AACA,QAAA,QAAQ,GAAG,SAAX;AACH;;AACD,MAAA,IAAI,CAAC,KAAD,EAAM,UAAG,IAAH,EAAS,EAAT,EAAgB;AAClC;AACA;AACYA,QAAAA,MAAI,CAAC,EAALA,CAAQ,IAARA,EAAc,QAAdA,EAAwB,IAAxBA,EAA8B,EAA9BA,EAAkC,GAAlCA;AACH,OAJG,CAAJ;AAKA,aAAO,IAAP;AACH;;AACD,QAAI,IAAI,IAAI,IAAR,IAAgB,QAAQ,IAAI,IAAhC,EAAsC;AAC1C;AACQ,MAAA,QAAQ,GAAG,QAAX;AACA,MAAA,IAAI,GAAG,QAAQ,GAAG,SAAlB;AACH,KAJD,MAKK,IAAI,QAAQ,IAAI,IAAhB,EAAsB;AACvB,UAAI,QAAQ,CAAC,QAAD,CAAZ,EAAwB;AAChC;AACY,QAAA,QAAQ,GAAG,IAAX;AACA,QAAA,IAAI,GAAG,SAAP;AACH,OAJD,MAKK;AACb;AACY,QAAA,QAAQ,GAAG,IAAX;AACA,QAAA,IAAI,GAAG,QAAP;AACA,QAAA,QAAQ,GAAG,SAAX;AACH;AACJ;;AACD,QAAI,QAAQ,KAAK,KAAjB,EAAwB;AACpB,MAAA,QAAQ,GAAG,WAAX;AACH,KAFD,MAGK,IAAI,CAAC,QAAL,EAAe;AAChB,aAAO,IAAP;AACH,KAvCqD,CAwC1D;;;AACI,QAAI,GAAJ,EAAS;AACb;AACQH,UAAM,KAAK,GAAG,IAAdA;;AACAA,UAAM,YAAY,GAAG,QAArBA;;AACA,MAAA,QAAQ,GAAG,UAAU,KAAV,EAAiB;AACxB,QAAA,KAAK,CAAC,GAAN,CAAU,KAAK,CAAC,IAAhB,EAAsB,QAAtB,EAAgC,QAAhC,EADwB,CAEpC;;;AACY,eAAO,YAAY,CAAC,KAAb,CAAmB,IAAnB,EAAyB,SAAzB,CAAP;AACH,OAJD;AAKH;;AACD,WAAO,KAAK,IAAL,CAAU,YAAY;AACzB,MAAA,GAAG,CAAC,IAAD,EAAO,KAAP,EAAc,QAAd,EAAwB,IAAxB,EAA8B,QAA9B,CAAH;AACH,KAFM,CAAP;AAGH,GAtDD;;ACFA,EAAA,IAAI,CAAC,UAAD,EAAW,UAAG,IAAH,EAAS,SAAT,EAAuB;AAClC,IAAA,CAAC,CAAC,EAAF,CAAK,IAAL,IAAa,UAAU,EAAV,EAAc;AACvB,aAAO,KAAK,EAAL,CAAQ,SAAR,EAAiB,UAAG,CAAH,EAAM,MAAN,EAAiB;AACrC,QAAA,EAAE,CAAC,CAAD,EAAI,MAAM,CAAC,GAAX,EAAgB,MAAM,CAAC,OAAvB,EAAgC,MAAM,CAAC,IAAvC,CAAF;AACH,OAFM,CAAP;AAGH,KAJD;AAKH,GANG,CAAJ;;ACDA,EAAA,CAAC,CAAC,EAAF,CAAK,GAAL,GAAW,UAAU,QAAV,EAAoB;AAC3B,WAAO,IAAI,EAAJ,CAAO,GAAG,CAAC,IAAD,EAAK,UAAG,OAAH,EAAY,CAAZ,EAAa;AAAA,aAAK,QAAQ,CAAC,IAAT,CAAc,OAAd,EAAuB,CAAvB,EAA0B,OAA1B,CAAL;AAAuC,KAAzD,CAAV,CAAP;AACH,GAFD;;ACDA,EAAA,CAAC,CAAC,EAAF,CAAK,KAAL,GAAa,YAAY;AACrB,WAAO,KAAK,GAAL,CAAS,YAAY;AACxB,aAAO,KAAK,SAAL,CAAe,IAAf,CAAP;AACH,KAFM,CAAP;AAGH,GAJD;;ACCA,EAAA,CAAC,CAAC,EAAF,CAAK,EAAL,GAAU,UAAU,QAAV,EAAoB;AAC1BC,QAAI,SAAS,GAAG,KAAhBA;;AACA,QAAI,UAAU,CAAC,QAAD,CAAd,EAA0B;AACtB,WAAK,IAAL,CAAS,UAAE,KAAF,EAAS,OAAT,EAAqB;AAC1B,YAAI,QAAQ,CAAC,IAAT,CAAc,OAAd,EAAuB,KAAvB,EAA8B,OAA9B,CAAJ,EAA4C;AACxC,UAAA,SAAS,GAAG,IAAZ;AACH;AACJ,OAJD;AAKA,aAAO,SAAP;AACH;;AACD,QAAI,QAAQ,CAAC,QAAD,CAAZ,EAAwB;AACpB,WAAK,IAAL,CAAS,UAAE,CAAF,EAAK,OAAL,EAAiB;AACtB,YAAI,UAAU,CAAC,OAAD,CAAV,IAAuB,QAAQ,CAAC,OAAD,CAAnC,EAA8C;AAC1C;AACH,SAHqB,CAIlC;;;AACYD,YAAM,OAAO,GAAG,OAAO,CAAC,OAAR,IAAmB,OAAO,CAAC,iBAA3CA;;AACA,YAAI,OAAO,CAAC,IAAR,CAAa,OAAb,EAAsB,QAAtB,CAAJ,EAAqC;AACjC,UAAA,SAAS,GAAG,IAAZ;AACH;AACJ,OATD;AAUA,aAAO,SAAP;AACH;;AACDA,QAAM,YAAY,GAAG,CAAC,CAAC,QAAD,CAAtBA;AACA,SAAK,IAAL,CAAS,UAAE,CAAF,EAAK,OAAL,EAAiB;AACtB,MAAA,YAAY,CAAC,IAAb,CAAiB,UAAE,CAAF,EAAK,OAAL,EAAiB;AAC9B,YAAI,OAAO,KAAK,OAAhB,EAAyB;AACrB,UAAA,SAAS,GAAG,IAAZ;AACH;AACJ,OAJD;AAKH,KAND;AAOA,WAAO,SAAP;AACH,GAhCD;;ACAA,EAAA,CAAC,CAAC,EAAF,CAAK,MAAL,GAAc,UAAU,QAAV,EAAoB;AAC9B,WAAO,KAAK,IAAL,CAAS,UAAE,CAAF,EAAK,OAAL,EAAiB;AAC7B,UAAI,OAAO,CAAC,UAAR,KAAuB,CAAC,QAAD,IAAa,CAAC,CAAC,OAAD,CAAD,CAAW,EAAX,CAAc,QAAd,CAApC,CAAJ,EAAkE;AAC9D,QAAA,OAAO,CAAC,UAAR,CAAmB,WAAnB,CAA+B,OAA/B;AACH;AACJ,KAJM,CAAP;AAKH,GAND;;ACMA,EAAA,IAAI,CAAC,CAAC,SAAD,EAAY,QAAZ,CAAD,EAAsB,UAAG,SAAH,EAAc,IAAd,EAAuB;AAC7C,IAAA,CAAC,CAAC,EAAF,CAAK,IAAL,IAAa,YAAmB;;;;;;AAC5B,aAAO,KAAK,IAAL,CAAS,UAAE,KAAF,EAAS,OAAT,EAAqB;;AACjCA,YAAM,UAAU,GAAG,OAAO,CAAC,UAA3BA;AACAA,YAAM,WAAW,GAAG,UAAU,CAAC,MAA/BA;AACAA,YAAM,KAAK,GAAG,WAAW,GACnB,UAAU,CAAC,SAAS,GAAG,WAAW,GAAG,CAAjB,GAAqB,CAA/B,CADS,GAEnB,QAAQ,CAAC,aAAT,CAAuB,KAAvB,CAFNA;;AAGA,YAAI,CAAC,WAAL,EAAkB;AACd,UAAA,OAAO,CAAC,WAAR,CAAoB,KAApB;AACH;;AACDC,YAAI,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC,CAAD,CAAL,CAAV,GACT,CAAC,IAAI,CAAC,CAAD,CAAJ,CAAQ,IAAR,CAAa,OAAb,EAAsB,KAAtB,EAA6B,OAAO,CAAC,SAArC,CAAD,CADS,GAET,IAFNA,CATiC,CAY7C;;AACY,YAAI,KAAJ,EAAW;AACP,UAAA,QAAQ,GAAG,QAAQ,CAAC,GAAT,CAAY,UAAE,OAAF,EAAc;AACjC,mBAAO,QAAQ,CAAC,OAAD,CAAR,GAAoB,OAApB,GAA8B,CAAC,CAAC,OAAD,CAAD,CAAW,KAAX,EAArC;AACH,WAFU,CAAX;AAGH;;AACb,SAAA,GAAA,GAAY,CAAC,CAAC,KAAD,CAAb,EAAqB,SAAS,GAAG,OAAH,GAAa,QAA3C,EAAmD,KAAnD,CAAoD,GAApD,EAAwD,QAAxD;;AACY,YAAI,CAAC,WAAL,EAAkB;AACd,UAAA,OAAO,CAAC,WAAR,CAAoB,KAApB;AACH;AACJ,OAtBM,CAAP;AAuBH,KAxBD;AAyBH,GA1BG,CAAJ;ACHA,EAAA,IAAI,CAAC,CAAC,UAAD,EAAa,WAAb,CAAD,EAA0B,UAAG,SAAH,EAAc,IAAd,EAAuB;AACjD,IAAA,CAAC,CAAC,EAAF,CAAK,IAAL,IAAa,UAAU,MAAV,EAAkB;AAC3BD,UAAM,WAAW,GAAG,EAApBA;AACAA,UAAM,OAAO,GAAG,CAAC,CAAC,MAAD,CAAD,CAAU,GAAV,CAAa,UAAE,CAAF,EAAK,OAAL,EAAiB;AAC1CA,YAAM,UAAU,GAAG,OAAO,CAAC,UAA3BA;AACAA,YAAM,WAAW,GAAG,UAAU,CAAC,MAA/BA;;AACA,YAAI,WAAJ,EAAiB;AACb,iBAAO,UAAU,CAAC,SAAS,GAAG,CAAH,GAAO,WAAW,GAAG,CAA/B,CAAjB;AACH;;AACDA,YAAM,KAAK,GAAG,QAAQ,CAAC,aAAT,CAAuB,KAAvB,CAAdA;AACA,QAAA,OAAO,CAAC,WAAR,CAAoB,KAApB;AACA,QAAA,WAAW,CAAC,IAAZ,CAAiB,KAAjB;AACA,eAAO,KAAP;AACH,OAVe,CAAhBA;AAWAA,UAAM,OAAO,GAAG,KAAK,SAAS,GAAG,cAAH,GAAoB,aAAlC,EAAiD,OAAjD,CAAhBA;AACA,MAAA,CAAC,CAAC,WAAD,CAAD,CAAe,MAAf;AACA,aAAO,OAAP;AACH,KAhBD;AAiBH,GAlBG,CAAJ;ACFA,EAAA,IAAI,CAAC,CAAC,MAAD,EAAS,MAAT,EAAiB,KAAjB,CAAD,EAAwB,UAAG,SAAH,EAAc,IAAd,EAAuB;AAC/C,aAAS,GAAT,CAAa,OAAb,EAAsB,GAAtB,EAA2B,KAA3B,EAAkC;AACtC;AACQ,UAAI,WAAW,CAAC,KAAD,CAAf,EAAwB;AACpB;AACH;;AACD,cAAQ,SAAR;AACR;AACY,aAAK,CAAL;AACI,cAAI,MAAM,CAAC,KAAD,CAAV,EAAmB;AACf,YAAA,OAAO,CAAC,eAAR,CAAwB,GAAxB;AACH,WAFD,MAGK;AACD,YAAA,OAAO,CAAC,YAAR,CAAqB,GAArB,EAA0B,KAA1B;AACH;;AACD;AAChB;;AACY,aAAK,CAAL;AACZ;AACgB,UAAA,OAAO,CAAC,GAAD,CAAP,GAAe,KAAf;AACA;AAChB;;AACY;AACI,UAAA,GAAG,GAAG,WAAW,CAAC,GAAD,CAAjB,CADJ,CAEZ;;AACgB,UAAA,OAAO,CAAC,KAAR,CAAc,GAAd,IAAqB,QAAQ,CAAC,KAAD,CAAR,GACrC,KAAyB,KAAzB,IAAiC,SAAS,CAAC,OAAV,CAAkB,GAAlB,IAAyB,CAAC,CAA1B,GAA8B,EAA9B,GAAmC,IAApE,CADqC,GAEf,KAFN;AAGA;AAtBR;AAwBH;;AACD,aAAS,GAAT,CAAa,OAAb,EAAsB,GAAtB,EAA2B;AACvB,cAAQ,SAAR;AACR;AACY,aAAK,CAAL;AACZ;AACgBA,cAAM,KAAK,GAAG,OAAO,CAAC,YAAR,CAAqB,GAArB,CAAdA;AACA,iBAAO,MAAM,CAAC,KAAD,CAAN,GAAgB,SAAhB,GAA4B,KAAnC;AAChB;;AACY,aAAK,CAAL;AACZ;AACgB,iBAAO,OAAO,CAAC,GAAD,CAAd;AAChB;;AACY;AACI,iBAAO,QAAQ,CAAC,OAAD,EAAU,GAAV,CAAf;AAZR;AAcH;;AACD,IAAA,CAAC,CAAC,EAAF,CAAK,IAAL,IAAa,UAAU,GAAV,EAAe,KAAf,EAAsB;;;AAC/B,UAAI,YAAY,CAAC,GAAD,CAAhB,EAAuB;AACnB,QAAA,IAAI,CAAC,GAAD,EAAI,UAAG,CAAH,EAAM,CAAN,EAAY;AAChC;AACgBG,UAAAA,MAAI,CAAC,IAAD,CAAJA,CAAW,CAAXA,EAAc,CAAdA;AACH,SAHG,CAAJ;AAIA,eAAO,IAAP;AACH;;AACD,UAAI,SAAS,CAAC,MAAV,KAAqB,CAAzB,EAA4B;AACxBH,YAAM,OAAO,GAAG,KAAK,CAAL,CAAhBA;AACA,eAAO,SAAS,CAAC,OAAD,CAAT,GAAqB,GAAG,CAAC,OAAD,EAAU,GAAV,CAAxB,GAAyC,SAAhD;AACH;;AACD,aAAO,KAAK,IAAL,CAAS,UAAE,CAAF,EAAK,OAAL,EAAiB;AAC7B,QAAA,GAAG,CAAC,OAAD,EAAU,GAAV,EAAe,UAAU,CAAC,KAAD,CAAV,GAAoB,KAAK,CAAC,IAAN,CAAW,OAAX,EAAoB,CAApB,EAAuB,GAAG,CAAC,OAAD,EAAU,GAAV,CAA1B,CAApB,GAAgE,KAA/E,CAAH;AACH,OAFM,CAAP;AAGH,KAfD;AAgBH,GA/DG,CAAJ;;ACGA,EAAA,CAAC,CAAC,EAAF,CAAK,QAAL,GAAgB,UAAU,QAAV,EAAoB;AAChCA,QAAM,QAAQ,GAAG,EAAjBA;AACA,SAAK,IAAL,CAAS,UAAE,CAAF,EAAK,OAAL,EAAiB;AACtB,MAAA,IAAI,CAAC,OAAO,CAAC,UAAT,EAAmB,UAAG,EAAH,EAAO,SAAP,EAAqB;AACxC,YAAI,CAAC,SAAS,CAAC,SAAD,CAAd,EAA2B;AACvB;AACH;;AACD,YAAI,CAAC,QAAD,IAAa,CAAC,CAAC,SAAD,CAAD,CAAa,EAAb,CAAgB,QAAhB,CAAjB,EAA4C;AACxC,UAAA,QAAQ,CAAC,IAAT,CAAc,SAAd;AACH;AACJ,OAPG,CAAJ;AAQH,KATD;AAUA,WAAO,IAAI,EAAJ,CAAO,MAAM,CAAC,QAAD,CAAb,CAAP;AACH,GAbD;;ACLA,EAAA,CAAC,CAAC,EAAF,CAAK,KAAL,GAAa,YAAmB;;;;;;AAC5B,WAAO,IAAI,EAAJ,CAAO,GAAG,KAAH,CAAS,KAAT,CAAe,IAAf,EAAqB,IAArB,CAAP,CAAP;AACH,GAFD;;ACCA,EAAA,CAAC,CAAC,EAAF,CAAK,EAAL,GAAU,UAAU,KAAV,EAAiB;AACvBA,QAAM,GAAG,GAAG,KAAK,KAAK,CAAC,CAAX,GAAe,KAAK,KAAL,CAAW,KAAX,CAAf,GAAmC,KAAK,KAAL,CAAW,KAAX,EAAkB,CAAC,KAAD,GAAS,CAA3B,CAA/CA;AACA,WAAO,IAAI,EAAJ,CAAO,GAAP,CAAP;AACH,GAHD;;ACGe,WAAS,GAAT,CAAa,SAAb,EAAwB,SAAxB,EAAmC,IAAnC,EAAyC,QAAzC,EAAmD,MAAnD,EAA2D;AACtEA,QAAM,GAAG,GAAG,EAAZA;AACAC,QAAI,MAAJA;AACA,IAAA,SAAS,CAAC,IAAV,CAAc,UAAE,CAAF,EAAK,OAAL,EAAiB;AAC3B,MAAA,MAAM,GAAG,OAAO,CAAC,IAAD,CAAhB,CAD2B,CAEnC;;AACQ,aAAO,MAAM,IAAI,SAAS,CAAC,MAAD,CAA1B,EAAoC;AAC5C;AACY,YAAI,SAAS,KAAK,CAAlB,EAAqB;AACjB,cAAI,QAAQ,IAAI,CAAC,CAAC,MAAD,CAAD,CAAU,EAAV,CAAa,QAAb,CAAhB,EAAwC;AACpC;AACH;;AACD,cAAI,CAAC,MAAD,IAAW,CAAC,CAAC,MAAD,CAAD,CAAU,EAAV,CAAa,MAAb,CAAf,EAAqC;AACjC,YAAA,GAAG,CAAC,IAAJ,CAAS,MAAT;AACH;AACJ,SAPD,CAQZ;AARY,aASK,IAAI,SAAS,KAAK,CAAlB,EAAqB;AACtB,gBAAI,CAAC,QAAD,IAAa,CAAC,CAAC,MAAD,CAAD,CAAU,EAAV,CAAa,QAAb,CAAjB,EAAyC;AACrC,cAAA,GAAG,CAAC,IAAJ,CAAS,MAAT;AACH;;AACD;AACH,WALI,CAMjB;AANiB,eAOA;AACD,kBAAI,CAAC,QAAD,IAAa,CAAC,CAAC,MAAD,CAAD,CAAU,EAAV,CAAa,QAAb,CAAjB,EAAyC;AACrC,gBAAA,GAAG,CAAC,IAAJ,CAAS,MAAT;AACH;AACJ,aAtB+B,CAuB5C;;;AACY,QAAA,MAAM,GAAG,MAAM,CAAC,IAAD,CAAf;AACH;AACJ,KA7BD;AA8BA,WAAO,IAAI,EAAJ,CAAO,MAAM,CAAC,GAAD,CAAb,CAAP;AACJ;;ACpCA,EAAA,IAAI,CAAC,CAAC,EAAD,EAAK,GAAL,EAAU,QAAV,CAAD,EAAoB,UAAG,SAAH,EAAc,IAAd,EAAuB;AAC3C,IAAA,CAAC,CAAC,EAAF,CAAI,WAAU,IAAd,IAAwB,UAAU,QAAV,EAAoB,MAApB,EAA4B;AACxD;AACQD,UAAM,MAAM,GAAG,CAAC,SAAD,GAAa,IAAb,GAAoB,CAAC,CAAC,KAAK,GAAL,GAAW,OAAX,EAAD,CAApCA;AACA,aAAO,GAAG,CAAC,MAAD,EAAS,SAAT,EAAoB,YAApB,EAAkC,QAAlC,EAA4C,MAA5C,CAAV;AACH,KAJD;AAKH,GANG,CAAJ;;ACCA,EAAA,CAAC,CAAC,EAAF,CAAK,OAAL,GAAe,UAAU,QAAV,EAAoB;AAC/B,QAAI,KAAK,EAAL,CAAQ,QAAR,CAAJ,EAAuB;AACnB,aAAO,IAAP;AACH;;AACDA,QAAM,OAAO,GAAG,EAAhBA;AACA,SAAK,OAAL,GAAe,IAAf,CAAmB,UAAE,CAAF,EAAK,OAAL,EAAiB;AAChC,UAAI,CAAC,CAAC,OAAD,CAAD,CAAW,EAAX,CAAc,QAAd,CAAJ,EAA6B;AACzB,QAAA,OAAO,CAAC,IAAR,CAAa,OAAb;AACA,eAAO,KAAP;AACH;AACJ,KALD;AAMA,WAAO,IAAI,EAAJ,CAAO,OAAP,CAAP;AACH,GAZD;;ACDAA,MAAM,MAAM,GAAG,8BAAfA,C,CACA;;AACA,WAAS,OAAT,CAAiB,KAAjB,EAAwB;AACpB,QAAI,KAAK,KAAK,MAAd,EAAsB;AAClB,aAAO,IAAP;AACH;;AACD,QAAI,KAAK,KAAK,OAAd,EAAuB;AACnB,aAAO,KAAP;AACH;;AACD,QAAI,KAAK,KAAK,MAAd,EAAsB;AAClB,aAAO,IAAP;AACH;;AACD,QAAI,KAAK,KAAK,CAAC,KAAD,GAAS,EAAvB,EAA2B;AACvB,aAAO,CAAC,KAAR;AACH;;AACD,QAAI,MAAM,CAAC,IAAP,CAAY,KAAZ,CAAJ,EAAwB;AACpB,aAAO,IAAI,CAAC,KAAL,CAAW,KAAX,CAAP;AACH;;AACD,WAAO,KAAP;AACH,G,CACD;;;AACA,WAAS,QAAT,CAAkB,OAAlB,EAA2B,GAA3B,EAAgC,KAAhC,EAAuC;AACnC,QAAI,WAAW,CAAC,KAAD,CAAX,IAAsB,OAAO,CAAC,QAAR,KAAqB,CAA/C,EAAkD;AAC9CA,UAAM,IAAI,GAAG,UAAU,WAAW,CAAC,GAAD,CAAlCA;AACA,MAAA,KAAK,GAAG,OAAO,CAAC,YAAR,CAAqB,IAArB,CAAR;;AACA,UAAI,QAAQ,CAAC,KAAD,CAAZ,EAAqB;AACjB,YAAI;AACA,UAAA,KAAK,GAAG,OAAO,CAAC,KAAD,CAAf;AACH,SAFD,CAGA,OAAO,CAAP,EAAU,CAAG;AAChB,OALD,MAMK;AACD,QAAA,KAAK,GAAG,SAAR;AACH;AACJ;;AACD,WAAO,KAAP;AACH;;AACD,EAAA,CAAC,CAAC,EAAF,CAAK,IAAL,GAAY,UAAU,GAAV,EAAe,KAAf,EAAsB;AAClC;AACI,QAAI,WAAW,CAAC,GAAD,CAAf,EAAsB;AAClB,UAAI,CAAC,KAAK,MAAV,EAAkB;AACd,eAAO,SAAP;AACH;;AACDA,UAAM,OAAO,GAAG,KAAK,CAAL,CAAhBA;AACAA,UAAM,UAAU,GAAG,IAAI,CAAC,OAAD,CAAvBA,CALkB,CAM1B;;AACQ,UAAI,OAAO,CAAC,QAAR,KAAqB,CAAzB,EAA4B;AACxB,eAAO,UAAP;AACH,OATiB,CAU1B;;;AACQA,UAAM,KAAK,GAAG,OAAO,CAAC,UAAtBA;AACAC,UAAI,CAAC,GAAG,KAAK,CAAC,MAAdA;;AACA,aAAO,CAAC,EAAR,EAAY;AACR,YAAI,KAAK,CAAC,CAAD,CAAT,EAAc;AACVA,cAAI,IAAI,GAAG,KAAK,CAAC,CAAD,CAAL,CAAS,IAApBA;;AACA,cAAI,IAAI,CAAC,OAAL,CAAa,OAAb,MAA0B,CAA9B,EAAiC;AAC7B,YAAA,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC,KAAL,CAAW,CAAX,CAAD,CAAlB;AACA,YAAA,UAAU,CAAC,IAAD,CAAV,GAAmB,QAAQ,CAAC,OAAD,EAAU,IAAV,EAAgB,UAAU,CAAC,IAAD,CAA1B,CAA3B;AACH;AACJ;AACJ;;AACD,aAAO,UAAP;AACH,KAzB6B,CA0BlC;;;AACI,QAAI,YAAY,CAAC,GAAD,CAAhB,EAAuB;AACnB,aAAO,KAAK,IAAL,CAAU,YAAY;AACzB,QAAA,IAAI,CAAC,IAAD,EAAO,GAAP,CAAJ;AACH,OAFM,CAAP;AAGH,KA/B6B,CAgClC;;;AACI,QAAI,SAAS,CAAC,MAAV,KAAqB,CAArB,IAA0B,WAAW,CAAC,KAAD,CAAzC,EAAkD;AAC9C,aAAO,IAAP;AACH,KAnC6B,CAoClC;;;AACI,QAAI,CAAC,WAAW,CAAC,KAAD,CAAhB,EAAyB;AACrB,aAAO,KAAK,IAAL,CAAU,YAAY;AACzB,QAAA,IAAI,CAAC,IAAD,EAAO,GAAP,EAAY,KAAZ,CAAJ;AACH,OAFM,CAAP;AAGH,KAzC6B,CA0ClC;;;AACI,QAAI,CAAC,KAAK,MAAV,EAAkB;AACd,aAAO,SAAP;AACH;;AACD,WAAO,QAAQ,CAAC,KAAK,CAAL,CAAD,EAAU,GAAV,EAAe,IAAI,CAAC,KAAK,CAAL,CAAD,EAAU,GAAV,CAAnB,CAAf;AACH,GA/CD;;ACvCA,EAAA,CAAC,CAAC,EAAF,CAAK,KAAL,GAAa,YAAY;AACrB,WAAO,KAAK,IAAL,CAAU,YAAY;AACzB,WAAK,SAAL,GAAiB,EAAjB;AACH,KAFM,CAAP;AAGH,GAJD;;ACAA,EAAA,CAAC,CAAC,EAAF,CAAK,MAAL,GAAc,UAAU,GAAV,EAAe;AACzB,IAAA,IAAI,CAAC,GAAD,EAAI,UAAG,IAAH,EAAS,KAAT,EAAmB;AAC/B;AACQ,MAAA,CAAC,CAAC,EAAF,CAAK,IAAL,IAAa,KAAb;AACH,KAHG,CAAJ;AAIA,WAAO,IAAP;AACH,GAND;;ACEA,EAAA,CAAC,CAAC,EAAF,CAAK,MAAL,GAAc,UAAU,QAAV,EAAoB;AAC9B,QAAI,UAAU,CAAC,QAAD,CAAd,EAA0B;AACtB,aAAO,KAAK,GAAL,CAAQ,UAAE,KAAF,EAAS,OAAT,EAAgB;AAAA,eAAK,QAAQ,CAAC,IAAT,CAAc,OAAd,EAAuB,KAAvB,EAA8B,OAA9B,IAAyC,OAAzC,GAAmD,SAAxD;AAAiE,OAAzF,CAAP;AACH;;AACD,QAAI,QAAQ,CAAC,QAAD,CAAZ,EAAwB;AACpB,aAAO,KAAK,GAAL,CAAQ,UAAE,CAAF,EAAK,OAAL,EAAY;AAAA,eAAK,CAAC,CAAC,OAAD,CAAD,CAAW,EAAX,CAAc,QAAd,IAA0B,OAA1B,GAAoC,SAAzC;AAAkD,OAAtE,CAAP;AACH;;AACDD,QAAM,SAAS,GAAG,CAAC,CAAC,QAAD,CAAnBA;AACA,WAAO,KAAK,GAAL,CAAQ,UAAE,CAAF,EAAK,OAAL,EAAY;AAAA,aAAK,SAAS,CAAC,GAAV,GAAgB,OAAhB,CAAwB,OAAxB,IAAmC,CAAC,CAApC,GAAwC,OAAxC,GAAkD,SAAvD;AAAgE,KAApF,CAAP;AACH,GATD;;ACFA,EAAA,CAAC,CAAC,EAAF,CAAK,KAAL,GAAa,YAAY;AACrB,WAAO,KAAK,EAAL,CAAQ,CAAR,CAAP;AACH,GAFD;;ACEA,EAAA,CAAC,CAAC,EAAF,CAAK,GAAL,GAAW,UAAU,QAAV,EAAoB;AAC3BA,QAAM,QAAQ,GAAG,QAAQ,CAAC,QAAD,CAAR,GAAqB,KAAK,IAAL,CAAU,QAAV,CAArB,GAA2C,CAAC,CAAC,QAAD,CAA7DA;AACQ,QAAA,MAAA,GAAA,QAAA,CAAA,MAAA;AACR,WAAO,KAAK,GAAL,CAAS,YAAY;AACxB,WAAKC,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,MAApB,EAA4B,CAAC,IAAI,CAAjC,EAAoC;AAChC,YAAI,QAAQ,CAAC,IAAD,EAAO,QAAQ,CAAC,CAAD,CAAf,CAAZ,EAAiC;AAC7B,iBAAO,IAAP;AACH;AACJ;;AACD;AACH,KAPM,CAAP;AAQH,GAXD;;ACHA,EAAA,CAAC,CAAC,EAAF,CAAK,QAAL,GAAgB,UAAU,SAAV,EAAqB;AACjC,WAAO,KAAK,CAAL,EAAQ,SAAR,CAAkB,QAAlB,CAA2B,SAA3B,CAAP;AACH,GAFD;ACIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,WAAS,gBAAT,CAA0B,OAA1B,EAAmC,IAAnC,EAAyC,KAAzC,EAAgD,SAAhD,EAA2D,aAA3D,EAA0E,QAA1E,EAAoF;AACpF;AACID,QAAM,kBAAkB,GAAA,UAAI,KAAJ,EAAc;AAClC,aAAQ,aAAa,CAAC,OAAD,EAAU,IAAI,CAAC,WAAL,EAAV,EAA8B,KAA9B,CAAb,GACJ,QADJ;AAEH,KAHDA;;AAIA,QAAI,SAAS,KAAK,CAAd,IAAmB,aAAvB,EAAsC;AAClC,MAAA,KAAK,IAAI,kBAAkB,CAAC,QAAD,CAA3B;AACH;;AACD,QAAI,WAAW,CAAC,OAAD,CAAf,EAA0B;AAC9B;AACA;AACQ,UAAI,IAAI,MAAM,QAAQ,KAAK,CAA3B,EAA8B;AAC1B,QAAA,KAAK,IAAI,kBAAkB,CAAC,QAAD,CAA3B;AACA,QAAA,KAAK,IAAI,kBAAkB,CAAC,SAAD,CAA3B;AACH;;AACD,UAAI,SAAS,KAAK,CAAlB,EAAqB;AACjB,QAAA,KAAK,IAAI,kBAAkB,CAAC,QAAD,CAA3B;AACH;;AACD,UAAI,SAAS,KAAK,CAAlB,EAAqB;AACjB,QAAA,KAAK,IAAI,kBAAkB,CAAC,QAAD,CAA3B;AACA,QAAA,KAAK,IAAI,kBAAkB,CAAC,SAAD,CAA3B;AACH;AACJ,KAdD,MAeK;AACD,UAAI,SAAS,KAAK,CAAlB,EAAqB;AACjB,QAAA,KAAK,IAAI,kBAAkB,CAAC,SAAD,CAA3B;AACH;;AACD,UAAI,SAAS,KAAK,CAAlB,EAAqB;AACjB,QAAA,KAAK,IAAI,kBAAkB,CAAC,QAAD,CAA3B;AACA,QAAA,KAAK,IAAI,kBAAkB,CAAC,SAAD,CAA3B;AACH;AACJ;;AACD,WAAO,KAAP;AACH;AACD;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,WAAS,GAAT,CAAa,OAAb,EAAsB,IAAtB,EAA4B,SAA5B,EAAuC,aAAvC,EAAsD;AAClDA,QAAM,UAAU,GAAG,WAAS,IAA5BA;AACAA,QAAM,UAAU,GAAG,WAAS,IAA5BA;AACAA,QAAM,UAAU,GAAG,WAAS,IAA5BA;AACAA,QAAM,SAAS,GAAG,UAAQ,IAA1BA,CAJkD,CAKtD;;AACI,QAAI,QAAQ,CAAC,OAAD,CAAZ,EAAuB;AAC3B;AACQ,aAAO,SAAS,KAAK,CAAd,GACD,OAAO,CAAC,SAAD,CADN,GAED,SAAS,CAAC,QAAD,CAAT,CAAoB,UAApB,CAFN;AAGH,KAXiD,CAYtD;;;AACI,QAAI,UAAU,CAAC,OAAD,CAAd,EAAyB;AACrBA,UAAM,GAAG,GAAG,SAAS,CAAC,OAAD,CAArBA;AACA,aAAO,IAAI,CAAC,GAAL,EACf;AACQ,MAAA,OAAO,CAAC,IAAR,CAAa,UAAb,CAFO,EAEmB,GAAG,CAAC,UAAD,CAFtB,EAGf;AACQ,MAAA,OAAO,CAAC,IAAR,CAAa,UAAb,CAJO,EAImB,GAAG,CAAC,UAAD,CAJtB,EAIoC,GAAG,CAAC,UAAD,CAJvC,CAAP;AAKH;;AACDA,QAAM,KAAK,GAAG,UAAU,CAAC,qBAAqB,CAAC,OAAD,EAAU,IAAI,CAAC,WAAL,EAAV,CAArB,IAAsD,GAAvD,CAAxBA;AACA,WAAO,gBAAgB,CAAC,OAAD,EAAU,IAAV,EAAgB,KAAhB,EAAuB,SAAvB,EAAkC,aAAlC,EAAiD,CAAjD,CAAvB;AACH;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,WAAS,GAAT,CAAa,OAAb,EAAsB,YAAtB,EAAoC,IAApC,EAA0C,SAA1C,EAAqD,aAArD,EAAoE,KAApE,EAA2E;AACvEC,QAAI,aAAa,GAAG,UAAU,CAAC,KAAD,CAAV,GACd,KAAK,CAAC,IAAN,CAAW,OAAX,EAAoB,YAApB,EAAkC,GAAG,CAAC,OAAD,EAAU,IAAV,EAAgB,SAAhB,EAA2B,aAA3B,CAArC,CADc,GAEd,KAFNA;;AAGA,QAAI,aAAa,IAAI,IAArB,EAA2B;AACvB;AACH;;AACDD,QAAM,QAAQ,GAAG,CAAC,CAAC,OAAD,CAAlBA;AACAA,QAAM,SAAS,GAAG,IAAI,CAAC,WAAL,EAAlBA,CARuE,CAS3E;;AACI,QAAI,CAAC,MAAD,EAAS,SAAT,EAAoB,EAApB,EAAwB,OAAxB,CAAgC,aAAhC,IAAiD,CAAC,CAAtD,EAAyD;AACrD,MAAA,QAAQ,CAAC,GAAT,CAAa,SAAb,EAAwB,aAAxB;AACA;AACH,KAbsE,CAc3E;;;AACIA,QAAM,MAAM,GAAG,aAAa,CAAC,QAAd,GAAyB,OAAzB,CAAiC,WAAjC,EAA8C,EAA9C,CAAfA;AACAA,QAAM,SAAS,GAAG,UAAU,CAAC,aAAD,CAA5BA;AACA,IAAA,aAAa,GACT,gBAAgB,CAAC,OAAD,EAAU,IAAV,EAAgB,SAAhB,EAA2B,SAA3B,EAAsC,aAAtC,EAAqD,CAAC,CAAtD,CAAhB,IACK,MAAM,IAAI,IADf,CADJ;AAGA,IAAA,QAAQ,CAAC,GAAT,CAAa,SAAb,EAAwB,aAAxB;AACH;;AACD,EAAA,IAAI,CAAC,CAAC,OAAD,EAAU,QAAV,CAAD,EAAoB,UAAG,CAAH,EAAM,IAAN,EAAe;AACnC,IAAA,IAAI,CAAC,CAAA,UAAS,IAAT,EAAiB,IAAI,CAAC,WAAL,EAAjB,EAAmC,UAAU,IAA7C,CAAD,EAAqD,UAAG,SAAH,EAAc,QAAd,EAA2B;AAChF,MAAA,CAAC,CAAC,EAAF,CAAK,QAAL,IAAiB,UAAU,MAAV,EAAkB,KAAlB,EAAyB;AAClD;AACYA,YAAM,KAAK,GAAG,SAAS,CAAC,MAAV,KAAqB,SAAS,GAAG,CAAZ,IAAiB,CAAC,SAAS,CAAC,MAAD,CAAhD,CAAdA;AACAA,YAAM,aAAa,GAAG,MAAM,KAAK,IAAX,IAAmB,KAAK,KAAK,IAAnDA,CAHsC,CAIlD;;AACY,YAAI,CAAC,KAAL,EAAY;AACR,iBAAO,KAAK,MAAL,GACD,GAAG,CAAC,KAAK,CAAL,CAAD,EAAU,IAAV,EAAgB,SAAhB,EAA2B,aAA3B,CADF,GAED,SAFN;AAGH,SATqC,CAUlD;;;AACY,eAAO,KAAK,IAAL,CAAS,UAAE,KAAF,EAAS,OAAT,EAAgB;AAAA,iBAAK,GAAG,CAAC,OAAD,EAAU,KAAV,EAAiB,IAAjB,EAAuB,SAAvB,EAAkC,aAAlC,EAAiD,MAAjD,CAAR;AAAgE,SAAzF,CAAP;AACH,OAZD;AAaH,KAdG,CAAJ;AAeH,GAhBG,CAAJ;;AC7GA,EAAA,CAAC,CAAC,EAAF,CAAK,IAAL,GAAY,YAAY;AACpB,WAAO,KAAK,IAAL,CAAU,YAAY;AACzB,WAAK,KAAL,CAAW,OAAX,GAAqB,MAArB;AACH,KAFM,CAAP;AAGH,GAJD;;ACIA,EAAA,IAAI,CAAC,CAAC,KAAD,EAAQ,MAAR,EAAgB,MAAhB,CAAD,EAAwB,UAAG,SAAH,EAAc,IAAd,EAAuB;AAC/CA,QAAM,KAAK,GAAG;AACV,SAAG,OADO;AAEV,SAAG,WAFO;AAGV,SAAG;AAHO,KAAdA;AAKAA,QAAM,QAAQ,GAAG,KAAK,CAAC,SAAD,CAAtBA;;AACA,aAAS,GAAT,CAAa,SAAb,EAAwB;AAC5B;AACQ,UAAI,SAAS,KAAK,CAAlB,EAAqB;AAC7B;AACY,eAAO,GAAG,CAAC,SAAD,EAAU,UAAG,OAAH,EAAU;AAAA,iBAAK,SAAS,CAAC,OAAD,CAAT,CAAmB,QAAnB,CAAL;AAAiC,SAArD,CAAH,CAA0D,IAA1D,CAA+D,EAA/D,CAAP;AACH,OALmB,CAM5B;;;AACQ,UAAI,CAAC,SAAS,CAAC,MAAf,EAAuB;AACnB,eAAO,SAAP;AACH,OATmB,CAU5B;;;AACQA,UAAM,YAAY,GAAG,SAAS,CAAC,CAAD,CAA9BA,CAXoB,CAY5B;;AACQ,UAAI,SAAS,KAAK,CAAd,IAAmB,CAAC,CAAC,YAAD,CAAD,CAAgB,EAAhB,CAAmB,kBAAnB,CAAvB,EAA+D;AAC3D,eAAO,GAAG,CAAC,CAAC,CAAC,YAAD,CAAD,CAAgB,IAAhB,CAAqB,gBAArB,CAAD,EAAuC,UAAG,OAAH,EAAU;AAAA,iBAAK,OAAO,CAAC,KAAb;AAAkB,SAAnE,CAAV;AACH,OAfmB,CAgB5B;;;AACQ,aAAO,YAAY,CAAC,QAAD,CAAnB;AACH;;AACD,aAAS,GAAT,CAAa,OAAb,EAAsB,KAAtB,EAA6B;AACjC;AACA;AACQ,UAAI,WAAW,CAAC,KAAD,CAAf,EAAwB;AACpB,YAAI,SAAS,KAAK,CAAlB,EAAqB;AACjB;AACH;;AACD,QAAA,KAAK,GAAG,EAAR;AACH;;AACD,UAAI,SAAS,KAAK,CAAd,IAAmB,SAAS,CAAC,KAAD,CAAhC,EAAyC;AACrC,QAAA,KAAK,GAAG,KAAK,CAAC,SAAd;AACH,OAXwB,CAYjC;;;AACQ,MAAA,OAAO,CAAC,QAAD,CAAP,GAAoB,KAApB;AACH;;AACD,IAAA,CAAC,CAAC,EAAF,CAAK,IAAL,IAAa,UAAU,KAAV,EAAiB;AAClC;AACQ,UAAI,CAAC,SAAS,CAAC,MAAf,EAAuB;AACnB,eAAO,GAAG,CAAC,IAAD,CAAV;AACH,OAJyB,CAKlC;;;AACQ,aAAO,KAAK,IAAL,CAAS,UAAE,CAAF,EAAK,OAAL,EAAiB;AAC7BA,YAAM,aAAa,GAAG,UAAU,CAAC,KAAD,CAAV,GAChB,KAAK,CAAC,IAAN,CAAW,OAAX,EAAoB,CAApB,EAAuB,GAAG,CAAC,CAAC,CAAC,OAAD,CAAF,CAA1B,CADgB,GAEhB,KAFNA,CAD6B,CAIzC;;AACY,YAAI,SAAS,KAAK,CAAd,IAAmB,KAAK,CAAC,OAAN,CAAc,aAAd,CAAvB,EAAqD;AACjE;AACgB,cAAI,CAAC,CAAC,OAAD,CAAD,CAAW,EAAX,CAAc,kBAAd,CAAJ,EAAuC;AACnC,YAAA,GAAG,CAAC,CAAC,CAAC,OAAD,CAAD,CAAW,IAAX,CAAgB,QAAhB,CAAD,EAA0B,UAAG,MAAH,EAAS;AAAA,qBAAM,MAAM,CAAC,QAAP,GACxC,aAAa,CAAC,OAAd,CAAsB,MAAM,CAAC,KAA7B,IACI,CAAC,CAF6B;AAE3B,aAFR,CAAH;AAGH,WAJD,CAKhB;AALgB,eAMK;AACD,cAAA,OAAO,CAAC,OAAR,GACI,aAAa,CAAC,OAAd,CAAsB,OAAO,CAAC,KAA9B,IAAuC,CAAC,CAD5C;AAEH;AACJ,SAZD,MAaK;AACD,UAAA,GAAG,CAAC,OAAD,EAAU,aAAV,CAAH;AACH;AACJ,OArBM,CAAP;AAsBH,KA5BD;AA6BH,GAtEG,CAAJ;;ACAA,EAAA,CAAC,CAAC,EAAF,CAAK,KAAL,GAAa,UAAU,QAAV,EAAoB;AAC7B,QAAI,CAAC,SAAS,CAAC,MAAf,EAAuB;AACnB,aAAO,KAAK,EAAL,CAAQ,CAAR,EAAW,MAAX,GAAoB,QAApB,GAA+B,GAA/B,GAAqC,OAArC,CAA6C,KAAK,CAAL,CAA7C,CAAP;AACH;;AACD,QAAI,QAAQ,CAAC,QAAD,CAAZ,EAAwB;AACpB,aAAO,CAAC,CAAC,QAAD,CAAD,CAAY,GAAZ,GAAkB,OAAlB,CAA0B,KAAK,CAAL,CAA1B,CAAP;AACH;;AACD,WAAO,KAAK,GAAL,GAAW,OAAX,CAAmB,CAAC,CAAC,QAAD,CAAD,CAAY,CAAZ,CAAnB,CAAP;AACH,GARD;;ACJA,EAAA,CAAC,CAAC,EAAF,CAAK,IAAL,GAAY,YAAY;AACpB,WAAO,KAAK,EAAL,CAAQ,CAAC,CAAT,CAAP;AACH,GAFD;;ACCA,EAAA,IAAI,CAAC,CAAC,EAAD,EAAK,KAAL,EAAY,OAAZ,CAAD,EAAqB,UAAG,SAAH,EAAc,IAAd,EAAuB;AAC5C,IAAA,CAAC,CAAC,EAAF,CAAI,SAAQ,IAAZ,IAAsB,UAAU,QAAV,EAAoB,MAApB,EAA4B;AAC9C,aAAO,GAAG,CAAC,IAAD,EAAO,SAAP,EAAkB,oBAAlB,EAAwC,QAAxC,EAAkD,MAAlD,CAAV;AACH,KAFD;AAGH,GAJG,CAAJ;;ACAA,EAAA,CAAC,CAAC,EAAF,CAAK,GAAL,GAAW,UAAU,QAAV,EAAoB;AAC3BA,QAAM,SAAS,GAAG,KAAK,MAAL,CAAY,QAAZ,CAAlBA;AACA,WAAO,KAAK,GAAL,CAAQ,UAAE,CAAF,EAAK,OAAL,EAAY;AAAA,aAAK,SAAS,CAAC,KAAV,CAAgB,OAAhB,IAA2B,CAAC,CAA5B,GAAgC,SAAhC,GAA4C,OAAjD;AAAwD,KAA5E,CAAP;AACH,GAHD;ACAA;AACA;AACA;;;AACA,EAAA,CAAC,CAAC,EAAF,CAAK,YAAL,GAAoB,YAAY;AAC5B,WAAO,KAAK,GAAL,CAAS,YAAY;AACxBC,UAAI,YAAY,GAAG,KAAK,YAAxBA;;AACA,aAAO,YAAY,IAAI,CAAC,CAAC,YAAD,CAAD,CAAgB,GAAhB,CAAoB,UAApB,MAAoC,QAA3D,EAAqE;AACjE,QAAA,YAAY,GAAG,YAAY,CAAC,YAA5B;AACH;;AACD,aAAO,YAAY,IAAI,QAAQ,CAAC,eAAhC;AACH,KANM,CAAP;AAOH,GARD;;ACDA,WAAS,UAAT,CAAoB,QAApB,EAA8B,IAA9B,EAAoC;AAChC,WAAO,UAAU,CAAC,QAAQ,CAAC,GAAT,CAAa,IAAb,CAAD,CAAjB;AACH;;AACD,EAAA,CAAC,CAAC,EAAF,CAAK,QAAL,GAAgB,YAAY;AACxB,QAAI,CAAC,KAAK,MAAV,EAAkB;AACd,aAAO,SAAP;AACH;;AACDD,QAAM,QAAQ,GAAG,KAAK,EAAL,CAAQ,CAAR,CAAjBA;AACAC,QAAI,aAAJA;AACAA,QAAI,YAAY,GAAG;AACf,MAAA,IAAI,EAAE,CADS;AAEf,MAAA,GAAG,EAAE;AAFU,KAAnBA;;AAIA,QAAI,QAAQ,CAAC,GAAT,CAAa,UAAb,MAA6B,OAAjC,EAA0C;AACtC,MAAA,aAAa,GAAG,QAAQ,CAAC,CAAD,CAAR,CAAY,qBAAZ,EAAhB;AACH,KAFD,MAGK;AACD,MAAA,aAAa,GAAG,QAAQ,CAAC,MAAT,EAAhB;AACAD,UAAM,aAAa,GAAG,QAAQ,CAAC,YAAT,EAAtBA;AACA,MAAA,YAAY,GAAG,aAAa,CAAC,MAAd,EAAf;AACA,MAAA,YAAY,CAAC,GAAb,IAAoB,UAAU,CAAC,aAAD,EAAgB,kBAAhB,CAA9B;AACA,MAAA,YAAY,CAAC,IAAb,IAAqB,UAAU,CAAC,aAAD,EAAgB,mBAAhB,CAA/B;AACH;;AACD,WAAO;AACH,MAAA,GAAG,EAAE,aAAa,CAAC,GAAd,GAAoB,YAAY,CAAC,GAAjC,GAAuC,UAAU,CAAC,QAAD,EAAW,YAAX,CADnD;AAEH,MAAA,IAAI,EAAE,aAAa,CAAC,IAAd,GACF,YAAY,CAAC,IADX,GAEF,UAAU,CAAC,QAAD,EAAW,aAAX;AAJX,KAAP;AAMH,GA1BD;;ACFA,WAASI,KAAT,CAAa,OAAb,EAAsB;AAClB,QAAI,CAAC,OAAO,CAAC,cAAR,GAAyB,MAA9B,EAAsC;AAClC,aAAO;AAAE,QAAA,GAAG,EAAE,CAAP;AAAU,QAAA,IAAI,EAAE;AAAhB,OAAP;AACH;;AACDJ,QAAM,IAAI,GAAG,OAAO,CAAC,qBAAR,EAAbA;AACAA,QAAM,GAAG,GAAG,OAAO,CAAC,aAAR,CAAsB,WAAlCA;AACA,WAAO;AACH,MAAA,GAAG,EAAE,IAAI,CAAC,GAAL,GAAW,GAAG,CAAC,WADjB;AAEH,MAAA,IAAI,EAAE,IAAI,CAAC,IAAL,GAAY,GAAG,CAAC;AAFnB,KAAP;AAIH;;AACD,WAASK,KAAT,CAAa,OAAb,EAAsB,KAAtB,EAA6B,KAA7B,EAAoC;AAChCL,QAAM,QAAQ,GAAG,CAAC,CAAC,OAAD,CAAlBA;AACAA,QAAM,QAAQ,GAAG,QAAQ,CAAC,GAAT,CAAa,UAAb,CAAjBA;;AACA,QAAI,QAAQ,KAAK,QAAjB,EAA2B;AACvB,MAAA,QAAQ,CAAC,GAAT,CAAa,UAAb,EAAyB,UAAzB;AACH;;AACDA,QAAM,aAAa,GAAGI,KAAG,CAAC,OAAD,CAAzBJ;AACAA,QAAM,gBAAgB,GAAG,QAAQ,CAAC,GAAT,CAAa,KAAb,CAAzBA;AACAA,QAAM,iBAAiB,GAAG,QAAQ,CAAC,GAAT,CAAa,MAAb,CAA1BA;AACAC,QAAI,UAAJA;AACAA,QAAI,WAAJA;AACAD,QAAM,iBAAiB,GAAG,CAAC,QAAQ,KAAK,UAAb,IAA2B,QAAQ,KAAK,OAAzC,KACtB,CAAC,gBAAgB,GAAG,iBAApB,EAAuC,OAAvC,CAA+C,MAA/C,IAAyD,CAAC,CAD9DA;;AAEA,QAAI,iBAAJ,EAAuB;AACnBA,UAAM,eAAe,GAAG,QAAQ,CAAC,QAAT,EAAxBA;AACA,MAAA,UAAU,GAAG,eAAe,CAAC,GAA7B;AACA,MAAA,WAAW,GAAG,eAAe,CAAC,IAA9B;AACH,KAJD,MAKK;AACD,MAAA,UAAU,GAAG,UAAU,CAAC,gBAAD,CAAvB;AACA,MAAA,WAAW,GAAG,UAAU,CAAC,iBAAD,CAAxB;AACH;;AACDA,QAAM,aAAa,GAAG,UAAU,CAAC,KAAD,CAAV,GAChB,KAAK,CAAC,IAAN,CAAW,OAAX,EAAoB,KAApB,EAA2B,MAAM,CAAC,EAAD,EAAK,aAAL,CAAjC,CADgB,GAEhB,KAFNA;AAGA,IAAA,QAAQ,CAAC,GAAT,CAAa;AACT,MAAA,GAAG,EAAE,aAAa,CAAC,GAAd,IAAqB,IAArB,GACC,aAAa,CAAC,GAAd,GAAoB,aAAa,CAAC,GAAlC,GAAwC,UADzC,GAEC,SAHG;AAIT,MAAA,IAAI,EAAE,aAAa,CAAC,IAAd,IAAsB,IAAtB,GACA,aAAa,CAAC,IAAd,GAAqB,aAAa,CAAC,IAAnC,GAA0C,WAD1C,GAEA;AANG,KAAb;AAQH;;AACD,EAAA,CAAC,CAAC,EAAF,CAAK,MAAL,GAAc,UAAU,KAAV,EAAiB;AAC/B;AACI,QAAI,CAAC,SAAS,CAAC,MAAf,EAAuB;AACnB,UAAI,CAAC,KAAK,MAAV,EAAkB;AACd,eAAO,SAAP;AACH;;AACD,aAAOI,KAAG,CAAC,KAAK,CAAL,CAAD,CAAV;AACH,KAP0B,CAQ/B;;;AACI,WAAO,KAAK,IAAL,CAAU,UAAU,KAAV,EAAiB;AAC9BC,MAAAA,KAAG,CAAC,IAAD,EAAO,KAAP,EAAc,KAAd,CAAHA;AACH,KAFM,CAAP;AAGH,GAZD;;ACjDA,EAAA,CAAC,CAAC,EAAF,CAAK,GAAL,GAAW,UAAU,KAAV,EAAiB,QAAjB,EAA2B,IAA3B,EAAiC,QAAjC,EAA2C;AACtD;AACI,WAAO,KAAK,EAAL,CAAQ,KAAR,EAAe,QAAf,EAAyB,IAAzB,EAA+B,QAA/B,EAAyC,IAAzC,CAAP;AACH,GAHD;;ACEA,EAAA,IAAI,CAAC,CAAC,EAAD,EAAK,KAAL,EAAY,OAAZ,CAAD,EAAqB,UAAG,SAAH,EAAc,IAAd,EAAuB;AAC5C,IAAA,CAAC,CAAC,EAAF,CAAI,SAAQ,IAAZ,IAAsB,UAAU,QAAV,EAAoB,MAApB,EAA4B;AACtD;AACQL,UAAM,MAAM,GAAG,CAAC,SAAD,GAAa,IAAb,GAAoB,CAAC,CAAC,KAAK,GAAL,GAAW,OAAX,EAAD,CAApCA;AACA,aAAO,GAAG,CAAC,MAAD,EAAS,SAAT,EAAoB,wBAApB,EAA8C,QAA9C,EAAwD,MAAxD,CAAV;AACH,KAJD;AAKH,GANG,CAAJ;;ACDA,EAAA,CAAC,CAAC,EAAF,CAAK,UAAL,GAAkB,UAAU,aAAV,EAAyB;AACvCA,QAAM,KAAK,GAAG,aAAa,CAAC,KAAd,CAAoB,GAApB,EAAyB,MAAzB,CAA+B,UAAE,IAAF,EAAM;AAAA,aAAK,IAAL;AAAS,KAA9C,CAAdA;AACA,WAAO,KAAK,IAAL,CAAU,YAAY;;AACzB,MAAA,IAAI,CAAC,KAAD,EAAM,UAAG,CAAH,EAAM,IAAN,EAAe;AACrBG,QAAAA,MAAI,CAAC,eAALA,CAAqB,IAArBA;AACH,OAFG,CAAJ;AAGH,KAJM,CAAP;AAKH,GAPD;;ACAA,EAAA,CAAC,CAAC,EAAF,CAAK,UAAL,GAAkB,UAAU,IAAV,EAAgB;AAC9B,WAAO,KAAK,IAAL,CAAU,YAAY;AACzB,MAAA,UAAU,CAAC,IAAD,EAAO,IAAP,CAAV;AACH,KAFM,CAAP;AAGH,GAJD;;ACDA,EAAA,CAAC,CAAC,EAAF,CAAK,UAAL,GAAkB,UAAU,IAAV,EAAgB;AAC9B,WAAO,KAAK,IAAL,CAAU,YAAY;AACzB,UAAI;AACZ;AACY,eAAO,KAAK,IAAL,CAAP;AACH,OAHD,CAIA,OAAO,CAAP,EAAU,CAAG;AAChB,KANM,CAAP;AAOH,GARD;;ACIA,EAAA,CAAC,CAAC,EAAF,CAAK,WAAL,GAAmB,UAAU,UAAV,EAAsB;AACrC,SAAK,IAAL,CAAS,UAAE,KAAF,EAAS,OAAT,EAAqB;AAC1BF,UAAI,OAAO,GAAG,UAAdA;;AACA,UAAI,UAAU,CAAC,OAAD,CAAd,EAAyB;AACrB,QAAA,OAAO,GAAG,OAAO,CAAC,IAAR,CAAa,OAAb,EAAsB,KAAtB,EAA6B,OAAO,CAAC,SAArC,CAAV;AACH,OAFD,MAGK,IAAI,KAAK,IAAI,CAAC,QAAQ,CAAC,OAAD,CAAtB,EAAiC;AAClC,QAAA,OAAO,GAAG,CAAC,CAAC,OAAD,CAAD,CAAW,KAAX,EAAV;AACH;;AACD,MAAA,CAAC,CAAC,OAAD,CAAD,CAAW,MAAX,CAAkB,OAAlB;AACH,KATD;AAUA,WAAO,KAAK,MAAL,EAAP;AACH,GAZD;;ACDA,EAAA,CAAC,CAAC,EAAF,CAAK,UAAL,GAAkB,UAAU,MAAV,EAAkB;;AAChC,WAAO,CAAC,CAAC,MAAD,CAAD,CAAU,GAAV,CAAa,UAAE,KAAF,EAAS,OAAT,EAAqB;AACrC,MAAA,CAAC,CAAC,OAAD,CAAD,CAAW,WAAX,CAAuB,KAAK,GAAGE,MAAI,CAAC,KAALA,EAAH,GAAkBA,MAA9C;AACA,aAAOA,MAAI,CAAC,GAALA,EAAP;AACH,KAHM,CAAP;AAIH,GALD;ACFA;AACA;AACA;AACA;;;AACA,EAAA,CAAC,CAAC,EAAF,CAAK,cAAL,GAAsB,YAAY;AAC9BH,QAAM,MAAM,GAAG,EAAfA;AACA,SAAK,IAAL,CAAS,UAAE,CAAF,EAAK,OAAL,EAAiB;AACtBA,UAAM,QAAQ,GAAG,OAAO,YAAY,eAAnB,GAAqC,OAAO,CAAC,QAA7C,GAAwD,CAAC,OAAD,CAAzEA;AACA,MAAA,CAAC,CAAC,QAAD,CAAD,CAAY,IAAZ,CAAgB,UAAE,CAAF,EAAK,OAAL,EAAiB;AAC7BA,YAAM,QAAQ,GAAG,CAAC,CAAC,OAAD,CAAlBA;AACAA,YAAM,IAAI,GAAG,OAAO,CAAC,IAArBA;AACAA,YAAM,QAAQ,GAAG,OAAO,CAAC,QAAR,CAAiB,WAAjB,EAAjBA;;AACA,YAAI,QAAQ,KAAK,UAAb,IACA,OAAO,CAAC,IADR,IAEA,CAAC,OAAO,CAAC,QAFT,IAGA,CAAC,OAAD,EAAU,QAAV,EAAoB,UAApB,EAAgC,QAAhC,EAA0C,OAA1C,CAAkD,QAAlD,IAA8D,CAAC,CAH/D,IAIA,CAAC,QAAD,EAAW,QAAX,EAAqB,OAArB,EAA8B,OAA9B,EAAuC,MAAvC,EAA+C,OAA/C,CAAuD,IAAvD,MAAiE,CAAC,CAJlE,KAKC,CAAC,OAAD,EAAU,UAAV,EAAsB,OAAtB,CAA8B,IAA9B,MAAwC,CAAC,CAAzC,IACG,OAAO,CAAC,OANZ,CAAJ,EAM0B;AACtBA,cAAM,KAAK,GAAG,QAAQ,CAAC,GAAT,EAAdA;AACAA,cAAM,QAAQ,GAAG,KAAK,CAAC,OAAN,CAAc,KAAd,IAAuB,KAAvB,GAA+B,CAAC,KAAD,CAAhDA;AACA,UAAA,QAAQ,CAAC,OAAT,CAAgB,UAAE,KAAF,EAAY;AACxB,YAAA,MAAM,CAAC,IAAP,CAAY;AACR,cAAA,IAAI,EAAE,OAAO,CAAC,IADN;AAEhC,cAAA,KAAA,EAAwB;AAFQ,aAAZ;AAIH,WALD;AAMH;AACJ,OApBD;AAqBH,KAvBD;AAwBA,WAAO,MAAP;AACH,GA3BD;;ACJA,EAAA,CAAC,CAAC,EAAF,CAAK,SAAL,GAAiB,YAAY;AACzB,WAAO,KAAK,CAAC,KAAK,cAAL,EAAD,CAAZ;AACH,GAFD;;ACAAA,MAAM,cAAc,GAAG,EAAvBA;AACA;AACA;AACA;AACA;;AACA,WAAS,cAAT,CAAwB,QAAxB,EAAkC;AAC9BC,QAAI,OAAJA;AACAA,QAAI,OAAJA;;AACA,QAAI,CAAC,cAAc,CAAC,QAAD,CAAnB,EAA+B;AAC3B,MAAA,OAAO,GAAG,QAAQ,CAAC,aAAT,CAAuB,QAAvB,CAAV;AACA,MAAA,QAAQ,CAAC,IAAT,CAAc,WAAd,CAA0B,OAA1B;AACA,MAAA,OAAO,GAAG,QAAQ,CAAC,OAAD,EAAU,SAAV,CAAlB;AACA,MAAA,OAAO,CAAC,UAAR,CAAmB,WAAnB,CAA+B,OAA/B;;AACA,UAAI,OAAO,KAAK,MAAhB,EAAwB;AACpB,QAAA,OAAO,GAAG,OAAV;AACH;;AACD,MAAA,cAAc,CAAC,QAAD,CAAd,GAA2B,OAA3B;AACH;;AACD,WAAO,cAAc,CAAC,QAAD,CAArB;AACH;AACD;AACA;AACA;AACA;;;AACA,EAAA,CAAC,CAAC,EAAF,CAAK,IAAL,GAAY,YAAY;AACpB,WAAO,KAAK,IAAL,CAAU,YAAY;AACzB,UAAI,KAAK,KAAL,CAAW,OAAX,KAAuB,MAA3B,EAAmC;AAC/B,aAAK,KAAL,CAAW,OAAX,GAAqB,EAArB;AACH;;AACD,UAAI,QAAQ,CAAC,IAAD,EAAO,SAAP,CAAR,KAA8B,MAAlC,EAA0C;AACtC,aAAK,KAAL,CAAW,OAAX,GAAqB,cAAc,CAAC,KAAK,QAAN,CAAnC;AACH;AACJ,KAPM,CAAP;AAQH,GATD;ACvBA;AACA;AACA;AACA;AACA;;;AACA,EAAA,CAAC,CAAC,EAAF,CAAK,QAAL,GAAgB,UAAU,QAAV,EAAoB;AAChC,WAAO,KAAK,OAAL,CAAa,QAAb,EAAuB,GAAvB,CAA2B,KAAK,OAAL,CAAa,QAAb,CAA3B,CAAP;AACH,GAFD;ACJA;AACA;AACA;;;AACA,EAAA,CAAC,CAAC,EAAF,CAAK,MAAL,GAAc,YAAY;AACtB,WAAO,KAAK,IAAL,CAAU,YAAY;AACzB,MAAA,QAAQ,CAAC,IAAD,EAAO,SAAP,CAAR,KAA8B,MAA9B,GAAuC,CAAC,CAAC,IAAD,CAAD,CAAQ,IAAR,EAAvC,GAAwD,CAAC,CAAC,IAAD,CAAD,CAAQ,IAAR,EAAxD;AACH,KAFM,CAAP;AAGH,GAJD;;ACUA,EAAA,CAAC,CAAC,EAAF,CAAK,MAAL,GAAc,YAAA;AACZ,WAAO,KAAK,IAAL,CAAU,YAAA;AACf,aAAO,KAAK,UAAZ;AACD,KAFM,CAAP;AAGD,GAJD;;ACEA,EAAA,CAAC,CAAC,EAAF,CAAK,UAAL,GAAkB,UAAoB,QAApB,EAA6C;AAC7D,QAAI,QAAQ,CAAC,QAAD,CAAZ,EAAwB;AACtB,MAAA,QAAQ,GAAM,QAAQ,GAAA,IAAtB;AACD;;AAED,WAAO,KAAK,IAAL,CAAU,YAAA;AACf,WAAK,KAAL,CAAW,wBAAX,GAAsC,QAAtC;AACA,WAAK,KAAL,CAAW,kBAAX,GAAgC,QAAhC;AACD,KAHM,CAAP;AAID,GATD;;ACEA,EAAA,CAAC,CAAC,EAAF,CAAK,aAAL,GAAqB,UAEnB,QAFmB,EAE4B;;AAG/CD,QAAM,IAAI,GAAG,IAAbA;AACAA,QAAM,MAAM,GAAG,CAAC,qBAAD,EAAwB,eAAxB,CAAfA;;AAEA,aAAS,YAAT,CAAyD,CAAzD,EAAiE;AAC/D,UAAI,CAAC,CAAC,MAAF,KAAa,IAAjB,EAAuB;AACrB;AACD,OAH8D,C;;;AAM/D,MAAA,QAAQ,CAAC,IAAT,CAAc,IAAd,EAAoB,CAApB;AAEA,MAAA,IAAI,CAAC,MAAD,EAAO,UAAG,CAAH,EAAM,KAAN,EAAW;AACpB,QAAA,IAAI,CAAC,GAAL,CAAS,KAAT,EAAgB,YAAhB;AACD,OAFG,CAAJ;AAGD;;AAED,IAAA,IAAI,CAAC,MAAD,EAAO,UAAG,CAAH,EAAM,KAAN,EAAW;AACpB,MAAA,IAAI,CAAC,EAAL,CAAQ,KAAR,EAAe,YAAf;AACD,KAFG,CAAJ;AAIA,WAAO,IAAP;AACD,GA1BD;;ACJA,EAAA,CAAC,CAAC,EAAF,CAAK,eAAL,GAAuB,UAAoB,eAApB,EAA2C;AAChE,WAAO,KAAK,IAAL,CAAU,YAAA;AACf,WAAK,KAAL,CAAW,qBAAX,GAAmC,eAAnC;AACA,WAAK,KAAL,CAAW,eAAX,GAA6B,eAA7B;AACD,KAHM,CAAP;AAID,GALD;;ACAA,EAAA,CAAC,CAAC,EAAF,CAAK,SAAL,GAAiB,UAAoB,SAApB,EAAqC;AACpD,WAAO,KAAK,IAAL,CAAU,YAAA;AACf,WAAK,KAAL,CAAW,eAAX,GAA6B,SAA7B;AACA,WAAK,KAAL,CAAW,SAAX,GAAuB,SAAvB;AACD,KAHM,CAAP;AAID,GALD;ACTA;;;;;AAGAA,MAAM,OAAO,GAA+B,EAA5CA;AAEA;;;;;;;;AAOA,WAAS,QAAT,CACE,QADF,EAEE,OAFF,EAGE,CAHF,EAIE,OAJF,EAIsB;AAEpBC,QAAI,SAAS,GAAG,IAAI,CAAC,OAAD,EAAU,gBAAV,CAApBA;;AAEA,QAAI,CAAC,SAAL,EAAgB;AACd,MAAA,SAAS,GAAG,EAAZ;AACA,MAAA,IAAI,CAAC,OAAD,EAAU,gBAAV,EAA4B,SAA5B,CAAJ;AACD;;AAED,QAAI,SAAS,CAAC,OAAV,CAAkB,QAAlB,MAAgC,CAAC,CAArC,EAAwC;AACtC,MAAA,SAAS,CAAC,IAAV,CAAe,QAAf;AACA,MAAA,OAAO,CAAC,IAAR,CAAa,OAAb,EAAsB,CAAtB,EAAyB,OAAzB;AACD;AACH;;ACrBA,EAAA,CAAC,CAAC,EAAF,CAAK,QAAL,GAAgB,YAAA;AACd,WAAO,KAAK,IAAL,CAAS,UAAE,CAAF,EAAK,OAAL,EAAY;AAC1BD,UAAM,KAAK,GAAG,CAAC,CAAC,OAAD,CAAfA;AAEA,MAAA,IAAI,CAAC,OAAD,EAAQ,UAAG,QAAH,EAAqB,OAArB,EAA4B;AACtC,YAAI,KAAK,CAAC,EAAN,CAAS,QAAT,CAAJ,EAAwB;AACtB,UAAA,QAAQ,CAAC,QAAD,EAAW,OAAX,EAAoB,CAApB,EAAuB,OAAvB,CAAR;AACD;;AAED,QAAA,KAAK,CAAC,IAAN,CAAW,QAAX,EAAqB,IAArB,CAAyB,UAAE,CAAF,EAAK,OAAL,EAAY;AACnC,UAAA,QAAQ,CAAC,QAAD,EAAW,OAAX,EAAoB,CAApB,EAAuB,OAAvB,CAAR;AACD,SAFD;AAGD,OARG,CAAJ;AASD,KAZM,CAAP;AAaD,GAdD;;ACUA,EAAA,CAAC,CAAC,WAAF,GAAgB,UAAU,MAAV,EAAyB;AACvCC,QAAI,QAAQ,GAAG,CAAC,CAAC,eAAD,CAAhBA;;AAEA,QAAI,QAAQ,CAAC,MAAb,EAAqB;AACnB,MAAA,QAAQ,CAAC,IAAT,CAAc,qBAAd,EAAqC,KAArC;;AAEA,UAAI,CAAC,WAAW,CAAC,MAAD,CAAhB,EAA0B;AACxB,QAAA,QAAQ,CAAC,GAAT,CAAa,SAAb,EAAwB,MAAxB;AACD;AACF,KAND,MAMO;AACL,UAAI,WAAW,CAAC,MAAD,CAAf,EAAyB;AACvB,QAAA,MAAM,GAAG,IAAT;AACD;;AAED,MAAA,QAAQ,GAAG,CAAC,CAAC,4BAAD,CAAD,CACR,QADQ,CACC,QAAQ,CAAC,IADV,EAER,MAFQ,GAGR,GAHQ,CAGJ,SAHI,EAGO,MAHP,CAAX;AAID;;AAEDA,QAAI,KAAK,GAAG,QAAQ,CAAC,IAAT,CAAc,gBAAd,KAAmC,CAA/CA;AAEA,WAAO,QAAQ,CAAC,IAAT,CAAc,gBAAd,EAAgC,EAAE,KAAlC,EAAyC,QAAzC,CAAkD,mBAAlD,CAAP;AACD,GAvBD;;ACDA,EAAA,CAAC,CAAC,WAAF,GAAgB,UAAU,KAAV,EAAuB;+BAAR,GAAG,K;AAChCD,QAAM,QAAQ,GAAG,CAAC,CAAC,eAAD,CAAlBA;;AAEA,QAAI,CAAC,QAAQ,CAAC,MAAd,EAAsB;AACpB;AACD;;AAEDC,QAAI,KAAK,GAAG,KAAK,GAAG,CAAH,GAAO,QAAQ,CAAC,IAAT,CAAc,gBAAd,CAAxBA;;AAEA,QAAI,KAAK,GAAG,CAAZ,EAAe;AACb,MAAA,QAAQ,CAAC,IAAT,CAAc,gBAAd,EAAgC,EAAE,KAAlC;AACA;AACD;;AAED,IAAA,QAAQ,CACL,IADH,CACQ,gBADR,EAC0B,CAD1B,EAEG,WAFH,CAEe,mBAFf,EAGG,IAHH,CAGQ,qBAHR,EAG+B,IAH/B,EAIG,aAJH,CAIgB,YAAA;AACZ,UAAI,QAAQ,CAAC,IAAT,CAAc,qBAAd,CAAJ,EAA0C;AACxC,QAAA,QAAQ,CAAC,MAAT;AACD;AACF,KARH;AASD,GAvBD;;ACRA,EAAA,CAAC,CAAC,UAAF,GAAe,YAAA;AACbD,QAAM,KAAK,GAAG,CAAC,CAAC,MAAD,CAAfA,CADa,C;;AAIbA,QAAM,YAAY,GAAG,KAAK,CAAC,KAAN,EAArBA;AACAC,QAAI,KAAK,GAAG,KAAK,CAAC,IAAN,CAAW,mBAAX,KAAmC,CAA/CA;AAEA,IAAA,KAAK,CACF,QADH,CACY,aADZ,EAEG,KAFH,CAES,YAFT,EAGG,IAHH,CAGQ,mBAHR,EAG6B,EAAE,KAH/B;AAID,GAXD;;ACOA,EAAA,CAAC,CAAC,YAAF,GAAiB,UAAU,KAAV,EAAuB;+BAAR,GAAG,K;AACjCD,QAAM,KAAK,GAAG,CAAC,CAAC,MAAD,CAAfA;AACAC,QAAI,KAAK,GAAG,KAAK,GAAG,CAAH,GAAO,KAAK,CAAC,IAAN,CAAW,mBAAX,CAAxBA;;AAEA,QAAI,KAAK,GAAG,CAAZ,EAAe;AACb,MAAA,KAAK,CAAC,IAAN,CAAW,mBAAX,EAAgC,EAAE,KAAlC;AACA;AACD;;AAED,IAAA,KAAK,CAAC,IAAN,CAAW,mBAAX,EAAgC,CAAhC,EAAmC,WAAnC,CAA+C,aAA/C,EAA8D,KAA9D,CAAoE,EAApE;AACD,GAVD;;ACLA,EAAA,CAAC,CAAC,QAAF,GAAa,UAAU,EAAV,EAA0B,KAA1B,EAAoC;+BAAL,GAAG,E;AAC7CA,QAAI,KAAK,GAAQ,IAAjBA;AAEA,WAAO,YAAA;;;;;;;AACL,UAAI,MAAM,CAAC,KAAD,CAAV,EAAmB;AACjB,QAAA,KAAK,GAAG,UAAU,CAAA,YAAA;AAChB,UAAA,EAAE,CAAC,KAAH,CAASE,MAAT,EAAe,IAAf;AACA,UAAA,KAAK,GAAG,IAAR;AACD,SAHiB,EAGf,KAHe,CAAlB;AAID;AACF,KAPD;AAQD,GAXD;;ACEAH,MAAM,IAAI,GAAwB,EAAlCA;;AAEA,EAAA,CAAC,CAAC,IAAF,GAAS,UAAU,IAAV,EAAuB;AAC9B,QAAI,CAAC,WAAW,CAAC,IAAD,CAAZ,IAAsB,CAAC,WAAW,CAAC,IAAI,CAAC,IAAD,CAAL,CAAtC,EAAoD;AAClD,aAAO,IAAI,CAAC,IAAD,CAAX;AACD;;AAED,aAAS,EAAT,GAAW;AACT,aAAO,IAAI,CAAC,KAAL,CAAW,CAAC,IAAI,IAAI,CAAC,MAAL,EAAL,IAAsB,OAAjC,EACJ,QADI,CACK,EADL,EAEJ,SAFI,CAEM,CAFN,CAAP;AAGD;;AAEDA,QAAM,IAAI,GACR,MACA,EAAE,EADF,GAEA,EAAE,EAFF,GAGA,GAHA,GAIA,EAAE,EAJF,GAKA,GALA,GAMA,EAAE,EANF,GAOA,GAPA,GAQA,EAAE,EARF,GASA,GATA,GAUA,EAAE,EAVF,GAWA,EAAE,EAXF,GAYA,EAAE,EAbJA;;AAeA,QAAI,CAAC,WAAW,CAAC,IAAD,CAAhB,EAAwB;AACtB,MAAA,IAAI,CAAC,IAAD,CAAJ,GAAa,IAAb;AACD;;AAED,WAAO,IAAP;AACD,GA/BD;;ACIA,EAAA,IAAI,CAAC,QAAL,GAAgB,UAAU,QAAV,EAA6B,OAA7B,EAAoD;AAClE,QAAI,WAAW,CAAC,QAAD,CAAX,IAAyB,WAAW,CAAC,OAAD,CAAxC,EAAmD;AACjD,MAAA,CAAC,CAAC,QAAD,CAAD,CAAY,QAAZ;AACA;AACD;;AAED,IAAA,OAAO,CAAC,QAAD,CAAP,GAAoB,OAApB;AACA,IAAA,CAAC,CAAC,QAAD,CAAD,CAAY,IAAZ,CAAgB,UAAE,CAAF,EAAK,OAAL,EAAY;AAAA,aAAK,QAAQ,CAAC,QAAD,EAAW,OAAX,EAAoB,CAApB,EAAuB,OAAvB,CAAb;AAA4C,KAAxE;AACD,GARD;ACvBA;;;;;;;;;;AAQA,WAAS,cAAT,CACE,SADF,EAEE,aAFF,EAGE,MAHF,EAIE,QAJF,EAKE,UALF,EAK0B;AAExB,QAAI,CAAC,UAAL,EAAiB;AACf,MAAA,UAAU,GAAG,EAAb;AACD,KAJuB,C;;;AAOxB,IAAA,UAAU,CAAC,IAAX,GAAkB,QAAlB;AAEAA,QAAM,aAAa,GAAM,SAAS,GAAA,QAAT,GAAkB,aAA3CA,CATwB,C;;;AAaxB,QAAI,OAAO,MAAP,KAAkB,WAAtB,EAAmC;;AAEjC,MAAA,MAAM,CAAC,MAAD,CAAN,CAAe,OAAf,CAAuB,aAAvB,EAAsC,UAAtC;AACD;;AAEDA,QAAM,OAAO,GAAG,CAAC,CAAC,MAAD,CAAjBA,CAlBwB,C;;AAqBxB,IAAA,OAAO,CAAC,OAAR,CAAgB,aAAhB,EAA+B,UAA/B;AASAA,QAAM,WAAW,GAAgB;AAC/B,MAAA,OAAO,EAAE,IADsB;AAE/B,MAAA,UAAU,EAAE,IAFmB;AAG/B,MAAA,MAAM,EAAE;AAHuB,KAAjCA;AAMAA,QAAM,WAAW,GAAgB,IAAI,WAAJ,CAAgB,aAAhB,EAA+B,WAA/B,CAAjCA,CApCwB,C;;AAuCxB,IAAA,WAAW,CAAC,OAAZ,GAAsB,UAAtB;AAEA,IAAA,OAAO,CAAC,CAAD,CAAP,CAAW,aAAX,CAAyB,WAAzB;AACF;;AC1DAA,MAAM,SAAS,GAAG,CAAC,CAAC,QAAD,CAAnBA;AACAA,MAAM,OAAO,GAAG,CAAC,CAAC,MAAD,CAAjBA;AACAA,MAAM,KAAK,GAAG,CAAC,CAAC,MAAD,CAAfA;AC2EAA,MAAM,eAAe,GAAY;AAC/B,IAAA,SAAS,EAAE,CADoB;AAE/B,IAAA,MAAM,EAAE,CAFuB;AAG/B,IAAA,YAAY,EAAE,eAHiB;AAI/B,IAAA,WAAW,EAAE,0BAJkB;AAK/B,IAAA,aAAa,EAAE;AALgB,GAAjCA;;AAQA,MAAM,QAAQ,GA+BZ,SAAA,QAAA,CACE,QADF,EAEE,OAFF,EAEuB;sCAAF,E;;;;;AAxBd,SAAA,OAAA,GAAmB,MAAM,CAAC,EAAD,EAAK,eAAL,CAAzB;;;;;AAKC,SAAA,KAAA,GAAe,QAAf;;;;;AAKA,SAAA,QAAA,GAAW,KAAX;;;;;AAKA,SAAA,WAAA,GAAc,CAAd;;;;;AAKA,SAAA,KAAA,GAAQ,CAAR;AAMN,SAAK,QAAL,GAAgB,CAAC,CAAC,QAAD,CAAD,CAAY,KAAZ,EAAhB;AAEA,IAAA,MAAM,CAAC,KAAK,OAAN,EAAe,OAAf,CAAN,CAJqB,C;;AAOrBA,QAAM,SAAS,GAAG,KAAK,OAAL,CAAa,SAA/BA;;AACA,QAAI,QAAQ,CAAC,SAAD,CAAZ,EAAyB;AACvB,WAAK,OAAL,CAAa,SAAb,GAAyB;AACvB,QAAA,IAAI,EAAE,SADiB;AAEvB,QAAA,EAAE,EAAE;AAFmB,OAAzB;AAID;;AAED,SAAK,MAAL;AACF,GAjDF;AAmDE;;;;;qBAGQ,Q,GAAA,SAAA,QAAA,GAAA;;AACN,SAAK,KAAL,GAAa,MAAM,CAAC,qBAAP,CAA4B,YAAA;AACvCA,UAAM,cAAc,GAAG,MAAM,CAAC,WAA9BA;AACAA,UAAM,SAAS,GAAG,cAAc,GAAGG,MAAI,CAAC,WAAtB,GAAoC,MAApC,GAA6C,IAA/DH;AACAA,UAAM,SAAS,GAAIG,MAAI,CAAC,OAALA,CAAa,SAAbA,CAAqC,SAArCA,CAAnBH;AACAA,UAAM,QAAQ,GAAG,IAAI,CAAC,GAAL,CAAS,cAAc,GAAGG,MAAI,CAAC,WAA/B,CAAjBH;AACAA,UAAM,iBAAiB,GAAG,QAAQ,IAAI,SAAtCA;;AAEA,UACE,cAAc,GAAGG,MAAI,CAAC,WAAtB,IACA,cAAc,IAAIA,MAAI,CAAC,OAALA,CAAa,MAD/B,IAEA,iBAHF,EAIE;AACAA,QAAAA,MAAI,CAAC,KAALA;AACD,OAND,MAMO,IACJ,cAAc,GAAGA,MAAI,CAAC,WAAtB,IAAqC,iBAAtC,IACA,cAAc,IAAIA,MAAI,CAAC,OAALA,CAAa,MAF1B,EAGL;AACAA,QAAAA,MAAI,CAAC,GAALA;AACD;;AAEDA,MAAAA,MAAI,CAAC,WAALA,GAAmB,cAAnBA;AACD,KArBY,CAAb;AAsBF,G;AAEA;;;;;;qBAIQ,Y,GAAA,SAAA,YAAA,CAAa,IAAb,EAAwB;AAC9B,IAAA,cAAc,CAAC,IAAD,EAAO,UAAP,EAAmB,KAAK,QAAxB,EAAkC,IAAlC,CAAd;AACF,G;AAEA;;;;;qBAGQ,a,GAAA,SAAA,aAAA,GAAA;AACN,QAAI,KAAK,KAAL,KAAe,SAAnB,EAA8B;AAC5B,WAAK,KAAL,GAAa,QAAb;AACA,WAAK,YAAL,CAAkB,QAAlB;AACD;;AAED,QAAI,KAAK,KAAL,KAAe,WAAnB,EAAgC;AAC9B,WAAK,KAAL,GAAa,UAAb;AACA,WAAK,YAAL,CAAkB,UAAlB;AACD;AACH,G;AAEA;;;;;qBAGO,G,GAAA,SAAA,GAAA,GAAA;;;AACL,QACE,KAAK,KAAL,KAAe,SAAf,IACA,KAAK,KAAL,KAAe,QADf,IAEA,CAAC,KAAK,QAAL,CAAc,QAAd,CAAuB,KAAK,OAAL,CAAa,YAApC,CAHH,EAIE;AACA;AACD;;AAED,SAAK,YAAL,CAAkB,KAAlB;AACA,SAAK,KAAL,GAAa,SAAb;AACA,SAAK,QAAL,CACG,WADH,CACe,KAAK,OAAL,CAAa,aAD5B,EAEG,QAFH,CAEY,KAAK,OAAL,CAAa,WAFzB,EAGG,aAHH,CAGgB,YAAA;AAAA,aAAOA,MAAI,CAAC,aAALA,EAAP;AAA2B,KAH3C;AAIF,G;AAEA;;;;;qBAGO,K,GAAA,SAAA,KAAA,GAAA;;;AACL,QACE,KAAK,KAAL,KAAe,WAAf,IACA,KAAK,KAAL,KAAe,UADf,IAEA,CAAC,KAAK,QAAL,CAAc,QAAd,CAAuB,KAAK,OAAL,CAAa,YAApC,CAHH,EAIE;AACA;AACD;;AAED,SAAK,YAAL,CAAkB,OAAlB;AACA,SAAK,KAAL,GAAa,WAAb;AACA,SAAK,QAAL,CACG,WADH,CACe,KAAK,OAAL,CAAa,WAD5B,EAEG,QAFH,CAEY,KAAK,OAAL,CAAa,aAFzB,EAGG,aAHH,CAGgB,YAAA;AAAA,aAAOA,MAAI,CAAC,aAALA,EAAP;AAA2B,KAH3C;AAIF,G;AAEA;;;;;qBAGO,M,GAAA,SAAA,MAAA,GAAA;;;AACL,QAAI,KAAK,QAAT,EAAmB;AACjB;AACD;;AAED,SAAK,QAAL,GAAgB,IAAhB;AACA,SAAK,KAAL,GAAa,QAAb;AACA,SAAK,QAAL,CACG,QADH,CACY,KAAK,OAAL,CAAa,YADzB,EAEG,WAFH,CAEe,KAAK,OAAL,CAAa,WAF5B,EAGG,WAHH,CAGe,KAAK,OAAL,CAAa,aAH5B;AAIA,SAAK,WAAL,GAAmB,MAAM,CAAC,WAA1B;AAEA,IAAA,OAAO,CAAC,EAAR,CAAW,QAAX,EAAmB,YAAA;AAAA,aAAQA,MAAI,CAAC,QAALA,EAAR;AAAuB,KAA1C;AACF,G;AAEA;;;;;qBAGO,O,GAAA,SAAA,OAAA,GAAA;;;AACL,QAAI,CAAC,KAAK,QAAV,EAAoB;AAClB;AACD;;AAED,SAAK,QAAL,GAAgB,KAAhB;AACA,SAAK,QAAL,CACG,WADH,CACe,KAAK,OAAL,CAAa,YAD5B,EAEG,WAFH,CAEe,KAAK,OAAL,CAAa,WAF5B,EAGG,WAHH,CAGe,KAAK,OAAL,CAAa,aAH5B;AAKA,IAAA,OAAO,CAAC,GAAR,CAAY,QAAZ,EAAoB,YAAA;AAAA,aAAQA,MAAI,CAAC,QAALA,EAAR;AAAuB,KAA3C;AACA,IAAA,MAAM,CAAC,oBAAP,CAA4B,KAAK,KAAjC;AACF,G;AAEA;;;;;qBAGO,Q,GAAA,SAAA,QAAA,GAAA;AACL,WAAO,KAAK,KAAZ;AACF,G;;AAGF,EAAA,IAAI,CAAC,QAAL,GAAgB,QAAhB;AC9QA;;;;;;AAKA,WAAS,YAAT,CAAsB,OAAtB,EAA4C,IAA5C,EAAwD;AACtDH,QAAM,IAAI,GAAG,CAAC,CAAC,OAAD,CAAD,CAAW,IAAX,CAAgB,IAAhB,CAAbA;;AAEA,QAAI,CAAC,IAAL,EAAW;AACT,aAAO,EAAP;AACD;;AAED,WAAO,IAAI,QAAJ,CACL,EADK,EACH,gBACY,IADZ,GACgB,4CAFb,GAAP;AAIF;;ACdAA,MAAM,UAAU,GAAG,eAAnBA;AAEA,EAAA,CAAC,CAAA,YAAA;AACC,IAAA,IAAI,CAAC,QAAL,CAAa,MAAK,UAAL,GAAe,GAA5B,EAAiC,YAAA;AAC/B,UAAI,IAAI,CAAC,QAAT,CAAkB,IAAlB,EAAwB,YAAY,CAAC,IAAD,EAAO,UAAP,CAApC;AACD,KAFD;AAGD,GAJA,CAAD;ACyBAA,MAAMM,iBAAe,GAAY;AAC/B,IAAA,SAAS,EAAE;AADoB,GAAjCN;;AAIA,MAAe,gBAAgB,GAoC7B,SAAA,gBAAA,CACE,QADF,EAEE,OAFF,EAEuB;sCAAF,E;;;;;AA7Bd,SAAA,OAAA,GAAmB,MAAM,CAAC,EAAD,EAAKM,iBAAL,CAAzB,CA6BgB,C;;AAGrBN,QAAM,WAAW,GAAG,UAAQ,KAAK,YAAL,EAAR,GAA2B,OAA/CA;AACA,SAAK,SAAL,GAAiB,WAAjB;AACA,SAAK,aAAL,GAAwB,WAAW,GAAA,OAAnC;AACA,SAAK,WAAL,GAAsB,WAAW,GAAA,SAAjC;AACA,SAAK,SAAL,GAAoB,WAAW,GAAA,OAA/B;AAEA,SAAK,QAAL,GAAgB,CAAC,CAAC,QAAD,CAAD,CAAY,KAAZ,EAAhB;AAEA,IAAA,MAAM,CAAC,KAAK,OAAN,EAAe,OAAf,CAAN;AAEA,SAAK,SAAL;AACF,GApDF;AAsDE;;;;;6BAGQ,S,GAAA,SAAA,SAAA,GAAA;;AAENA,QAAM,IAAI,GAAG,IAAbA,CAFM,C;;AAKN,SAAK,QAAL,CAAc,EAAd,CAAiB,OAAjB,EAAwB,MAAM,KAAK,WAAnC,EAAkD,YAAA;AAChDA,UAAM,OAAO,GAAG,CAAC,CAAC,IAAD,CAAjBA;AACAA,UAAM,KAAK,GAAG,OAAO,CAAC,MAAR,EAAdA;AACAA,UAAM,MAAM,GAAG,IAAI,CAAC,QAAL,EAAfA;AAEA,MAAA,MAAM,CAAC,IAAP,CAAW,UAAE,CAAF,EAAK,IAAL,EAAS;AAClB,YAAI,KAAK,CAAC,EAAN,CAAS,IAAT,CAAJ,EAAoB;AAClB,UAAA,IAAI,CAAC,MAAL,CAAY,IAAZ;AACD;AACF,OAJD;AAKD,KAVD,EALM,C;;AAkBN,SAAK,QAAL,CAAc,EAAd,CACE,OADF,EACS,WACE,KAAK,YAAL,EADF,GACqB,cAF9B,EAGE,YAAA;AACEA,UAAM,OAAO,GAAG,CAAC,CAAC,IAAD,CAAjBA;AACAA,UAAM,KAAK,GAAG,OAAO,CAAC,OAAR,CAAe,MAAK,IAAI,CAAC,SAAzB,EAAsC,KAAtC,EAAdA;AAEA,MAAA,IAAI,CAAC,KAAL,CAAW,KAAX;AACD,KARH;AAUF,G;AAEA;;;;;;6BAIQ,M,GAAA,SAAA,MAAA,CAAO,KAAP,EAAgB;AACtB,WAAO,KAAK,CAAC,QAAN,CAAe,KAAK,aAApB,CAAP;AACF,G;AAEA;;;;;6BAGQ,Q,GAAA,SAAA,QAAA,GAAA;AACN,WAAO,KAAK,QAAL,CAAc,QAAd,CAAsB,MAAK,KAAK,SAAhC,CAAP;AACF,G;AAEA;;;;;;6BAIQ,O,GAAA,SAAA,OAAA,CACN,IADM,EACwD;AAE9D,QAAI,QAAQ,CAAC,IAAD,CAAZ,EAAoB;AAClB,aAAO,KAAK,QAAL,GAAgB,EAAhB,CAAmB,IAAnB,CAAP;AACD;;AAED,WAAO,CAAC,CAAC,IAAD,CAAD,CAAQ,KAAR,EAAP;AACF,G;AAEA;;;;;;;6BAKQ,Y,GAAA,SAAA,YAAA,CAAa,IAAb,EAA0B,KAA1B,EAAmC;AACzC,IAAA,cAAc,CAAC,IAAD,EAAO,KAAK,YAAL,EAAP,EAA4B,KAA5B,EAAmC,IAAnC,CAAd;AACF,G;AAEA;;;;;;;6BAKQ,a,GAAA,SAAA,aAAA,CAAc,QAAd,EAA4B,KAA5B,EAAqC;AAC3C,QAAI,KAAK,MAAL,CAAY,KAAZ,CAAJ,EAAwB;AACtB,MAAA,QAAQ,CAAC,UAAT,CAAoB,CAApB,EAAuB,MAAvB,CAA8B,MAA9B,EAAsC,MAAtC,GAA+C,UAA/C,CAA0D,EAA1D;AAEA,WAAK,YAAL,CAAkB,QAAlB,EAA4B,KAA5B;AACD,KAJD,MAIO;AACL,MAAA,QAAQ,CAAC,MAAT,CAAgB,EAAhB;AAEA,WAAK,YAAL,CAAkB,QAAlB,EAA4B,KAA5B;AACD;AACH,G;AAEA;;;;;;6BAIO,I,GAAA,SAAA,IAAA,CACL,IADK,EACyD;;AAE9DA,QAAM,KAAK,GAAG,KAAK,OAAL,CAAa,IAAb,CAAdA;;AAEA,QAAI,KAAK,MAAL,CAAY,KAAZ,CAAJ,EAAwB;AACtB;AACD,KAN6D,C;;;AAS9D,QAAI,KAAK,OAAL,CAAa,SAAjB,EAA4B;AAC1B,WAAK,QAAL,CAAc,QAAd,CAAsB,MAAK,KAAK,aAAhC,EAAiD,IAAjD,CAAqD,UAAE,CAAF,EAAK,OAAL,EAAY;AAC/DA,YAAM,QAAQ,GAAG,CAAC,CAAC,OAAD,CAAlBA;;AAEA,YAAI,CAAC,QAAQ,CAAC,EAAT,CAAY,KAAZ,CAAL,EAAyB;AACvBG,UAAAA,MAAI,CAAC,KAALA,CAAW,QAAXA;AACD;AACF,OAND;AAOD;;AAEDH,QAAM,QAAQ,GAAG,KAAK,CAAC,QAAN,CAAc,MAAK,KAAK,SAAxB,CAAjBA;AAEA,IAAA,QAAQ,CACL,MADH,CACU,QAAQ,CAAC,CAAD,CAAR,CAAY,YADtB,EAEG,aAFH,CAEgB,YAAA;AAAA,aAAOG,MAAI,CAAC,aAALA,CAAmB,QAAnBA,EAA6B,KAA7BA,CAAP;AAA0C,KAF1D;AAIA,SAAK,YAAL,CAAkB,MAAlB,EAA0B,KAA1B;AAEA,IAAA,KAAK,CAAC,QAAN,CAAe,KAAK,aAApB;AACF,G;AAEA;;;;;;6BAIO,K,GAAA,SAAA,KAAA,CACL,IADK,EACyD;;AAE9DH,QAAM,KAAK,GAAG,KAAK,OAAL,CAAa,IAAb,CAAdA;;AAEA,QAAI,CAAC,KAAK,MAAL,CAAY,KAAZ,CAAL,EAAyB;AACvB;AACD;;AAEDA,QAAM,QAAQ,GAAG,KAAK,CAAC,QAAN,CAAc,MAAK,KAAK,SAAxB,CAAjBA;AAEA,SAAK,YAAL,CAAkB,OAAlB,EAA2B,KAA3B;AAEA,IAAA,KAAK,CAAC,WAAN,CAAkB,KAAK,aAAvB;AAEA,IAAA,QAAQ,CACL,UADH,CACc,CADd,EAEG,MAFH,CAEU,QAAQ,CAAC,CAAD,CAAR,CAAY,YAFtB,EAGG,MAHH,GAIG,UAJH,CAIc,EAJd,EAKG,MALH,CAKU,EALV,EAMG,aANH,CAMgB,YAAA;AAAA,aAAOG,MAAI,CAAC,aAALA,CAAmB,QAAnBA,EAA6B,KAA7BA,CAAP;AAA0C,KAN1D;AAOF,G;AAEA;;;;;;6BAIO,M,GAAA,SAAA,MAAA,CACL,IADK,EACyD;AAE9DH,QAAM,KAAK,GAAG,KAAK,OAAL,CAAa,IAAb,CAAdA;AAEA,SAAK,MAAL,CAAY,KAAZ,IAAqB,KAAK,KAAL,CAAW,KAAX,CAArB,GAAyC,KAAK,IAAL,CAAU,KAAV,CAAzC;AACF,G;AAEA;;;;;6BAGO,O,GAAA,SAAA,OAAA,GAAA;;AACL,SAAK,QAAL,GAAgB,IAAhB,CAAoB,UAAE,CAAF,EAAK,OAAL,EAAY;AAAA,aAAKG,MAAI,CAAC,IAALA,CAAU,OAAVA,CAAL;AAAuB,KAAvD;AACF,G;AAEA;;;;;6BAGO,Q,GAAA,SAAA,QAAA,GAAA;;AACL,SAAK,QAAL,GAAgB,IAAhB,CAAoB,UAAE,CAAF,EAAK,OAAL,EAAY;AAAA,aAAKA,MAAI,CAAC,KAALA,CAAW,OAAXA,CAAL;AAAwB,KAAxD;AACF,G;;ACjPF,MAAM,QAAS,GAAA,aAAA,UAAA,gBAAA,EAAA;;;;;;;;;uBACH,Y,GAAA,SAAA,YAAA,GAAA;AACR,aAAO,UAAP;;;;GAFW,CAAQ,gBAAR,CAAf;;AAMA,EAAA,IAAI,CAAC,QAAL,GAAgB,QAAhB;ACzBAH,MAAMO,YAAU,GAAG,eAAnBP;AAEA,EAAA,CAAC,CAAA,YAAA;AACC,IAAA,IAAI,CAAC,QAAL,CAAa,MAAKO,YAAL,GAAe,GAA5B,EAAiC,YAAA;AAC/B,UAAI,IAAI,CAAC,QAAT,CAAkB,IAAlB,EAAwB,YAAY,CAAC,IAAD,EAAOA,YAAP,CAApC;AACD,KAFD;AAGD,GAJA,CAAD;;ACiBA,MAAM,KAAM,GAAA,aAAA,UAAA,gBAAA,EAAA;;;;;;;;;oBACA,Y,GAAA,SAAA,YAAA,GAAA;AACR,aAAO,OAAP;;;;GAFQ,CAAQ,gBAAR,CAAZ;;AAMA,EAAA,IAAI,CAAC,KAAL,GAAa,KAAb;ACzBAP,MAAMO,YAAU,GAAG,YAAnBP;AAEA,EAAA,CAAC,CAAA,YAAA;AACC,IAAA,IAAI,CAAC,QAAL,CAAa,MAAKO,YAAL,GAAe,GAA5B,EAAiC,YAAA;AAC/B,UAAI,IAAI,CAAC,KAAT,CAAe,IAAf,EAAqB,YAAY,CAAC,IAAD,EAAOA,YAAP,CAAjC;AACD,KAFD;AAGD,GAJA,CAAD;;ACyBA,MAAM,KAAK,GAoCT,SAAA,KAAA,CACE,QADF,EAC2D;;;;AA5BnD,SAAA,MAAA,GAAa,CAAC,EAAd;;;;;AAKA,SAAA,OAAA,GAAc,CAAC,EAAf;;;;;AAKA,SAAA,WAAA,GAAoC,CAAC,EAArC;;;;;AAKA,SAAA,YAAA,GAAqC,CAAC,EAAtC;;;;;AAKA,SAAA,UAAA,GAAa,KAAb;;;;;AAKA,SAAA,WAAA,GAAc,CAAd;AAKN,SAAK,QAAL,GAAgB,CAAC,CAAC,QAAD,CAAD,CAAY,KAAZ,EAAhB;AACA,SAAK,IAAL;AACF,GAzCF;AA2CE;;;;;kBAGO,I,GAAA,SAAA,IAAA,GAAA;AACL,SAAK,MAAL,GAAc,KAAK,QAAL,CAAc,IAAd,CAAmB,UAAnB,CAAd;AACA,SAAK,OAAL,GAAe,KAAK,QAAL,CAAc,IAAd,CAAmB,UAAnB,CAAf;AACA,SAAK,UAAL,GAAkB,KAAK,QAAL,CAAc,QAAd,CAAuB,uBAAvB,CAAlB;AAEA,SAAK,gBAAL;AACA,SAAK,gBAAL;AACA,SAAK,gBAAL;AACF,G;AAEA;;;;;;kBAIQ,kB,GAAA,SAAA,kBAAA,CAAmB,GAAnB,EAA8B;AACpC,WACE,MAAI,GAAJ,GAAO,sCAAP,GACA,+BADA,GAEA,0BAFA,GAGA,oCAHA,GAIA,UAJA,GAKA,IALA,GAKK,GALL,GAKQ,GANV;AAQF,G;AAEA;;;;;kBAGQ,sB,GAAA,SAAA,sBAAA,GAAA;AACNP,QAAM,QAAQ,GAAG,KAAK,WAAL,CAAiB,CAAjB,CAAjBA;AACAA,QAAM,WAAW,GAAG,KAAK,WAAzBA;AACAA,QAAM,YAAY,GAAG,KAAK,OAAL,CAAa,MAAlCA;AAEA,IAAA,QAAQ,CAAC,OAAT,GAAmB,WAAW,KAAK,YAAnC;AACA,IAAA,QAAQ,CAAC,aAAT,GAAyB,CAAC,CAAC,WAAF,IAAiB,WAAW,KAAK,YAA1D;AACF,G;AAEA;;;;;kBAGQ,gB,GAAA,SAAA,gBAAA,GAAA;;AACNA,QAAM,gBAAgB,GAAG,yBAAzBA;AAEA,SAAK,OAAL,CAAa,IAAb,CAAiB,UAAE,CAAF,EAAK,GAAL,EAAQ;AACvBA,UAAM,IAAI,GAAG,CAAC,CAAC,GAAD,CAAdA,CADuB,C;;AAIvB,MAAA,IAAI,CAAC,IAAL,CAAU,2BAAV,EAAuC,MAAvC;;AAEA,UAAI,CAACG,MAAI,CAAC,UAAV,EAAsB;AACpB;AACD,OARsB,C;;;AAWvBH,UAAM,SAAS,GAAG,CAAC,CAACG,MAAI,CAAC,kBAALA,CAAwB,IAAxBA,CAAD,CAAD,CACf,SADe,CACL,IADK,EAEf,IAFe,CAEV,wBAFU,CAAlBH,CAXuB,C;;AAgBvB,UAAI,IAAI,CAAC,QAAL,CAAc,gBAAd,CAAJ,EAAqC;AACnC,QAAA,SAAS,CAAC,CAAD,CAAT,CAAa,OAAb,GAAuB,IAAvB;AACAG,QAAAA,MAAI,CAAC,WAALA;AACD;;AAEDA,MAAAA,MAAI,CAAC,sBAALA,GArBuB,C;;AAwBvB,MAAA,SAAS,CAAC,EAAV,CAAa,QAAb,EAAqB,YAAA;AACnB,YAAI,SAAS,CAAC,CAAD,CAAT,CAAa,OAAjB,EAA0B;AACxB,UAAA,IAAI,CAAC,QAAL,CAAc,gBAAd;AACAA,UAAAA,MAAI,CAAC,WAALA;AACD,SAHD,MAGO;AACL,UAAA,IAAI,CAAC,WAAL,CAAiB,gBAAjB;AACAA,UAAAA,MAAI,CAAC,WAALA;AACD;;AAEDA,QAAAA,MAAI,CAAC,sBAALA;AACD,OAVD;AAYAA,MAAAA,MAAI,CAAC,YAALA,GAAoBA,MAAI,CAAC,YAALA,CAAkB,GAAlBA,CAAsB,SAAtBA,CAApBA;AACD,KArCD;AAsCF,G;AAEA;;;;;kBAGQ,gB,GAAA,SAAA,gBAAA,GAAA;sBAAA,C;;AAEN,SAAK,MAAL,CAAY,IAAZ,CAAiB,2BAAjB,EAA8C,MAA9C;;AAEA,QAAI,CAAC,KAAK,UAAV,EAAsB;AACpB;AACD;;AAED,SAAK,WAAL,GAAmB,CAAC,CAAC,KAAK,kBAAL,CAAwB,IAAxB,CAAD,CAAD,CAChB,SADgB,CACN,KAAK,MADC,EAEhB,IAFgB,CAEX,wBAFW,EAGhB,EAHgB,CAGb,QAHa,EAGL,YAAA;AACVH,UAAM,YAAY,GAAGG,MAAI,CAAC,WAALA,CAAiB,CAAjBA,EAAoB,OAAzCH;AACAG,MAAAA,MAAI,CAAC,WAALA,GAAmB,YAAY,GAAGA,MAAI,CAAC,OAALA,CAAa,MAAhB,GAAyB,CAAxDA;AAEAA,MAAAA,MAAI,CAAC,YAALA,CAAkB,IAAlBA,CAAsB,UAAE,CAAF,EAAK,QAAL,EAAa;AACjC,QAAA,QAAQ,CAAC,OAAT,GAAmB,YAAnB;AACD,OAFDA;AAIAA,MAAAA,MAAI,CAAC,OAALA,CAAa,IAAbA,CAAiB,UAAE,CAAF,EAAK,GAAL,EAAQ;AACvB,QAAA,YAAY,GACR,CAAC,CAAC,GAAD,CAAD,CAAO,QAAP,CAAgB,yBAAhB,CADQ,GAER,CAAC,CAAC,GAAD,CAAD,CAAO,WAAP,CAAmB,yBAAnB,CAFJ;AAGD,OAJDA;AAKD,KAhBgB,CAAnB;AAiBF,G;AAEA;;;;;kBAGQ,gB,GAAA,SAAA,gBAAA,GAAA;;AACNH,QAAM,YAAY,GAAG,wBAArBA;AAEA,SAAK,MAAL,CAAY,IAAZ,CAAiB,IAAjB,EAAuB,IAAvB,CAA2B,UAAE,CAAF,EAAK,EAAL,EAAO;AAChCA,UAAM,YAAY,GAAG,CAAC,CAAC,EAAD,CAAD,CAAM,QAAN,CAAe,YAAf,CAArBA;AAEAG,MAAAA,MAAI,CAAC,OAALA,CAAa,IAAbA,CAAiB,UAAE,CAAF,EAAK,GAAL,EAAQ;AACvBH,YAAM,GAAG,GAAG,CAAC,CAAC,GAAD,CAAD,CAAO,IAAP,CAAY,IAAZ,EAAkB,EAAlB,CAAqB,CAArB,CAAZA;AAEA,QAAA,YAAY,GACR,GAAG,CAAC,QAAJ,CAAa,YAAb,CADQ,GAER,GAAG,CAAC,WAAJ,CAAgB,YAAhB,CAFJ;AAGD,OANDG;AAOD,KAVD;AAWF,G;;AAGFH,MAAM,QAAQ,GAAG,aAAjBA;AAEA,EAAA,CAAC,CAAA,YAAA;AACC,IAAA,IAAI,CAAC,QAAL,CAAc,aAAd,EAA6B,YAAA;AAC3BA,UAAM,QAAQ,GAAG,CAAC,CAAC,IAAD,CAAlBA;;AAEA,UAAI,CAAC,QAAQ,CAAC,IAAT,CAAc,QAAd,CAAL,EAA8B;AAC5B,QAAA,QAAQ,CAAC,IAAT,CAAc,QAAd,EAAwB,IAAI,KAAJ,CAAU,QAAV,CAAxB;AACD;AACF,KAND;AAOD,GARA,CAAD;;AAUA,EAAA,IAAI,CAAC,YAAL,GAAoB,UAClB,QADkB,EACwC;AAE1DA,QAAM,SAAS,GAAG,WAAW,CAAC,QAAD,CAAX,GAAwB,CAAC,CAAC,aAAD,CAAzB,GAA2C,CAAC,CAAC,QAAD,CAA9DA;AAEA,IAAA,SAAS,CAAC,IAAV,CAAc,UAAE,CAAF,EAAK,OAAL,EAAY;AACxBA,UAAM,QAAQ,GAAG,CAAC,CAAC,OAAD,CAAlBA;AACAA,UAAM,QAAQ,GAAG,QAAQ,CAAC,IAAT,CAAc,QAAd,CAAjBA;;AAEA,UAAI,QAAJ,EAAc;AACZ,QAAA,QAAQ,CAAC,IAAT;AACD,OAFD,MAEO;AACL,QAAA,QAAQ,CAAC,IAAT,CAAc,QAAd,EAAwB,IAAI,KAAJ,CAAU,QAAV,CAAxB;AACD;AACF,KATD;AAUD,GAfD;AChOA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCAA,MAAM,UAAU,GAAG,sBAAnBA;AACAA,MAAM,SAAS,GAAG,qBAAlBA;AACAA,MAAM,QAAQ,GAAG,kBAAjBA;AACAA,MAAM,WAAW,GAAG,wBAApBA;AACAA,MAAM,WAAW,GAAG,gCAApBA;AAEAC,MAAI,OAAO,GAAG,CAAdA;AAEA;;;;;;AAKA,WAAS,OAAT,CAAiB,KAAjB,EAA6B;AAC3B,WAAO,EACL,OAAO,IACP,CACE,WADF,EAEE,SAFF,EAGE,WAHF,EAIE,OAJF,EAKE,WALF,EAME,UANF,EAOE,YAPF,EAQE,YARF,EASE,OATF,CASU,KAAK,CAAC,IAThB,IASwB,CAAC,CAXpB,CAAP;AAaD;AAED;;;;;;AAIA,WAAS,QAAT,CAAkB,KAAlB,EAA8B;AAC5B,QAAI,KAAK,CAAC,IAAN,KAAe,YAAnB,EAAiC;;AAE/B,MAAA,OAAO,IAAI,CAAX;AACD,KAHD,MAGO,IACL,CAAC,WAAD,EAAc,UAAd,EAA0B,aAA1B,EAAyC,OAAzC,CAAiD,KAAK,CAAC,IAAvD,IAA+D,CAAC,CAD3D,EAEL;;AAEA,MAAA,UAAU,CAAC,YAAA;AACT,YAAI,OAAJ,EAAa;AACX,UAAA,OAAO,IAAI,CAAX;AACD;AACF,OAJS,EAIP,GAJO,CAAV;AAKD;AACH;ACjFA;;;;;;;AAwCA;;;;;;;AAKA,WAAS,IAAT,CAAc,KAAd,EAA4B,OAA5B,EAAuC;;AAErC,QAAI,KAAK,YAAY,UAAjB,IAA+B,KAAK,CAAC,MAAN,KAAiB,CAApD,EAAuD;AACrD;AACD,KAJoC,C;;;AAOrCD,QAAM,aAAa,GACjB,OAAO,UAAP,KAAsB,WAAtB,IACA,KAAK,YAAY,UADjB,IAEA,KAAK,CAAC,OAAN,CAAc,MAFd,GAGI,KAAK,CAAC,OAAN,CAAc,CAAd,CAHJ,GAIK,KALPA;AAOAA,QAAM,WAAW,GAAG,aAAa,CAAC,KAAlCA;AACAA,QAAM,WAAW,GAAG,aAAa,CAAC,KAAlCA,CAfqC,C;;AAkBrCA,QAAM,MAAM,GAAG,OAAO,CAAC,MAAR,EAAfA;AACAA,QAAM,MAAM,GAAG,OAAO,CAAC,WAAR,EAAfA;AACAA,QAAM,KAAK,GAAG,OAAO,CAAC,UAAR,EAAdA;AACAA,QAAM,MAAM,GAAG;AACb,MAAA,CAAC,EAAE,WAAW,GAAG,MAAM,CAAC,IADX;AAEb,MAAA,CAAC,EAAE,WAAW,GAAG,MAAM,CAAC;AAFX,KAAfA;AAIAA,QAAM,QAAQ,GAAG,IAAI,CAAC,GAAL,CACf,IAAI,CAAC,GAAL,CAAS,IAAI,CAAC,GAAL,CAAS,MAAT,EAAiB,CAAjB,IAAsB,IAAI,CAAC,GAAL,CAAS,KAAT,EAAgB,CAAhB,CAA/B,EAAmD,GAAnD,CADe,EAEf,EAFe,CAAjBA,CAzBqC,C;;AA+BrCA,QAAM,SAAS,GACb,kBAAe,CAAC,MAAM,CAAC,CAAR,GAAY,KAAK,GAAG,CAAnC,IAAoC,KAApC,IACG,CAAC,MAAM,CAAC,CAAR,GAAY,MAAM,GAAG,CADxB,IACyB,iBAF3BA,CA/BqC,C;;AAoCrC,IAAA,CAAC,CACC,qCACE,gBADF,GACkB,QADlB,GAC0B,YAD1B,GACuC,QADvC,GAC+C,KAD/C,GAEE,cAFF,GAEiB,QAAQ,GAAG,CAF5B,GAE6B,kBAF7B,GAEgD,QAAQ,GAAG,CAF3D,GAE4D,KAF5D,GAGE,OAHF,GAGU,MAAM,CAAC,CAHjB,GAGkB,SAHlB,GAG4B,MAAM,CAAC,CAHnC,GAGoC,cAJrC,CAAD,CAMG,IANH,CAMQ,wBANR,EAMkC,SANlC,EAOG,SAPH,CAOa,OAPb,EAQG,MARH,GASG,SATH,CASa,SATb;AAUD;AAED;;;;;;AAIA,WAAS,YAAT,CAAsB,KAAtB,EAA+B;AAC7B,QAAI,CAAC,KAAK,CAAC,MAAP,IAAiB,KAAK,CAAC,IAAN,CAAW,sBAAX,CAArB,EAAyD;AACvD;AACD;;AAED,IAAA,KAAK,CAAC,IAAN,CAAW,sBAAX,EAAmC,IAAnC;AAEAC,QAAI,WAAW,GAAG,UAAU,CAAA,YAAA;AAAA,aAAO,KAAK,CAAC,MAAN,EAAP;AAAqB,KAArB,EAAuB,GAAvB,CAA5BA;AACAD,QAAM,SAAS,GAAG,KAAK,CAAC,IAAN,CAAW,wBAAX,CAAlBA;AAEA,IAAA,KAAK,CACF,QADH,CACY,uBADZ,EAEG,SAFH,CAEa,SAAS,CAAC,OAAV,CAAkB,UAAlB,EAA8B,aAA9B,CAFb,EAGG,aAHH,CAGgB,YAAA;AACZ,MAAA,YAAY,CAAC,WAAD,CAAZ;AAEA,MAAA,KAAK,CACF,QADH,CACY,sBADZ,EAEG,SAFH,CAEa,SAAS,CAAC,OAAV,CAAkB,UAAlB,EAA8B,aAA9B,CAFb;AAIA,MAAA,WAAW,GAAG,UAAU,CAAA,YAAA;AAAA,eAAO,KAAK,CAAC,MAAN,EAAP;AAAqB,OAArB,EAAuB,GAAvB,CAAxB;AAEA,MAAA,UAAU,CAAA,YAAA;AACR,QAAA,KAAK,CAAC,aAAN,CAAmB,YAAA;AACjB,UAAA,YAAY,CAAC,WAAD,CAAZ;AACA,UAAA,KAAK,CAAC,MAAN;AACD,SAHD;AAID,OALS,EAKP,CALO,CAAV;AAMD,KAlBH;AAmBD;AAED;;;;;;AAIA,WAAS,IAAT,GAAa;AACXA,QAAM,OAAO,GAAG,CAAC,CAAC,IAAD,CAAjBA;AAEA,IAAA,OAAO,CAAC,QAAR,CAAiB,mBAAjB,EAAsC,IAAtC,CAA0C,UAAE,CAAF,EAAK,IAAL,EAAS;AACjD,MAAA,YAAY,CAAC,CAAC,CAAC,IAAD,CAAF,CAAZ;AACD,KAFD;AAIA,IAAA,OAAO,CAAC,GAAR,CAAe,SAAS,GAAA,GAAT,GAAa,QAAb,GAAqB,GAArB,GAAyB,WAAxC,EAAuD,IAAvD;AACD;AAED;;;;;;AAIA,WAAS,UAAT,CAAoB,KAApB,EAAgC;AAC9B,QAAI,CAAC,OAAO,CAAC,KAAD,CAAZ,EAAqB;AACnB;AACD;;AAED,IAAA,QAAQ,CAAC,KAAD,CAAR,CAL8B,C;;AAQ9B,QAAI,KAAK,CAAC,MAAN,KAAiB,QAArB,EAA+B;AAC7B;AACD;;AAEDA,QAAM,OAAO,GAAG,CAAC,CAAC,KAAK,CAAC,MAAP,CAAjBA,CAZ8B,C;;AAe9BA,QAAM,OAAO,GAAG,OAAO,CAAC,QAAR,CAAiB,aAAjB,IACZ,OADY,GAEZ,OAAO,CAAC,OAAR,CAAgB,cAAhB,EAAgC,KAAhC,EAFJA;;AAIA,QAAI,CAAC,OAAO,CAAC,MAAb,EAAqB;AACnB;AACD,KArB6B,C;;;AAwB9B,QAAI,OAAO,CAAC,IAAR,CAAa,UAAb,KAA4B,CAAC,WAAW,CAAC,OAAO,CAAC,IAAR,CAAa,UAAb,CAAD,CAA5C,EAAwE;AACtE;AACD;;AAED,QAAI,KAAK,CAAC,IAAN,KAAe,YAAnB,EAAiC;AAC/BC,UAAI,MAAM,GAAG,KAAbA,CAD+B,C;;AAI/BA,UAAI,KAAK,GAAG,UAAU,CAAA,YAAA;AACpB,QAAA,KAAK,GAAG,CAAR;AACA,QAAA,IAAI,CAAC,KAAD,EAAQ,OAAR,CAAJ;AACD,OAHqB,EAGnB,GAHmB,CAAtBA;;AAKAD,UAAM,UAAU,GAAA,YAAA;;AAEd,YAAI,KAAJ,EAAW;AACT,UAAA,YAAY,CAAC,KAAD,CAAZ;AACA,UAAA,KAAK,GAAG,CAAR;AACA,UAAA,IAAI,CAAC,KAAD,EAAQ,OAAR,CAAJ;AACD;;AAED,YAAI,CAAC,MAAL,EAAa;AACX,UAAA,MAAM,GAAG,IAAT;AACA,UAAA,IAAI,CAAC,IAAL,CAAU,OAAV;AACD;AACF,OAZDA,CAT+B,C;;;AAwB/BA,UAAM,SAAS,GAAA,YAAA;AACb,YAAI,KAAJ,EAAW;AACT,UAAA,YAAY,CAAC,KAAD,CAAZ;AACA,UAAA,KAAK,GAAG,CAAR;AACD;;AAED,QAAA,UAAU;AACX,OAPDA;;AASA,MAAA,OAAO,CAAC,EAAR,CAAW,WAAX,EAAwB,SAAxB,EAAmC,EAAnC,CAAsC,sBAAtC,EAA8D,UAA9D;AACD,KAlCD,MAkCO;AACL,MAAA,IAAI,CAAC,KAAD,EAAQ,OAAR,CAAJ;AACA,MAAA,OAAO,CAAC,EAAR,CAAc,SAAS,GAAA,GAAT,GAAa,QAAb,GAAqB,GAArB,GAAyB,WAAvC,EAAsD,IAAtD;AACD;AACF;;AAED,EAAA,CAAC,CAAA,YAAA;AACC,IAAA,SAAS,CAAC,EAAV,CAAa,UAAb,EAAyB,UAAzB,EAAqC,EAArC,CAAwC,WAAxC,EAAqD,QAArD;AACD,GAFA,CAAD;AC5KAA,MAAM,WAAW,GAAqB;AACpC,IAAA,MAAM,EAAE,KAD4B;AAEpC,IAAA,cAAc,EAAE;AAFoB,GAAtCA;AAKA;;;;;;AAKA,WAAS,UAAT,CAAoB,KAApB,EAAkC,IAAlC,EAA6D;gCAAF,E;AACzD,IAAA,IAAI,GAAG,MAAM,CAAC,EAAD,EAAK,WAAL,EAAkB,IAAlB,CAAb;AAEAA,QAAM,KAAK,GAAG,KAAK,CAAC,MAApBA;AACAA,QAAM,MAAM,GAAG,CAAC,CAAC,KAAD,CAAhBA;AACAA,QAAM,SAAS,GAAG,KAAK,CAAC,IAAxBA;AACAA,QAAM,KAAK,GAAG,MAAM,CAAC,GAAP,EAAdA,CAN2D,C;;AAS3DA,QAAM,SAAS,GAAG,MAAM,CAAC,IAAP,CAAY,MAAZ,KAAuB,EAAzCA;;AACA,QACE,CAAC,UAAD,EAAa,QAAb,EAAuB,QAAvB,EAAiC,OAAjC,EAA0C,OAA1C,EAAmD,OAAnD,EAA4D,OAA5D,CACE,SADF,IAEI,CAAC,CAHP,EAIE;AACA;AACD;;AAEDA,QAAM,UAAU,GAAG,MAAM,CAAC,MAAP,CAAc,iBAAd,CAAnBA,CAlB2D,C;;AAqB3D,QAAI,SAAS,KAAK,OAAlB,EAA2B;AACzB,MAAA,UAAU,CAAC,QAAX,CAAoB,sBAApB;AACD;;AAED,QAAI,SAAS,KAAK,MAAlB,EAA0B;AACxB,MAAA,UAAU,CAAC,WAAX,CAAuB,sBAAvB;AACD,KA3B0D,C;;;AA8B3D,QAAI,SAAS,KAAK,MAAd,IAAwB,SAAS,KAAK,OAA1C,EAAmD;AACjD,MAAA,KAAK,GACD,UAAU,CAAC,QAAX,CAAoB,0BAApB,CADC,GAED,UAAU,CAAC,WAAX,CAAuB,0BAAvB,CAFJ;AAGD,KAlC0D,C;;;AAqC3D,IAAA,KAAK,CAAC,QAAN,GACI,UAAU,CAAC,QAAX,CAAoB,yBAApB,CADJ,GAEI,UAAU,CAAC,WAAX,CAAuB,yBAAvB,CAFJ,CArC2D,C;;AA0C3D,QACE,CAAC,SAAS,KAAK,OAAd,IAAyB,SAAS,KAAK,MAAxC,KACA,CAAC,IAAI,CAAC,cADN,IAEA,KAAK,CAAC,QAHR,EAIE;AACA,MAAA,KAAK,CAAC,QAAN,CAAe,KAAf,GACI,UAAU,CAAC,WAAX,CAAuB,8BAAvB,CADJ,GAEI,UAAU,CAAC,QAAX,CAAoB,8BAApB,CAFJ;AAGD,KAlD0D,C;;;AAqD3D,QAAI,MAAM,CAAC,EAAP,CAAU,UAAV,CAAJ,EAA2B;;;AAGzBA,UAAM,UAAU,GAAG,KAAnBA;AACAC,UAAI,aAAa,GAAG,KAApBA;;AAEA,UAAI,UAAU,CAAC,OAAX,CAAmB,SAAnB,EAA8B,EAA9B,MAAsC,EAA1C,EAA8C;AAC5C,QAAA,MAAM,CAAC,GAAP,CAAW,MAAM,UAAjB;AACA,QAAA,aAAa,GAAG,IAAhB;AACD,OATwB,C;;;AAYzB,MAAA,MAAM,CAAC,WAAP,CAAmB,EAAnB;AACAD,UAAM,MAAM,GAAG,MAAM,CAAC,WAAP,EAAfA;AACAA,UAAM,YAAY,GAAG,KAAK,CAAC,YAA3BA;;AAEA,UAAI,YAAY,GAAG,MAAnB,EAA2B;AACzB,QAAA,MAAM,CAAC,WAAP,CAAmB,YAAnB;AACD,OAlBwB,C;;;AAqBzB,UAAI,aAAJ,EAAmB;AACjB,QAAA,MAAM,CAAC,GAAP,CAAW,UAAX;AACD;AACF,KA7E0D,C;;;AAgF3D,QAAI,IAAI,CAAC,MAAT,EAAiB;AACf,MAAA,UAAU,CAAC,IAAX,CAAgB,yBAAhB,EAA2C,MAA3C;AACD;;AAEDA,QAAM,SAAS,GAAG,MAAM,CAAC,IAAP,CAAY,WAAZ,CAAlBA;;AACA,QAAI,SAAJ,EAAe;AACb,UAAI,IAAI,CAAC,MAAL,IAAe,IAAI,CAAC,cAAxB,EAAwC;AACtC,QAAA,CAAC,CACC,yCACE,2DADF,GAC4D,SAD5D,GAEE,QAHH,CAAD,CAIE,QAJF,CAIW,UAJX;AAKD;;AAED,MAAA,UAAU,CACP,IADH,CACQ,iCADR,EAEG,IAFH,CAEQ,KAAK,CAAC,MAAN,CAAa,QAAb,EAFR;AAGD,KAjG0D,C;;;AAoG3D,QACE,UAAU,CAAC,IAAX,CAAgB,wBAAhB,EAA0C,MAA1C,IACA,UAAU,CAAC,IAAX,CAAgB,uBAAhB,EAAyC,MADzC,IAEA,SAHF,EAIE;AACA,MAAA,UAAU,CAAC,QAAX,CAAoB,2BAApB;AACD;AACF;;AAED,EAAA,CAAC,CAAA,YAAA;;AAEC,IAAA,SAAS,CAAC,EAAV,CACE,kBADF,EAEE,uBAFF,EAGE;AAAE,MAAA,UAAU,EAAE;AAAd,KAHF,EAIE,UAJF,EAFD,C;;AAUC,IAAA,SAAS,CAAC,EAAV,CACE,OADF,EAEE,iDAFF,EAGE,YAAA;AACE,MAAA,CAAC,CAAC,IAAD,CAAD,CACG,OADH,CACW,iBADX,EAEG,QAFH,CAEY,yBAFZ,EAGG,IAHH,CAGQ,uBAHR,EAGiC,CAHjC,EAIG,KAJH;AAKD,KATH,EAVD,C;;AAuBC,IAAA,SAAS,CAAC,EAAV,CACE,OADF,EAEE,gDAFF,EAGE,YAAA;AACE,MAAA,CAAC,CAAC,IAAD,CAAD,CACG,OADH,CACW,iBADX,EAEG,WAFH,CAEe,yBAFf,EAGG,IAHH,CAGQ,uBAHR,EAIG,GAJH,CAIO,EAJP;AAKD,KATH;;;;;AAeA,IAAA,IAAI,CAAC,QAAL,CAAc,iBAAd,EAAiC,YAAA;AAC/B,MAAA,CAAC,CAAC,IAAD,CAAD,CAAQ,IAAR,CAAa,uBAAb,EAAsC,OAAtC,CAA8C,OAA9C,EAAuD;AACrD,QAAA,cAAc,EAAE;AADqC,OAAvD;AAGD,KAJD;AAKD,GA3CA,CAAD;;AA6CA,EAAA,IAAI,CAAC,gBAAL,GAAwB,UACtB,QADsB,EACoC;AAE1DA,QAAM,SAAS,GAAG,WAAW,CAAC,QAAD,CAAX,GAAwB,CAAC,CAAC,iBAAD,CAAzB,GAA+C,CAAC,CAAC,QAAD,CAAlEA;AAEA,IAAA,SAAS,CAAC,IAAV,CAAc,UAAE,CAAF,EAAK,OAAL,EAAY;AACxB,MAAA,CAAC,CAAC,OAAD,CAAD,CAAW,IAAX,CAAgB,uBAAhB,EAAyC,OAAzC,CAAiD,OAAjD,EAA0D;AACxD,QAAA,MAAM,EAAE;AADgD,OAA1D;AAGD,KAJD;AAKD,GAVD;AClKA;;;;;;AAIA,WAAS,gBAAT,CAA0B,OAA1B,EAAqC;AACnCA,QAAM,IAAI,GAAG,OAAO,CAAC,IAAR,EAAbA;AAEAA,QAAM,MAAM,GAAG,IAAI,CAAC,cAApBA;AACAA,QAAM,KAAK,GAAG,IAAI,CAAC,aAAnBA;AACAA,QAAM,MAAM,GAAG,IAAI,CAAC,cAApBA;AACAA,QAAM,MAAM,GAAG,IAAI,CAAC,cAApBA;AACAA,QAAM,GAAG,GAAG,IAAI,CAAC,WAAjBA;AACAA,QAAM,GAAG,GAAG,IAAI,CAAC,WAAjBA;AACAA,QAAM,UAAU,GAAG,IAAI,CAAC,gBAAxBA;AACAA,QAAM,UAAU,GAAG,IAAI,CAAC,gBAAxBA;AACAA,QAAM,UAAU,GAAG,IAAI,CAAC,kBAAxBA;AACAA,QAAM,KAAK,GAAG,MAAM,CAAC,GAAP,EAAdA;AACAA,QAAM,OAAO,GAAI,CAAC,KAAK,GAAG,GAAT,KAAiB,GAAG,GAAG,GAAvB,CAAD,GAAgC,GAAhDA;AAEA,IAAA,KAAK,CAAC,KAAN,CAAe,OAAO,GAAA,GAAtB;AACA,IAAA,MAAM,CAAC,KAAP,CAAgB,MAAM,OAAV,GAAU,GAAtB;;AAEA,QAAI,UAAJ,EAAgB;AACd,MAAA,KAAK,CAAC,GAAN,CAAU,eAAV,EAA2B,KAA3B;AACA,MAAA,MAAM,CAAC,GAAP,CAAW,cAAX,EAA2B,KAA3B;AACD;;AAED,IAAA,MAAM,CAAC,GAAP,CAAW,MAAX,EAAsB,OAAO,GAAA,GAA7B;;AAEA,QAAI,UAAJ,EAAgB;AACd,MAAA,UAAU,CAAC,IAAX,CAAgB,KAAhB;AACD;;AAED,IAAA,OAAO,KAAK,CAAZ,GACI,OAAO,CAAC,QAAR,CAAiB,kBAAjB,CADJ,GAEI,OAAO,CAAC,WAAR,CAAoB,kBAApB,CAFJ;AAGD;AAED;;;;;;AAIA,WAAS,MAAT,CAAgB,OAAhB,EAA2B;AACzBA,QAAM,MAAM,GAAG,CAAC,CAAC,uCAAD,CAAhBA;AACAA,QAAM,KAAK,GAAG,CAAC,CAAC,sCAAD,CAAfA;AACAA,QAAM,MAAM,GAAG,CAAC,CAAC,uCAAD,CAAhBA;AACAA,QAAM,MAAM,GAAG,OAAO,CAAC,IAAR,CAAa,qBAAb,CAAfA;AACAA,QAAM,UAAU,GAAG,MAAM,CAAC,CAAD,CAAN,CAAU,QAA7BA;AACAA,QAAM,UAAU,GAAG,OAAO,CAAC,QAAR,CAAiB,sBAAjB,CAAnBA,CANyB,C;;AASzB,IAAA,UAAU,GACN,OAAO,CAAC,QAAR,CAAiB,sBAAjB,CADM,GAEN,OAAO,CAAC,WAAR,CAAoB,sBAApB,CAFJ,CATyB,C;;AAczB,IAAA,OAAO,CAAC,IAAR,CAAa,oBAAb,EAAmC,MAAnC;AACA,IAAA,OAAO,CAAC,IAAR,CAAa,mBAAb,EAAkC,MAAlC;AACA,IAAA,OAAO,CAAC,IAAR,CAAa,oBAAb,EAAmC,MAAnC;AACA,IAAA,OAAO,CAAC,MAAR,CAAe,MAAf,EAAuB,MAAvB,CAA8B,KAA9B,EAAqC,MAArC,CAA4C,MAA5C,EAjByB,C;;AAoBzBC,QAAI,UAAU,GAAG,CAAC,EAAlBA;;AACA,QAAI,UAAJ,EAAgB;AACd,MAAA,UAAU,GAAG,CAAC,CAAC,eAAD,CAAd;AACA,MAAA,MAAM,CAAC,KAAP,GAAe,MAAf,CAAsB,UAAtB;AACD;;AAED,IAAA,OAAO,CAAC,IAAR,CAAa,gBAAb,EAA+B,MAA/B;AACA,IAAA,OAAO,CAAC,IAAR,CAAa,eAAb,EAA8B,KAA9B;AACA,IAAA,OAAO,CAAC,IAAR,CAAa,gBAAb,EAA+B,MAA/B;AACA,IAAA,OAAO,CAAC,IAAR,CAAa,gBAAb,EAA+B,MAA/B;AACA,IAAA,OAAO,CAAC,IAAR,CAAa,aAAb,EAA4B,MAAM,CAAC,IAAP,CAAY,KAAZ,CAA5B;AACA,IAAA,OAAO,CAAC,IAAR,CAAa,aAAb,EAA4B,MAAM,CAAC,IAAP,CAAY,KAAZ,CAA5B;AACA,IAAA,OAAO,CAAC,IAAR,CAAa,kBAAb,EAAiC,UAAjC;AACA,IAAA,OAAO,CAAC,IAAR,CAAa,kBAAb,EAAiC,UAAjC;AACA,IAAA,OAAO,CAAC,IAAR,CAAa,oBAAb,EAAmC,UAAnC,EAlCyB,C;;AAqCzB,IAAA,gBAAgB,CAAC,OAAD,CAAhB;AACD;;AAEDD,MAAM,aAAa,GAAG,kCAAtBA;AAEA,EAAA,CAAC,CAAA,YAAA;;AAEC,IAAA,SAAS,CAAC,EAAV,CAAa,cAAb,EAA6B,aAA7B,EAA4C,YAAA;AAC1CA,UAAM,OAAO,GAAG,CAAC,CAAC,IAAD,CAAD,CAAQ,MAAR,EAAhBA;AAEA,MAAA,gBAAgB,CAAC,OAAD,CAAhB;AACD,KAJD,EAFD,C;;AASC,IAAA,SAAS,CAAC,EAAV,CAAa,UAAb,EAAyB,aAAzB,EAAwC,UAAU,KAAV,EAAsB;AAC5D,UAAI,CAAC,OAAO,CAAC,KAAD,CAAZ,EAAqB;AACnB;AACD;;AAED,MAAA,QAAQ,CAAC,KAAD,CAAR;;AAEA,UAAK,KAA0B,QAA/B,EAAyC;AACvC;AACD;;AAEDA,UAAM,OAAO,GAAG,CAAC,CAAC,IAAD,CAAD,CAAQ,MAAR,EAAhBA;AAEA,MAAA,OAAO,CAAC,QAAR,CAAiB,mBAAjB;AACD,KAdD,EATD,C;;AA0BC,IAAA,SAAS,CAAC,EAAV,CAAa,QAAb,EAAuB,aAAvB,EAAsC,UAAU,KAAV,EAAsB;AAC1D,UAAI,CAAC,OAAO,CAAC,KAAD,CAAZ,EAAqB;AACnB;AACD;;AAED,UAAK,KAA0B,QAA/B,EAAyC;AACvC;AACD;;AAEDA,UAAM,OAAO,GAAG,CAAC,CAAC,IAAD,CAAD,CAAQ,MAAR,EAAhBA;AAEA,MAAA,OAAO,CAAC,WAAR,CAAoB,mBAApB;AACD,KAZD;AAcA,IAAA,SAAS,CAAC,EAAV,CAAa,WAAb,EAA0B,aAA1B,EAAyC,QAAzC;;;;;AAKA,IAAA,IAAI,CAAC,QAAL,CAAc,cAAd,EAA8B,YAAA;AAC5B,MAAA,MAAM,CAAC,CAAC,CAAC,IAAD,CAAF,CAAN;AACD,KAFD;AAGD,GAhDA,CAAD;;AAkDA,EAAA,IAAI,CAAC,aAAL,GAAqB,UACnB,QADmB,EACuC;AAE1DA,QAAM,SAAS,GAAG,WAAW,CAAC,QAAD,CAAX,GAAwB,CAAC,CAAC,cAAD,CAAzB,GAA4C,CAAC,CAAC,QAAD,CAA/DA;AAEA,IAAA,SAAS,CAAC,IAAV,CAAc,UAAE,CAAF,EAAK,OAAL,EAAY;AACxB,MAAA,MAAM,CAAC,CAAC,CAAC,OAAD,CAAF,CAAN;AACD,KAFD;AAGD,GARD;;AC7HAA,MAAMM,iBAAe,GAAY;AAC/B,IAAA,OAAO,EAAE;AADsB,GAAjCN;;AAIA,MAAM,GAAG,GA+BP,SAAA,GAAA,CACE,QADF,EAEE,OAFF,EAEuB;;sCAAF,E;;;;;AAxBd,SAAA,OAAA,GAAmB,MAAM,CAAC,EAAD,EAAKM,iBAAL,CAAzB;;;;;AAKC,SAAA,KAAA,GAAe,QAAf;AAqBN,SAAK,QAAL,GAAgB,CAAC,CAAC,QAAD,CAAD,CAAY,KAAZ,EAAhB;AAEA,IAAA,MAAM,CAAC,KAAK,OAAN,EAAe,OAAf,CAAN;AAEA,SAAK,IAAL,GAAY,KAAK,QAAL,CAAc,IAAd,CAAmB,WAAnB,CAAZ;AACA,SAAK,KAAL,GAAa,KAAK,QAAL,CAAc,IAAd,CAAmB,gBAAnB,CAAb;AACA,SAAK,SAAL,GAAiB,KAAK,KAAL,CAAW,IAAX,CAAgB,WAAhB,CAAjB;;AAEA,QAAI,KAAK,OAAL,CAAa,OAAb,KAAyB,OAA7B,EAAsC;AACpC,WAAK,IAAL,CAAU,EAAV,CAAa,uBAAb,EAAoC,YAAA;AAAA,eAAQH,MAAI,CAAC,IAALA,EAAR;AAAmB,OAAvD;AACA,WAAK,QAAL,CAAc,EAAd,CAAiB,YAAjB,EAA6B,YAAA;AAAA,eAAQA,MAAI,CAAC,KAALA,EAAR;AAAoB,OAAjD;AACD;;AAED,QAAI,KAAK,OAAL,CAAa,OAAb,KAAyB,OAA7B,EAAsC;AACpC,WAAK,IAAL,CAAU,EAAV,CAAa,UAAb,EAAuB,YAAA;AAAA,eAAQA,MAAI,CAAC,IAALA,EAAR;AAAmB,OAA1C;AACD,KAjBoB,C;;;AAoBrB,IAAA,SAAS,CAAC,EAAV,CAAa,UAAb,EAAuB,UAAG,KAAH,EAAQ;AAC7B,UAAI,CAAC,CAAC,KAAK,CAAC,MAAP,CAAD,CAA+B,OAA/B,CAAuC,mBAAvC,EAA4D,MAAhE,EAAwE;AACtE;AACD;;AAEDA,MAAAA,MAAI,CAAC,KAALA;AACD,KAND;AAOF,GA5DF;AA8DE;;;;;;gBAIQ,Y,GAAA,SAAA,YAAA,CAAa,IAAb,EAAwB;AAC9B,IAAA,cAAc,CAAC,IAAD,EAAO,KAAP,EAAc,KAAK,QAAnB,EAA6B,IAA7B,CAAd;AACF,G;AAEA;;;;;gBAGQ,M,GAAA,SAAA,MAAA,GAAA;AACN,WAAO,KAAK,KAAL,KAAe,SAAf,IAA4B,KAAK,KAAL,KAAe,QAAlD;AACF,G;AAEA;;;;;gBAGO,I,GAAA,SAAA,IAAA,GAAA;;;AACL,QAAI,KAAK,MAAL,EAAJ,EAAmB;AACjB;AACD,KAHI,C;;;AAML,SAAK,SAAL,CAAe,IAAf,CAAmB,UAAE,KAAF,EAAS,GAAT,EAAY;AAC7BH,UAAM,KAAK,GAAM,MAAMG,MAAI,CAAC,SAALA,CAAe,MAAfA,GAAwB,KAA9B,CAAN,GAAyC,IAApDH;AAEA,MAAA,GAAG,CAAC,KAAJ,CAAU,eAAV,GAA4B,KAA5B;AACA,MAAA,GAAG,CAAC,KAAJ,CAAU,qBAAV,GAAkC,KAAlC;AACD,KALD;AAOA,SAAK,KAAL,CAAW,GAAX,CAAe,QAAf,EAAyB,MAAzB,EAAiC,QAAjC,CAA0C,oBAA1C,EAbK,C;;AAgBL,QAAI,KAAK,IAAL,CAAU,IAAV,CAAe,kBAAf,EAAmC,MAAvC,EAA+C;AAC7C,WAAK,IAAL,CAAU,QAAV,CAAmB,iBAAnB;AACD;;AAED,SAAK,KAAL,GAAa,SAAb;AACA,SAAK,YAAL,CAAkB,MAAlB,EArBK,C;;AAwBL,SAAK,SAAL,CAAe,KAAf,GAAuB,aAAvB,CAAoC,YAAA;AAClC,UAAIG,MAAI,CAAC,IAALA,CAAU,QAAVA,CAAmB,iBAAnBA,CAAJ,EAA2C;AACzCA,QAAAA,MAAI,CAAC,KAALA,GAAa,QAAbA;AACAA,QAAAA,MAAI,CAAC,YAALA,CAAkB,QAAlBA;AACD;AACF,KALD;AAMF,G;AAEA;;;;;gBAGO,K,GAAA,SAAA,KAAA,GAAA;;;AACL,QAAI,CAAC,KAAK,MAAL,EAAL,EAAoB;AAClB;AACD,KAHI,C;;;AAML,SAAK,SAAL,CAAe,IAAf,CAAmB,UAAE,KAAF,EAAS,GAAT,EAAY;AAC7BH,UAAM,KAAK,GAAM,KAAK,KAAX,GAAW,IAAtBA;AAEA,MAAA,GAAG,CAAC,KAAJ,CAAU,eAAV,GAA4B,KAA5B;AACA,MAAA,GAAG,CAAC,KAAJ,CAAU,qBAAV,GAAkC,KAAlC;AACD,KALD;AAOA,SAAK,KAAL,CAAW,WAAX,CAAuB,oBAAvB;AACA,SAAK,IAAL,CAAU,WAAV,CAAsB,iBAAtB;AACA,SAAK,KAAL,GAAa,SAAb;AACA,SAAK,YAAL,CAAkB,OAAlB,EAhBK,C;;AAmBL,SAAK,SAAL,CAAe,IAAf,GAAsB,aAAtB,CAAmC,YAAA;AACjC,UAAIG,MAAI,CAAC,IAALA,CAAU,QAAVA,CAAmB,iBAAnBA,CAAJ,EAA2C;AACzC;AACD;;AAEDA,MAAAA,MAAI,CAAC,KAALA,GAAa,QAAbA;AACAA,MAAAA,MAAI,CAAC,YAALA,CAAkB,QAAlBA;AACAA,MAAAA,MAAI,CAAC,KAALA,CAAW,GAAXA,CAAe,QAAfA,EAAyB,CAAzBA;AACD,KARD;AASF,G;AAEA;;;;;gBAGO,M,GAAA,SAAA,MAAA,GAAA;AACL,SAAK,MAAL,KAAgB,KAAK,KAAL,EAAhB,GAA+B,KAAK,IAAL,EAA/B;AACF,G;AAEA;;;;;gBAGO,I,GAAA,SAAA,IAAA,GAAA;AACL,SAAK,QAAL,CAAc,WAAd,CAA0B,eAA1B;AACF,G;AAEA;;;;;gBAGO,I,GAAA,SAAA,IAAA,GAAA;AACL,SAAK,QAAL,CAAc,QAAd,CAAuB,eAAvB;AACF,G;AAEA;;;;;gBAGO,Q,GAAA,SAAA,QAAA,GAAA;AACL,WAAO,KAAK,KAAZ;AACF,G;;AAGF,EAAA,IAAI,CAAC,GAAL,GAAW,GAAX;ACjOAH,MAAMO,YAAU,GAAG,UAAnBP;AAEA,EAAA,CAAC,CAAA,YAAA;;;AAIC,IAAA,SAAS,CAAC,EAAV,CACE,gCADF,EACkC,MAC5BO,YAD4B,GAClB,GAFhB,EAGE,YAAA;AACE,UAAI,IAAI,CAAC,GAAT,CACE,IADF,EAEE,YAAY,CAAC,IAAD,EAAsBA,YAAtB,CAFd;AAID,KARH;AAUD,GAdA,CAAD;ACRA;;;;;;;;;;;;;;;;;AAuFAP,MAAMM,iBAAe,GAAY;AAC/B,IAAA,QAAQ,EAAE,MADqB;AAE/B,IAAA,MAAM,EAAE;AAFuB,GAAjCN;;AAKA,MAAM,MAAM,GA6DV,SAAA,MAAA,CACE,QADF,EAEE,OAFF,EAEuB;;sCAAF,E;;;;;AAtDd,SAAA,QAAA,GAAe,CAAC,EAAhB;;;;;AAKA,SAAA,OAAA,GAAmB,MAAM,CAAC,EAAD,EAAKM,iBAAL,CAAzB;;;;;AAKC,SAAA,IAAA,GAAO,CAAP;;;;;AAKA,SAAA,SAAA,GAAgB,CAAC,EAAjB;;;;;AAKA,SAAA,KAAA,GAAY,CAAC,EAAb;;;;;AAKA,SAAA,MAAA,GAAa,CAAC,EAAd;;;;;AAKA,SAAA,aAAA,GAAgB,CAAhB;;;;;AAKA,SAAA,YAAA,GAAe,EAAf;;;;;AAKA,SAAA,aAAA,GAAgB,EAAhB;;;;;AAUA,SAAA,KAAA,GAAe,QAAf;AAMN,SAAK,OAAL,GAAe,CAAC,CAAC,QAAD,CAAD,CAAY,KAAZ,EAAf;AACA,SAAK,OAAL,CAAa,IAAb;AAEA,IAAA,MAAM,CAAC,KAAK,OAAN,EAAe,OAAf,CAAN,CALqB,C;;AAQrB,SAAK,QAAL,GAAgB,CAAC,CAAC,IAAF,EAAhB,CARqB,C;;AAWrB,SAAK,YAAL,GAXqB,C;;AAcrB,IAAA,SAAS,CAAC,EAAV,CAAa,kBAAb,EAA+B,UAAG,KAAH,EAAe;AAC5CN,UAAM,OAAO,GAAG,CAAC,CAAC,KAAK,CAAC,MAAP,CAAjBA;;AAEA,UACEG,MAAI,CAAC,MAALA,MACA,CAAC,OAAO,CAAC,EAAR,CAAWA,MAAI,CAAC,QAAhB,CADDA,IAEA,CAAC,QAAQ,CAACA,MAAI,CAAC,QAALA,CAAc,CAAdA,CAAD,EAAmB,OAAO,CAAC,CAAD,CAA1B,CAHX,EAIE;AACAA,QAAAA,MAAI,CAAC,KAALA;AACD;AACF,KAVD;AAWF,GAxFF;AA0FE;;;;;mBAGQ,Y,GAAA,SAAA,YAAA,GAAA;AACNH,QAAM,YAAY,GAAG,OAAO,CAAC,MAAR,EAArBA,CADM,C;;AAINA,QAAM,aAAa,GAAG,KAAK,QAAL,CAAc,MAAd,EAAtBA,CAJM,C;;AAONA,QAAM,UAAU,GAAG,KAAK,MAAL,CAAY,KAAZ,EAAnBA;AACAA,QAAM,UAAU,GAAG,UAAU,CAAC,MAAX,EAAnBA;AACAA,QAAM,UAAU,GAAG,QAAQ,CAAC,UAAU,CAAC,GAAX,CAAe,YAAf,CAAD,CAA3BA,CATM,C;;AAYNA,QAAM,SAAS,GAAG,KAAK,QAAL,CAAc,UAAd,KAA6B,IAA/CA,CAZM,CAY8C;;AACpDC,QAAI,UAAU,GAAG,UAAU,GAAG,KAAK,IAAlB,GAAyB,UAAU,GAAG,CAAvDA,CAbM,C;;AAgBND,QAAM,UAAU,GAAG,KAAK,QAAL,CAAc,CAAd,EAAiB,qBAAjB,GAAyC,GAA5DA;AAEAC,QAAI,gBAAJA;AACAA,QAAI,aAAJA;;AAEA,QAAI,KAAK,OAAL,CAAa,QAAb,KAA0B,QAA9B,EAAwC;AACtC,MAAA,aAAa,GAAG,aAAhB;AACA,MAAA,gBAAgB,GAAG,KAAnB;AACD,KAHD,MAGO,IAAI,KAAK,OAAL,CAAa,QAAb,KAA0B,KAA9B,EAAqC;AAC1C,MAAA,aAAa,GAAG,CAAC,UAAD,GAAc,CAA9B;AACA,MAAA,gBAAgB,GAAG,MAAnB;AACD,KAHM,MAGA;;AAELD,UAAM,aAAa,GAAG,YAAY,GAAG,KAAK,OAAL,CAAa,MAAb,GAAuB,CAA5DA;;AACA,UAAI,UAAU,GAAG,aAAjB,EAAgC;AAC9B,QAAA,UAAU,GAAG,aAAb;AACD,OALI,C;;;AAQL,MAAA,aAAa,GAAG,EACd,UAAU,GACV,KAAK,aAAL,GAAqB,UADrB,GAEA,CAAC,UAAU,GAAG,aAAd,IAA+B,CAHjB,CAAhB;AAMAA,UAAM,gBAAgB,GAAG,EACvB,UAAU,GACV,CAAC,KAAK,IAAL,GAAY,CAAb,IAAkB,UADlB,GAEA,CAAC,UAAU,GAAG,aAAd,IAA+B,CAHR,CAAzBA;;AAKA,UAAI,aAAa,GAAG,gBAApB,EAAsC;AACpC,QAAA,aAAa,GAAG,gBAAhB;AACD,OArBI,C;;;AAwBLA,UAAM,OAAO,GAAG,UAAU,GAAG,aAA7BA;;AACA,UAAI,OAAO,GAAG,KAAK,OAAL,CAAa,MAA3B,EAAoC;;AAElC,QAAA,aAAa,GAAG,EAAE,UAAU,GAAG,KAAK,OAAL,CAAa,MAA5B,CAAhB;AACD,OAHD,MAGO,IAAI,OAAO,GAAG,UAAV,GAAuB,KAAK,OAAL,CAAa,MAApC,GAA8C,YAAlD,EAAgE;;AAErE,QAAA,aAAa,GAAG,EACd,UAAU,GACV,UADA,GAEA,KAAK,OAAL,CAAa,MAFb,GAGA,YAJc,CAAhB;AAMD,OApCI,C;;;AAuCL,MAAA,gBAAgB,GACd,KAAK,aAAL,GAAqB,UAArB,GAAkC,UAAU,GAAG,CAA/C,GAAmD,UADrC,GACqC,IADrD;AAGD,KArEK,C;;;AAwEN,SAAK,QAAL,CAAc,UAAd,CAAyB,SAAzB;AACA,SAAK,KAAL,CACG,UADH,CACc,SADd,EAEG,MAFH,CAEU,UAFV,EAGG,GAHH,CAGO;AACH,oBAAc,aAAa,GAAG,IAD3B;AAEH,0BAAoB,YAAY,gBAAZ,GAA+B;AAFhD,KAHP;AAOF,G;AAEA;;;;;mBAGQ,M,GAAA,SAAA,MAAA,GAAA;AACN,WAAO,KAAK,KAAL,KAAe,SAAf,IAA4B,KAAK,KAAL,KAAe,QAAlD;AACF,G;AAEA;;;;;mBAGO,Y,GAAA,SAAA,YAAA,GAAA;;;AACL,QAAI,KAAK,MAAL,EAAJ,EAAmB;AACjB,WAAK,KAAL;AACD;;AAED,SAAK,aAAL,GAAqB,KAAK,OAAL,CAAa,GAAb,EAArB;AAUAA,QAAM,SAAS,GAAoB,EAAnCA;AACA,SAAK,MAAL,GAAc,CAAC,EAAf,CAhBK,C;;AAmBL,SAAK,OAAL,CAAa,IAAb,CAAkB,QAAlB,EAA4B,IAA5B,CAAgC,UAAE,KAAF,EAAS,MAAT,EAAe;AAC7CA,UAAM,IAAI,GAAG,MAAM,CAAC,WAAP,IAAsB,EAAnCA;AACAA,UAAM,KAAK,GAAG,MAAM,CAAC,KAArBA;AACAA,UAAM,QAAQ,GAAG,MAAM,CAAC,QAAxBA;AACAA,UAAM,QAAQ,GAAGG,MAAI,CAAC,aAALA,KAAuB,KAAxCH;AAEA,MAAA,SAAS,CAAC,IAAV,CAAe;eACb,KADa;cAEb,IAFa;kBAGb,QAHa;kBAIb,QAJa;eAKb;AALa,OAAf;;AAQA,UAAI,QAAJ,EAAc;AACZG,QAAAA,MAAI,CAAC,YAALA,GAAoB,IAApBA;AACAA,QAAAA,MAAI,CAAC,aAALA,GAAqB,KAArBA;AACD;;AAEDA,MAAAA,MAAI,CAAC,MAALA,GAAcA,MAAI,CAAC,MAALA,CAAY,GAAZA,CACZ,oDACG,QAAQ,GAAG,WAAH,GAAiB,EAD5B,KAEG,QAAQ,GAAG,WAAH,GAAiB,EAF5B,IAGE,GAHF,GAGM,IAHN,GAGU,QAJEA,CAAdA;AAMD,KAzBD;AA2BA,SAAK,SAAL,GAAiB,CAAC,CAAA,0CACsB,KAAK,YAD3B,GACuC,SADvC,CAAlB;AAIA,SAAK,QAAL,GAAgB,CAAC,CACf,mDAAgD,KAAK,OAAL,CAAa,QAA7D,GAAqE,KAArE,GACE,UADF,GACY,KAAK,OAAL,CAAa,IAAb,CAAkB,OAAlB,CADZ,GACsC,KADtC,GAEE,OAFF,GAES,KAAK,QAFd,GAEsB,WAHP,CAAD,CAKb,IALa,GAMb,MANa,CAMN,KAAK,SANC,CAAhB;AAQA,SAAK,KAAL,GAAa,CAAC,CAAC,sCAAD,CAAD,CACV,QADU,CACD,KAAK,QADJ,EAEV,MAFU,CAEH,KAAK,MAFF,CAAb;AAIA,IAAA,CAAC,CAAA,MAAK,KAAK,QAAV,CAAD,CAAuB,MAAvB;AACA,SAAK,OAAL,CAAa,KAAb,CAAmB,KAAK,QAAxB,EA/DK,C;;AAkEL,SAAK,IAAL,GAAY,QAAQ,CAAC,KAAK,OAAL,CAAa,IAAb,CAAkB,MAAlB,KAA6B,GAA9B,CAApB;;AAEA,QAAI,KAAK,IAAL,IAAa,CAAjB,EAAoB;AAClB,WAAK,IAAL,GAAY,KAAK,MAAL,CAAY,MAAxB;;AAEA,UAAI,KAAK,IAAL,GAAY,CAAhB,EAAmB;AACjB,aAAK,IAAL,GAAY,CAAZ;AACD;AACF,KA1EI,C;;;;AA8ELH,QAAM,IAAI,GAAG,IAAbA;AACA,SAAK,MAAL,CAAY,EAAZ,CAAe,OAAf,EAAwB,YAAA;AACtB,UAAI,IAAI,CAAC,KAAL,KAAe,SAAnB,EAA8B;AAC5B;AACD;;AAEDA,UAAM,KAAK,GAAG,CAAC,CAAC,IAAD,CAAfA;AACAA,UAAM,KAAK,GAAG,KAAK,CAAC,KAAN,EAAdA;AACAA,UAAM,IAAI,GAAG,SAAS,CAAC,KAAD,CAAtBA;;AAEA,UAAI,IAAI,CAAC,QAAT,EAAmB;AACjB;AACD;;AAED,MAAA,IAAI,CAAC,SAAL,CAAe,IAAf,CAAoB,IAAI,CAAC,IAAzB;AACA,MAAA,IAAI,CAAC,OAAL,CAAa,GAAb,CAAiB,IAAI,CAAC,KAAtB;AACA,MAAA,IAAI,CAAC,MAAL,CAAY,UAAZ,CAAuB,UAAvB;AACA,MAAA,KAAK,CAAC,IAAN,CAAW,UAAX,EAAuB,EAAvB;AACA,MAAA,IAAI,CAAC,aAAL,GAAqB,IAAI,CAAC,KAA1B;AACA,MAAA,IAAI,CAAC,aAAL,GAAqB,IAAI,CAAC,KAA1B;AACA,MAAA,IAAI,CAAC,YAAL,GAAoB,IAAI,CAAC,IAAzB;AACA,MAAA,IAAI,CAAC,OAAL,CAAa,OAAb,CAAqB,QAArB;AACA,MAAA,IAAI,CAAC,KAAL;AACD,KAtBD,EA/EK,C;;AAwGL,SAAK,QAAL,CAAc,EAAd,CAAiB,OAAjB,EAAwB,UAAG,KAAH,EAAe;AACrCA,UAAM,OAAO,GAAG,CAAC,CAAC,KAAK,CAAC,MAAP,CAAjBA,CADqC,C;;AAIrC,UACE,OAAO,CAAC,EAAR,CAAW,mBAAX,KACA,OAAO,CAAC,EAAR,CAAW,wBAAX,CAFF,EAGE;AACA;AACD;;AAEDG,MAAAA,MAAI,CAAC,MAALA;AACD,KAZD;AAaF,G;AAEA;;;;;mBAGQ,a,GAAA,SAAA,aAAA,GAAA;AACN,SAAK,QAAL,CAAc,WAAd,CAA0B,qBAA1B;;AAEA,QAAI,KAAK,KAAL,KAAe,SAAnB,EAA8B;AAC5B,WAAK,KAAL,GAAa,QAAb;AACA,WAAK,YAAL,CAAkB,QAAlB;AACA,WAAK,KAAL,CAAW,GAAX,CAAe,YAAf,EAA6B,MAA7B;AACD;;AAED,QAAI,KAAK,KAAL,KAAe,SAAnB,EAA8B;AAC5B,WAAK,KAAL,GAAa,QAAb;AACA,WAAK,YAAL,CAAkB,QAAlB,EAF4B,C;;AAK5B,WAAK,QAAL,CAAc,UAAd,CAAyB,EAAzB;AACA,WAAK,KAAL,CAAW,GAAX,CAAe;AACb,sBAAc,EADD;AAEb,QAAA,MAAM,EAAE,EAFK;AAGb,QAAA,KAAK,EAAE;AAHM,OAAf;AAKD;AACH,G;AAEA;;;;;;mBAIQ,Y,GAAA,SAAA,YAAA,CAAa,IAAb,EAAwB;AAC9B,IAAA,cAAc,CAAC,IAAD,EAAO,QAAP,EAAiB,KAAK,OAAtB,EAA+B,IAA/B,CAAd;AACF,G;AAEA;;;;;mBAGO,M,GAAA,SAAA,MAAA,GAAA;AACL,SAAK,MAAL,KAAgB,KAAK,KAAL,EAAhB,GAA+B,KAAK,IAAL,EAA/B;AACF,G;AAEA;;;;;mBAGO,I,GAAA,SAAA,IAAA,GAAA;;;AACL,QAAI,KAAK,MAAL,EAAJ,EAAmB;AACjB;AACD;;AAED,SAAK,KAAL,GAAa,SAAb;AACA,SAAK,YAAL,CAAkB,MAAlB;AACA,SAAK,YAAL;AACA,SAAK,QAAL,CAAc,QAAd,CAAuB,kBAAvB;AACA,SAAK,KAAL,CAAW,aAAX,CAAwB,YAAA;AAAA,aAAOA,MAAI,CAAC,aAALA,EAAP;AAA2B,KAAnD;AACF,G;AAEA;;;;;mBAGO,K,GAAA,SAAA,KAAA,GAAA;;;AACL,QAAI,CAAC,KAAK,MAAL,EAAL,EAAoB;AAClB;AACD;;AAED,SAAK,KAAL,GAAa,SAAb;AACA,SAAK,YAAL,CAAkB,OAAlB;AACA,SAAK,KAAL,CAAW,GAAX,CAAe,YAAf,EAA6B,EAA7B;AACA,SAAK,QAAL,CACG,WADH,CACe,kBADf,EAEG,QAFH,CAEY,qBAFZ;AAGA,SAAK,KAAL,CAAW,aAAX,CAAwB,YAAA;AAAA,aAAOA,MAAI,CAAC,aAALA,EAAP;AAA2B,KAAnD;AACF,G;AAEA;;;;;mBAGO,Q,GAAA,SAAA,QAAA,GAAA;AACL,WAAO,KAAK,KAAZ;AACF,G;;AAGF,EAAA,IAAI,CAAC,MAAL,GAAc,MAAd;ACvdAH,MAAMO,YAAU,GAAG,aAAnBP;AAEA,EAAA,CAAC,CAAA,YAAA;AACC,IAAA,IAAI,CAAC,QAAL,CAAa,MAAKO,YAAL,GAAe,GAA5B,EAAiC,YAAA;AAC/B,UAAI,IAAI,CAAC,MAAT,CAAgB,IAAhB,EAAsB,YAAY,CAAC,IAAD,EAAOA,YAAP,CAAlC;AACD,KAFD;AAGD,GAJA,CAAD;ACHA,EAAA,CAAC,CAAA,YAAA;;AAEC,IAAA,IAAI,CAAC,QAAL,CAAc,0BAAd,EAA0C,YAAA;AACxC,UAAI,IAAI,CAAC,QAAT,CAAkB,IAAlB;AACD,KAFD,EAFD,C;;AAOC,IAAA,IAAI,CAAC,QAAL,CAAc,kCAAd,EAAkD,YAAA;AAChD,UAAI,IAAI,CAAC,QAAT,CAAkB,IAAlB,EAAwB;AACtB,QAAA,WAAW,EAAE,8BADS;AAEtB,QAAA,aAAa,EAAE;AAFO,OAAxB;AAID,KALD;AAMD,GAbA,CAAD;ACyDAP,MAAMM,iBAAe,GAAY;AAC/B,IAAA,OAAO,EAAE,OADsB;AAE/B,IAAA,IAAI,EAAE;AAFyB,GAAjCN;;AAKA,MAAM,GAAG,GA0BP,SAAA,GAAA,CACE,QADF,EAEE,OAFF,EAEuB;;sCAAF,E;;;;;AAnBd,SAAA,OAAA,GAAmB,MAAM,CAAC,EAAD,EAAKM,iBAAL,CAAzB;;;;;AAKA,SAAA,WAAA,GAAc,CAAC,CAAf;AAgBL,SAAK,QAAL,GAAgB,CAAC,CAAC,QAAD,CAAD,CAAY,KAAZ,EAAhB;AAEA,IAAA,MAAM,CAAC,KAAK,OAAN,EAAe,OAAf,CAAN;AAEA,SAAK,KAAL,GAAa,KAAK,QAAL,CAAc,QAAd,CAAuB,GAAvB,CAAb;AACA,SAAK,UAAL,GAAkB,CAAC,CAAC,wCAAD,CAAD,CAA4C,QAA5C,CAChB,KAAK,QADW,CAAlB,CAPqB,C;;AAYrBN,QAAM,IAAI,GAAG,MAAM,CAAC,QAAP,CAAgB,IAA7BA;;AACA,QAAI,IAAJ,EAAU;AACR,WAAK,KAAL,CAAW,IAAX,CAAe,UAAE,KAAF,EAAS,GAAT,EAAY;AACzB,YAAI,CAAC,CAAC,GAAD,CAAD,CAAO,IAAP,CAAY,MAAZ,MAAwB,IAA5B,EAAkC;AAChCG,UAAAA,MAAI,CAAC,WAALA,GAAmB,KAAnBA;AACA,iBAAO,KAAP;AACD;;AAED,eAAO,IAAP;AACD,OAPD;AAQD,KAtBoB,C;;;AAyBrB,QAAI,KAAK,WAAL,KAAqB,CAAC,CAA1B,EAA6B;AAC3B,WAAK,KAAL,CAAW,IAAX,CAAe,UAAE,KAAF,EAAS,GAAT,EAAY;AACzB,YAAI,CAAC,CAAC,GAAD,CAAD,CAAO,QAAP,CAAgB,iBAAhB,CAAJ,EAAwC;AACtCA,UAAAA,MAAI,CAAC,WAALA,GAAmB,KAAnBA;AACA,iBAAO,KAAP;AACD;;AAED,eAAO,IAAP;AACD,OAPD;AAQD,KAlCoB,C;;;AAqCrB,QAAI,KAAK,KAAL,CAAW,MAAX,IAAqB,KAAK,WAAL,KAAqB,CAAC,CAA/C,EAAkD;AAChD,WAAK,WAAL,GAAmB,CAAnB;AACD,KAvCoB,C;;;AA0CrB,SAAK,SAAL,GA1CqB,C;;AA6CrB,IAAA,OAAO,CAAC,EAAR,CACE,QADF,EAEE,CAAC,CAAC,QAAF,CAAU,YAAA;AAAA,aAAOA,MAAI,CAAC,oBAALA,EAAP;AAAkC,KAA5C,EAA8C,GAA9C,CAFF,EA7CqB,C;;AAmDrB,SAAK,KAAL,CAAW,IAAX,CAAe,UAAE,CAAF,EAAK,GAAL,EAAQ;AACrBA,MAAAA,MAAI,CAAC,YAALA,CAAkB,GAAlBA;AACD,KAFD;AAGF,GAlFF;AAoFE;;;;;;gBAIQ,U,GAAA,SAAA,UAAA,CAAW,IAAX,EAAmB;AACzB,WAAO,IAAI,CAAC,IAAL,CAAU,UAAV,MAA0B,SAAjC;AACF,G;AAEA;;;;;;gBAIQ,Y,GAAA,SAAA,YAAA,CAAa,GAAb,EAA6B;;AACnCH,QAAM,IAAI,GAAG,CAAC,CAAC,GAAD,CAAdA,CADmC,C;;AAInCA,QAAM,UAAU,GAAA,YAAA;;AAEd,UAAIG,MAAI,CAAC,UAALA,CAAgB,IAAhBA,CAAJ,EAA2B;AACzB,eAAO,KAAP;AACD;;AAEDA,MAAAA,MAAI,CAAC,WAALA,GAAmBA,MAAI,CAAC,KAALA,CAAW,KAAXA,CAAiB,GAAjBA,CAAnBA;AACAA,MAAAA,MAAI,CAAC,SAALA;AACD,KARDH,CAJmC,C;;;AAenC,IAAA,IAAI,CAAC,EAAL,CAAQ,OAAR,EAAiB,UAAjB,EAfmC,C;;AAkBnC,QAAI,KAAK,OAAL,CAAa,OAAb,KAAyB,OAA7B,EAAsC;AACpC,MAAA,IAAI,CAAC,EAAL,CAAQ,YAAR,EAAsB,UAAtB;AACD,KApBkC,C;;;AAuBnC,IAAA,IAAI,CAAC,EAAL,CAAQ,OAAR,EAAe,YAAA;AACb,UAAI,CAAC,IAAI,CAAC,IAAL,CAAU,MAAV,KAAqB,EAAtB,EAA0B,OAA1B,CAAkC,GAAlC,MAA2C,CAA/C,EAAkD;AAChD,eAAO,KAAP;AACD;AACF,KAJD;AAKF,G;AAEA;;;;;;;;gBAMQ,Y,GAAA,SAAA,YAAA,CAAa,IAAb,EAA0B,QAA1B,EAAwC,UAAxC,EAAuD;yCAAL,GAAG,E;AAC3D,IAAA,cAAc,CAAC,IAAD,EAAO,KAAP,EAAc,QAAd,EAAwB,IAAxB,EAA8B,UAA9B,CAAd;AACF,G;AAEA;;;;;gBAGQ,S,GAAA,SAAA,SAAA,GAAA;;AACN,SAAK,KAAL,CAAW,IAAX,CAAe,UAAE,KAAF,EAAS,GAAT,EAAY;AACzBA,UAAM,IAAI,GAAG,CAAC,CAAC,GAAD,CAAdA;AACAA,UAAM,QAAQ,GAAG,IAAI,CAAC,IAAL,CAAU,MAAV,KAAqB,EAAtCA,CAFyB,C;;AAKzB,UAAI,KAAK,KAAKG,MAAI,CAAC,WAAf,IAA8B,CAACA,MAAI,CAAC,UAALA,CAAgB,IAAhBA,CAAnC,EAA0D;AACxD,YAAI,CAAC,IAAI,CAAC,QAAL,CAAc,iBAAd,CAAL,EAAuC;AACrCA,UAAAA,MAAI,CAAC,YAALA,CAAkB,QAAlBA,EAA4BA,MAAI,CAAC,QAAjCA,EAA2C;AACzC,YAAA,KAAK,EAAEA,MAAI,CAAC,WAD6B;AAEzC,YAAA,EAAE,EAAE,QAAQ,CAAC,MAAT,CAAgB,CAAhB;AAFqC,WAA3CA;AAIAA,UAAAA,MAAI,CAAC,YAALA,CAAkB,MAAlBA,EAA0B,IAA1BA;AAEA,UAAA,IAAI,CAAC,QAAL,CAAc,iBAAd;AACD;;AAED,QAAA,CAAC,CAAC,QAAD,CAAD,CAAY,IAAZ;AACAA,QAAAA,MAAI,CAAC,oBAALA;AACD,OAbD,MAaO;AACL,QAAA,IAAI,CAAC,WAAL,CAAiB,iBAAjB;AACA,QAAA,CAAC,CAAC,QAAD,CAAD,CAAY,IAAZ;AACD;AACF,KAtBD;AAuBF,G;AAEA;;;;;gBAGQ,oB,GAAA,SAAA,oBAAA,GAAA;;AAEN,QAAI,KAAK,WAAL,KAAqB,CAAC,CAA1B,EAA6B;AAC3B,WAAK,UAAL,CAAgB,GAAhB,CAAoB;AAClB,QAAA,IAAI,EAAE,CADY;AAElB,QAAA,KAAK,EAAE;AAFW,OAApB;AAKA;AACD;;AAEDH,QAAM,UAAU,GAAG,KAAK,KAAL,CAAW,EAAX,CAAc,KAAK,WAAnB,CAAnBA;;AAEA,QAAI,KAAK,UAAL,CAAgB,UAAhB,CAAJ,EAAiC;AAC/B;AACD;;AAEDA,QAAM,eAAe,GAAG,UAAU,CAAC,MAAX,EAAxBA;AAEA,SAAK,UAAL,CAAgB,GAAhB,CAAoB;AAClB,MAAA,IAAI,EACF,eAAe,CAAC,IAAhB,GACA,KAAK,QAAL,CAAc,CAAd,EAAiB,UADjB,GAEA,KAAK,QAAL,CAAc,CAAd,EAAiB,qBAAjB,GAAyC,IAHvC,GAGuC,IAJzB;AAMlB,MAAA,KAAK,EAAK,UAAU,CAAC,UAAX,EAAL,GAA0B;AANb,KAApB;AAQF,G;AAEA;;;;;gBAGO,I,GAAA,SAAA,IAAA,GAAA;AACL,QAAI,KAAK,WAAL,KAAqB,CAAC,CAA1B,EAA6B;AAC3B;AACD;;AAED,QAAI,KAAK,KAAL,CAAW,MAAX,GAAoB,KAAK,WAAL,GAAmB,CAA3C,EAA8C;AAC5C,WAAK,WAAL;AACD,KAFD,MAEO,IAAI,KAAK,OAAL,CAAa,IAAjB,EAAuB;AAC5B,WAAK,WAAL,GAAmB,CAAnB;AACD;;AAED,SAAK,SAAL;AACF,G;AAEA;;;;;gBAGO,I,GAAA,SAAA,IAAA,GAAA;AACL,QAAI,KAAK,WAAL,KAAqB,CAAC,CAA1B,EAA6B;AAC3B;AACD;;AAED,QAAI,KAAK,WAAL,GAAmB,CAAvB,EAA0B;AACxB,WAAK,WAAL;AACD,KAFD,MAEO,IAAI,KAAK,OAAL,CAAa,IAAjB,EAAuB;AAC5B,WAAK,WAAL,GAAmB,KAAK,KAAL,CAAW,MAAX,GAAoB,CAAvC;AACD;;AAED,SAAK,SAAL;AACF,G;AAEA;;;;;;gBAIO,I,GAAA,SAAA,IAAA,CAAK,KAAL,EAA2B;;;AAChC,QAAI,KAAK,WAAL,KAAqB,CAAC,CAA1B,EAA6B;AAC3B;AACD;;AAED,QAAI,QAAQ,CAAC,KAAD,CAAZ,EAAqB;AACnB,WAAK,WAAL,GAAmB,KAAnB;AACD,KAFD,MAEO;AACL,WAAK,KAAL,CAAW,IAAX,CAAe,UAAE,CAAF,EAAK,GAAL,EAAQ;AACrB,YAAI,GAAG,CAAC,EAAJ,KAAW,KAAf,EAAsB;AACpBG,UAAAA,MAAI,CAAC,WAALA,KAAqB,CAArBA;AACA,iBAAO,KAAP;AACD;AACF,OALD;AAMD;;AAED,SAAK,SAAL;AACF,G;AAEA;;;;;;gBAIO,Y,GAAA,SAAA,YAAA,GAAA;;AACLH,QAAM,QAAQ,GAAG,KAAK,KAAtBA,CADK,CACuB;;AAC5BA,QAAM,QAAQ,GAAG,KAAK,QAAL,CAAc,QAAd,CAAuB,GAAvB,CAAjBA,CAFK,CAEwC;;AAC7CA,QAAM,cAAc,GAAG,QAAQ,CAAC,GAAT,EAAvBA,CAHK,CAGiC;;AACtCA,QAAM,cAAc,GAAG,QAAQ,CAAC,GAAT,EAAvBA,CAJK,CAIiC;;AAEtC,QAAI,CAAC,QAAQ,CAAC,MAAd,EAAsB;AACpB,WAAK,WAAL,GAAmB,CAAC,CAApB;AACA,WAAK,KAAL,GAAa,QAAb;AACA,WAAK,oBAAL;AAEA;AACD,KAZI,C;;;AAeL,IAAA,QAAQ,CAAC,IAAT,CAAa,UAAE,KAAF,EAAS,GAAT,EAAY;;AAEvB,UAAI,cAAc,CAAC,OAAf,CAAuB,GAAvB,IAA8B,CAAlC,EAAqC;AACnCG,QAAAA,MAAI,CAAC,YAALA,CAAkB,GAAlBA;;AAEA,YAAIA,MAAI,CAAC,WAALA,KAAqB,CAAC,CAA1B,EAA6B;AAC3BA,UAAAA,MAAI,CAAC,WAALA,GAAmB,CAAnBA;AACD,SAFD,MAEO,IAAI,KAAK,IAAIA,MAAI,CAAC,WAAlB,EAA+B;AACpCA,UAAAA,MAAI,CAAC,WAALA;AACD;AACF;AACF,KAXD,EAfK,C;;AA6BL,IAAA,QAAQ,CAAC,IAAT,CAAa,UAAE,KAAF,EAAS,GAAT,EAAY;;AAEvB,UAAI,cAAc,CAAC,OAAf,CAAuB,GAAvB,IAA8B,CAAlC,EAAqC;AACnC,YAAI,KAAK,GAAGA,MAAI,CAAC,WAAjB,EAA8B;AAC5BA,UAAAA,MAAI,CAAC,WAALA;AACD,SAFD,MAEO,IAAI,KAAK,KAAKA,MAAI,CAAC,WAAnB,EAAgC;AACrCA,UAAAA,MAAI,CAAC,WAALA,GAAmB,CAAnBA;AACD;AACF;AACF,KATD;AAWA,SAAK,KAAL,GAAa,QAAb;AAEA,SAAK,SAAL;AACF,G;;AAGF,EAAA,IAAI,CAAC,GAAL,GAAW,GAAX;AC7WAH,MAAMO,YAAU,GAAG,UAAnBP;AAEA,EAAA,CAAC,CAAA,YAAA;AACC,IAAA,IAAI,CAAC,QAAL,CAAa,MAAKO,YAAL,GAAe,GAA5B,EAAiC,YAAA;AAC/B,UAAI,IAAI,CAAC,GAAT,CAAa,IAAb,EAAmB,YAAY,CAAC,IAAD,EAAOA,YAAP,CAA/B;AACD,KAFD;AAGD,GAJA,CAAD;ACRA;;;;;AAiEAP,MAAMM,iBAAe,GAAY;AAC/B,IAAA,OAAO,EAAE,KADsB;AAE/B,IAAA,KAAK,EAAE;AAFwB,GAAjCN;;AAKA,MAAM,MAAM,GA0BV,SAAA,MAAA,CACE,QADF,EAEE,OAFF,EAEuB;;sCAAF,E;;;;;AAnBd,SAAA,OAAA,GAAmB,MAAM,CAAC,EAAD,EAAKM,iBAAL,CAAzB;;;;;AAKC,SAAA,OAAA,GAAU,KAAV;AAgBN,SAAK,QAAL,GAAgB,CAAC,CAAC,QAAD,CAAD,CAAY,KAAZ,EAAhB;AAEA,IAAA,MAAM,CAAC,KAAK,OAAN,EAAe,OAAf,CAAN;AAEA,SAAK,QAAL,GAAgB,KAAK,QAAL,CAAc,QAAd,CAAuB,mBAAvB,IACZ,OADY,GAEZ,MAFJ;;AAIA,QAAI,KAAK,QAAL,CAAc,QAAd,CAAuB,mBAAvB,CAAJ,EAAiD;AAC/C,WAAK,KAAL,GAAa,QAAb;AACD,KAFD,MAEO,IAAI,KAAK,QAAL,CAAc,QAAd,CAAuB,kBAAvB,CAAJ,EAAgD;AACrD,WAAK,KAAL,GAAa,QAAb;AACD,KAFM,MAEA,IAAI,KAAK,SAAL,EAAJ,EAAsB;AAC3B,WAAK,KAAL,GAAa,QAAb;AACD,KAFM,MAEA;AACL,WAAK,KAAL,GAAa,QAAb;AACD,KAlBoB,C;;;AAqBrB,IAAA,OAAO,CAAC,EAAR,CACE,QADF,EAEE,CAAC,CAAC,QAAF,CAAU,YAAA;AACR,UAAIH,MAAI,CAAC,SAALA,EAAJ,EAAsB;;;AAGpB,YAAIA,MAAI,CAAC,OAALA,IAAgB,CAACA,MAAI,CAAC,OAALA,CAAa,OAAlC,EAA2C;AACzC,UAAA,CAAC,CAAC,WAAF;AACAA,UAAAA,MAAI,CAAC,OAALA,GAAe,KAAfA;AACA,UAAA,CAAC,CAAC,YAAF;AACD,SAPmB,C;;;AAUpB,YAAI,CAACA,MAAI,CAAC,QAALA,CAAc,QAAdA,CAAuB,mBAAvBA,CAAL,EAAkD;AAChDA,UAAAA,MAAI,CAAC,KAALA,GAAa,QAAbA;AACD;AACF,OAbD,MAaO,IAAI,CAACA,MAAI,CAAC,OAAN,IAAiBA,MAAI,CAAC,KAALA,KAAe,QAApC,EAA8C;;AAEnD,YAAIA,MAAI,CAAC,QAALA,CAAc,QAAdA,CAAuB,kBAAvBA,CAAJ,EAAgD;AAC9C,UAAA,CAAC,CAAC,WAAF;AACAA,UAAAA,MAAI,CAAC,OAALA,GAAe,IAAfA;AACA,UAAA,CAAC,CAAC,UAAF;AAEA,UAAA,CAAC,CAAC,eAAD,CAAD,CAAmB,GAAnB,CAAuB,OAAvB,EAA8B,YAAA;AAAA,mBAAQA,MAAI,CAAC,KAALA,EAAR;AAAoB,WAAlD;AACD,SAND,MAMO;AACLA,UAAAA,MAAI,CAAC,KAALA,GAAa,QAAbA;AACD;AACF;AACF,KA1BD,EA0BG,GA1BH,CAFF,EArBqB,C;;AAqDrB,SAAK,QAAL,CAAc,IAAd,CAAmB,qBAAnB,EAA0C,IAA1C,CAA8C,UAAE,CAAF,EAAK,KAAL,EAAU;AACtD,MAAA,CAAC,CAAC,KAAD,CAAD,CAAS,EAAT,CAAY,OAAZ,EAAmB,YAAA;AAAA,eAAQA,MAAI,CAAC,KAALA,EAAR;AAAoB,OAAvC;AACD,KAFD;AAIA,SAAK,YAAL;AACF,GAtFF;AAwFE;;;;;mBAGQ,S,GAAA,SAAA,SAAA,GAAA;AACN,WAAO,OAAO,CAAC,KAAR,MAAmB,IAA1B;AACF,G;AAEA;;;;;mBAGQ,Y,GAAA,SAAA,YAAA,GAAA;;AAENH,QAAM,IAAI,GAAG,IAAbA,CAFM,C;;AAKNC,QAAI,mBAAJA;AACAA,QAAI,WAAJA;AACAA,QAAI,WAAJA;AACAA,QAAI,WAAJA;AACAA,QAAI,OAAO,GAAiC,IAA5CA;AACAA,QAAI,YAAY,GAAG,KAAnBA;AACAD,QAAM,KAAK,GAAG,CAAC,CAAC,MAAD,CAAfA,CAXM,C;;AAcNA,QAAM,cAAc,GAAG,EAAvBA;;AAEA,aAAS,WAAT,CAAqB,UAArB,EAAuC;AACrCA,UAAM,sBAAsB,GAAG,IAAI,CAAC,QAAL,KAAkB,OAAlB,GAA4B,CAAC,CAA7B,GAAiC,CAAhEA;AACAA,UAAM,YAAY,GAAG,eACnB,CAAC,CAAD,GAAK,sBAAL,GAA8B,UADX,GAErB,oBAFAA;AAGAA,UAAM,aAAa,GAAG,qBAAtBA;AAEA,MAAA,IAAI,CAAC,QAAL,CAAc,GAAd,CACE,SADF,EACW,gBACK,YADL,GACiB,gBADjB,GACkC,aADlC,GAC+C,GAF1D;AAID;;AAED,aAAS,aAAT,GAAsB;AACpB,MAAA,IAAI,CAAC,QAAL,CAAc,CAAd,EAAiB,KAAjB,CAAuB,SAAvB,GAAmC,EAAnC;AACA,MAAA,IAAI,CAAC,QAAL,CAAc,CAAd,EAAiB,KAAjB,CAAuB,eAAvB,GAAyC,EAAzC;AACA,MAAA,IAAI,CAAC,QAAL,CAAc,CAAd,EAAiB,KAAjB,CAAuB,UAAvB,GAAoC,EAApC;AACA,MAAA,IAAI,CAAC,QAAL,CAAc,CAAd,EAAiB,KAAjB,CAAuB,gBAAvB,GAA0C,EAA1C;AACD;;AAED,aAAS,gBAAT,GAAyB;AACvB,aAAO,IAAI,CAAC,QAAL,CAAc,KAAd,KAAwB,EAA/B;AACD;;AAED,aAAS,aAAT,CAAuB,QAAvB,EAAuC;AACrC,aAAO,IAAI,CAAC,GAAL,CACL,IAAI,CAAC,GAAL,CACE,OAAO,KAAK,SAAZ,GACI,WAAW,GAAG,QADlB,GAEI,gBAAgB,KAAK,WAArB,GAAmC,QAHzC,EAIE,CAJF,CADK,EAOL,gBAAgB,EAPX,CAAP;AASD;;AAED,aAAS,cAAT,CAAwB,KAAxB,EAAqC;AACnC,UAAI,OAAJ,EAAa;AACXC,YAAI,MAAM,GAAI,KAAoB,CAAC,cAArB,CAAoC,CAApC,EAAuC,KAArDA;;AACA,YAAI,IAAI,CAAC,QAAL,KAAkB,OAAtB,EAA+B;AAC7B,UAAA,MAAM,GAAG,KAAK,CAAC,KAAN,KAAgB,MAAzB;AACD;;AAEDD,YAAM,cAAc,GAAG,aAAa,CAAC,MAAD,CAAb,GAAwB,gBAAgB,EAA/DA;AAEA,QAAA,YAAY,GAAG,KAAf;AACAA,YAAM,YAAY,GAAG,OAArBA;AACA,QAAA,OAAO,GAAG,IAAV;;AAEA,YAAI,YAAY,KAAK,SAArB,EAAgC;AAC9B,cAAI,cAAc,GAAG,IAArB,EAA2B;AACzB,YAAA,aAAa;AACb,YAAA,IAAI,CAAC,IAAL;AACD,WAHD,MAGO;AACL,YAAA,aAAa;AACd;AACF,SAPD,MAOO;AACL,cAAI,cAAc,GAAG,IAArB,EAA2B;AACzB,YAAA,aAAa;AACb,YAAA,IAAI,CAAC,KAAL;AACD,WAHD,MAGO;AACL,YAAA,aAAa;AACd;AACF;;AAED,QAAA,CAAC,CAAC,YAAF;AACD,OA7BD,MA6BO;AACL,QAAA,YAAY,GAAG,KAAf;AACD;;AAED,MAAA,KAAK,CAAC,GAAN,CAAU;;AAER,QAAA,SAAS,EAAE,eAFH;AAGR,QAAA,QAAQ,EAAE,cAHF;;AAKR,QAAA,WAAW,EAAE;AALL,OAAV;AAOD;;AAED,aAAS,eAAT,CAAyB,KAAzB,EAAqC;AACnCC,UAAI,MAAM,GAAI,KAAoB,CAAC,OAArB,CAA6B,CAA7B,EAAgC,KAA9CA;;AACA,UAAI,IAAI,CAAC,QAAL,KAAkB,OAAtB,EAA+B;AAC7B,QAAA,MAAM,GAAG,KAAK,CAAC,KAAN,KAAgB,MAAzB;AACD;;AAEDD,UAAM,MAAM,GAAI,KAAoB,CAAC,OAArB,CAA6B,CAA7B,EAAgC,KAAhDA;;AAEA,UAAI,OAAJ,EAAa;AACX,QAAA,WAAW,CAAC,aAAa,CAAC,MAAD,CAAd,CAAX;AACD,OAFD,MAEO,IAAI,YAAJ,EAAkB;AACvBA,YAAM,KAAK,GAAG,IAAI,CAAC,GAAL,CAAS,MAAM,GAAG,WAAlB,CAAdA;AACAA,YAAM,KAAK,GAAG,IAAI,CAAC,GAAL,CAAS,MAAM,GAAG,WAAlB,CAAdA;AACAA,YAAM,SAAS,GAAG,CAAlBA;;AAEA,YAAI,KAAK,GAAG,SAAR,IAAqB,KAAK,IAAI,SAAlC,EAA6C;AAC3C,UAAA,WAAW,GAAG,MAAd;AACA,UAAA,OAAO,GAAG,IAAI,CAAC,KAAL,KAAe,QAAf,GAA0B,SAA1B,GAAsC,SAAhD;AACA,UAAA,CAAC,CAAC,UAAF;AACA,UAAA,WAAW,CAAC,aAAa,CAAC,MAAD,CAAd,CAAX;AACD,SALD,MAKO,IAAI,KAAK,IAAI,SAAT,IAAsB,KAAK,GAAG,SAAlC,EAA6C;AAClD,UAAA,cAAc;AACf;AACF;AACF;;AAED,aAAS,gBAAT,CAA0B,KAA1B,EAAsC;AACpC,MAAA,WAAW,GAAI,KAAoB,CAAC,OAArB,CAA6B,CAA7B,EAAgC,KAA/C;;AACA,UAAI,IAAI,CAAC,QAAL,KAAkB,OAAtB,EAA+B;AAC7B,QAAA,WAAW,GAAG,KAAK,CAAC,KAAN,KAAgB,WAA9B;AACD;;AAED,MAAA,WAAW,GAAI,KAAoB,CAAC,OAArB,CAA6B,CAA7B,EAAgC,KAA/C;;AAEA,UAAI,IAAI,CAAC,KAAL,KAAe,QAAnB,EAA6B;AAC3B,YACE,WAAW,GAAG,cAAd,IACA,mBAAmB,KAAK,gBAF1B,EAGE;AACA;AACD;AACF;;AAED,MAAA,YAAY,GAAG,IAAf;AAEA,MAAA,KAAK,CAAC,EAAN,CAAS;AACP,QAAA,SAAS,EAAE,eADJ;AAEP,QAAA,QAAQ,EAAE,cAFH;AAGP,QAAA,WAAW,EAAE;AAHN,OAAT;AAKD;;AAED,aAAS,mBAAT,GAA4B;AAC1B,UAAI,CAAC,mBAAL,EAA0B;AACxB,QAAA,KAAK,CAAC,EAAN,CAAS,YAAT,EAAuB,gBAAvB;AACA,QAAA,mBAAmB,GAAG,gBAAtB;AACD;AACF;;AAED,QAAI,KAAK,OAAL,CAAa,KAAjB,EAAwB;AACtB,MAAA,mBAAmB;AACpB;AACH,G;AAEA;;;;;;mBAIQ,Y,GAAA,SAAA,YAAA,CAAa,IAAb,EAAwB;AAC9B,IAAA,cAAc,CAAC,IAAD,EAAO,QAAP,EAAiB,KAAK,QAAtB,EAAgC,IAAhC,CAAd;AACF,G;AAEA;;;;;mBAGQ,a,GAAA,SAAA,aAAA,GAAA;AACN,QAAI,KAAK,QAAL,CAAc,QAAd,CAAuB,kBAAvB,CAAJ,EAAgD;AAC9C,WAAK,KAAL,GAAa,QAAb;AACA,WAAK,YAAL,CAAkB,QAAlB;AACD,KAHD,MAGO;AACL,WAAK,KAAL,GAAa,QAAb;AACA,WAAK,YAAL,CAAkB,QAAlB;AACD;AACH,G;AAEA;;;;;mBAGQ,M,GAAA,SAAA,MAAA,GAAA;AACN,WAAO,KAAK,KAAL,KAAe,SAAf,IAA4B,KAAK,KAAL,KAAe,QAAlD;AACF,G;AAEA;;;;;mBAGO,I,GAAA,SAAA,IAAA,GAAA;;;AACL,QAAI,KAAK,MAAL,EAAJ,EAAmB;AACjB;AACD;;AAED,SAAK,KAAL,GAAa,SAAb;AACA,SAAK,YAAL,CAAkB,MAAlB;;AAEA,QAAI,CAAC,KAAK,OAAL,CAAa,OAAlB,EAA2B;AACzB,MAAA,CAAC,CAAC,MAAD,CAAD,CAAU,QAAV,CAAkB,sBAAqB,KAAK,QAA5C;AACD;;AAED,SAAK,QAAL,CACG,WADH,CACe,mBADf,EAEG,QAFH,CAEY,kBAFZ,EAGG,aAHH,CAGgB,YAAA;AAAA,aAAOG,MAAI,CAAC,aAALA,EAAP;AAA2B,KAH3C;;AAKA,QAAI,CAAC,KAAK,SAAL,EAAD,IAAqB,KAAK,OAAL,CAAa,OAAtC,EAA+C;AAC7C,WAAK,OAAL,GAAe,IAAf;AACA,MAAA,CAAC,CAAC,WAAF,GAAgB,GAAhB,CAAoB,OAApB,EAA2B,YAAA;AAAA,eAAQA,MAAI,CAAC,KAALA,EAAR;AAAoB,OAA/C;AACA,MAAA,CAAC,CAAC,UAAF;AACD;AACH,G;AAEA;;;;;mBAGO,K,GAAA,SAAA,KAAA,GAAA;;;AACL,QAAI,CAAC,KAAK,MAAL,EAAL,EAAoB;AAClB;AACD;;AAED,SAAK,KAAL,GAAa,SAAb;AACA,SAAK,YAAL,CAAkB,OAAlB;;AAEA,QAAI,CAAC,KAAK,OAAL,CAAa,OAAlB,EAA2B;AACzB,MAAA,CAAC,CAAC,MAAD,CAAD,CAAU,WAAV,CAAqB,sBAAqB,KAAK,QAA/C;AACD;;AAED,SAAK,QAAL,CACG,QADH,CACY,mBADZ,EAEG,WAFH,CAEe,kBAFf,EAGG,aAHH,CAGgB,YAAA;AAAA,aAAOA,MAAI,CAAC,aAALA,EAAP;AAA2B,KAH3C;;AAKA,QAAI,KAAK,OAAT,EAAkB;AAChB,MAAA,CAAC,CAAC,WAAF;AACA,WAAK,OAAL,GAAe,KAAf;AACA,MAAA,CAAC,CAAC,YAAF;AACD;AACH,G;AAEA;;;;;mBAGO,M,GAAA,SAAA,MAAA,GAAA;AACL,SAAK,MAAL,KAAgB,KAAK,KAAL,EAAhB,GAA+B,KAAK,IAAL,EAA/B;AACF,G;AAEA;;;;;mBAGO,Q,GAAA,SAAA,QAAA,GAAA;AACL,WAAO,KAAK,KAAZ;AACF,G;;AAGF,EAAA,IAAI,CAAC,MAAL,GAAc,MAAd;AChaAH,MAAMO,YAAU,GAAG,aAAnBP;AAQA,EAAA,CAAC,CAAA,YAAA;AACC,IAAA,IAAI,CAAC,QAAL,CAAa,MAAKO,YAAL,GAAe,GAA5B,EAAiC,YAAA;AAC/BP,UAAM,QAAQ,GAAG,CAAC,CAAC,IAAD,CAAlBA;AACAA,UAAM,OAAO,GAAG,YAAY,CAAC,IAAD,EAAOO,YAAP,CAA5BP;AACAA,UAAM,QAAQ,GAAG,OAAO,CAAC,MAAzBA,CAH+B,C;;AAK/B,aAAO,OAAO,CAAC,MAAf;AAEAA,UAAM,OAAO,GAAG,CAAC,CAAC,QAAD,CAAD,CAAY,KAAZ,EAAhBA;AACAA,UAAM,QAAQ,GAAG,IAAI,IAAI,CAAC,MAAT,CAAgB,OAAhB,EAAyB,OAAzB,CAAjBA;AAEA,MAAA,QAAQ,CAAC,EAAT,CAAY,OAAZ,EAAmB,YAAA;AAAA,eAAQ,QAAQ,CAAC,MAAT,EAAR;AAAyB,OAA5C;AACD,KAXD;AAYD,GAbA,CAAD;ACXAA,MAAM,SAAS,GAAwB,EAAvCA;;AAeA,WAAS,KAAT,CAAe,IAAf,EAA6B,IAA7B,EAAwC;AACtC,QAAI,WAAW,CAAC,SAAS,CAAC,IAAD,CAAV,CAAf,EAAkC;AAChC,MAAA,SAAS,CAAC,IAAD,CAAT,GAAkB,EAAlB;AACD;;AAED,QAAI,WAAW,CAAC,IAAD,CAAf,EAAuB;AACrB,aAAO,SAAS,CAAC,IAAD,CAAhB;AACD;;AAED,IAAA,SAAS,CAAC,IAAD,CAAT,CAAgB,IAAhB,CAAqB,IAArB;AACD;AAED;;;;;;AAIA,WAAS,OAAT,CAAiB,IAAjB,EAA6B;AAC3B,QAAI,WAAW,CAAC,SAAS,CAAC,IAAD,CAAV,CAAf,EAAkC;AAChC;AACD;;AAED,QAAI,CAAC,SAAS,CAAC,IAAD,CAAT,CAAgB,MAArB,EAA6B;AAC3B;AACD;;AAEDA,QAAM,IAAI,GAAG,SAAS,CAAC,IAAD,CAAT,CAAgB,KAAhB,EAAbA;AAEA,IAAA,IAAI;AACN;;ACuBAA,MAAMM,iBAAe,GAAY;AAC/B,IAAA,OAAO,EAAE,IADsB;AAE/B,IAAA,OAAO,EAAE,IAFsB;AAG/B,IAAA,KAAK,EAAE,KAHwB;AAI/B,IAAA,UAAU,EAAE,IAJmB;AAK/B,IAAA,aAAa,EAAE,IALgB;AAM/B,IAAA,cAAc,EAAE,IANe;AAO/B,IAAA,eAAe,EAAE;AAPc,GAAjCN;AAUA;;;;AAGAC,MAAI,WAAW,GAAkB,IAAjCA;AAEA;;;;AAGAD,MAAM,SAAS,GAAG,cAAlBA;AAEA;;;;AAGAC,MAAI,YAAY,GAAG,KAAnBA;AAEA;;;;AAGAA,MAAI,QAAJA;;AAEA,MAAM,MAAM,GAqBV,SAAA,MAAA,CACE,QADF,EAEE,OAFF,EAEuB;;sCAAF,E;;;;;AAdd,SAAA,OAAA,GAAmB,MAAM,CAAC,EAAD,EAAKK,iBAAL,CAAzB;;;;;AAKA,SAAA,KAAA,GAAe,QAAf;;;;;AAKC,SAAA,MAAA,GAAS,KAAT;AAMN,SAAK,QAAL,GAAgB,CAAC,CAAC,QAAD,CAAD,CAAY,KAAZ,EAAhB,CAFqB,C;;AAKrB,QAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAV,EAAgB,KAAK,QAAL,CAAc,CAAd,CAAhB,CAAb,EAAgD;AAC9C,WAAK,MAAL,GAAc,IAAd;AACA,MAAA,CAAC,CAAC,MAAD,CAAD,CAAU,MAAV,CAAiB,KAAK,QAAtB;AACD;;AAED,IAAA,MAAM,CAAC,KAAK,OAAN,EAAe,OAAf,CAAN,CAVqB,C;;AAarB,SAAK,QAAL,CAAc,IAAd,CAAmB,sBAAnB,EAA2C,IAA3C,CAA+C,UAAE,CAAF,EAAK,MAAL,EAAW;AACxD,MAAA,CAAC,CAAC,MAAD,CAAD,CAAU,EAAV,CAAa,OAAb,EAAoB,YAAA;AAClBH,QAAAA,MAAI,CAAC,YAALA,CAAkB,QAAlBA;;AAEA,YAAIA,MAAI,CAAC,OAALA,CAAa,aAAjB,EAAgC;AAC9BA,UAAAA,MAAI,CAAC,KAALA;AACD;AACF,OAND;AAOD,KARD,EAbqB,C;;AAwBrB,SAAK,QAAL,CAAc,IAAd,CAAmB,uBAAnB,EAA4C,IAA5C,CAAgD,UAAE,CAAF,EAAK,OAAL,EAAY;AAC1D,MAAA,CAAC,CAAC,OAAD,CAAD,CAAW,EAAX,CAAc,OAAd,EAAqB,YAAA;AACnBA,QAAAA,MAAI,CAAC,YAALA,CAAkB,SAAlBA;;AAEA,YAAIA,MAAI,CAAC,OAALA,CAAa,cAAjB,EAAiC;AAC/BA,UAAAA,MAAI,CAAC,KAALA;AACD;AACF,OAND;AAOD,KARD,EAxBqB,C;;AAmCrB,SAAK,QAAL,CAAc,IAAd,CAAmB,qBAAnB,EAA0C,IAA1C,CAA8C,UAAE,CAAF,EAAK,KAAL,EAAU;AACtD,MAAA,CAAC,CAAC,KAAD,CAAD,CAAS,EAAT,CAAY,OAAZ,EAAmB,YAAA;AAAA,eAAQA,MAAI,CAAC,KAALA,EAAR;AAAoB,OAAvC;AACD,KAFD;AAGF,GA7DF;AA+DE;;;;;;mBAIQ,Y,GAAA,SAAA,YAAA,CAAa,IAAb,EAAwB;AAC9B,IAAA,cAAc,CAAC,IAAD,EAAO,QAAP,EAAiB,KAAK,QAAtB,EAAgC,IAAhC,CAAd;AACF,G;AAEA;;;;;mBAGQ,Q,GAAA,SAAA,QAAA,GAAA;AACN,QAAI,CAAC,WAAL,EAAkB;AAChB;AACD;;AAEDH,QAAM,QAAQ,GAAG,WAAW,CAAC,QAA7BA;AACAA,QAAM,MAAM,GAAG,QAAQ,CAAC,QAAT,CAAkB,oBAAlB,CAAfA;AACAA,QAAM,QAAQ,GAAG,QAAQ,CAAC,QAAT,CAAkB,sBAAlB,CAAjBA;AACAA,QAAM,QAAQ,GAAG,QAAQ,CAAC,QAAT,CAAkB,sBAAlB,CAAjBA,CARM,C;;AAWN,IAAA,QAAQ,CAAC,MAAT,CAAgB,EAAhB;AACA,IAAA,QAAQ,CAAC,MAAT,CAAgB,EAAhB;AAEAA,QAAM,aAAa,GAAG,QAAQ,CAAC,MAAT,EAAtBA;AACA,IAAA,QAAQ,CAAC,GAAT,CAAa;AACX,MAAA,GAAG,EAAK,CAAC,OAAO,CAAC,MAAR,KAAmB,aAApB,IAAqC,CAA1C,GAA0C,IADlC;AAEX,MAAA,MAAM,EAAK,aAAa,GAAA;AAFb,KAAb,EAfM,C;;AAqBN,IAAA,QAAQ,CAAC,WAAT,CACE,aAAa,IACV,MAAM,CAAC,WAAP,MAAwB,CADd,CAAb,IAEG,QAAQ,CAAC,WAAT,MAA0B,CAF7B,CADF;AAKF,G;AAEA;;;;;mBAGQ,e,GAAA,SAAA,eAAA,GAAA;AACN,QAAI,MAAM,CAAC,QAAP,CAAgB,IAAhB,CAAqB,SAArB,CAA+B,CAA/B,EAAkC,OAAlC,CAA0C,aAA1C,IAA2D,CAA/D,EAAkE;AAChE,MAAA,WAAY,CAAC,KAAb,CAAmB,IAAnB;AACD;AACH,G;AAEA;;;;;;mBAIQ,Y,GAAA,SAAA,YAAA,CAAa,KAAb,EAAyB;AAC/B,QACE,CAAC,CAAC,KAAK,CAAC,MAAP,CAAD,CAA+B,QAA/B,CAAwC,cAAxC,KACA,WAFF,EAGE;AACA,MAAA,WAAW,CAAC,KAAZ;AACD;AACH,G;AAEA;;;;;mBAGQ,a,GAAA,SAAA,aAAA,GAAA;AACN,QAAI,KAAK,QAAL,CAAc,QAAd,CAAuB,kBAAvB,CAAJ,EAAgD;AAC9C,WAAK,KAAL,GAAa,QAAb;AACA,WAAK,YAAL,CAAkB,QAAlB;AACD,KAHD,MAGO;AACL,WAAK,KAAL,GAAa,QAAb;AACA,WAAK,YAAL,CAAkB,QAAlB;AACA,WAAK,QAAL,CAAc,IAAd,GAHK,C;;AAML,UAAI,CAAC,KAAK,CAAC,SAAD,CAAL,CAAiB,MAAlB,IAA4B,CAAC,WAA7B,IAA4C,YAAhD,EAA8D;AAC5D,QAAA,CAAC,CAAC,YAAF;AACA,QAAA,YAAY,GAAG,KAAf;AACD;;AAED,MAAA,OAAO,CAAC,GAAR,CAAY,QAAZ,EAAsB,CAAC,CAAC,QAAF,CAAW,KAAK,QAAhB,EAA0B,GAA1B,CAAtB;;AAEA,UAAI,KAAK,OAAL,CAAa,eAAjB,EAAkC;AAChC,aAAK,OAAL;AACD;AACF;AACH,G;AAEA;;;;;mBAGQ,M,GAAA,SAAA,MAAA,GAAA;;AACN,IAAA,WAAW,GAAG,IAAd;;AAEA,QAAI,CAAC,YAAL,EAAmB;AACjB,MAAA,CAAC,CAAC,UAAF;AACA,MAAA,YAAY,GAAG,IAAf;AACD;;AAED,SAAK,QAAL,CAAc,IAAd;AACA,SAAK,QAAL;AAEA,IAAA,OAAO,CAAC,EAAR,CAAW,QAAX,EAAqB,CAAC,CAAC,QAAF,CAAW,KAAK,QAAhB,EAA0B,GAA1B,CAArB,EAXM,C;;AAcN,SAAK,KAAL,GAAa,SAAb;AACA,SAAK,YAAL,CAAkB,MAAlB;AACA,SAAK,QAAL,CACG,QADH,CACY,kBADZ,EAEG,aAFH,CAEgB,YAAA;AAAA,aAAOG,MAAI,CAAC,aAALA,EAAP;AAA2B,KAF3C,EAhBM,C;;AAqBN,QAAI,CAAC,QAAL,EAAe;AACb,MAAA,QAAQ,GAAG,CAAC,CAAC,WAAF,CAAc,IAAd,CAAX;AACD,KAvBK,C;;;AA0BN,QAAI,KAAK,OAAL,CAAa,KAAjB,EAAwB;AACtB,MAAA,QAAQ,CAAC,GAAT,CAAa,OAAb,EAAsB,KAAK,YAA3B;AACD,KAFD,MAEO;AACL,MAAA,QAAQ,CAAC,EAAT,CAAY,OAAZ,EAAqB,KAAK,YAA1B;AACD,KA9BK,C;;;AAiCN,IAAA,QAAQ,CAAC,GAAT,CAAa,SAAb,EAAwB,KAAK,OAAL,CAAa,OAAb,GAAuB,EAAvB,GAA4B,CAApD;;AAEA,QAAI,KAAK,OAAL,CAAa,OAAjB,EAA0B;;;AAGxBF,UAAI,IAAI,GAAG,MAAM,CAAC,QAAP,CAAgB,IAAhB,CAAqB,SAArB,CAA+B,CAA/B,CAAXA;;AACA,UAAI,IAAI,CAAC,OAAL,CAAa,aAAb,IAA8B,CAAC,CAAnC,EAAsC;AACpC,QAAA,IAAI,GAAG,IAAI,CAAC,OAAL,CAAa,mBAAb,EAAkC,EAAlC,CAAP;AACD,OANuB,C;;;AASxB,UAAI,IAAJ,EAAU;AACR,QAAA,MAAM,CAAC,QAAP,CAAgB,IAAhB,GAAuB,KAAG,IAAH,IACrB,IAAI,CAAC,OAAL,CAAa,GAAb,IAAoB,CAAC,CAArB,GAAyB,GAAzB,GAA+B,GADV,IAEvB,aAFA;AAGD,OAJD,MAIO;AACL,QAAA,MAAM,CAAC,QAAP,CAAgB,IAAhB,GAAuB,aAAvB;AACD;;AAED,MAAA,OAAO,CAAC,EAAR,CAAW,YAAX,EAAyB,KAAK,eAA9B;AACD;AACH,G;AAEA;;;;;mBAGQ,M,GAAA,SAAA,MAAA,GAAA;AACN,WAAO,KAAK,KAAL,KAAe,SAAf,IAA4B,KAAK,KAAL,KAAe,QAAlD;AACF,G;AAEA;;;;;mBAGO,I,GAAA,SAAA,IAAA,GAAA;;;AACL,QAAI,KAAK,MAAL,EAAJ,EAAmB;AACjB;AACD,KAHI,C;;;AAML,QACG,WAAW,KACT,WAAW,CAAC,KAAZ,KAAsB,SAAtB,IAAmC,WAAW,CAAC,KAAZ,KAAsB,QADhD,CAAZ,IAEA,KAAK,CAAC,SAAD,CAAL,CAAiB,MAHnB,EAIE;AACA,MAAA,KAAK,CAAC,SAAD,EAAU,YAAA;AAAA,eAAQE,MAAI,CAAC,MAALA,EAAR;AAAqB,OAA/B,CAAL;AAEA;AACD;;AAED,SAAK,MAAL;AACF,G;AAEA;;;;;mBAGO,K,GAAA,SAAA,KAAA,CAAM,WAAN,EAAyB;;2CAAR,GAAG,K,CAAK,C;;;;;;AAO9B,IAAA,UAAU,CAAA,YAAA;AACR,UAAI,CAACA,MAAI,CAAC,MAALA,EAAL,EAAoB;AAClB;AACD;;AAED,MAAA,WAAW,GAAG,IAAd;AAEAA,MAAAA,MAAI,CAAC,KAALA,GAAa,SAAbA;AACAA,MAAAA,MAAI,CAAC,YAALA,CAAkB,OAAlBA,EARQ,C;;AAWR,UAAI,CAAC,KAAK,CAAC,SAAD,CAAL,CAAiB,MAAlB,IAA4B,QAAhC,EAA0C;AACxC,QAAA,CAAC,CAAC,WAAF;AACA,QAAA,QAAQ,GAAG,IAAX,CAFwC,C;;AAKxC,QAAA,CAAC,CAAC,eAAD,CAAD,CAAmB,GAAnB,CAAuB,SAAvB,EAAkC,IAAlC;AACD;;AAEDA,MAAAA,MAAI,CAAC,QAALA,CACG,WADHA,CACe,kBADfA,EAEG,aAFHA,CAEgB,YAAA;AAAA,eAAOA,MAAI,CAAC,aAALA,EAAP;AAA2B,OAF3CA;;AAIA,UAAIA,MAAI,CAAC,OAALA,CAAa,OAAbA,IAAwB,CAAC,KAAK,CAAC,SAAD,CAAL,CAAiB,MAA9C,EAAsD;AACpD,YAAI,CAAC,WAAL,EAAkB;AAChB,UAAA,MAAM,CAAC,OAAP,CAAe,IAAf;AACD;;AAED,QAAA,OAAO,CAAC,GAAR,CAAY,YAAZ,EAA0BA,MAAI,CAAC,eAA/B;AACD,OA7BO,C;;;;AAiCR,MAAA,UAAU,CAAA,YAAA;AACR,QAAA,OAAO,CAAC,SAAD,CAAP;AACD,OAFS,EAEP,GAFO,CAAV;AAGD,KApCS,CAAV;AAqCF,G;AAEA;;;;;mBAGO,M,GAAA,SAAA,MAAA,GAAA;AACL,SAAK,MAAL,KAAgB,KAAK,KAAL,EAAhB,GAA+B,KAAK,IAAL,EAA/B;AACF,G;AAEA;;;;;mBAGO,Q,GAAA,SAAA,QAAA,GAAA;AACL,WAAO,KAAK,KAAZ;AACF,G;AAEA;;;;;mBAGO,O,GAAA,SAAA,OAAA,GAAA;AACL,QAAI,KAAK,MAAT,EAAiB;AACf,WAAK,QAAL,CAAc,MAAd;AACD;;AAED,QAAI,CAAC,KAAK,CAAC,SAAD,CAAL,CAAiB,MAAlB,IAA4B,CAAC,WAAjC,EAA8C;AAC5C,UAAI,QAAJ,EAAc;AACZ,QAAA,CAAC,CAAC,WAAF;AACA,QAAA,QAAQ,GAAG,IAAX;AACD;;AAED,UAAI,YAAJ,EAAkB;AAChB,QAAA,CAAC,CAAC,YAAF;AACA,QAAA,YAAY,GAAG,KAAf;AACD;AACF;AACH,G;AAEA;;;;;mBAGO,Y,GAAA,SAAA,YAAA,GAAA;AACL,SAAK,QAAL;AACF,G,ECjZF;;;AACA,EAAA,SAAS,CAAC,EAAV,CAAa,SAAb,EAAsB,UAAG,KAAH,EAAe;AACnC,QACE,WAAW,IACX,WAAW,CAAC,OAAZ,CAAoB,UADpB,IAEA,WAAW,CAAC,KAAZ,KAAsB,QAFtB,IAGC,KAAuB,CAAC,OAAxB,KAAoC,EAJvC,EAKE;AACA,MAAA,WAAW,CAAC,KAAZ;AACD;AACF,GATD;AAWA,EAAA,IAAI,CAAC,MAAL,GAAc,MAAd;AC9BAH,MAAMO,YAAU,GAAG,aAAnBP;AACAA,MAAMQ,UAAQ,GAAG,cAAjBR;AAaA,EAAA,CAAC,CAAA,YAAA;AACC,IAAA,SAAS,CAAC,EAAV,CAAa,OAAb,EAAoB,MAAMO,YAAN,GAAgB,GAApC,EAAyC,YAAA;AACvCP,UAAM,OAAO,GAAG,YAAY,CAAC,IAAD,EAAsBO,YAAtB,CAA5BP;AACAA,UAAM,QAAQ,GAAG,OAAO,CAAC,MAAzBA,CAFuC,C;;AAIvC,aAAO,OAAO,CAAC,MAAf;AAEAA,UAAM,OAAO,GAAG,CAAC,CAAC,QAAD,CAAD,CAAY,KAAZ,EAAhBA;AACAC,UAAI,QAAQ,GAAG,OAAO,CAAC,IAAR,CAAaO,UAAb,CAAfP;;AAEA,UAAI,CAAC,QAAL,EAAe;AACb,QAAA,QAAQ,GAAG,IAAI,IAAI,CAAC,MAAT,CAAgB,OAAhB,EAAyB,OAAzB,CAAX;AACA,QAAA,OAAO,CAAC,IAAR,CAAaO,UAAb,EAAuB,QAAvB;AACD;;AAED,MAAA,QAAQ,CAAC,IAAT;AACD,KAfD;AAgBD,GAjBA,CAAD;AC2FAR,MAAM,cAAc,GAAW;AAC7B,IAAA,IAAI,EAAE,EADuB;AAE7B,IAAA,IAAI,EAAE,KAFuB;AAG7B,IAAA,KAAK,EAAE,IAHsB;;AAK7B,IAAA,OAAO,EAAA,YAAA,CAAU;AALY,GAA/BA;AAQAA,MAAMM,iBAAe,GAAY;AAC/B,IAAA,KAAK,EAAE,EADwB;AAE/B,IAAA,OAAO,EAAE,EAFsB;AAG/B,IAAA,OAAO,EAAE,EAHsB;AAI/B,IAAA,cAAc,EAAE,KAJe;AAK/B,IAAA,QAAQ,EAAE,EALqB;AAM/B,IAAA,OAAO,EAAE,IANsB;AAO/B,IAAA,OAAO,EAAE,IAPsB;AAQ/B,IAAA,KAAK,EAAE,KARwB;AAS/B,IAAA,UAAU,EAAE,IATmB;AAU/B,IAAA,eAAe,EAAE,IAVc;;AAY/B,IAAA,MAAM,EAAA,YAAA,CAAU,CAZe;;AAc/B,IAAA,QAAQ,EAAA,YAAA,CAAU,CAda;;AAgB/B,IAAA,OAAO,EAAA,YAAA,CAAU,CAhBc;;AAkB/B,IAAA,QAAQ,EAAA,YAAA,CAAU;AAlBa,GAAjCN;;AAqBA,EAAA,IAAI,CAAC,MAAL,GAAc,UAAU,OAAV,EAA0B;eAAA,C;;;AAEtC,IAAA,OAAO,GAAG,MAAM,CAAC,EAAD,EAAKM,iBAAL,EAAsB,OAAtB,CAAhB;AAEA,IAAA,IAAI,CAAC,OAAO,CAAC,OAAT,EAAiB,UAAG,CAAH,EAAM,MAAN,EAAY;AAC/B,MAAA,OAAO,CAAC,OAAR,CAAiB,CAAjB,IAAsB,MAAM,CAAC,EAAD,EAAK,cAAL,EAAqB,MAArB,CAA5B;AACD,KAFG,CAAJ,CAJsC,C;;AAStCL,QAAI,WAAW,GAAG,EAAlBA;;AACA,QAAA,CAAA,EAAA,GAAI,OAAO,CAAC,OAAZ,MAAmB,IAAnB,IAAmB,EAAA,KAAA,KAAA,CAAnB,GAAmB,KAAA,CAAnB,GAAmB,EAAA,CAAE,MAArB,EAA6B;AAC3B,MAAA,WAAW,GAAG,sCACZ,OAAO,CAAC,cAAR,GAAyB,8BAAzB,GAA0D,EAD9C,IAEd,KAFA;AAIA,MAAA,IAAI,CAAC,OAAO,CAAC,OAAT,EAAgB,UAAG,CAAH,EAAM,MAAN,EAAY;AAC9B,QAAA,WAAW,IACT,kCACA,uDADA,IAEE,MAAM,CAAC,IAAP,GAAc,eAAd,GAAgC,EAFlC,IAGA,KAHA,GAGK,MAAM,CAAC,IAHZ,GAGgB,MAJlB;AAKD,OANG,CAAJ;AAQA,MAAA,WAAW,IAAI,QAAf;AACD,KAxBqC,C;;;AA2BtCD,QAAM,IAAI,GACR,8BAA2B,OAAO,CAAC,QAAnC,GAA2C,KAA3C,IACC,OAAO,CAAC,KAAR,G,sCACqC,OAAO,CAAC,K,GAAK,QADlD,GAEG,EAHJ,KAIC,OAAO,CAAC,OAAR,G,wCACuC,OAAO,CAAC,O,GAAO,QADtD,GAEG,EANJ,IAOA,WAPA,GAQA,QATFA,CA3BsC,C;;AAuCtCA,QAAM,QAAQ,GAAG,IAAI,IAAI,CAAC,MAAT,CAAgB,IAAhB,EAAsB;AACrC,MAAA,OAAO,EAAE,OAAO,CAAC,OADoB;AAErC,MAAA,OAAO,EAAE,OAAO,CAAC,OAFoB;AAGrC,MAAA,KAAK,EAAE,OAAO,CAAC,KAHsB;AAIrC,MAAA,UAAU,EAAE,OAAO,CAAC,UAJiB;AAKrC,MAAA,eAAe,EAAE,OAAO,CAAC;AALY,KAAtB,CAAjBA,CAvCsC,C;;AAgDtC,QAAA,CAAA,EAAA,GAAI,OAAO,CAAC,OAAZ,MAAmB,IAAnB,IAAmB,EAAA,KAAA,KAAA,CAAnB,GAAmB,KAAA,CAAnB,GAAmB,EAAA,CAAE,MAArB,EAA6B;AAC3B,MAAA,QAAQ,CAAC,QAAT,CACG,IADH,CACQ,gCADR,EAEG,IAFH,CAEO,UAAE,KAAF,EAAS,MAAT,EAAe;AAClB,QAAA,CAAC,CAAC,MAAD,CAAD,CAAU,EAAV,CAAa,OAAb,EAAoB,YAAA;AAClB,UAAA,OAAO,CAAC,OAAR,CAAiB,KAAjB,EAAwB,OAAxB,CAAiC,QAAjC;;AAEA,cAAI,OAAO,CAAC,OAAR,CAAiB,KAAjB,EAAwB,KAA5B,EAAmC;AACjC,YAAA,QAAQ,CAAC,KAAT;AACD;AACF,SAND;AAOD,OAVH;AAWD,KA5DqC,C;;;AA+DtC,IAAA,QAAQ,CAAC,QAAT,CACG,EADH,CACM,kBADN,EACwB,YAAA;AACpB,MAAA,OAAO,CAAC,MAAR,CAAgB,QAAhB;AACD,KAHH,EAIG,EAJH,CAIM,oBAJN,EAI0B,YAAA;AACtB,MAAA,OAAO,CAAC,QAAR,CAAkB,QAAlB;AACD,KANH,EAOG,EAPH,CAOM,mBAPN,EAOyB,YAAA;AACrB,MAAA,OAAO,CAAC,OAAR,CAAiB,QAAjB;AACD,KATH,EAUG,EAVH,CAUM,oBAVN,EAU0B,YAAA;AACtB,MAAA,OAAO,CAAC,QAAR,CAAkB,QAAlB;AACD,KAZH;AAcA,IAAA,QAAQ,CAAC,IAAT;AAEA,WAAO,QAAP;AACD,GAhFD;;AChFAA,MAAMM,iBAAe,GAAY;AAC/B,IAAA,WAAW,EAAE,IADkB;AAE/B,IAAA,OAAO,EAAE,IAFsB;AAG/B,IAAA,KAAK,EAAE,KAHwB;AAI/B,IAAA,UAAU,EAAE,IAJmB;AAK/B,IAAA,cAAc,EAAE;AALe,GAAjCN;;AAQA,EAAA,IAAI,CAAC,KAAL,GAAa,UACX,IADW,EAEX,KAFW,EAGX,SAHW,EAIX,OAJW,EAIE;AAEb,QAAI,UAAU,CAAC,KAAD,CAAd,EAAuB;AACrB,MAAA,OAAO,GAAG,SAAV;AACA,MAAA,SAAS,GAAG,KAAZ;AACA,MAAA,KAAK,GAAG,EAAR;AACD;;AAED,QAAI,WAAW,CAAC,SAAD,CAAf,EAA4B;;AAE1B,MAAA,SAAS,GAAA,YAAA,CAAiB,CAA1B;AACD;;AAED,QAAI,WAAW,CAAC,OAAD,CAAf,EAA0B;AACxB,MAAA,OAAO,GAAG,EAAV;AACD;;AAED,IAAA,OAAO,GAAG,MAAM,CAAC,EAAD,EAAKM,iBAAL,EAAsB,OAAtB,CAAhB;AAEA,WAAO,IAAI,CAAC,MAAL,CAAY;AACjB,MAAA,KAAK,EAAE,KADU;AAEjB,MAAA,OAAO,EAAE,IAFQ;AAGjB,MAAA,OAAO,EAAE,CACP;AACE,QAAA,IAAI,EAAE,OAAO,CAAC,WADhB;AAEE,QAAA,IAAI,EAAE,KAFR;AAGE,QAAA,KAAK,EAAE,OAAO,CAAC,cAHjB;AAIE,QAAA,OAAO,EAAE;AAJX,OADO,CAHQ;AAWjB,MAAA,QAAQ,EAAE,mBAXO;AAYjB,MAAA,OAAO,EAAE,OAAO,CAAC,OAZA;AAajB,MAAA,KAAK,EAAE,OAAO,CAAC,KAbE;AAcjB,MAAA,UAAU,EAAE,OAAO,CAAC;AAdH,KAAZ,CAAP;AAgBD,GAvCD;;ACMAN,MAAMM,iBAAe,GAAY;AAC/B,IAAA,WAAW,EAAE,IADkB;AAE/B,IAAA,UAAU,EAAE,QAFmB;AAG/B,IAAA,OAAO,EAAE,IAHsB;AAI/B,IAAA,KAAK,EAAE,KAJwB;AAK/B,IAAA,UAAU,EAAE,IALmB;AAM/B,IAAA,aAAa,EAAE,IANgB;AAO/B,IAAA,cAAc,EAAE;AAPe,GAAjCN;;AAUA,EAAA,IAAI,CAAC,OAAL,GAAe,UACb,IADa,EAEb,KAFa,EAGb,SAHa,EAIb,QAJa,EAKb,OALa,EAKA;AAEb,QAAI,UAAU,CAAC,KAAD,CAAd,EAAuB;AACrB,MAAA,OAAO,GAAG,QAAV;AACA,MAAA,QAAQ,GAAG,SAAX;AACA,MAAA,SAAS,GAAG,KAAZ;AACA,MAAA,KAAK,GAAG,EAAR;AACD;;AAED,QAAI,WAAW,CAAC,SAAD,CAAf,EAA4B;;AAE1B,MAAA,SAAS,GAAA,YAAA,CAAiB,CAA1B;AACD;;AAED,QAAI,WAAW,CAAC,QAAD,CAAf,EAA2B;;AAEzB,MAAA,QAAQ,GAAA,YAAA,CAAiB,CAAzB;AACD;;AAED,QAAI,WAAW,CAAC,OAAD,CAAf,EAA0B;AACxB,MAAA,OAAO,GAAG,EAAV;AACD;;AAED,IAAA,OAAO,GAAG,MAAM,CAAC,EAAD,EAAKM,iBAAL,EAAsB,OAAtB,CAAhB;AAEA,WAAO,IAAI,CAAC,MAAL,CAAY;AACjB,MAAA,KAAK,EAAE,KADU;AAEjB,MAAA,OAAO,EAAE,IAFQ;AAGjB,MAAA,OAAO,EAAE,CACP;AACE,QAAA,IAAI,EAAE,OAAO,CAAC,UADhB;AAEE,QAAA,IAAI,EAAE,KAFR;AAGE,QAAA,KAAK,EAAE,OAAO,CAAC,aAHjB;AAIE,QAAA,OAAO,EAAE;AAJX,OADO,EAOP;AACE,QAAA,IAAI,EAAE,OAAO,CAAC,WADhB;AAEE,QAAA,IAAI,EAAE,KAFR;AAGE,QAAA,KAAK,EAAE,OAAO,CAAC,cAHjB;AAIE,QAAA,OAAO,EAAE;AAJX,OAPO,CAHQ;AAiBjB,MAAA,QAAQ,EAAE,qBAjBO;AAkBjB,MAAA,OAAO,EAAE,OAAO,CAAC,OAlBA;AAmBjB,MAAA,KAAK,EAAE,OAAO,CAAC,KAnBE;AAoBjB,MAAA,UAAU,EAAE,OAAO,CAAC;AApBH,KAAZ,CAAP;AAsBD,GApDD;;ACcAN,MAAMM,iBAAe,GAAY;AAC/B,IAAA,WAAW,EAAE,IADkB;AAE/B,IAAA,UAAU,EAAE,QAFmB;AAG/B,IAAA,OAAO,EAAE,IAHsB;AAI/B,IAAA,KAAK,EAAE,KAJwB;AAK/B,IAAA,UAAU,EAAE,IALmB;AAM/B,IAAA,aAAa,EAAE,IANgB;AAO/B,IAAA,cAAc,EAAE,IAPe;AAQ/B,IAAA,IAAI,EAAE,MARyB;AAS/B,IAAA,SAAS,EAAE,CAToB;AAU/B,IAAA,YAAY,EAAE,EAViB;AAW/B,IAAA,cAAc,EAAE;AAXe,GAAjCN;;AAcA,EAAA,IAAI,CAAC,MAAL,GAAc,UACZ,KADY,EAEZ,KAFY,EAGZ,SAHY,EAIZ,QAJY,EAKZ,OALY,EAKC;AAEb,QAAI,UAAU,CAAC,KAAD,CAAd,EAAuB;AACrB,MAAA,OAAO,GAAG,QAAV;AACA,MAAA,QAAQ,GAAG,SAAX;AACA,MAAA,SAAS,GAAG,KAAZ;AACA,MAAA,KAAK,GAAG,EAAR;AACD;;AAED,QAAI,WAAW,CAAC,SAAD,CAAf,EAA4B;;AAE1B,MAAA,SAAS,GAAA,YAAA,CAAiB,CAA1B;AACD;;AAED,QAAI,WAAW,CAAC,QAAD,CAAf,EAA2B;;AAEzB,MAAA,QAAQ,GAAA,YAAA,CAAiB,CAAzB;AACD;;AAED,QAAI,WAAW,CAAC,OAAD,CAAf,EAA0B;AACxB,MAAA,OAAO,GAAG,EAAV;AACD;;AAED,IAAA,OAAO,GAAG,MAAM,CAAC,EAAD,EAAKM,iBAAL,EAAsB,OAAtB,CAAhB;AAEAN,QAAM,OAAO,GACX,kCACC,KAAK,GAAA,2CAA0C,KAA1C,GAA+C,UAA/C,GAA4D,EADlE,KAEC,OAAO,CAAC,IAAR,KAAiB,MAAjB,G,iEAEK,OAAO,CAAC,Y,GACV,K,IACE,OAAO,CAAC,SAAR,GAAoB,gBAAgB,OAAO,CAAC,SAAxB,GAAoC,GAAxD,GAA8D,E,IAChE,IALH,GAMG,EARJ,KASC,OAAO,CAAC,IAAR,KAAiB,UAAjB,G,+CAEK,OAAO,CAAC,SAAR,GAAoB,gBAAgB,OAAO,CAAC,SAAxB,GAAoC,GAAxD,GAA8D,E,IAChE,G,GAAI,OAAO,CAAC,Y,GAAY,aAH3B,GAIG,EAbJ,IAcA,QAfFA;;AAiBAA,QAAM,aAAa,GAAA,UAAI,MAAJ,EAAkB;AACnCA,UAAM,KAAK,GAAG,MAAM,CAAC,QAAP,CAAgB,IAAhB,CAAqB,uBAArB,EAA8C,GAA9C,EAAdA;AACA,MAAA,QAAQ,CAAC,KAAD,EAAQ,MAAR,CAAR;AACD,KAHDA;;AAKAA,QAAM,cAAc,GAAA,UAAI,MAAJ,EAAkB;AACpCA,UAAM,KAAK,GAAG,MAAM,CAAC,QAAP,CAAgB,IAAhB,CAAqB,uBAArB,EAA8C,GAA9C,EAAdA;AACA,MAAA,SAAS,CAAC,KAAD,EAAQ,MAAR,CAAT;AACD,KAHDA;;AAKA,WAAO,IAAI,CAAC,MAAL,CAAY;aACjB,KADiB;eAEjB,OAFiB;AAGjB,MAAA,OAAO,EAAE,CACP;AACE,QAAA,IAAI,EAAE,OAAO,CAAC,UADhB;AAEE,QAAA,IAAI,EAAE,KAFR;AAGE,QAAA,KAAK,EAAE,OAAO,CAAC,aAHjB;AAIE,QAAA,OAAO,EAAE;AAJX,OADO,EAOP;AACE,QAAA,IAAI,EAAE,OAAO,CAAC,WADhB;AAEE,QAAA,IAAI,EAAE,KAFR;AAGE,QAAA,KAAK,EAAE,OAAO,CAAC,cAHjB;AAIE,QAAA,OAAO,EAAE;AAJX,OAPO,CAHQ;AAiBjB,MAAA,QAAQ,EAAE,oBAjBO;AAkBjB,MAAA,OAAO,EAAE,OAAO,CAAC,OAlBA;AAmBjB,MAAA,KAAK,EAAE,OAAO,CAAC,KAnBE;AAoBjB,MAAA,UAAU,EAAE,OAAO,CAAC,UApBH;AAqBjB,MAAA,MAAM,EAAA,UAAG,MAAH,EAAS;;AAEbA,YAAM,MAAM,GAAG,MAAM,CAAC,QAAP,CAAgB,IAAhB,CAAqB,uBAArB,CAAfA;AACA,QAAA,IAAI,CAAC,gBAAL,CAAsB,MAAtB,EAHa,C;;AAMb,QAAA,MAAM,CAAC,CAAD,CAAN,CAAU,KAAV,GANa,C;;AASb,YAAI,OAAO,CAAC,IAAR,KAAiB,UAAjB,IAA+B,OAAO,CAAC,cAAR,KAA2B,IAA9D,EAAoE;AAClE,UAAA,MAAM,CAAC,EAAP,CAAU,SAAV,EAAmB,UAAG,KAAH,EAAQ;AACzB,gBAAK,KAAuB,CAAC,OAAxB,KAAoC,EAAzC,EAA6C;AAC3CA,kBAAM,KAAK,GAAG,MAAM,CAAC,QAAP,CAAgB,IAAhB,CAAqB,uBAArB,EAA8C,GAA9C,EAAdA;AACA,cAAA,SAAS,CAAC,KAAD,EAAQ,MAAR,CAAT;;AAEA,kBAAI,OAAO,CAAC,cAAZ,EAA4B;AAC1B,gBAAA,MAAM,CAAC,KAAP;AACD;;AAED,qBAAO,KAAP;AACD;;AAED;AACD,WAbD;AAcD,SAxBY,C;;;AA2Bb,YAAI,OAAO,CAAC,IAAR,KAAiB,UAArB,EAAiC;AAC/B,UAAA,MAAM,CAAC,EAAP,CAAU,OAAV,EAAiB,YAAA;AAAA,mBAAQ,MAAM,CAAC,YAAP,EAAR;AAA6B,WAA9C;AACD,SA7BY,C;;;AAgCb,YAAI,OAAO,CAAC,SAAZ,EAAuB;AACrB,UAAA,MAAM,CAAC,YAAP;AACD;AACF;AAxDgB,KAAZ,CAAP;AA0DD,GAnHD;;AC9CAA,MAAMM,iBAAe,GAAY;AAC/B,IAAA,QAAQ,EAAE,MADqB;AAE/B,IAAA,KAAK,EAAE,CAFwB;AAG/B,IAAA,OAAO,EAAE;AAHsB,GAAjCN;;AAMA,MAAM,OAAO,GA0BX,SAAA,OAAA,CACE,QADF,EAEE,OAFF,EAEuB;sCAAF,E;;;;;AAdd,SAAA,OAAA,GAAmB,MAAM,CAAC,EAAD,EAAKM,iBAAL,CAAzB;;;;;AAKC,SAAA,KAAA,GAAe,QAAf;;;;;AAKA,SAAA,SAAA,GAAiB,IAAjB;AAMN,SAAK,OAAL,GAAe,CAAC,CAAC,QAAD,CAAD,CAAY,KAAZ,EAAf;AAEA,IAAA,MAAM,CAAC,KAAK,OAAN,EAAe,OAAf,CAAN,CAJqB,C;;AAOrB,SAAK,QAAL,GAAgB,CAAC,CAAA,sCACkB,CAAC,CAAC,IAAF,EADlB,GAC0B,KAD1B,GAEb,KAAK,OAAL,CAAa,OAFA,GAGf,QAHe,CAAD,CAId,QAJc,CAIL,QAAQ,CAAC,IAJJ,CAAhB,CAPqB,C;;;AAerBN,QAAM,IAAI,GAAG,IAAbA;AACA,SAAK,OAAL,CACG,EADH,CACM,uBADN,EAC+B,UAAU,KAAV,EAAe;AAC1C,UAAI,IAAI,CAAC,UAAL,CAAgB,IAAhB,CAAJ,EAA0C;AACxC;AACD;;AAED,UAAI,CAAC,OAAO,CAAC,KAAD,CAAZ,EAAqB;AACnB;AACD;;AAED,MAAA,QAAQ,CAAC,KAAD,CAAR;AAEA,MAAA,IAAI,CAAC,IAAL;AACD,KAbH,EAcG,EAdH,CAcM,qBAdN,EAc6B,UAAU,KAAV,EAAe;AACxC,UAAI,IAAI,CAAC,UAAL,CAAgB,IAAhB,CAAJ,EAA0C;AACxC;AACD;;AAED,UAAI,CAAC,OAAO,CAAC,KAAD,CAAZ,EAAqB;AACnB;AACD;;AAED,MAAA,IAAI,CAAC,KAAL;AACD,KAxBH,EAyBG,EAzBH,CAyBM,WAzBN,EAyBmB,UAAU,KAAV,EAAe;AAC9B,UAAI,IAAI,CAAC,UAAL,CAAgB,IAAhB,CAAJ,EAA0C;AACxC;AACD;;AAED,MAAA,QAAQ,CAAC,KAAD,CAAR;AACD,KA/BH;AAgCF,GA5EF;AA8EE;;;;;;oBAIQ,U,GAAA,SAAA,UAAA,CAAW,OAAX,EAA+B;AACrC,WACG,OAA4B,CAAC,QAA7B,IACD,CAAC,CAAC,OAAD,CAAD,CAAW,IAAX,CAAgB,UAAhB,MAAgC,SAFlC;AAIF,G;AAEA;;;;;oBAGQ,S,GAAA,SAAA,SAAA,GAAA;AACN,WAAO,OAAO,CAAC,KAAR,KAAkB,IAAzB;AACF,G;AAEA;;;;;oBAGQ,W,GAAA,SAAA,WAAA,GAAA;AACNC,QAAI,UAAJA;AACAA,QAAI,SAAJA,CAFM,C;;AAKND,QAAM,WAAW,GAAG,KAAK,OAAL,CAAa,CAAb,EAAgB,qBAAhB,EAApBA,CALM,C;;AAQNA,QAAM,YAAY,GAAG,KAAK,SAAL,KAAmB,EAAnB,GAAwB,EAA7CA,CARM,C;;AAWNA,QAAM,YAAY,GAAG,KAAK,QAAL,CAAc,CAAd,EAAiB,WAAtCA;AACAA,QAAM,aAAa,GAAG,KAAK,QAAL,CAAc,CAAd,EAAiB,YAAvCA,CAZM,C;;AAeNC,QAAI,QAAQ,GAAa,KAAK,OAAL,CAAa,QAAtCA,CAfM,C;;AAkBN,QAAI,QAAQ,KAAK,MAAjB,EAAyB;AACvB,UACE,WAAW,CAAC,GAAZ,GACE,WAAW,CAAC,MADd,GAEE,YAFF,GAGE,aAHF,GAIE,CAJF,GAKA,OAAO,CAAC,MAAR,EANF,EAOE;AACA,QAAA,QAAQ,GAAG,QAAX;AACD,OATD,MASO,IAAI,YAAY,GAAG,aAAf,GAA+B,CAA/B,GAAmC,WAAW,CAAC,GAAnD,EAAwD;AAC7D,QAAA,QAAQ,GAAG,KAAX;AACD,OAFM,MAEA,IAAI,YAAY,GAAG,YAAf,GAA8B,CAA9B,GAAkC,WAAW,CAAC,IAAlD,EAAwD;AAC7D,QAAA,QAAQ,GAAG,MAAX;AACD,OAFM,MAEA,IACL,WAAW,CAAC,KAAZ,GAAoB,YAApB,GAAmC,YAAnC,GAAkD,CAAlD,GACA,OAAO,CAAC,KAAR,KAAkB,WAAW,CAAC,IAFzB,EAGL;AACA,QAAA,QAAQ,GAAG,OAAX;AACD,OALM,MAKA;AACL,QAAA,QAAQ,GAAG,QAAX;AACD;AACF,KAxCK,C;;;AA2CN,YAAQ,QAAR;AACE,WAAK,QAAL;AACE,QAAA,UAAU,GAAG,CAAC,CAAD,IAAM,YAAY,GAAG,CAArB,CAAb;AACA,QAAA,SAAS,GAAG,WAAW,CAAC,MAAZ,GAAqB,CAArB,GAAyB,YAArC;AACA,aAAK,QAAL,CAAc,eAAd,CAA8B,YAA9B;AACA;;AAEF,WAAK,KAAL;AACE,QAAA,UAAU,GAAG,CAAC,CAAD,IAAM,YAAY,GAAG,CAArB,CAAb;AACA,QAAA,SAAS,GACP,CAAC,CAAD,IAAM,aAAa,GAAG,WAAW,CAAC,MAAZ,GAAqB,CAArC,GAAyC,YAA/C,CADF;AAEA,aAAK,QAAL,CAAc,eAAd,CAA8B,eAA9B;AACA;;AAEF,WAAK,MAAL;AACE,QAAA,UAAU,GAAG,CAAC,CAAD,IAAM,YAAY,GAAG,WAAW,CAAC,KAAZ,GAAoB,CAAnC,GAAuC,YAA7C,CAAb;AACA,QAAA,SAAS,GAAG,CAAC,CAAD,IAAM,aAAa,GAAG,CAAtB,CAAZ;AACA,aAAK,QAAL,CAAc,eAAd,CAA8B,cAA9B;AACA;;AAEF,WAAK,OAAL;AACE,QAAA,UAAU,GAAG,WAAW,CAAC,KAAZ,GAAoB,CAApB,GAAwB,YAArC;AACA,QAAA,SAAS,GAAG,CAAC,CAAD,IAAM,aAAa,GAAG,CAAtB,CAAZ;AACA,aAAK,QAAL,CAAc,eAAd,CAA8B,aAA9B;AACA;AAxBJ;;AA2BAD,QAAM,YAAY,GAAG,KAAK,OAAL,CAAa,MAAb,EAArBA;AAEA,SAAK,QAAL,CAAc,GAAd,CAAkB;AAChB,MAAA,GAAG,EAAK,YAAY,CAAC,GAAb,GAAmB,WAAW,CAAC,MAAZ,GAAqB,CAA7C,GAA6C,IADhC;AAEhB,MAAA,IAAI,EAAK,YAAY,CAAC,IAAb,GAAoB,WAAW,CAAC,KAAZ,GAAoB,CAA7C,GAA6C,IAFjC;AAGhB,qBAAkB,UAAU,GAAA,IAHZ;AAIhB,oBAAiB,SAAS,GAAA;AAJV,KAAlB;AAMF,G;AAEA;;;;;;oBAIQ,Y,GAAA,SAAA,YAAA,CAAa,IAAb,EAAwB;AAC9B,IAAA,cAAc,CAAC,IAAD,EAAO,SAAP,EAAkB,KAAK,OAAvB,EAAgC,IAAhC,CAAd;AACF,G;AAEA;;;;;oBAGQ,a,GAAA,SAAA,aAAA,GAAA;AACN,QAAI,KAAK,QAAL,CAAc,QAAd,CAAuB,mBAAvB,CAAJ,EAAiD;AAC/C,WAAK,KAAL,GAAa,QAAb;AACA,WAAK,YAAL,CAAkB,QAAlB;AACD,KAHD,MAGO;AACL,WAAK,KAAL,GAAa,QAAb;AACA,WAAK,YAAL,CAAkB,QAAlB;AACD;AACH,G;AAEA;;;;;oBAGQ,M,GAAA,SAAA,MAAA,GAAA;AACN,WAAO,KAAK,KAAL,KAAe,SAAf,IAA4B,KAAK,KAAL,KAAe,QAAlD;AACF,G;AAEA;;;;;oBAGQ,M,GAAA,SAAA,MAAA,GAAA;;AACN,SAAK,KAAL,GAAa,SAAb;AACA,SAAK,YAAL,CAAkB,MAAlB;AAEA,SAAK,QAAL,CACG,QADH,CACY,mBADZ,EAEG,aAFH,CAEgB,YAAA;AAAA,aAAOG,MAAI,CAAC,aAALA,EAAP;AAA2B,KAF3C;AAGF,G;AAEA;;;;;;oBAIO,I,GAAA,SAAA,IAAA,CAAK,OAAL,EAAsB;;;AAC3B,QAAI,KAAK,MAAL,EAAJ,EAAmB;AACjB;AACD;;AAEDH,QAAM,UAAU,GAAG,MAAM,CAAC,EAAD,EAAK,KAAK,OAAV,CAAzBA;;AAEA,QAAI,OAAJ,EAAa;AACX,MAAA,MAAM,CAAC,KAAK,OAAN,EAAe,OAAf,CAAN;AACD,KAT0B,C;;;AAY3B,QAAI,UAAU,CAAC,OAAX,KAAuB,KAAK,OAAL,CAAa,OAAxC,EAAiD;AAC/C,WAAK,QAAL,CAAc,IAAd,CAAmB,KAAK,OAAL,CAAa,OAAhC;AACD;;AAED,SAAK,WAAL;;AAEA,QAAI,KAAK,OAAL,CAAa,KAAjB,EAAwB;AACtB,WAAK,SAAL,GAAiB,UAAU,CAAA,YAAA;AAAA,eAAOG,MAAI,CAAC,MAALA,EAAP;AAAoB,OAApB,EAAsB,KAAK,OAAL,CAAa,KAAnC,CAA3B;AACD,KAFD,MAEO;AACL,WAAK,SAAL,GAAiB,IAAjB;AACA,WAAK,MAAL;AACD;AACH,G;AAEA;;;;;oBAGO,K,GAAA,SAAA,KAAA,GAAA;;;AACL,QAAI,KAAK,SAAT,EAAoB;AAClB,MAAA,YAAY,CAAC,KAAK,SAAN,CAAZ;AACA,WAAK,SAAL,GAAiB,IAAjB;AACD;;AAED,QAAI,CAAC,KAAK,MAAL,EAAL,EAAoB;AAClB;AACD;;AAED,SAAK,KAAL,GAAa,SAAb;AACA,SAAK,YAAL,CAAkB,OAAlB;AAEA,SAAK,QAAL,CACG,WADH,CACe,mBADf,EAEG,aAFH,CAEgB,YAAA;AAAA,aAAOA,MAAI,CAAC,aAALA,EAAP;AAA2B,KAF3C;AAGF,G;AAEA;;;;;oBAGO,M,GAAA,SAAA,MAAA,GAAA;AACL,SAAK,MAAL,KAAgB,KAAK,KAAL,EAAhB,GAA+B,KAAK,IAAL,EAA/B;AACF,G;AAEA;;;;;oBAGO,Q,GAAA,SAAA,QAAA,GAAA;AACL,WAAO,KAAK,KAAZ;AACF,G;;AAGF,EAAA,IAAI,CAAC,OAAL,GAAe,OAAf;AChWAH,MAAMO,YAAU,GAAG,cAAnBP;AACAA,MAAMQ,UAAQ,GAAG,eAAjBR;AAEA,EAAA,CAAC,CAAA,YAAA;;AAEC,IAAA,SAAS,CAAC,EAAV,CAAa,sBAAb,EAAmC,MAAMO,YAAN,GAAgB,GAAnD,EAAwD,YAAA;AACtDP,UAAM,OAAO,GAAG,CAAC,CAAC,IAAD,CAAjBA;AACAC,UAAI,QAAQ,GAAG,OAAO,CAAC,IAAR,CAAaO,UAAb,CAAfP;;AAEA,UAAI,CAAC,QAAL,EAAe;AACb,QAAA,QAAQ,GAAG,IAAI,IAAI,CAAC,OAAT,CACT,IADS,EAET,YAAY,CAAC,IAAD,EAAsBM,YAAtB,CAFH,CAAX;AAIA,QAAA,OAAO,CAAC,IAAR,CAAaC,UAAb,EAAuB,QAAvB;AACD;AACF,KAXD;AAYD,GAdA,CAAD;AC4GAR,MAAMM,iBAAe,GAAY;AAC/B,IAAA,OAAO,EAAE,EADsB;AAE/B,IAAA,OAAO,EAAE,IAFsB;AAG/B,IAAA,QAAQ,EAAE,QAHqB;AAI/B,IAAA,UAAU,EAAE,EAJmB;AAK/B,IAAA,WAAW,EAAE,EALkB;AAM/B,IAAA,kBAAkB,EAAE,IANW;AAO/B,IAAA,mBAAmB,EAAE,IAPU;;AAS/B,IAAA,OAAO,EAAA,YAAA,CAAU,CATc;;AAW/B,IAAA,aAAa,EAAA,YAAA,CAAU,CAXQ;;AAa/B,IAAA,MAAM,EAAA,YAAA,CAAU,CAbe;;AAe/B,IAAA,QAAQ,EAAA,YAAA,CAAU,CAfa;;AAiB/B,IAAA,OAAO,EAAA,YAAA,CAAU,CAjBc;;AAmB/B,IAAA,QAAQ,EAAA,YAAA,CAAU;AAnBa,GAAjCN;AAsBA;;;;AAGAC,MAAIQ,aAAW,GAAoB,IAAnCR;AAEA;;;;AAGAD,MAAMU,WAAS,GAAG,gBAAlBV;;AAEA,MAAM,QAAQ,GAoBZ,SAAA,QAAA,CAAmB,OAAnB,EAAmC;;;;AAZ5B,SAAA,OAAA,GAAmB,MAAM,CAAC,EAAD,EAAKM,iBAAL,CAAzB;;;;;AAKC,SAAA,KAAA,GAAe,QAAf;;;;;AAKA,SAAA,SAAA,GAAiB,IAAjB;AAGN,IAAA,MAAM,CAAC,KAAK,OAAN,EAAe,OAAf,CAAN,CADiC,C;;AAIjCL,QAAI,gBAAgB,GAAG,EAAvBA;AACAA,QAAI,gBAAgB,GAAG,EAAvBA;;AAEA,QACE,KAAK,OAAL,CAAa,WAAb,CAA0B,OAA1B,CAAkC,GAAlC,MAA2C,CAA3C,IACA,KAAK,OAAL,CAAa,WAAb,CAA0B,OAA1B,CAAkC,KAAlC,MAA6C,CAF/C,EAGE;AACA,MAAA,gBAAgB,GAAG,mBAAgB,KAAK,OAAL,CAAa,WAA7B,GAAwC,IAA3D;AACD,KALD,MAKO,IAAI,KAAK,OAAL,CAAa,WAAb,KAA6B,EAAjC,EAAqC;AAC1C,MAAA,gBAAgB,GAAG,qBAAmB,KAAK,OAAL,CAAa,WAAnD;AACD,KAdgC,C;;;AAiBjC,SAAK,QAAL,GAAgB,CAAC,CACf,gCACE,oCADF,GACqC,KAAK,OAAL,CAAa,OADlD,GACyD,QADzD,IAEG,KAAK,OAAL,CAAa,UAAb,G,wGACsG,gB,GAAgB,K,GAAK,gB,GAAgB,G,GAAI,KAAK,OAAL,CAAa,U,GAAU,MADtK,GAEG,EAJN,IAKE,QANa,CAAD,CAOd,QAPc,CAOL,QAAQ,CAAC,IAPJ,CAAhB,CAjBiC,C;;AA2BjC,SAAK,WAAL,CAAiB,OAAjB;AAEA,SAAK,QAAL,CAAc,MAAd,GAAuB,QAAvB,CAA+B,mBAAkB,KAAK,OAAL,CAAa,QAA9D;AACF,GAlDF;AAoDE;;;;;;qBAIQ,mB,GAAA,SAAA,mBAAA,CAAoB,KAApB,EAAgC;AACtCD,QAAM,OAAO,GAAG,CAAC,CAAC,KAAK,CAAC,MAAP,CAAjBA;;AAEA,QACE,CAAC,OAAO,CAAC,QAAR,CAAiB,eAAjB,CAAD,IACA,CAAC,OAAO,CAAC,OAAR,CAAgB,gBAAhB,EAAkC,MAFrC,EAGE;AACAS,MAAAA,aAAY,CAAC,KAAbA;AACD;AACH,G;AAEA;;;;;;qBAIQ,W,GAAA,SAAA,WAAA,CAAY,KAAZ,EAAmC;AACzCT,QAAM,cAAc,GAAG,KAAK,QAAL,CAAc,CAAd,EAAiB,YAAxCA;AACAA,QAAM,QAAQ,GAAG,KAAK,OAAL,CAAa,QAA9BA;AAEAC,QAAI,UAAJA;AACAA,QAAI,UAAJA,CALyC,C;;AAQzC,QAAI,QAAQ,KAAK,QAAb,IAAyB,QAAQ,KAAK,KAA1C,EAAiD;AAC/C,MAAA,UAAU,GAAG,MAAb;AACD,KAFD,MAEO;AACL,MAAA,UAAU,GAAG,GAAb;AACD,KAZwC,C;;;AAezC,QAAI,KAAK,KAAK,MAAd,EAAsB;AACpB,MAAA,UAAU,GAAG,GAAb;AACD,KAFD,MAEO;AACL,UAAI,QAAQ,KAAK,QAAjB,EAA2B;AACzB,QAAA,UAAU,GAAG,cAAb;AACD;;AAED,UAAI,QAAQ,KAAK,KAAjB,EAAwB;AACtB,QAAA,UAAU,GAAG,CAAC,cAAd;AACD;;AAED,UAAI,QAAQ,KAAK,UAAb,IAA2B,QAAQ,KAAK,WAA5C,EAAyD;AACvD,QAAA,UAAU,GAAG,CAAC,cAAD,GAAkB,EAA/B;AACD;;AAED,UAAI,QAAQ,KAAK,aAAb,IAA8B,QAAQ,KAAK,cAA/C,EAA+D;AAC7D,QAAA,UAAU,GAAG,cAAc,GAAG,EAA9B;AACD;AACF;;AAED,SAAK,QAAL,CAAc,SAAd,CAAuB,eAAc,UAAd,GAAwB,GAAxB,GAA4B,UAA5B,GAAsC,IAA7D;AACF,G;AAEA;;;;;qBAGO,I,GAAA,SAAA,IAAA,GAAA;;;AACL,QAAI,KAAK,KAAL,KAAe,SAAf,IAA4B,KAAK,KAAL,KAAe,QAA/C,EAAyD;AACvD;AACD,KAHI,C;;;AAML,QAAIQ,aAAJ,EAAiB;AACf,MAAA,KAAK,CAACC,WAAD,EAAU,YAAA;AAAA,eAAQP,MAAI,CAAC,IAALA,EAAR;AAAmB,OAA7B,CAAL;AACA;AACD;;AAEDM,IAAAA,aAAW,GAAG,IAAdA,CAXK,C;;AAcL,SAAK,KAAL,GAAa,SAAb;AACA,SAAK,OAAL,CAAa,MAAb,CAAqB,IAArB;AAEA,SAAK,WAAL,CAAiB,MAAjB;AAEA,SAAK,QAAL,CAAc,aAAd,CAA2B,YAAA;AACzB,UAAIN,MAAI,CAAC,KAALA,KAAe,SAAnB,EAA8B;AAC5B;AACD;;AAEDA,MAAAA,MAAI,CAAC,KAALA,GAAa,QAAbA;AACAA,MAAAA,MAAI,CAAC,OAALA,CAAa,QAAbA,CAAuBA,MAAvBA,EANyB,C;;AASzB,UAAIA,MAAI,CAAC,OAALA,CAAa,UAAjB,EAA6B;AAC3BA,QAAAA,MAAI,CAAC,QAALA,CAAc,IAAdA,CAAmB,uBAAnBA,EAA4C,EAA5CA,CAA+C,OAA/CA,EAAsD,YAAA;AACpDA,UAAAA,MAAI,CAAC,OAALA,CAAa,aAAbA,CAA4BA,MAA5BA;;AACA,cAAIA,MAAI,CAAC,OAALA,CAAa,kBAAjB,EAAqC;AACnCA,YAAAA,MAAI,CAAC,KAALA;AACD;AACF,SALDA;AAMD,OAhBwB,C;;;AAmBzBA,MAAAA,MAAI,CAAC,QAALA,CAAc,EAAdA,CAAiB,OAAjBA,EAAwB,UAAG,KAAH,EAAQ;AAC9B,YAAI,CAAC,CAAC,CAAC,KAAK,CAAC,MAAP,CAAD,CAA+B,QAA/B,CAAwC,sBAAxC,CAAL,EAAsE;AACpEA,UAAAA,MAAI,CAAC,OAALA,CAAa,OAAbA,CAAsBA,MAAtBA;AACD;AACF,OAJDA,EAnByB,C;;AA0BzB,UAAIA,MAAI,CAAC,OAALA,CAAa,mBAAjB,EAAsC;AACpC,QAAA,SAAS,CAAC,EAAV,CAAa,UAAb,EAAyBA,MAAI,CAAC,mBAA9B;AACD,OA5BwB,C;;;AA+BzB,UAAIA,MAAI,CAAC,OAALA,CAAa,OAAjB,EAA0B;AACxBA,QAAAA,MAAI,CAAC,SAALA,GAAiB,UAAU,CAAA,YAAA;AAAA,iBAAOA,MAAI,CAAC,KAALA,EAAP;AAAmB,SAAnB,EAAqBA,MAAI,CAAC,OAALA,CAAa,OAAlC,CAA3BA;AACD;AACF,KAlCD;AAmCF,G;AAEA;;;;;qBAGO,K,GAAA,SAAA,KAAA,GAAA;;;AACL,QAAI,KAAK,KAAL,KAAe,SAAf,IAA4B,KAAK,KAAL,KAAe,QAA/C,EAAyD;AACvD;AACD;;AAED,QAAI,KAAK,SAAT,EAAoB;AAClB,MAAA,YAAY,CAAC,KAAK,SAAN,CAAZ;AACD;;AAED,QAAI,KAAK,OAAL,CAAa,mBAAjB,EAAsC;AACpC,MAAA,SAAS,CAAC,GAAV,CAAc,UAAd,EAA0B,KAAK,mBAA/B;AACD;;AAED,SAAK,KAAL,GAAa,SAAb;AACA,SAAK,OAAL,CAAa,OAAb,CAAsB,IAAtB;AAEA,SAAK,WAAL,CAAiB,OAAjB;AAEA,SAAK,QAAL,CAAc,aAAd,CAA2B,YAAA;AACzB,UAAIA,MAAI,CAAC,KAALA,KAAe,SAAnB,EAA8B;AAC5B;AACD;;AAEDM,MAAAA,aAAW,GAAG,IAAdA;AACAN,MAAAA,MAAI,CAAC,KAALA,GAAa,QAAbA;AACAA,MAAAA,MAAI,CAAC,OAALA,CAAa,QAAbA,CAAuBA,MAAvBA;AACAA,MAAAA,MAAI,CAAC,QAALA,CAAc,MAAdA;AACA,MAAA,OAAO,CAACO,WAAD,CAAP;AACD,KAVD;AAWF,G;;AAGF,EAAA,IAAI,CAAC,QAAL,GAAgB,UAAU,OAAV,EAAwB,OAAxB,EAAyC;sCAAF,E;;AACrD,QAAI,QAAQ,CAAC,OAAD,CAAZ,EAAuB;AACrB,MAAA,OAAO,CAAC,OAAR,GAAkB,OAAlB;AACD,KAFD,MAEO;AACL,MAAA,OAAO,GAAG,OAAV;AACD;;AAEDV,QAAM,QAAQ,GAAG,IAAI,QAAJ,CAAa,OAAb,CAAjBA;AAEA,IAAA,QAAQ,CAAC,IAAT;AAEA,WAAO,QAAP;AACD,GAZD;;ACpVA,EAAA,CAAC,CAAA,YAAA;;AAEC,IAAA,SAAS,CAAC,EAAV,CAAa,OAAb,EAAsB,oBAAtB,EAA4C,YAAA;AAC1CA,UAAM,KAAK,GAAG,CAAC,CAAC,IAAD,CAAfA;AACAA,UAAM,UAAU,GAAG,KAAK,CAAC,MAAN,EAAnBA;AAEA,MAAA,UAAU,CAAC,QAAX,CAAoB,GAApB,EAAyB,IAAzB,CAA6B,UAAE,KAAF,EAAS,IAAT,EAAa;AACxCA,YAAM,MAAM,GAAG,KAAK,CAAC,EAAN,CAAS,IAAT,CAAfA;;AAEA,YAAI,MAAJ,EAAY;AACV,UAAA,cAAc,CAAC,QAAD,EAAW,WAAX,EAAwB,UAAU,CAAC,CAAD,CAAlC,EAAuC,SAAvC,EAAkD;mBAC9D;AAD8D,WAAlD,CAAd;AAGD;;AAED,QAAA,MAAM,GACF,CAAC,CAAC,IAAD,CAAD,CAAQ,QAAR,CAAiB,wBAAjB,CADE,GAEF,CAAC,CAAC,IAAD,CAAD,CAAQ,WAAR,CAAoB,wBAApB,CAFJ;AAGD,OAZD;AAaD,KAjBD,EAFD,C;;AAsBC,IAAA,IAAI,CAAC,QAAL,CAAc,8BAAd,EAA8C,YAAA;AAC5C,UAAI,IAAI,CAAC,QAAT,CAAkB,IAAlB,EAAwB;AACtB,QAAA,WAAW,EAAE,2BADS;AAEtB,QAAA,aAAa,EAAE;AAFO,OAAxB;AAID,KALD;AAMD,GA5BA,CAAD;ACSA;;;;;AAIA,WAAS,SAAT,CAAmB,KAAnB,EAAgD;kCAAL,K;AACzC,WACE,sCACE,KAAK,GAAA,wBAAyB,KAAzB,GAAmC,EAD1C,IAEA,KAFA,GAGA,6DAHA,GAIA,yCAJA,GAKA,QALA,GAMA,sCANA,GAOA,yCAPA,GAQA,QARA,GASA,8DATA,GAUA,yCAVA,GAWA,QAXA,GAYA,QAbF;AAeD;AAED;;;;;;AAIA,WAAS,QAAT,CAAkB,OAAlB,EAAsC;AACpCA,QAAM,QAAQ,GAAG,CAAC,CAAC,OAAD,CAAlBA;AAEAA,QAAM,KAAK,GAAG,QAAQ,CAAC,QAAT,CAAkB,uBAAlB,IACV,SAAS,CAAC,CAAD,CAAT,GAAe,SAAS,CAAC,CAAD,CAAxB,GAA8B,SAAS,CAAC,CAAD,CAAvC,GAA6C,SAAS,CAAC,CAAD,CAD5C,GAEV,SAAS,EAFbA;AAIA,IAAA,QAAQ,CAAC,IAAT,CAAc,KAAd;AACD;;AAED,EAAA,CAAC,CAAA,YAAA;;AAEC,IAAA,IAAI,CAAC,QAAL,CAAc,eAAd,EAA+B,YAAA;AAC7B,MAAA,QAAQ,CAAC,IAAD,CAAR;AACD,KAFD;AAGD,GALA,CAAD;;AAOA,EAAA,IAAI,CAAC,cAAL,GAAsB,UACpB,QADoB,EACsC;AAE1DA,QAAM,SAAS,GAAG,WAAW,CAAC,QAAD,CAAX,GAAwB,CAAC,CAAC,eAAD,CAAzB,GAA6C,CAAC,CAAC,QAAD,CAAhEA;AAEA,IAAA,SAAS,CAAC,IAAV,CAAe,YAAA;AACb,MAAA,QAAQ,CAAC,IAAD,CAAR;AACD,KAFD;AAGD,GARD;;AC0CAA,MAAMM,iBAAe,GAAY;AAC/B,IAAA,QAAQ,EAAE,MADqB;AAE/B,IAAA,KAAK,EAAE,MAFwB;AAG/B,IAAA,MAAM,EAAE,EAHuB;AAI/B,IAAA,KAAK,EAAE,KAJwB;AAK/B,IAAA,OAAO,EAAE,MALsB;AAM/B,IAAA,cAAc,EAAE,OANe;AAO/B,IAAA,YAAY,EAAE;AAPiB,GAAjCN;;AAUA,MAAM,IAAI,GA+BR,SAAA,IAAA,CACE,cADF,EAEE,YAFF,EAGE,OAHF,EAGuB;;sCAAF,E;;;;;AApBd,SAAA,OAAA,GAAmB,MAAM,CAAC,EAAD,EAAKM,iBAAL,CAAzB;;;;;AAKC,SAAA,KAAA,GAAe,QAAf;AAiBN,SAAK,OAAL,GAAe,CAAC,CAAC,cAAD,CAAD,CAAkB,KAAlB,EAAf;AACA,SAAK,QAAL,GAAgB,CAAC,CAAC,YAAD,CAAD,CAAgB,KAAhB,EAAhB,CAHqB,C;;AAMrB,QAAI,CAAC,KAAK,OAAL,CAAa,MAAb,GAAsB,EAAtB,CAAyB,KAAK,QAAL,CAAc,MAAd,EAAzB,CAAL,EAAuD;AACrD,YAAM,IAAI,KAAJ,CAAU,kDAAV,CAAN;AACD;;AAED,IAAA,MAAM,CAAC,KAAK,OAAN,EAAe,OAAf,CAAN,CAVqB,C;;AAarB,SAAK,SAAL,GAAiB,KAAK,QAAL,CAAc,QAAd,CAAuB,mBAAvB,CAAjB,CAbqB,C;;AAgBrB,SAAK,SAAL,GACE,KAAK,OAAL,CAAa,OAAb,KAAyB,MAAzB,GAAkC,CAAC,KAAK,SAAxC,GAAoD,KAAK,OAAL,CAAa,OADnE,CAhBqB,C;;AAoBrB,SAAK,OAAL,CAAa,EAAb,CAAgB,OAAhB,EAAuB,YAAA;AAAA,aAAQH,MAAI,CAAC,MAALA,EAAR;AAAqB,KAA5C,EApBqB,C;;AAuBrB,IAAA,SAAS,CAAC,EAAV,CAAa,kBAAb,EAA+B,UAAG,KAAH,EAAe;AAC5CH,UAAM,OAAO,GAAG,CAAC,CAAC,KAAK,CAAC,MAAP,CAAjBA;;AAEA,UACEG,MAAI,CAAC,MAALA,MACA,CAAC,OAAO,CAAC,EAAR,CAAWA,MAAI,CAAC,QAAhB,CADDA,IAEA,CAAC,QAAQ,CAACA,MAAI,CAAC,QAALA,CAAc,CAAdA,CAAD,EAAmB,OAAO,CAAC,CAAD,CAA1B,CAFTA,IAGA,CAAC,OAAO,CAAC,EAAR,CAAWA,MAAI,CAAC,OAAhB,CAHDA,IAIA,CAAC,QAAQ,CAACA,MAAI,CAAC,OAALA,CAAa,CAAbA,CAAD,EAAkB,OAAO,CAAC,CAAD,CAAzB,CALX,EAME;AACAA,QAAAA,MAAI,CAAC,KAALA;AACD;AACF,KAZD,EAvBqB,C;;;AAuCrBH,QAAM,IAAI,GAAG,IAAbA;AACA,IAAA,SAAS,CAAC,EAAV,CAAa,OAAb,EAAsB,iBAAtB,EAAyC,YAAA;AACvCA,UAAM,KAAK,GAAG,CAAC,CAAC,IAAD,CAAfA;;AAEA,UACE,CAAC,KAAK,CAAC,IAAN,CAAW,YAAX,EAAyB,MAA1B,IACA,KAAK,CAAC,IAAN,CAAW,UAAX,MAA2B,SAF7B,EAGE;AACA,QAAA,IAAI,CAAC,KAAL;AACD;AACF,KATD,EAxCqB,C;;AAoDrB,SAAK,gBAAL,GApDqB,C;;AAuDrB,IAAA,OAAO,CAAC,EAAR,CACE,QADF,EAEE,CAAC,CAAC,QAAF,CAAU,YAAA;AAAA,aAAOG,MAAI,CAAC,QAALA,EAAP;AAAsB,KAAhC,EAAkC,GAAlC,CAFF;AAIF,GA7FF;AA+FE;;;;;iBAGQ,M,GAAA,SAAA,MAAA,GAAA;AACN,WAAO,KAAK,KAAL,KAAe,SAAf,IAA4B,KAAK,KAAL,KAAe,QAAlD;AACF,G;AAEA;;;;;;iBAIQ,Y,GAAA,SAAA,YAAA,CAAa,IAAb,EAAwB;AAC9B,IAAA,cAAc,CAAC,IAAD,EAAO,MAAP,EAAe,KAAK,QAApB,EAA8B,IAA9B,CAAd;AACF,G;AAEA;;;;;iBAGQ,Q,GAAA,SAAA,QAAA,GAAA;AACNF,QAAI,QAAJA;AACAA,QAAI,OAAJA,CAFM,C;;AAKNA,QAAI,QAAJA;AACAA,QAAI,KAAJA,CANM,C;;AASND,QAAM,YAAY,GAAG,OAAO,CAAC,MAAR,EAArBA;AACAA,QAAM,WAAW,GAAG,OAAO,CAAC,KAAR,EAApBA,CAVM,C;;AAaNA,QAAM,MAAM,GAAG,KAAK,OAAL,CAAa,MAA5BA;AACAA,QAAM,SAAS,GAAG,KAAK,SAAvBA;AACAA,QAAM,OAAO,GAAG,KAAK,OAAL,CAAa,KAA7BA,CAfM,C;;AAkBNC,QAAI,gBAAJA;AACAA,QAAI,gBAAJA,CAnBM,C;;AAsBND,QAAM,SAAS,GAAG,KAAK,QAAL,CAAc,KAAd,EAAlBA;AACAA,QAAM,UAAU,GAAG,KAAK,QAAL,CAAc,MAAd,EAAnBA,CAvBM,C;;AA0BNA,QAAM,UAAU,GAAG,KAAK,OAAL,CAAa,CAAb,EAAgB,qBAAhB,EAAnBA;AACAA,QAAM,SAAS,GAAG,UAAU,CAAC,GAA7BA;AACAA,QAAM,UAAU,GAAG,UAAU,CAAC,IAA9BA;AACAA,QAAM,YAAY,GAAG,UAAU,CAAC,MAAhCA;AACAA,QAAM,WAAW,GAAG,UAAU,CAAC,KAA/BA;AACAA,QAAM,YAAY,GAAG,YAAY,GAAG,SAAf,GAA2B,YAAhDA;AACAA,QAAM,WAAW,GAAG,WAAW,GAAG,UAAd,GAA2B,WAA/CA,CAhCM,C;;AAmCNA,QAAM,eAAe,GAAG,KAAK,OAAL,CAAa,CAAb,EAAgB,SAAxCA;AACAA,QAAM,gBAAgB,GAAG,KAAK,OAAL,CAAa,CAAb,EAAgB,UAAzCA,CApCM,C;;AAuCN,QAAI,KAAK,OAAL,CAAa,QAAb,KAA0B,MAA9B,EAAsC;AACpC,UAAI,YAAY,IAAI,SAAS,GAAG,YAAH,GAAkB,CAA/B,CAAZ,GAAgD,UAAU,GAAG,MAAjE,EAAyE;;AAEvE,QAAA,QAAQ,GAAG,QAAX;AACD,OAHD,MAGO,IACL,SAAS,IAAI,SAAS,GAAG,YAAH,GAAkB,CAA/B,CAAT,GACA,UAAU,GAAG,MAFR,EAGL;;AAEA,QAAA,QAAQ,GAAG,KAAX;AACD,OANM,MAMA;;AAEL,QAAA,QAAQ,GAAG,QAAX;AACD;AACF,KAdD,MAcO;AACL,MAAA,QAAQ,GAAG,KAAK,OAAL,CAAa,QAAxB;AACD,KAvDK,C;;;AA0DN,QAAI,KAAK,OAAL,CAAa,KAAb,KAAuB,MAA3B,EAAmC;AACjC,UAAI,WAAW,GAAG,WAAd,GAA4B,SAAS,GAAG,MAA5C,EAAoD;;AAElD,QAAA,KAAK,GAAG,MAAR;AACD,OAHD,MAGO,IAAI,UAAU,GAAG,WAAb,GAA2B,SAAS,GAAG,MAA3C,EAAmD;;AAExD,QAAA,KAAK,GAAG,OAAR;AACD,OAHM,MAGA;;AAEL,QAAA,KAAK,GAAG,QAAR;AACD;AACF,KAXD,MAWO;AACL,MAAA,KAAK,GAAG,KAAK,OAAL,CAAa,KAArB;AACD,KAvEK,C;;;AA0EN,QAAI,QAAQ,KAAK,QAAjB,EAA2B;AACzB,MAAA,gBAAgB,GAAG,GAAnB;AACA,MAAA,OAAO,GACL,CAAC,SAAS,GAAG,CAAH,GAAO,YAAjB,KACC,OAAO,GAAG,SAAH,GAAe,eADvB,CADF;AAGD,KALD,MAKO,IAAI,QAAQ,KAAK,KAAjB,EAAwB;AAC7B,MAAA,gBAAgB,GAAG,MAAnB;AACA,MAAA,OAAO,GACL,CAAC,SAAS,GAAG,YAAH,GAAkB,CAA5B,KACC,OAAO,GAAG,SAAS,GAAG,UAAf,GAA4B,eAAe,GAAG,UADtD,CADF;AAGD,KALM,MAKA;AACL,MAAA,gBAAgB,GAAG,KAAnB,CADK,C;;;;AAMLC,UAAI,cAAc,GAAG,UAArBA,CANK,C;;AASL,UAAI,CAAC,KAAK,SAAV,EAAqB;AACnB,YAAI,UAAU,GAAG,MAAM,GAAG,CAAtB,GAA0B,YAA9B,EAA4C;AAC1C,UAAA,cAAc,GAAG,YAAY,GAAG,MAAM,GAAG,CAAzC;AACA,eAAK,QAAL,CAAc,MAAd,CAAqB,cAArB;AACD;AACF;;AAED,MAAA,OAAO,GACL,CAAC,YAAY,GAAG,cAAhB,IAAkC,CAAlC,IACC,OAAO,GAAG,CAAH,GAAO,eAAe,GAAG,SADjC,CADF;AAGD;;AAED,SAAK,QAAL,CAAc,GAAd,CAAkB,KAAlB,EAA4B,OAAO,GAAA,IAAnC,EAzGM,C;;AA4GN,QAAI,KAAK,KAAK,MAAd,EAAsB;AACpB,MAAA,gBAAgB,GAAG,GAAnB;AACA,MAAA,QAAQ,GAAG,OAAO,GAAG,UAAH,GAAgB,gBAAlC;AACD,KAHD,MAGO,IAAI,KAAK,KAAK,OAAd,EAAuB;AAC5B,MAAA,gBAAgB,GAAG,MAAnB;AACA,MAAA,QAAQ,GAAG,OAAO,GACd,UAAU,GAAG,WAAb,GAA2B,SADb,GAEd,gBAAgB,GAAG,WAAnB,GAAiC,SAFrC;AAGD,KALM,MAKA;AACL,MAAA,gBAAgB,GAAG,KAAnB,CADK,C;;;AAKLA,UAAI,aAAa,GAAG,SAApBA,CALK,C;;AAQL,UAAI,SAAS,GAAG,MAAM,GAAG,CAArB,GAAyB,WAA7B,EAA0C;AACxC,QAAA,aAAa,GAAG,WAAW,GAAG,MAAM,GAAG,CAAvC;AACA,aAAK,QAAL,CAAc,KAAd,CAAoB,aAApB;AACD;;AAED,MAAA,QAAQ,GACN,CAAC,WAAW,GAAG,aAAf,IAAgC,CAAhC,IACC,OAAO,GAAG,CAAH,GAAO,gBAAgB,GAAG,UADlC,CADF;AAGD;;AAED,SAAK,QAAL,CAAc,GAAd,CAAkB,MAAlB,EAA6B,QAAQ,GAAA,IAArC,EAtIM,C;;AAyIN,SAAK,QAAL,CAAc,eAAd,CAAiC,gBAAgB,GAAA,GAAhB,GAAoB,gBAArD;AACF,G;AAEA;;;;;;iBAIQ,e,GAAA,SAAA,eAAA,CAAgB,QAAhB,EAA4B;AAClCD,QAAM,KAAK,GAAG,QAAQ,CAAC,MAAT,CAAgB,iBAAhB,CAAdA;AAEAC,QAAI,UAAJA;AACAA,QAAI,WAAJA,CAJkC,C;;AAOlCA,QAAI,QAAJA;AACAA,QAAI,KAAJA,CARkC,C;;AAWlCD,QAAM,YAAY,GAAG,OAAO,CAAC,MAAR,EAArBA;AACAA,QAAM,WAAW,GAAG,OAAO,CAAC,KAAR,EAApBA,CAZkC,C;;AAelCC,QAAI,gBAAJA;AACAA,QAAI,gBAAJA,CAhBkC,C;;AAmBlCD,QAAM,YAAY,GAAG,QAAQ,CAAC,KAAT,EAArBA;AACAA,QAAM,aAAa,GAAG,QAAQ,CAAC,MAAT,EAAtBA,CApBkC,C;;AAuBlCA,QAAM,QAAQ,GAAG,KAAK,CAAC,CAAD,CAAL,CAAS,qBAAT,EAAjBA;AACAA,QAAM,SAAS,GAAG,QAAQ,CAAC,KAA3BA;AACAA,QAAM,UAAU,GAAG,QAAQ,CAAC,MAA5BA;AACAA,QAAM,QAAQ,GAAG,QAAQ,CAAC,IAA1BA;AACAA,QAAM,OAAO,GAAG,QAAQ,CAAC,GAAzBA,CA3BkC,C;;AA8BlC,QAAI,YAAY,GAAG,OAAf,GAAyB,aAA7B,EAA4C;;AAE1C,MAAA,QAAQ,GAAG,QAAX;AACD,KAHD,MAGO,IAAI,OAAO,GAAG,UAAV,GAAuB,aAA3B,EAA0C;;AAE/C,MAAA,QAAQ,GAAG,KAAX;AACD,KAHM,MAGA;;AAEL,MAAA,QAAQ,GAAG,QAAX;AACD,KAvCiC,C;;;AA0ClC,QAAI,WAAW,GAAG,QAAd,GAAyB,SAAzB,GAAqC,YAAzC,EAAuD;;AAErD,MAAA,KAAK,GAAG,MAAR;AACD,KAHD,MAGO,IAAI,QAAQ,GAAG,YAAf,EAA6B;;AAElC,MAAA,KAAK,GAAG,OAAR;AACD,KAHM,MAGA;;AAEL,MAAA,KAAK,GAAG,MAAR;AACD,KAnDiC,C;;;AAsDlC,QAAI,QAAQ,KAAK,QAAjB,EAA2B;AACzB,MAAA,gBAAgB,GAAG,GAAnB;AACA,MAAA,UAAU,GAAG,GAAb;AACD,KAHD,MAGO,IAAI,QAAQ,KAAK,KAAjB,EAAwB;AAC7B,MAAA,gBAAgB,GAAG,MAAnB;AACA,MAAA,UAAU,GAAG,CAAC,aAAD,GAAiB,UAA9B;AACD;;AAED,IAAA,QAAQ,CAAC,GAAT,CAAa,KAAb,EAAuB,UAAU,GAAA,IAAjC,EA9DkC,C;;AAiElC,QAAI,KAAK,KAAK,MAAd,EAAsB;AACpB,MAAA,gBAAgB,GAAG,GAAnB;AACA,MAAA,WAAW,GAAG,SAAd;AACD,KAHD,MAGO,IAAI,KAAK,KAAK,OAAd,EAAuB;AAC5B,MAAA,gBAAgB,GAAG,MAAnB;AACA,MAAA,WAAW,GAAG,CAAC,YAAf;AACD;;AAED,IAAA,QAAQ,CAAC,GAAT,CAAa,MAAb,EAAwB,WAAW,GAAA,IAAnC,EAzEkC,C;;AA4ElC,IAAA,QAAQ,CAAC,eAAT,CAA4B,gBAAgB,GAAA,GAAhB,GAAoB,gBAAhD;AACF,G;AAEA;;;;;;iBAIQ,W,GAAA,SAAA,WAAA,CAAY,QAAZ,EAAwB;AAC9B,SAAK,eAAL,CAAqB,QAArB;AAEA,IAAA,QAAQ,CACL,QADH,CACY,gBADZ,EAEG,MAFH,CAEU,iBAFV,EAGG,QAHH,CAGY,uBAHZ;AAIF,G;AAEA;;;;;;iBAIQ,Y,GAAA,SAAA,YAAA,CAAa,QAAb,EAAyB;;AAE/B,IAAA,QAAQ,CACL,WADH,CACe,gBADf,EAEG,QAFH,CAEY,mBAFZ,EAGG,aAHH,CAGgB,YAAA;AAAA,aAAO,QAAQ,CAAC,WAAT,CAAqB,mBAArB,CAAP;AAAgD,KAHhE,E;AAAA,KAMG,MANH,CAMU,iBANV,EAOG,WAPH,CAOe,uBAPf,EAF+B,C;;AAY/B,IAAA,QAAQ,CAAC,IAAT,CAAc,YAAd,EAA4B,IAA5B,CAAgC,UAAE,CAAF,EAAK,IAAL,EAAS;AACvCA,UAAM,WAAW,GAAG,CAAC,CAAC,IAAD,CAArBA;AAEA,MAAA,WAAW,CACR,WADH,CACe,gBADf,EAEG,QAFH,CAEY,mBAFZ,EAGG,aAHH,CAGgB,YAAA;AAAA,eAAO,WAAW,CAAC,WAAZ,CAAwB,mBAAxB,CAAP;AAAmD,OAHnE,EAIG,MAJH,CAIU,iBAJV,EAKG,WALH,CAKe,uBALf;AAMD,KATD;AAUF,G;AAEA;;;;;;iBAIQ,a,GAAA,SAAA,aAAA,CAAc,QAAd,EAA0B;AAChC,IAAA,QAAQ,CAAC,QAAT,CAAkB,gBAAlB,IACI,KAAK,YAAL,CAAkB,QAAlB,CADJ,GAEI,KAAK,WAAL,CAAiB,QAAjB,CAFJ;AAGF,G;AAEA;;;;;iBAGQ,gB,GAAA,SAAA,gBAAA,GAAA;;AAENA,QAAM,IAAI,GAAG,IAAbA,CAFM,C;;AAKN,SAAK,QAAL,CAAc,EAAd,CAAiB,OAAjB,EAA0B,iBAA1B,EAA6C,UAAU,KAAV,EAAe;AAC1DA,UAAM,KAAK,GAAG,CAAC,CAAC,IAAD,CAAfA;AACAA,UAAM,OAAO,GAAG,CAAC,CAAC,KAAK,CAAC,MAAP,CAAjBA,CAF0D,C;;AAK1D,UAAI,KAAK,CAAC,IAAN,CAAW,UAAX,MAA2B,SAA/B,EAA0C;AACxC;AACD,OAPyD,C;;;AAU1D,UAAI,OAAO,CAAC,EAAR,CAAW,YAAX,KAA4B,OAAO,CAAC,EAAR,CAAW,eAAX,CAAhC,EAA6D;AAC3D;AACD,OAZyD,C;;;AAe1D,UAAI,CAAC,OAAO,CAAC,OAAR,CAAgB,iBAAhB,EAAmC,KAAnC,GAA2C,EAA3C,CAA8C,KAA9C,CAAL,EAA2D;AACzD;AACD,OAjByD,C;;;AAoB1DA,UAAM,QAAQ,GAAG,KAAK,CAAC,QAAN,CAAe,YAAf,CAAjBA,CApB0D,C;;AAuB1D,MAAA,KAAK,CACF,MADH,CACU,YADV,EAEG,QAFH,CAEY,iBAFZ,EAGG,IAHH,CAGO,UAAE,CAAF,EAAK,IAAL,EAAS;AACZA,YAAM,WAAW,GAAG,CAAC,CAAC,IAAD,CAAD,CAAQ,QAAR,CAAiB,YAAjB,CAApBA;;AAEA,YACE,WAAW,CAAC,MAAZ,KACC,CAAC,QAAQ,CAAC,MAAV,IAAoB,CAAC,WAAW,CAAC,EAAZ,CAAe,QAAf,CADtB,CADF,EAGE;AACA,UAAA,IAAI,CAAC,YAAL,CAAkB,WAAlB;AACD;AACF,OAZH,EAvB0D,C;;AAsC1D,UAAI,QAAQ,CAAC,MAAb,EAAqB;AACnB,QAAA,IAAI,CAAC,aAAL,CAAmB,QAAnB;AACD;AACF,KAzCD;;AA2CA,QAAI,KAAK,OAAL,CAAa,cAAb,KAAgC,OAApC,EAA6C;;AAE3CC,UAAI,OAAO,GAAQ,IAAnBA;AACAA,UAAI,WAAW,GAAQ,IAAvBA;AAEA,WAAK,QAAL,CAAc,EAAd,CAAiB,oBAAjB,EAAuC,iBAAvC,EAA0D,UACxD,KADwD,EACnD;AAELD,YAAM,KAAK,GAAG,CAAC,CAAC,IAAD,CAAfA;AACAA,YAAM,SAAS,GAAG,KAAK,CAAC,IAAxBA;AACAA,YAAM,cAAc,GAAG,CAAC,CACrB,KAAoB,CAAC,aADA,CAAxBA,CAJK,C;;AASL,YAAI,KAAK,CAAC,IAAN,CAAW,UAAX,MAA2B,SAA/B,EAA0C;AACxC;AACD,SAXI,C;;;AAcL,YAAI,SAAS,KAAK,WAAlB,EAA+B;AAC7B,cACE,CAAC,KAAK,CAAC,EAAN,CAAS,cAAT,CAAD,IACA,QAAQ,CAAC,KAAK,CAAC,CAAD,CAAN,EAAW,cAAc,CAAC,CAAD,CAAzB,CAFV,EAGE;AACA;AACD;AACF,SAPD,C;AAAA,aAUK,IAAI,SAAS,KAAK,UAAlB,EAA8B;AACjC,gBACE,KAAK,CAAC,EAAN,CAAS,cAAT,KACA,QAAQ,CAAC,KAAK,CAAC,CAAD,CAAN,EAAW,cAAc,CAAC,CAAD,CAAzB,CAFV,EAGE;AACA;AACD;AACF,WA/BI,C;;;AAkCLA,YAAM,QAAQ,GAAG,KAAK,CAAC,QAAN,CAAe,YAAf,CAAjBA,CAlCK,C;;AAqCL,YAAI,SAAS,KAAK,WAAlB,EAA+B;AAC7B,cAAI,QAAQ,CAAC,MAAb,EAAqB;;AAEnBA,gBAAM,QAAQ,GAAG,QAAQ,CAAC,IAAT,CAAc,wBAAd,CAAjBA;;AACA,gBAAI,QAAJ,EAAc;AACZ,cAAA,YAAY,CAAC,QAAD,CAAZ;AACD,aALkB,C;;;AAQnB,gBAAI,QAAQ,CAAC,QAAT,CAAkB,gBAAlB,CAAJ,EAAyC;AACvC;AACD,aAVkB,C;;;AAanB,YAAA,YAAY,CAAC,WAAD,CAAZ,CAbmB,C;;AAgBnB,YAAA,OAAO,GAAG,WAAW,GAAG,UAAU,CAAA,YAAA;AAAA,qBAC1B,IAAI,CAAC,WAAL,CAAiB,QAAjB,CAD0B;AACA,aADA,EAEhC,IAAI,CAAC,OAAL,CAAa,YAFmB,CAAlC;AAKA,YAAA,QAAQ,CAAC,IAAT,CAAc,uBAAd,EAAuC,OAAvC;AACD;AACF,SAxBD,C;AAAA,aA2BK,IAAI,SAAS,KAAK,UAAlB,EAA8B;AACjC,gBAAI,QAAQ,CAAC,MAAb,EAAqB;;AAEnBA,kBAAM,OAAO,GAAG,QAAQ,CAAC,IAAT,CAAc,uBAAd,CAAhBA;;AACA,kBAAI,OAAJ,EAAa;AACX,gBAAA,YAAY,CAAC,OAAD,CAAZ;AACD,eALkB,C;;;AAQnB,cAAA,OAAO,GAAG,UAAU,CAAA,YAAA;AAAA,uBACZ,IAAI,CAAC,YAAL,CAAkB,QAAlB,CADY;AACe,eADf,EAElB,IAAI,CAAC,OAAL,CAAa,YAFK,CAApB;AAKA,cAAA,QAAQ,CAAC,IAAT,CAAc,wBAAd,EAAwC,OAAxC;AACD;AACF;AACF,OAlFD;AAmFD;AACH,G;AAEA;;;;;iBAGQ,a,GAAA,SAAA,aAAA,GAAA;AACN,SAAK,QAAL,CAAc,WAAd,CAA0B,mBAA1B;;AAEA,QAAI,KAAK,KAAL,KAAe,SAAnB,EAA8B;AAC5B,WAAK,KAAL,GAAa,QAAb;AACA,WAAK,YAAL,CAAkB,QAAlB;AACD;;AAED,QAAI,KAAK,KAAL,KAAe,SAAnB,EAA8B;AAC5B,WAAK,KAAL,GAAa,QAAb;AACA,WAAK,YAAL,CAAkB,QAAlB,EAF4B,C;;AAK5B,WAAK,QAAL,CAAc,GAAd,CAAkB;AAChB,QAAA,GAAG,EAAE,EADW;AAEhB,QAAA,IAAI,EAAE,EAFU;AAGhB,QAAA,KAAK,EAAE,EAHS;AAIhB,QAAA,QAAQ,EAAE;AAJM,OAAlB;AAMD;AACH,G;AAEA;;;;;iBAGO,M,GAAA,SAAA,MAAA,GAAA;AACL,SAAK,MAAL,KAAgB,KAAK,KAAL,EAAhB,GAA+B,KAAK,IAAL,EAA/B;AACF,G;AAEA;;;;;iBAGO,I,GAAA,SAAA,IAAA,GAAA;;;AACL,QAAI,KAAK,MAAL,EAAJ,EAAmB;AACjB;AACD;;AAED,SAAK,KAAL,GAAa,SAAb;AACA,SAAK,YAAL,CAAkB,MAAlB;AAEA,SAAK,QAAL;AAEA,SAAK,QAAL,C;AAAA,KAEG,GAFH,CAEO,UAFP,EAEmB,KAAK,OAAL,CAAa,KAAb,GAAqB,OAArB,GAA+B,UAFlD,EAGG,QAHH,CAGY,gBAHZ,EAIG,aAJH,CAIgB,YAAA;AAAA,aAAOG,MAAI,CAAC,aAALA,EAAP;AAA2B,KAJ3C;AAKF,G;AAEA;;;;;iBAGO,K,GAAA,SAAA,KAAA,GAAA;;;AACL,QAAI,CAAC,KAAK,MAAL,EAAL,EAAoB;AAClB;AACD;;AAED,SAAK,KAAL,GAAa,SAAb;AACA,SAAK,YAAL,CAAkB,OAAlB,EANK,C;;AASL,SAAK,QAAL,CAAc,IAAd,CAAmB,YAAnB,EAAiC,IAAjC,CAAqC,UAAE,CAAF,EAAK,OAAL,EAAY;AAC/CA,MAAAA,MAAI,CAAC,YAALA,CAAkB,CAAC,CAAC,OAAD,CAAnBA;AACD,KAFD;AAIA,SAAK,QAAL,CACG,WADH,CACe,gBADf,EAEG,QAFH,CAEY,mBAFZ,EAGG,aAHH,CAGgB,YAAA;AAAA,aAAOA,MAAI,CAAC,aAALA,EAAP;AAA2B,KAH3C;AAIF,G;;AAGF,EAAA,IAAI,CAAC,IAAL,GAAY,IAAZ;AC1sBAH,MAAMO,YAAU,GAAG,WAAnBP;AACAA,MAAMQ,UAAQ,GAAG,YAAjBR;AAaA,EAAA,CAAC,CAAA,YAAA;AACC,IAAA,SAAS,CAAC,EAAV,CAAa,OAAb,EAAoB,MAAMO,YAAN,GAAgB,GAApC,EAAyC,YAAA;AACvCP,UAAM,KAAK,GAAG,CAAC,CAAC,IAAD,CAAfA;AACAC,UAAI,QAAQ,GAAG,KAAK,CAAC,IAAN,CAAWO,UAAX,CAAfP;;AAEA,UAAI,CAAC,QAAL,EAAe;AACbD,YAAM,OAAO,GAAG,YAAY,CAAC,IAAD,EAAsBO,YAAtB,CAA5BP;AACAA,YAAM,YAAY,GAAG,OAAO,CAAC,MAA7BA,CAFa,C;;AAIb,eAAO,OAAO,CAAC,MAAf;AAEA,QAAA,QAAQ,GAAG,IAAI,IAAI,CAAC,IAAT,CAAc,KAAd,EAAqB,YAArB,EAAmC,OAAnC,CAAX;AACA,QAAA,KAAK,CAAC,IAAN,CAAWQ,UAAX,EAAqB,QAArB;AAEA,QAAA,QAAQ,CAAC,MAAT;AACD;AACF,KAfD;AAgBD,GAjBA,CAAD","sourcesContent":["!function(){try{return new MouseEvent(\"test\")}catch(e){}var e=function(e,t){t=t||{bubbles:!1,cancelable:!1};var n=document.createEvent(\"MouseEvent\");return n.initMouseEvent(e,t.bubbles,t.cancelable,window,0,t.screenX||0,t.screenY||0,t.clientX||0,t.clientY||0,t.ctrlKey||!1,t.altKey||!1,t.shiftKey||!1,t.metaKey||!1,t.button||0,t.relatedTarget||null),n};e.prototype=Event.prototype,window.MouseEvent=e}();\n","!function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent(\"CustomEvent\");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}\"function\"!=typeof window.CustomEvent&&(t.prototype=window.Event.prototype,window.CustomEvent=t)}();\n","/**\n * @this {Promise}\n */\nfunction finallyConstructor(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      // @ts-ignore\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      // @ts-ignore\n      return constructor.resolve(callback()).then(function() {\n        // @ts-ignore\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\nexport default finallyConstructor;\n","function allSettled(arr) {\n  var P = this;\n  return new P(function(resolve, reject) {\n    if (!(arr && typeof arr.length !== 'undefined')) {\n      return reject(\n        new TypeError(\n          typeof arr +\n            ' ' +\n            arr +\n            ' is not iterable(cannot read property Symbol(Symbol.iterator))'\n        )\n      );\n    }\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      if (val && (typeof val === 'object' || typeof val === 'function')) {\n        var then = val.then;\n        if (typeof then === 'function') {\n          then.call(\n            val,\n            function(val) {\n              res(i, val);\n            },\n            function(e) {\n              args[i] = { status: 'rejected', reason: e };\n              if (--remaining === 0) {\n                resolve(args);\n              }\n            }\n          );\n          return;\n        }\n      }\n      args[i] = { status: 'fulfilled', value: val };\n      if (--remaining === 0) {\n        resolve(args);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n}\n\nexport default allSettled;\n","import promiseFinally from './finally';\nimport allSettled from './allSettled';\n\n// Store setTimeout reference so promise-polyfill will be unaffected by\n// other code modifying setTimeout (like sinon.useFakeTimers())\nvar setTimeoutFunc = setTimeout;\n\nfunction isArray(x) {\n  return Boolean(x && typeof x.length !== 'undefined');\n}\n\nfunction noop() {}\n\n// Polyfill for Function.prototype.bind\nfunction bind(fn, thisArg) {\n  return function() {\n    fn.apply(thisArg, arguments);\n  };\n}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError('Promises must be constructed via new');\n  if (typeof fn !== 'function') throw new TypeError('not a function');\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError('A promise cannot be resolved with itself.');\n    if (\n      newValue &&\n      (typeof newValue === 'object' || typeof newValue === 'function')\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === 'function') {\n        doResolve(bind(then, newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) return;\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) return;\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) return;\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype['catch'] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype['finally'] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!isArray(arr)) {\n      return reject(new TypeError('Promise.all accepts an array'));\n    }\n\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === 'object' || typeof val === 'function')) {\n          var then = val.then;\n          if (typeof then === 'function') {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.allSettled = allSettled;\n\nPromise.resolve = function(value) {\n  if (value && typeof value === 'object' && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!isArray(arr)) {\n      return reject(new TypeError('Promise.race accepts an array'));\n    }\n\n    for (var i = 0, len = arr.length; i < len; i++) {\n      Promise.resolve(arr[i]).then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn =\n  // @ts-ignore\n  (typeof setImmediate === 'function' &&\n    function(fn) {\n      // @ts-ignore\n      setImmediate(fn);\n    }) ||\n  function(fn) {\n    setTimeoutFunc(fn, 0);\n  };\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n  if (typeof console !== 'undefined' && console) {\n    console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n  }\n};\n\nexport default Promise;\n","import Promise from './index';\nimport promiseFinally from './finally';\nimport allSettled from './allSettled';\n\n/** @suppress {undefinedVars} */\nvar globalNS = (function() {\n  // the only reliable means to get the global object is\n  // `Function('return this')()`\n  // However, this causes CSP violations in Chrome apps.\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  throw new Error('unable to locate global object');\n})();\n\n// Expose the polyfill if Promise is undefined or set to a\n// non-function value. The latter can be due to a named HTMLElement\n// being exposed by browsers for legacy reasons.\n// https://github.com/taylorhakes/promise-polyfill/issues/114\nif (typeof globalNS['Promise'] !== 'function') {\n  globalNS['Promise'] = Promise;\n} else if (!globalNS.Promise.prototype['finally']) {\n  globalNS.Promise.prototype['finally'] = promiseFinally;\n} else if (!globalNS.Promise.allSettled) {\n  globalNS.Promise.allSettled = allSettled;\n}\n","function isNodeName(element, name) {\n    return element.nodeName.toLowerCase() === name.toLowerCase();\n}\nfunction isFunction(target) {\n    return typeof target === 'function';\n}\nfunction isString(target) {\n    return typeof target === 'string';\n}\nfunction isNumber(target) {\n    return typeof target === 'number';\n}\nfunction isBoolean(target) {\n    return typeof target === 'boolean';\n}\nfunction isUndefined(target) {\n    return typeof target === 'undefined';\n}\nfunction isNull(target) {\n    return target === null;\n}\nfunction isWindow(target) {\n    return target instanceof Window;\n}\nfunction isDocument(target) {\n    return target instanceof Document;\n}\nfunction isElement(target) {\n    return target instanceof Element;\n}\nfunction isNode(target) {\n    return target instanceof Node;\n}\n/**\n * 是否是 IE 浏览器\n */\nfunction isIE() {\n    // @ts-ignore\n    return !!window.document.documentMode;\n}\nfunction isArrayLike(target) {\n    if (isFunction(target) || isWindow(target)) {\n        return false;\n    }\n    return isNumber(target.length);\n}\nfunction isObjectLike(target) {\n    return typeof target === 'object' && target !== null;\n}\nfunction toElement(target) {\n    return isDocument(target) ? target.documentElement : target;\n}\n/**\n * 把用 - 分隔的字符串转为驼峰（如 box-sizing 转换为 boxSizing）\n * @param string\n */\nfunction toCamelCase(string) {\n    return string\n        .replace(/^-ms-/, 'ms-')\n        .replace(/-([a-z])/g, (_, letter) => letter.toUpperCase());\n}\n/**\n * 把驼峰法转为用 - 分隔的字符串（如 boxSizing 转换为 box-sizing）\n * @param string\n */\nfunction toKebabCase(string) {\n    return string.replace(/[A-Z]/g, (replacer) => '-' + replacer.toLowerCase());\n}\n/**\n * 获取元素的样式值\n * @param element\n * @param name\n */\nfunction getComputedStyleValue(element, name) {\n    return window.getComputedStyle(element).getPropertyValue(toKebabCase(name));\n}\n/**\n * 检查元素的 box-sizing 是否是 border-box\n * @param element\n */\nfunction isBorderBox(element) {\n    return getComputedStyleValue(element, 'box-sizing') === 'border-box';\n}\n/**\n * 获取元素的 padding, border, margin 宽度（两侧宽度的和，单位为px）\n * @param element\n * @param direction\n * @param extra\n */\nfunction getExtraWidth(element, direction, extra) {\n    const position = direction === 'width' ? ['Left', 'Right'] : ['Top', 'Bottom'];\n    return [0, 1].reduce((prev, _, index) => {\n        let prop = extra + position[index];\n        if (extra === 'border') {\n            prop += 'Width';\n        }\n        return prev + parseFloat(getComputedStyleValue(element, prop) || '0');\n    }, 0);\n}\n/**\n * 获取元素的样式值，对 width 和 height 进行过处理\n * @param element\n * @param name\n */\nfunction getStyle(element, name) {\n    // width、height 属性使用 getComputedStyle 得到的值不准确，需要使用 getBoundingClientRect 获取\n    if (name === 'width' || name === 'height') {\n        const valueNumber = element.getBoundingClientRect()[name];\n        if (isBorderBox(element)) {\n            return `${valueNumber}px`;\n        }\n        return `${valueNumber -\n            getExtraWidth(element, name, 'border') -\n            getExtraWidth(element, name, 'padding')}px`;\n    }\n    return getComputedStyleValue(element, name);\n}\n/**\n * 获取子节点组成的数组\n * @param target\n * @param parent\n */\nfunction getChildNodesArray(target, parent) {\n    const tempParent = document.createElement(parent);\n    tempParent.innerHTML = target;\n    return [].slice.call(tempParent.childNodes);\n}\n/**\n * 始终返回 false 的函数\n */\nfunction returnFalse() {\n    return false;\n}\n/**\n * 数值单位的 CSS 属性\n */\nconst cssNumber = [\n    'animationIterationCount',\n    'columnCount',\n    'fillOpacity',\n    'flexGrow',\n    'flexShrink',\n    'fontWeight',\n    'gridArea',\n    'gridColumn',\n    'gridColumnEnd',\n    'gridColumnStart',\n    'gridRow',\n    'gridRowEnd',\n    'gridRowStart',\n    'lineHeight',\n    'opacity',\n    'order',\n    'orphans',\n    'widows',\n    'zIndex',\n    'zoom',\n];\nexport { isNodeName, isArrayLike, isObjectLike, isFunction, isString, isNumber, isBoolean, isUndefined, isNull, isWindow, isDocument, isElement, isNode, isIE, toElement, toCamelCase, toKebabCase, getComputedStyleValue, isBorderBox, getExtraWidth, getStyle, getChildNodesArray, returnFalse, cssNumber, };\n","import { isArrayLike } from '../utils';\nfunction each(target, callback) {\n    if (isArrayLike(target)) {\n        for (let i = 0; i < target.length; i += 1) {\n            if (callback.call(target[i], i, target[i]) === false) {\n                return target;\n            }\n        }\n    }\n    else {\n        const keys = Object.keys(target);\n        for (let i = 0; i < keys.length; i += 1) {\n            if (callback.call(target[keys[i]], keys[i], target[keys[i]]) === false) {\n                return target;\n            }\n        }\n    }\n    return target;\n}\nexport default each;\n","import each from './functions/each';\n/**\n * 为了使用模块扩充，这里不能使用默认导出\n */\nexport class JQ {\n    constructor(arr) {\n        this.length = 0;\n        if (!arr) {\n            return this;\n        }\n        each(arr, (i, item) => {\n            // @ts-ignore\n            this[i] = item;\n        });\n        this.length = arr.length;\n        return this;\n    }\n}\n","import each from './functions/each';\nimport { JQ } from './JQ';\nimport { getChildNodesArray, isArrayLike, isFunction, isNode, isString, } from './utils';\nfunction get$() {\n    const $ = function (selector) {\n        if (!selector) {\n            return new JQ();\n        }\n        // JQ\n        if (selector instanceof JQ) {\n            return selector;\n        }\n        // function\n        if (isFunction(selector)) {\n            if (/complete|loaded|interactive/.test(document.readyState) &&\n                document.body) {\n                selector.call(document, $);\n            }\n            else {\n                document.addEventListener('DOMContentLoaded', () => selector.call(document, $), false);\n            }\n            return new JQ([document]);\n        }\n        // String\n        if (isString(selector)) {\n            const html = selector.trim();\n            // 根据 HTML 字符串创建 JQ 对象\n            if (html[0] === '<' && html[html.length - 1] === '>') {\n                let toCreate = 'div';\n                const tags = {\n                    li: 'ul',\n                    tr: 'tbody',\n                    td: 'tr',\n                    th: 'tr',\n                    tbody: 'table',\n                    option: 'select',\n                };\n                each(tags, (childTag, parentTag) => {\n                    if (html.indexOf(`<${childTag}`) === 0) {\n                        toCreate = parentTag;\n                        return false;\n                    }\n                    return;\n                });\n                return new JQ(getChildNodesArray(html, toCreate));\n            }\n            // 根据 CSS 选择器创建 JQ 对象\n            const isIdSelector = selector[0] === '#' && !selector.match(/[ .<>:~]/);\n            if (!isIdSelector) {\n                return new JQ(document.querySelectorAll(selector));\n            }\n            const element = document.getElementById(selector.slice(1));\n            if (element) {\n                return new JQ([element]);\n            }\n            return new JQ();\n        }\n        if (isArrayLike(selector) && !isNode(selector)) {\n            return new JQ(selector);\n        }\n        return new JQ([selector]);\n    };\n    $.fn = JQ.prototype;\n    return $;\n}\nconst $ = get$();\nexport default $;\n","import { MduiStatic } from './interfaces/MduiStatic';\nimport $ from 'mdui.jq/es/$';\n\n// 避免页面加载完后直接执行css动画\n// https://css-tricks.com/transitions-only-after-page-load/\nsetTimeout(() => $('body').addClass('mdui-loaded'));\n\nconst mdui = {\n  $: $,\n} as MduiStatic;\n\nexport default mdui;\n","import $ from '../$';\nimport each from '../functions/each';\n$.fn.each = function (callback) {\n    return each(this, callback);\n};\n","import { toElement } from '../utils';\n/**\n * 检查 container 元素内是否包含 contains 元素\n * @param container 父元素\n * @param contains 子元素\n * @example\n```js\ncontains( document, document.body ); // true\ncontains( document.getElementById('test'), document ); // false\ncontains( $('.container').get(0), $('.contains').get(0) ); // false\n```\n */\nfunction contains(container, contains) {\n    return container !== contains && toElement(container).contains(contains);\n}\nexport default contains;\n","import each from './each';\n/**\n * 把第二个数组的元素追加到第一个数组中，并返回合并后的数组\n * @param first 第一个数组\n * @param second 该数组的元素将被追加到第一个数组中\n * @example\n```js\nmerge( [ 0, 1, 2 ], [ 2, 3, 4 ] )\n// [ 0, 1, 2, 2, 3, 4 ]\n```\n */\nfunction merge(first, second) {\n    each(second, (_, value) => {\n        first.push(value);\n    });\n    return first;\n}\nexport default merge;\n","import $ from '../$';\n$.fn.get = function (index) {\n    return index === undefined\n        ? [].slice.call(this)\n        : this[index >= 0 ? index : index + this.length];\n};\n","import $ from '../$';\nimport merge from '../functions/merge';\nimport { JQ } from '../JQ';\nimport './each';\nimport './get';\n$.fn.find = function (selector) {\n    const foundElements = [];\n    this.each((_, element) => {\n        merge(foundElements, $(element.querySelectorAll(selector)).get());\n    });\n    return new JQ(foundElements);\n};\n","import $ from '../../$';\nimport contains from '../../functions/contains';\nimport { isObjectLike } from '../../utils';\nimport '../find';\n// 存储事件\nconst handlers = {};\n// 元素ID\nlet mduiElementId = 1;\n/**\n * 为元素赋予一个唯一的ID\n */\nfunction getElementId(element) {\n    const key = '_mduiEventId';\n    // @ts-ignore\n    if (!element[key]) {\n        // @ts-ignore\n        element[key] = ++mduiElementId;\n    }\n    // @ts-ignore\n    return element[key];\n}\n/**\n * 解析事件名中的命名空间\n */\nfunction parse(type) {\n    const parts = type.split('.');\n    return {\n        type: parts[0],\n        ns: parts.slice(1).sort().join(' '),\n    };\n}\n/**\n * 命名空间匹配规则\n */\nfunction matcherFor(ns) {\n    return new RegExp('(?:^| )' + ns.replace(' ', ' .* ?') + '(?: |$)');\n}\n/**\n * 获取匹配的事件\n * @param element\n * @param type\n * @param func\n * @param selector\n */\nfunction getHandlers(element, type, func, selector) {\n    const event = parse(type);\n    return (handlers[getElementId(element)] || []).filter((handler) => handler &&\n        (!event.type || handler.type === event.type) &&\n        (!event.ns || matcherFor(event.ns).test(handler.ns)) &&\n        (!func || getElementId(handler.func) === getElementId(func)) &&\n        (!selector || handler.selector === selector));\n}\n/**\n * 添加事件监听\n * @param element\n * @param types\n * @param func\n * @param data\n * @param selector\n */\nfunction add(element, types, func, data, selector) {\n    const elementId = getElementId(element);\n    if (!handlers[elementId]) {\n        handlers[elementId] = [];\n    }\n    // 传入 data.useCapture 来设置 useCapture: true\n    let useCapture = false;\n    if (isObjectLike(data) && data.useCapture) {\n        useCapture = true;\n    }\n    types.split(' ').forEach((type) => {\n        if (!type) {\n            return;\n        }\n        const event = parse(type);\n        function callFn(e, elem) {\n            // 因为鼠标事件模拟事件的 detail 属性是只读的，因此在 e._detail 中存储参数\n            const result = func.apply(elem, \n            // @ts-ignore\n            e._detail === undefined ? [e] : [e].concat(e._detail));\n            if (result === false) {\n                e.preventDefault();\n                e.stopPropagation();\n            }\n        }\n        function proxyFn(e) {\n            // @ts-ignore\n            if (e._ns && !matcherFor(e._ns).test(event.ns)) {\n                return;\n            }\n            // @ts-ignore\n            e._data = data;\n            if (selector) {\n                // 事件代理\n                $(element)\n                    .find(selector)\n                    .get()\n                    .reverse()\n                    .forEach((elem) => {\n                    if (elem === e.target ||\n                        contains(elem, e.target)) {\n                        callFn(e, elem);\n                    }\n                });\n            }\n            else {\n                // 不使用事件代理\n                callFn(e, element);\n            }\n        }\n        const handler = {\n            type: event.type,\n            ns: event.ns,\n            func,\n            selector,\n            id: handlers[elementId].length,\n            proxy: proxyFn,\n        };\n        handlers[elementId].push(handler);\n        element.addEventListener(handler.type, proxyFn, useCapture);\n    });\n}\n/**\n * 移除事件监听\n * @param element\n * @param types\n * @param func\n * @param selector\n */\nfunction remove(element, types, func, selector) {\n    const handlersInElement = handlers[getElementId(element)] || [];\n    const removeEvent = (handler) => {\n        delete handlersInElement[handler.id];\n        element.removeEventListener(handler.type, handler.proxy, false);\n    };\n    if (!types) {\n        handlersInElement.forEach((handler) => removeEvent(handler));\n    }\n    else {\n        types.split(' ').forEach((type) => {\n            if (type) {\n                getHandlers(element, type, func, selector).forEach((handler) => removeEvent(handler));\n            }\n        });\n    }\n}\nexport { parse, add, remove };\n","import $ from '../$';\nimport './each';\nimport { parse } from './utils/event';\n$.fn.trigger = function (type, extraParameters) {\n    const event = parse(type);\n    let eventObject;\n    const eventParams = {\n        bubbles: true,\n        cancelable: true,\n    };\n    const isMouseEvent = ['click', 'mousedown', 'mouseup', 'mousemove'].indexOf(event.type) > -1;\n    if (isMouseEvent) {\n        // Note: MouseEvent 无法传入 detail 参数\n        eventObject = new MouseEvent(event.type, eventParams);\n    }\n    else {\n        eventParams.detail = extraParameters;\n        eventObject = new CustomEvent(event.type, eventParams);\n    }\n    // @ts-ignore\n    eventObject._detail = extraParameters;\n    // @ts-ignore\n    eventObject._ns = event.ns;\n    return this.each(function () {\n        this.dispatchEvent(eventObject);\n    });\n};\n","import each from '../functions/each';\nimport { isUndefined } from '../utils';\nfunction extend(target, object1, ...objectN) {\n    objectN.unshift(object1);\n    each(objectN, (_, object) => {\n        each(object, (prop, value) => {\n            if (!isUndefined(value)) {\n                target[prop] = value;\n            }\n        });\n    });\n    return target;\n}\nexport default extend;\n","import { isObjectLike } from '../utils';\nimport each from './each';\n/**\n * 将数组或对象序列化，序列化后的字符串可作为 URL 查询字符串使用\n *\n * 若传入数组，则格式必须和 serializeArray 方法的返回值一样\n * @param obj 对象或数组\n * @example\n```js\nparam({ width: 1680, height: 1050 });\n// width=1680&height=1050\n```\n * @example\n```js\nparam({ foo: { one: 1, two: 2 }})\n// foo[one]=1&foo[two]=2\n```\n * @example\n```js\nparam({ids: [1, 2, 3]})\n// ids[]=1&ids[]=2&ids[]=3\n```\n * @example\n```js\nparam([\n  {\"name\":\"name\",\"value\":\"mdui\"},\n  {\"name\":\"password\",\"value\":\"123456\"}\n])\n// name=mdui&password=123456\n```\n */\nfunction param(obj) {\n    if (!isObjectLike(obj) && !Array.isArray(obj)) {\n        return '';\n    }\n    const args = [];\n    function destructure(key, value) {\n        let keyTmp;\n        if (isObjectLike(value)) {\n            each(value, (i, v) => {\n                if (Array.isArray(value) && !isObjectLike(v)) {\n                    keyTmp = '';\n                }\n                else {\n                    keyTmp = i;\n                }\n                destructure(`${key}[${keyTmp}]`, v);\n            });\n        }\n        else {\n            if (value == null || value === '') {\n                keyTmp = '=';\n            }\n            else {\n                keyTmp = `=${encodeURIComponent(value)}`;\n            }\n            args.push(encodeURIComponent(key) + keyTmp);\n        }\n    }\n    if (Array.isArray(obj)) {\n        each(obj, function () {\n            destructure(this.name, this.value);\n        });\n    }\n    else {\n        each(obj, destructure);\n    }\n    return args.join('&');\n}\nexport default param;\n","// 全局配置参数\nconst globalOptions = {};\n// 全局事件名\nconst ajaxEvents = {\n    ajaxStart: 'start.mdui.ajax',\n    ajaxSuccess: 'success.mdui.ajax',\n    ajaxError: 'error.mdui.ajax',\n    ajaxComplete: 'complete.mdui.ajax',\n};\nexport { globalOptions, ajaxEvents };\n","import $ from '../$';\nimport '../methods/trigger';\nimport { isString, isUndefined } from '../utils';\nimport each from './each';\nimport extend from './extend';\nimport param from './param';\nimport { ajaxEvents, globalOptions } from './utils/ajax';\n/**\n * 判断此请求方法是否通过查询字符串提交参数\n * @param method 请求方法，大写\n */\nfunction isQueryStringData(method) {\n    return ['GET', 'HEAD'].indexOf(method) >= 0;\n}\n/**\n * 添加参数到 URL 上，且 URL 中不存在 ? 时，自动把第一个 & 替换为 ?\n * @param url\n * @param query\n */\nfunction appendQuery(url, query) {\n    return `${url}&${query}`.replace(/[&?]{1,2}/, '?');\n}\n/**\n * 合并请求参数，参数优先级：options > globalOptions > defaults\n * @param options\n */\nfunction mergeOptions(options) {\n    // 默认参数\n    const defaults = {\n        url: '',\n        method: 'GET',\n        data: '',\n        processData: true,\n        async: true,\n        cache: true,\n        username: '',\n        password: '',\n        headers: {},\n        xhrFields: {},\n        statusCode: {},\n        dataType: 'text',\n        contentType: 'application/x-www-form-urlencoded',\n        timeout: 0,\n        global: true,\n    };\n    // globalOptions 中的回调函数不合并\n    each(globalOptions, (key, value) => {\n        const callbacks = [\n            'beforeSend',\n            'success',\n            'error',\n            'complete',\n            'statusCode',\n        ];\n        // @ts-ignore\n        if (callbacks.indexOf(key) < 0 && !isUndefined(value)) {\n            defaults[key] = value;\n        }\n    });\n    return extend({}, defaults, options);\n}\n/**\n * 发送 ajax 请求\n * @param options\n * @example\n```js\najax({\n  method: \"POST\",\n  url: \"some.php\",\n  data: { name: \"John\", location: \"Boston\" }\n}).then(function( msg ) {\n  alert( \"Data Saved: \" + msg );\n});\n```\n */\nfunction ajax(options) {\n    // 是否已取消请求\n    let isCanceled = false;\n    // 事件参数\n    const eventParams = {};\n    // 参数合并\n    const mergedOptions = mergeOptions(options);\n    let url = mergedOptions.url || window.location.toString();\n    const method = mergedOptions.method.toUpperCase();\n    let data = mergedOptions.data;\n    const processData = mergedOptions.processData;\n    const async = mergedOptions.async;\n    const cache = mergedOptions.cache;\n    const username = mergedOptions.username;\n    const password = mergedOptions.password;\n    const headers = mergedOptions.headers;\n    const xhrFields = mergedOptions.xhrFields;\n    const statusCode = mergedOptions.statusCode;\n    const dataType = mergedOptions.dataType;\n    const contentType = mergedOptions.contentType;\n    const timeout = mergedOptions.timeout;\n    const global = mergedOptions.global;\n    // 需要发送的数据\n    // GET/HEAD 请求和 processData 为 true 时，转换为查询字符串格式，特殊格式不转换\n    if (data &&\n        (isQueryStringData(method) || processData) &&\n        !isString(data) &&\n        !(data instanceof ArrayBuffer) &&\n        !(data instanceof Blob) &&\n        !(data instanceof Document) &&\n        !(data instanceof FormData)) {\n        data = param(data);\n    }\n    // 对于 GET、HEAD 类型的请求，把 data 数据添加到 URL 中\n    if (data && isQueryStringData(method)) {\n        // 查询字符串拼接到 URL 中\n        url = appendQuery(url, data);\n        data = null;\n    }\n    /**\n     * 触发事件和回调函数\n     * @param event\n     * @param params\n     * @param callback\n     * @param args\n     */\n    function trigger(event, params, callback, ...args) {\n        // 触发全局事件\n        if (global) {\n            $(document).trigger(event, params);\n        }\n        // 触发 ajax 回调和事件\n        let result1;\n        let result2;\n        if (callback) {\n            // 全局回调\n            if (callback in globalOptions) {\n                // @ts-ignore\n                result1 = globalOptions[callback](...args);\n            }\n            // 自定义回调\n            if (mergedOptions[callback]) {\n                // @ts-ignore\n                result2 = mergedOptions[callback](...args);\n            }\n            // beforeSend 回调返回 false 时取消 ajax 请求\n            if (callback === 'beforeSend' &&\n                (result1 === false || result2 === false)) {\n                isCanceled = true;\n            }\n        }\n    }\n    // XMLHttpRequest 请求\n    function XHR() {\n        let textStatus;\n        return new Promise((resolve, reject) => {\n            // GET/HEAD 请求的缓存处理\n            if (isQueryStringData(method) && !cache) {\n                url = appendQuery(url, `_=${Date.now()}`);\n            }\n            // 创建 XHR\n            const xhr = new XMLHttpRequest();\n            xhr.open(method, url, async, username, password);\n            if (contentType ||\n                (data && !isQueryStringData(method) && contentType !== false)) {\n                xhr.setRequestHeader('Content-Type', contentType);\n            }\n            // 设置 Accept\n            if (dataType === 'json') {\n                xhr.setRequestHeader('Accept', 'application/json, text/javascript');\n            }\n            // 添加 headers\n            if (headers) {\n                each(headers, (key, value) => {\n                    // undefined 值不发送，string 和 null 需要发送\n                    if (!isUndefined(value)) {\n                        xhr.setRequestHeader(key, value + ''); // 把 null 转换成字符串\n                    }\n                });\n            }\n            // 检查是否是跨域请求，跨域请求时不添加 X-Requested-With\n            const crossDomain = /^([\\w-]+:)?\\/\\/([^/]+)/.test(url) &&\n                RegExp.$2 !== window.location.host;\n            if (!crossDomain) {\n                xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n            }\n            if (xhrFields) {\n                each(xhrFields, (key, value) => {\n                    // @ts-ignore\n                    xhr[key] = value;\n                });\n            }\n            eventParams.xhr = xhr;\n            eventParams.options = mergedOptions;\n            let xhrTimeout;\n            xhr.onload = function () {\n                if (xhrTimeout) {\n                    clearTimeout(xhrTimeout);\n                }\n                // AJAX 返回的 HTTP 响应码是否表示成功\n                const isHttpStatusSuccess = (xhr.status >= 200 && xhr.status < 300) ||\n                    xhr.status === 304 ||\n                    xhr.status === 0;\n                let responseData;\n                if (isHttpStatusSuccess) {\n                    if (xhr.status === 204 || method === 'HEAD') {\n                        textStatus = 'nocontent';\n                    }\n                    else if (xhr.status === 304) {\n                        textStatus = 'notmodified';\n                    }\n                    else {\n                        textStatus = 'success';\n                    }\n                    if (dataType === 'json') {\n                        try {\n                            responseData =\n                                method === 'HEAD' ? undefined : JSON.parse(xhr.responseText);\n                            eventParams.data = responseData;\n                        }\n                        catch (err) {\n                            textStatus = 'parsererror';\n                            trigger(ajaxEvents.ajaxError, eventParams, 'error', xhr, textStatus);\n                            reject(new Error(textStatus));\n                        }\n                        if (textStatus !== 'parsererror') {\n                            trigger(ajaxEvents.ajaxSuccess, eventParams, 'success', responseData, textStatus, xhr);\n                            resolve(responseData);\n                        }\n                    }\n                    else {\n                        responseData =\n                            method === 'HEAD'\n                                ? undefined\n                                : xhr.responseType === 'text' || xhr.responseType === ''\n                                    ? xhr.responseText\n                                    : xhr.response;\n                        eventParams.data = responseData;\n                        trigger(ajaxEvents.ajaxSuccess, eventParams, 'success', responseData, textStatus, xhr);\n                        resolve(responseData);\n                    }\n                }\n                else {\n                    textStatus = 'error';\n                    trigger(ajaxEvents.ajaxError, eventParams, 'error', xhr, textStatus);\n                    reject(new Error(textStatus));\n                }\n                // statusCode\n                each([globalOptions.statusCode, statusCode], (_, func) => {\n                    if (func && func[xhr.status]) {\n                        if (isHttpStatusSuccess) {\n                            func[xhr.status](responseData, textStatus, xhr);\n                        }\n                        else {\n                            func[xhr.status](xhr, textStatus);\n                        }\n                    }\n                });\n                trigger(ajaxEvents.ajaxComplete, eventParams, 'complete', xhr, textStatus);\n            };\n            xhr.onerror = function () {\n                if (xhrTimeout) {\n                    clearTimeout(xhrTimeout);\n                }\n                trigger(ajaxEvents.ajaxError, eventParams, 'error', xhr, xhr.statusText);\n                trigger(ajaxEvents.ajaxComplete, eventParams, 'complete', xhr, 'error');\n                reject(new Error(xhr.statusText));\n            };\n            xhr.onabort = function () {\n                let statusText = 'abort';\n                if (xhrTimeout) {\n                    statusText = 'timeout';\n                    clearTimeout(xhrTimeout);\n                }\n                trigger(ajaxEvents.ajaxError, eventParams, 'error', xhr, statusText);\n                trigger(ajaxEvents.ajaxComplete, eventParams, 'complete', xhr, statusText);\n                reject(new Error(statusText));\n            };\n            // ajax start 回调\n            trigger(ajaxEvents.ajaxStart, eventParams, 'beforeSend', xhr);\n            if (isCanceled) {\n                reject(new Error('cancel'));\n                return;\n            }\n            // Timeout\n            if (timeout > 0) {\n                xhrTimeout = setTimeout(() => {\n                    xhr.abort();\n                }, timeout);\n            }\n            // 发送 XHR\n            xhr.send(data);\n        });\n    }\n    return XHR();\n}\nexport default ajax;\n","import $ from '../$';\nimport ajax from '../functions/ajax';\n$.ajax = ajax;\n","import extend from '../functions/extend';\nimport { globalOptions } from './utils/ajax';\n/**\n * 为 Ajax 请求设置全局配置参数\n * @param options 键值对参数\n * @example\n```js\najaxSetup({\n  dataType: 'json',\n  method: 'POST',\n});\n```\n */\nfunction ajaxSetup(options) {\n    return extend(globalOptions, options);\n}\nexport default ajaxSetup;\n","import $ from '../$';\nimport ajaxSetup from '../functions/ajaxSetup';\n$.ajaxSetup = ajaxSetup;\n","import $ from '../$';\nimport contains from '../functions/contains';\n$.contains = contains;\n","const dataNS = '_mduiElementDataStorage';\nexport default dataNS;\n","import { isObjectLike, isUndefined, toCamelCase } from '../utils';\nimport each from './each';\nimport dataNS from './utils/data';\n/**\n * 在元素上设置键值对数据\n * @param element\n * @param object\n */\nfunction setObjectToElement(element, object) {\n    // @ts-ignore\n    if (!element[dataNS]) {\n        // @ts-ignore\n        element[dataNS] = {};\n    }\n    each(object, (key, value) => {\n        // @ts-ignore\n        element[dataNS][toCamelCase(key)] = value;\n    });\n}\nfunction data(element, key, value) {\n    // 根据键值对设置值\n    // data(element, { 'key' : 'value' })\n    if (isObjectLike(key)) {\n        setObjectToElement(element, key);\n        return key;\n    }\n    // 根据 key、value 设置值\n    // data(element, 'key', 'value')\n    if (!isUndefined(value)) {\n        setObjectToElement(element, { [key]: value });\n        return value;\n    }\n    // 获取所有值\n    // data(element)\n    if (isUndefined(key)) {\n        // @ts-ignore\n        return element[dataNS] ? element[dataNS] : {};\n    }\n    // 从 dataNS 中获取指定值\n    // data(element, 'key')\n    key = toCamelCase(key);\n    // @ts-ignore\n    if (element[dataNS] && key in element[dataNS]) {\n        // @ts-ignore\n        return element[dataNS][key];\n    }\n    return undefined;\n}\nexport default data;\n","import $ from '../$';\nimport data from '../functions/data';\n$.data = data;\n","import $ from '../$';\nimport each from '../functions/each';\n$.each = each;\n","import $ from '../$';\nimport each from '../functions/each';\nimport extend from '../functions/extend';\n$.extend = function (...objectN) {\n    if (objectN.length === 1) {\n        each(objectN[0], (prop, value) => {\n            this[prop] = value;\n        });\n        return this;\n    }\n    return extend(objectN.shift(), objectN.shift(), ...objectN);\n};\n","import each from './each';\nfunction map(elements, callback) {\n    let value;\n    const ret = [];\n    each(elements, (i, element) => {\n        value = callback.call(window, element, i);\n        if (value != null) {\n            ret.push(value);\n        }\n    });\n    return [].concat(...ret);\n}\nexport default map;\n","import $ from '../$';\nimport map from '../functions/map';\n$.map = map;\n","import $ from '../$';\nimport merge from '../functions/merge';\n$.merge = merge;\n","import $ from '../$';\nimport param from '../functions/param';\n$.param = param;\n","import each from '../functions/each';\nimport { isUndefined, isString, toCamelCase } from '../utils';\nimport dataNS from './utils/data';\n/**\n * 移除指定元素上存放的数据\n * @param element 存放数据的元素\n * @param name\n * 数据键名\n *\n * 若未指定键名，将移除元素上所有数据\n *\n * 多个键名可以用空格分隔，或者用数组表示多个键名\n  @example\n```js\n// 移除元素上键名为 name 的数据\nremoveData(document.body, 'name');\n```\n * @example\n```js\n// 移除元素上键名为 name1 和 name2 的数据\nremoveData(document.body, 'name1 name2');\n```\n * @example\n```js\n// 移除元素上键名为 name1 和 name2 的数据\nremoveData(document.body, ['name1', 'name2']);\n```\n * @example\n```js\n// 移除元素上所有数据\nremoveData(document.body);\n```\n */\nfunction removeData(element, name) {\n    // @ts-ignore\n    if (!element[dataNS]) {\n        return;\n    }\n    const remove = (nameItem) => {\n        nameItem = toCamelCase(nameItem);\n        // @ts-ignore\n        if (element[dataNS][nameItem]) {\n            // @ts-ignore\n            element[dataNS][nameItem] = null;\n            // @ts-ignore\n            delete element[dataNS][nameItem];\n        }\n    };\n    if (isUndefined(name)) {\n        // @ts-ignore\n        element[dataNS] = null;\n        // @ts-ignore\n        delete element[dataNS];\n        // @ts-ignore\n    }\n    else if (isString(name)) {\n        name\n            .split(' ')\n            .filter((nameItem) => nameItem)\n            .forEach((nameItem) => remove(nameItem));\n    }\n    else {\n        each(name, (_, nameItem) => remove(nameItem));\n    }\n}\nexport default removeData;\n","import $ from '../$';\nimport removeData from '../functions/removeData';\n$.removeData = removeData;\n","import each from './each';\n/**\n * 过滤掉数组中的重复元素\n * @param arr 数组\n * @example\n```js\nunique([1, 2, 12, 3, 2, 1, 2, 1, 1]);\n// [1, 2, 12, 3]\n```\n */\nfunction unique(arr) {\n    const result = [];\n    each(arr, (_, val) => {\n        if (result.indexOf(val) === -1) {\n            result.push(val);\n        }\n    });\n    return result;\n}\nexport default unique;\n","import $ from '../$';\nimport unique from '../functions/unique';\n$.unique = unique;\n","import $ from '../$';\nimport merge from '../functions/merge';\nimport unique from '../functions/unique';\nimport { JQ } from '../JQ';\nimport './get';\n$.fn.add = function (selector) {\n    return new JQ(unique(merge(this.get(), $(selector).get())));\n};\n","import $ from '../$';\nimport each from '../functions/each';\nimport { isElement, isFunction } from '../utils';\nimport './each';\neach(['add', 'remove', 'toggle'], (_, name) => {\n    $.fn[`${name}Class`] = function (className) {\n        if (name === 'remove' && !arguments.length) {\n            return this.each((_, element) => {\n                element.setAttribute('class', '');\n            });\n        }\n        return this.each((i, element) => {\n            if (!isElement(element)) {\n                return;\n            }\n            const classes = (isFunction(className)\n                ? className.call(element, i, element.getAttribute('class') || '')\n                : className)\n                .split(' ')\n                .filter((name) => name);\n            each(classes, (_, cls) => {\n                element.classList[name](cls);\n            });\n        });\n    };\n});\n","import $ from '../$';\nimport each from '../functions/each';\nimport './each';\neach(['insertBefore', 'insertAfter'], (nameIndex, name) => {\n    $.fn[name] = function (target) {\n        const $element = nameIndex ? $(this.get().reverse()) : this; // 顺序和 jQuery 保持一致\n        const $target = $(target);\n        const result = [];\n        $target.each((index, target) => {\n            if (!target.parentNode) {\n                return;\n            }\n            $element.each((_, element) => {\n                const newItem = index\n                    ? element.cloneNode(true)\n                    : element;\n                const existingItem = nameIndex ? target.nextSibling : target;\n                result.push(newItem);\n                target.parentNode.insertBefore(newItem, existingItem);\n            });\n        });\n        return $(nameIndex ? result.reverse() : result);\n    };\n});\n","import $ from '../$';\nimport each from '../functions/each';\nimport { getChildNodesArray, isFunction, isString, isElement } from '../utils';\nimport './each';\nimport './insertAfter';\nimport './insertBefore';\n/**\n * 是否不是 HTML 字符串（包裹在 <> 中）\n * @param target\n */\nfunction isPlainText(target) {\n    return (isString(target) && (target[0] !== '<' || target[target.length - 1] !== '>'));\n}\neach(['before', 'after'], (nameIndex, name) => {\n    $.fn[name] = function (...args) {\n        // after 方法，多个参数需要按参数顺序添加到元素后面，所以需要将参数顺序反向处理\n        if (nameIndex === 1) {\n            args = args.reverse();\n        }\n        return this.each((index, element) => {\n            const targets = isFunction(args[0])\n                ? [args[0].call(element, index, element.innerHTML)]\n                : args;\n            each(targets, (_, target) => {\n                let $target;\n                if (isPlainText(target)) {\n                    $target = $(getChildNodesArray(target, 'div'));\n                }\n                else if (index && isElement(target)) {\n                    $target = $(target.cloneNode(true));\n                }\n                else {\n                    $target = $(target);\n                }\n                $target[nameIndex ? 'insertAfter' : 'insertBefore'](element);\n            });\n        });\n    };\n});\n","import $ from '../$';\nimport each from '../functions/each';\nimport { isFunction, isObjectLike, returnFalse } from '../utils';\nimport './each';\nimport { remove } from './utils/event';\n$.fn.off = function (types, selector, callback) {\n    // types 是对象\n    if (isObjectLike(types)) {\n        each(types, (type, fn) => {\n            // this.off('click', undefined, function () {})\n            // this.off('click', '.box', function () {})\n            this.off(type, selector, fn);\n        });\n        return this;\n    }\n    // selector 不存在\n    if (selector === false || isFunction(selector)) {\n        callback = selector;\n        selector = undefined;\n        // this.off('click', undefined, function () {})\n    }\n    // callback 传入 `false`，相当于 `return false`\n    if (callback === false) {\n        callback = returnFalse;\n    }\n    return this.each(function () {\n        remove(this, types, callback, selector);\n    });\n};\n","import $ from '../$';\nimport each from '../functions/each';\nimport { isObjectLike, isString, returnFalse } from '../utils';\nimport './each';\nimport './off';\nimport { add } from './utils/event';\n$.fn.on = function (types, selector, data, callback, one) {\n    // types 可以是 type/func 对象\n    if (isObjectLike(types)) {\n        // (types-Object, selector, data)\n        if (!isString(selector)) {\n            // (types-Object, data)\n            data = data || selector;\n            selector = undefined;\n        }\n        each(types, (type, fn) => {\n            // selector 和 data 都可能是 undefined\n            // @ts-ignore\n            this.on(type, selector, data, fn, one);\n        });\n        return this;\n    }\n    if (data == null && callback == null) {\n        // (types, fn)\n        callback = selector;\n        data = selector = undefined;\n    }\n    else if (callback == null) {\n        if (isString(selector)) {\n            // (types, selector, fn)\n            callback = data;\n            data = undefined;\n        }\n        else {\n            // (types, data, fn)\n            callback = data;\n            data = selector;\n            selector = undefined;\n        }\n    }\n    if (callback === false) {\n        callback = returnFalse;\n    }\n    else if (!callback) {\n        return this;\n    }\n    // $().one()\n    if (one) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        const _this = this;\n        const origCallback = callback;\n        callback = function (event) {\n            _this.off(event.type, selector, callback);\n            // eslint-disable-next-line prefer-rest-params\n            return origCallback.apply(this, arguments);\n        };\n    }\n    return this.each(function () {\n        add(this, types, callback, data, selector);\n    });\n};\n","import $ from '../$';\nimport each from '../functions/each';\nimport { ajaxEvents } from '../functions/utils/ajax';\nimport './on';\neach(ajaxEvents, (name, eventName) => {\n    $.fn[name] = function (fn) {\n        return this.on(eventName, (e, params) => {\n            fn(e, params.xhr, params.options, params.data);\n        });\n    };\n});\n","import $ from '../$';\nimport map from '../functions/map';\nimport { JQ } from '../JQ';\n$.fn.map = function (callback) {\n    return new JQ(map(this, (element, i) => callback.call(element, i, element)));\n};\n","import $ from '../$';\nimport './map';\n$.fn.clone = function () {\n    return this.map(function () {\n        return this.cloneNode(true);\n    });\n};\n","import $ from '../$';\nimport { isDocument, isFunction, isString, isWindow } from '../utils';\nimport './each';\n$.fn.is = function (selector) {\n    let isMatched = false;\n    if (isFunction(selector)) {\n        this.each((index, element) => {\n            if (selector.call(element, index, element)) {\n                isMatched = true;\n            }\n        });\n        return isMatched;\n    }\n    if (isString(selector)) {\n        this.each((_, element) => {\n            if (isDocument(element) || isWindow(element)) {\n                return;\n            }\n            // @ts-ignore\n            const matches = element.matches || element.msMatchesSelector;\n            if (matches.call(element, selector)) {\n                isMatched = true;\n            }\n        });\n        return isMatched;\n    }\n    const $compareWith = $(selector);\n    this.each((_, element) => {\n        $compareWith.each((_, compare) => {\n            if (element === compare) {\n                isMatched = true;\n            }\n        });\n    });\n    return isMatched;\n};\n","import $ from '../$';\nimport './each';\nimport './is';\n$.fn.remove = function (selector) {\n    return this.each((_, element) => {\n        if (element.parentNode && (!selector || $(element).is(selector))) {\n            element.parentNode.removeChild(element);\n        }\n    });\n};\n","import $ from '../$';\nimport each from '../functions/each';\nimport { isFunction, isString } from '../utils';\nimport './after';\nimport './before';\nimport './clone';\nimport './each';\nimport './map';\nimport './remove';\neach(['prepend', 'append'], (nameIndex, name) => {\n    $.fn[name] = function (...args) {\n        return this.each((index, element) => {\n            const childNodes = element.childNodes;\n            const childLength = childNodes.length;\n            const child = childLength\n                ? childNodes[nameIndex ? childLength - 1 : 0]\n                : document.createElement('div');\n            if (!childLength) {\n                element.appendChild(child);\n            }\n            let contents = isFunction(args[0])\n                ? [args[0].call(element, index, element.innerHTML)]\n                : args;\n            // 如果不是字符串，则仅第一个元素使用原始元素，其他的都克隆自第一个元素\n            if (index) {\n                contents = contents.map((content) => {\n                    return isString(content) ? content : $(content).clone();\n                });\n            }\n            $(child)[nameIndex ? 'after' : 'before'](...contents);\n            if (!childLength) {\n                element.removeChild(child);\n            }\n        });\n    };\n});\n","import $ from '../$';\nimport each from '../functions/each';\nimport './insertAfter';\nimport './insertBefore';\nimport './map';\nimport './remove';\neach(['appendTo', 'prependTo'], (nameIndex, name) => {\n    $.fn[name] = function (target) {\n        const extraChilds = [];\n        const $target = $(target).map((_, element) => {\n            const childNodes = element.childNodes;\n            const childLength = childNodes.length;\n            if (childLength) {\n                return childNodes[nameIndex ? 0 : childLength - 1];\n            }\n            const child = document.createElement('div');\n            element.appendChild(child);\n            extraChilds.push(child);\n            return child;\n        });\n        const $result = this[nameIndex ? 'insertBefore' : 'insertAfter']($target);\n        $(extraChilds).remove();\n        return $result;\n    };\n});\n","import $ from '../$';\nimport each from '../functions/each';\nimport { cssNumber, getStyle, isElement, isFunction, isNull, isNumber, isObjectLike, isUndefined, toCamelCase, } from '../utils';\nimport './each';\neach(['attr', 'prop', 'css'], (nameIndex, name) => {\n    function set(element, key, value) {\n        // 值为 undefined 时，不修改\n        if (isUndefined(value)) {\n            return;\n        }\n        switch (nameIndex) {\n            // attr\n            case 0:\n                if (isNull(value)) {\n                    element.removeAttribute(key);\n                }\n                else {\n                    element.setAttribute(key, value);\n                }\n                break;\n            // prop\n            case 1:\n                // @ts-ignore\n                element[key] = value;\n                break;\n            // css\n            default:\n                key = toCamelCase(key);\n                // @ts-ignore\n                element.style[key] = isNumber(value)\n                    ? `${value}${cssNumber.indexOf(key) > -1 ? '' : 'px'}`\n                    : value;\n                break;\n        }\n    }\n    function get(element, key) {\n        switch (nameIndex) {\n            // attr\n            case 0:\n                // 属性不存在时，原生 getAttribute 方法返回 null，而 jquery 返回 undefined。这里和 jquery 保持一致\n                const value = element.getAttribute(key);\n                return isNull(value) ? undefined : value;\n            // prop\n            case 1:\n                // @ts-ignore\n                return element[key];\n            // css\n            default:\n                return getStyle(element, key);\n        }\n    }\n    $.fn[name] = function (key, value) {\n        if (isObjectLike(key)) {\n            each(key, (k, v) => {\n                // @ts-ignore\n                this[name](k, v);\n            });\n            return this;\n        }\n        if (arguments.length === 1) {\n            const element = this[0];\n            return isElement(element) ? get(element, key) : undefined;\n        }\n        return this.each((i, element) => {\n            set(element, key, isFunction(value) ? value.call(element, i, get(element, key)) : value);\n        });\n    };\n});\n","import $ from '../$';\nimport each from '../functions/each';\nimport unique from '../functions/unique';\nimport { JQ } from '../JQ';\nimport { isElement } from '../utils';\nimport './each';\nimport './is';\n$.fn.children = function (selector) {\n    const children = [];\n    this.each((_, element) => {\n        each(element.childNodes, (__, childNode) => {\n            if (!isElement(childNode)) {\n                return;\n            }\n            if (!selector || $(childNode).is(selector)) {\n                children.push(childNode);\n            }\n        });\n    });\n    return new JQ(unique(children));\n};\n","import $ from '../$';\nimport { JQ } from '../JQ';\n$.fn.slice = function (...args) {\n    return new JQ([].slice.apply(this, args));\n};\n","import $ from '../$';\nimport { JQ } from '../JQ';\nimport './slice';\n$.fn.eq = function (index) {\n    const ret = index === -1 ? this.slice(index) : this.slice(index, +index + 1);\n    return new JQ(ret);\n};\n","import $ from '../../$';\nimport unique from '../../functions/unique';\nimport { JQ } from '../../JQ';\nimport { isElement } from '../../utils';\nimport '../each';\nimport '../is';\nexport default function dir($elements, nameIndex, node, selector, filter) {\n    const ret = [];\n    let target;\n    $elements.each((_, element) => {\n        target = element[node];\n        // 不能包含最顶层的 document 元素\n        while (target && isElement(target)) {\n            // prevUntil, nextUntil, parentsUntil\n            if (nameIndex === 2) {\n                if (selector && $(target).is(selector)) {\n                    break;\n                }\n                if (!filter || $(target).is(filter)) {\n                    ret.push(target);\n                }\n            }\n            // prev, next, parent\n            else if (nameIndex === 0) {\n                if (!selector || $(target).is(selector)) {\n                    ret.push(target);\n                }\n                break;\n            }\n            // prevAll, nextAll, parents\n            else {\n                if (!selector || $(target).is(selector)) {\n                    ret.push(target);\n                }\n            }\n            // @ts-ignore\n            target = target[node];\n        }\n    });\n    return new JQ(unique(ret));\n}\n","import $ from '../$';\nimport each from '../functions/each';\nimport './get';\nimport dir from './utils/dir';\neach(['', 's', 'sUntil'], (nameIndex, name) => {\n    $.fn[`parent${name}`] = function (selector, filter) {\n        // parents、parentsUntil 需要把元素的顺序反向处理，以便和 jQuery 的结果一致\n        const $nodes = !nameIndex ? this : $(this.get().reverse());\n        return dir($nodes, nameIndex, 'parentNode', selector, filter);\n    };\n});\n","import $ from '../$';\nimport { JQ } from '../JQ';\nimport './eq';\nimport './is';\nimport './parents';\n$.fn.closest = function (selector) {\n    if (this.is(selector)) {\n        return this;\n    }\n    const matched = [];\n    this.parents().each((_, element) => {\n        if ($(element).is(selector)) {\n            matched.push(element);\n            return false;\n        }\n    });\n    return new JQ(matched);\n};\n","import $ from '../$';\nimport data from '../functions/data';\nimport { isObjectLike, isString, isUndefined, toCamelCase, toKebabCase, } from '../utils';\nimport './each';\nconst rbrace = /^(?:{[\\w\\W]*\\}|\\[[\\w\\W]*\\])$/;\n// 从 `data-*` 中获取的值，需要经过该函数转换\nfunction getData(value) {\n    if (value === 'true') {\n        return true;\n    }\n    if (value === 'false') {\n        return false;\n    }\n    if (value === 'null') {\n        return null;\n    }\n    if (value === +value + '') {\n        return +value;\n    }\n    if (rbrace.test(value)) {\n        return JSON.parse(value);\n    }\n    return value;\n}\n// 若 value 不存在，则从 `data-*` 中获取值\nfunction dataAttr(element, key, value) {\n    if (isUndefined(value) && element.nodeType === 1) {\n        const name = 'data-' + toKebabCase(key);\n        value = element.getAttribute(name);\n        if (isString(value)) {\n            try {\n                value = getData(value);\n            }\n            catch (e) { }\n        }\n        else {\n            value = undefined;\n        }\n    }\n    return value;\n}\n$.fn.data = function (key, value) {\n    // 获取所有值\n    if (isUndefined(key)) {\n        if (!this.length) {\n            return undefined;\n        }\n        const element = this[0];\n        const resultData = data(element);\n        // window, document 上不存在 `data-*` 属性\n        if (element.nodeType !== 1) {\n            return resultData;\n        }\n        // 从 `data-*` 中获取值\n        const attrs = element.attributes;\n        let i = attrs.length;\n        while (i--) {\n            if (attrs[i]) {\n                let name = attrs[i].name;\n                if (name.indexOf('data-') === 0) {\n                    name = toCamelCase(name.slice(5));\n                    resultData[name] = dataAttr(element, name, resultData[name]);\n                }\n            }\n        }\n        return resultData;\n    }\n    // 同时设置多个值\n    if (isObjectLike(key)) {\n        return this.each(function () {\n            data(this, key);\n        });\n    }\n    // value 传入了 undefined\n    if (arguments.length === 2 && isUndefined(value)) {\n        return this;\n    }\n    // 设置值\n    if (!isUndefined(value)) {\n        return this.each(function () {\n            data(this, key, value);\n        });\n    }\n    // 获取值\n    if (!this.length) {\n        return undefined;\n    }\n    return dataAttr(this[0], key, data(this[0], key));\n};\n","import $ from '../$';\nimport './each';\n$.fn.empty = function () {\n    return this.each(function () {\n        this.innerHTML = '';\n    });\n};\n","import $ from '../$';\nimport each from '../functions/each';\n$.fn.extend = function (obj) {\n    each(obj, (prop, value) => {\n        // 在 JQ 对象上扩展方法时，需要自己添加 typescript 的类型定义\n        $.fn[prop] = value;\n    });\n    return this;\n};\n","import $ from '../$';\nimport { isFunction, isString } from '../utils';\nimport './is';\nimport './map';\n$.fn.filter = function (selector) {\n    if (isFunction(selector)) {\n        return this.map((index, element) => selector.call(element, index, element) ? element : undefined);\n    }\n    if (isString(selector)) {\n        return this.map((_, element) => $(element).is(selector) ? element : undefined);\n    }\n    const $selector = $(selector);\n    return this.map((_, element) => $selector.get().indexOf(element) > -1 ? element : undefined);\n};\n","import $ from '../$';\nimport './eq';\n$.fn.first = function () {\n    return this.eq(0);\n};\n","import $ from '../$';\nimport contains from '../functions/contains';\nimport { isString } from '../utils';\nimport './find';\n$.fn.has = function (selector) {\n    const $targets = isString(selector) ? this.find(selector) : $(selector);\n    const { length } = $targets;\n    return this.map(function () {\n        for (let i = 0; i < length; i += 1) {\n            if (contains(this, $targets[i])) {\n                return this;\n            }\n        }\n        return;\n    });\n};\n","import $ from '../$';\n$.fn.hasClass = function (className) {\n    return this[0].classList.contains(className);\n};\n","import $ from '../$';\nimport each from '../functions/each';\nimport { isBoolean, isDocument, isFunction, isWindow, toElement, isBorderBox, getExtraWidth, getComputedStyleValue, isIE, } from '../utils';\nimport './css';\nimport './each';\n/**\n * 值上面的 padding、border、margin 处理\n * @param element\n * @param name\n * @param value\n * @param funcIndex\n * @param includeMargin\n * @param multiply\n */\nfunction handleExtraWidth(element, name, value, funcIndex, includeMargin, multiply) {\n    // 获取元素的 padding, border, margin 宽度（两侧宽度的和）\n    const getExtraWidthValue = (extra) => {\n        return (getExtraWidth(element, name.toLowerCase(), extra) *\n            multiply);\n    };\n    if (funcIndex === 2 && includeMargin) {\n        value += getExtraWidthValue('margin');\n    }\n    if (isBorderBox(element)) {\n        // IE 为 box-sizing: border-box 时，得到的值不含 border 和 padding，这里先修复\n        // 仅获取时需要处理，multiply === 1 为 get\n        if (isIE() && multiply === 1) {\n            value += getExtraWidthValue('border');\n            value += getExtraWidthValue('padding');\n        }\n        if (funcIndex === 0) {\n            value -= getExtraWidthValue('border');\n        }\n        if (funcIndex === 1) {\n            value -= getExtraWidthValue('border');\n            value -= getExtraWidthValue('padding');\n        }\n    }\n    else {\n        if (funcIndex === 0) {\n            value += getExtraWidthValue('padding');\n        }\n        if (funcIndex === 2) {\n            value += getExtraWidthValue('border');\n            value += getExtraWidthValue('padding');\n        }\n    }\n    return value;\n}\n/**\n * 获取元素的样式值\n * @param element\n * @param name\n * @param funcIndex 0: innerWidth, innerHeight; 1: width, height; 2: outerWidth, outerHeight\n * @param includeMargin\n */\nfunction get(element, name, funcIndex, includeMargin) {\n    const clientProp = `client${name}`;\n    const scrollProp = `scroll${name}`;\n    const offsetProp = `offset${name}`;\n    const innerProp = `inner${name}`;\n    // $(window).width()\n    if (isWindow(element)) {\n        // outerWidth, outerHeight 需要包含滚动条的宽度\n        return funcIndex === 2\n            ? element[innerProp]\n            : toElement(document)[clientProp];\n    }\n    // $(document).width()\n    if (isDocument(element)) {\n        const doc = toElement(element);\n        return Math.max(\n        // @ts-ignore\n        element.body[scrollProp], doc[scrollProp], \n        // @ts-ignore\n        element.body[offsetProp], doc[offsetProp], doc[clientProp]);\n    }\n    const value = parseFloat(getComputedStyleValue(element, name.toLowerCase()) || '0');\n    return handleExtraWidth(element, name, value, funcIndex, includeMargin, 1);\n}\n/**\n * 设置元素的样式值\n * @param element\n * @param elementIndex\n * @param name\n * @param funcIndex 0: innerWidth, innerHeight; 1: width, height; 2: outerWidth, outerHeight\n * @param includeMargin\n * @param value\n */\nfunction set(element, elementIndex, name, funcIndex, includeMargin, value) {\n    let computedValue = isFunction(value)\n        ? value.call(element, elementIndex, get(element, name, funcIndex, includeMargin))\n        : value;\n    if (computedValue == null) {\n        return;\n    }\n    const $element = $(element);\n    const dimension = name.toLowerCase();\n    // 特殊的值，不需要计算 padding、border、margin\n    if (['auto', 'inherit', ''].indexOf(computedValue) > -1) {\n        $element.css(dimension, computedValue);\n        return;\n    }\n    // 其他值保留原始单位。注意：如果不使用 px 作为单位，则算出的值一般是不准确的\n    const suffix = computedValue.toString().replace(/\\b[0-9.]*/, '');\n    const numerical = parseFloat(computedValue);\n    computedValue =\n        handleExtraWidth(element, name, numerical, funcIndex, includeMargin, -1) +\n            (suffix || 'px');\n    $element.css(dimension, computedValue);\n}\neach(['Width', 'Height'], (_, name) => {\n    each([`inner${name}`, name.toLowerCase(), `outer${name}`], (funcIndex, funcName) => {\n        $.fn[funcName] = function (margin, value) {\n            // 是否是赋值操作\n            const isSet = arguments.length && (funcIndex < 2 || !isBoolean(margin));\n            const includeMargin = margin === true || value === true;\n            // 获取第一个元素的值\n            if (!isSet) {\n                return this.length\n                    ? get(this[0], name, funcIndex, includeMargin)\n                    : undefined;\n            }\n            // 设置每个元素的值\n            return this.each((index, element) => set(element, index, name, funcIndex, includeMargin, margin));\n        };\n    });\n});\n","import $ from '../$';\nimport './each';\n$.fn.hide = function () {\n    return this.each(function () {\n        this.style.display = 'none';\n    });\n};\n","import $ from '../$';\nimport each from '../functions/each';\nimport map from '../functions/map';\nimport { isElement, isFunction, isUndefined, toElement } from '../utils';\nimport './each';\nimport './is';\neach(['val', 'html', 'text'], (nameIndex, name) => {\n    const props = {\n        0: 'value',\n        1: 'innerHTML',\n        2: 'textContent',\n    };\n    const propName = props[nameIndex];\n    function get($elements) {\n        // text() 获取所有元素的文本\n        if (nameIndex === 2) {\n            // @ts-ignore\n            return map($elements, (element) => toElement(element)[propName]).join('');\n        }\n        // 空集合时，val() 和 html() 返回 undefined\n        if (!$elements.length) {\n            return undefined;\n        }\n        // val() 和 html() 仅获取第一个元素的内容\n        const firstElement = $elements[0];\n        // select multiple 返回数组\n        if (nameIndex === 0 && $(firstElement).is('select[multiple]')) {\n            return map($(firstElement).find('option:checked'), (element) => element.value);\n        }\n        // @ts-ignore\n        return firstElement[propName];\n    }\n    function set(element, value) {\n        // text() 和 html() 赋值为 undefined，则保持原内容不变\n        // val() 赋值为 undefined 则赋值为空\n        if (isUndefined(value)) {\n            if (nameIndex !== 0) {\n                return;\n            }\n            value = '';\n        }\n        if (nameIndex === 1 && isElement(value)) {\n            value = value.outerHTML;\n        }\n        // @ts-ignore\n        element[propName] = value;\n    }\n    $.fn[name] = function (value) {\n        // 获取值\n        if (!arguments.length) {\n            return get(this);\n        }\n        // 设置值\n        return this.each((i, element) => {\n            const computedValue = isFunction(value)\n                ? value.call(element, i, get($(element)))\n                : value;\n            // value 是数组，则选中数组中的元素，反选不在数组中的元素\n            if (nameIndex === 0 && Array.isArray(computedValue)) {\n                // select[multiple]\n                if ($(element).is('select[multiple]')) {\n                    map($(element).find('option'), (option) => (option.selected =\n                        computedValue.indexOf(option.value) >\n                            -1));\n                }\n                // 其他 checkbox, radio 等元素\n                else {\n                    element.checked =\n                        computedValue.indexOf(element.value) > -1;\n                }\n            }\n            else {\n                set(element, computedValue);\n            }\n        });\n    };\n});\n","import $ from '../$';\nimport { isString } from '../utils';\nimport './children';\nimport './eq';\nimport './get';\nimport './parent';\n$.fn.index = function (selector) {\n    if (!arguments.length) {\n        return this.eq(0).parent().children().get().indexOf(this[0]);\n    }\n    if (isString(selector)) {\n        return $(selector).get().indexOf(this[0]);\n    }\n    return this.get().indexOf($(selector)[0]);\n};\n","import $ from '../$';\nimport './eq';\n$.fn.last = function () {\n    return this.eq(-1);\n};\n","import $ from '../$';\nimport each from '../functions/each';\nimport dir from './utils/dir';\neach(['', 'All', 'Until'], (nameIndex, name) => {\n    $.fn[`next${name}`] = function (selector, filter) {\n        return dir(this, nameIndex, 'nextElementSibling', selector, filter);\n    };\n});\n","import $ from '../$';\nimport './filter';\nimport './map';\n$.fn.not = function (selector) {\n    const $excludes = this.filter(selector);\n    return this.map((_, element) => $excludes.index(element) > -1 ? undefined : element);\n};\n","import $ from '../$';\nimport './css';\nimport './map';\n/**\n * 返回最近的用于定位的父元素\n */\n$.fn.offsetParent = function () {\n    return this.map(function () {\n        let offsetParent = this.offsetParent;\n        while (offsetParent && $(offsetParent).css('position') === 'static') {\n            offsetParent = offsetParent.offsetParent;\n        }\n        return offsetParent || document.documentElement;\n    });\n};\n","import $ from '../$';\nimport './css';\nimport './eq';\nimport './offset';\nimport './offsetParent';\nfunction floatStyle($element, name) {\n    return parseFloat($element.css(name));\n}\n$.fn.position = function () {\n    if (!this.length) {\n        return undefined;\n    }\n    const $element = this.eq(0);\n    let currentOffset;\n    let parentOffset = {\n        left: 0,\n        top: 0,\n    };\n    if ($element.css('position') === 'fixed') {\n        currentOffset = $element[0].getBoundingClientRect();\n    }\n    else {\n        currentOffset = $element.offset();\n        const $offsetParent = $element.offsetParent();\n        parentOffset = $offsetParent.offset();\n        parentOffset.top += floatStyle($offsetParent, 'border-top-width');\n        parentOffset.left += floatStyle($offsetParent, 'border-left-width');\n    }\n    return {\n        top: currentOffset.top - parentOffset.top - floatStyle($element, 'margin-top'),\n        left: currentOffset.left -\n            parentOffset.left -\n            floatStyle($element, 'margin-left'),\n    };\n};\n","import $ from '../$';\nimport extend from '../functions/extend';\nimport { isFunction } from '../utils';\nimport './css';\nimport './each';\nimport './position';\nfunction get(element) {\n    if (!element.getClientRects().length) {\n        return { top: 0, left: 0 };\n    }\n    const rect = element.getBoundingClientRect();\n    const win = element.ownerDocument.defaultView;\n    return {\n        top: rect.top + win.pageYOffset,\n        left: rect.left + win.pageXOffset,\n    };\n}\nfunction set(element, value, index) {\n    const $element = $(element);\n    const position = $element.css('position');\n    if (position === 'static') {\n        $element.css('position', 'relative');\n    }\n    const currentOffset = get(element);\n    const currentTopString = $element.css('top');\n    const currentLeftString = $element.css('left');\n    let currentTop;\n    let currentLeft;\n    const calculatePosition = (position === 'absolute' || position === 'fixed') &&\n        (currentTopString + currentLeftString).indexOf('auto') > -1;\n    if (calculatePosition) {\n        const currentPosition = $element.position();\n        currentTop = currentPosition.top;\n        currentLeft = currentPosition.left;\n    }\n    else {\n        currentTop = parseFloat(currentTopString);\n        currentLeft = parseFloat(currentLeftString);\n    }\n    const computedValue = isFunction(value)\n        ? value.call(element, index, extend({}, currentOffset))\n        : value;\n    $element.css({\n        top: computedValue.top != null\n            ? computedValue.top - currentOffset.top + currentTop\n            : undefined,\n        left: computedValue.left != null\n            ? computedValue.left - currentOffset.left + currentLeft\n            : undefined,\n    });\n}\n$.fn.offset = function (value) {\n    // 获取坐标\n    if (!arguments.length) {\n        if (!this.length) {\n            return undefined;\n        }\n        return get(this[0]);\n    }\n    // 设置坐标\n    return this.each(function (index) {\n        set(this, value, index);\n    });\n};\n","import $ from '../$';\nimport './on';\n$.fn.one = function (types, selector, data, callback) {\n    // @ts-ignore\n    return this.on(types, selector, data, callback, true);\n};\n","import $ from '../$';\nimport each from '../functions/each';\nimport './get';\nimport dir from './utils/dir';\neach(['', 'All', 'Until'], (nameIndex, name) => {\n    $.fn[`prev${name}`] = function (selector, filter) {\n        // prevAll、prevUntil 需要把元素的顺序倒序处理，以便和 jQuery 的结果一致\n        const $nodes = !nameIndex ? this : $(this.get().reverse());\n        return dir($nodes, nameIndex, 'previousElementSibling', selector, filter);\n    };\n});\n","import $ from '../$';\nimport each from '../functions/each';\nimport './each';\n$.fn.removeAttr = function (attributeName) {\n    const names = attributeName.split(' ').filter((name) => name);\n    return this.each(function () {\n        each(names, (_, name) => {\n            this.removeAttribute(name);\n        });\n    });\n};\n","import $ from '../$';\nimport removeData from '../functions/removeData';\nimport './each';\n$.fn.removeData = function (name) {\n    return this.each(function () {\n        removeData(this, name);\n    });\n};\n","import $ from '../$';\nimport './each';\n$.fn.removeProp = function (name) {\n    return this.each(function () {\n        try {\n            // @ts-ignore\n            delete this[name];\n        }\n        catch (e) { }\n    });\n};\n","import $ from '../$';\nimport './before';\nimport './clone';\nimport './each';\nimport './remove';\nimport { isFunction, isString } from '../utils';\n$.fn.replaceWith = function (newContent) {\n    this.each((index, element) => {\n        let content = newContent;\n        if (isFunction(content)) {\n            content = content.call(element, index, element.innerHTML);\n        }\n        else if (index && !isString(content)) {\n            content = $(content).clone();\n        }\n        $(element).before(content);\n    });\n    return this.remove();\n};\n","import $ from '../$';\nimport './clone';\nimport './get';\nimport './map';\nimport './replaceWith';\n$.fn.replaceAll = function (target) {\n    return $(target).map((index, element) => {\n        $(element).replaceWith(index ? this.clone() : this);\n        return this.get();\n    });\n};\n","import $ from '../$';\nimport './each';\nimport './val';\n/**\n * 将表单元素的值组合成键值对数组\n * @returns {Array}\n */\n$.fn.serializeArray = function () {\n    const result = [];\n    this.each((_, element) => {\n        const elements = element instanceof HTMLFormElement ? element.elements : [element];\n        $(elements).each((_, element) => {\n            const $element = $(element);\n            const type = element.type;\n            const nodeName = element.nodeName.toLowerCase();\n            if (nodeName !== 'fieldset' &&\n                element.name &&\n                !element.disabled &&\n                ['input', 'select', 'textarea', 'keygen'].indexOf(nodeName) > -1 &&\n                ['submit', 'button', 'image', 'reset', 'file'].indexOf(type) === -1 &&\n                (['radio', 'checkbox'].indexOf(type) === -1 ||\n                    element.checked)) {\n                const value = $element.val();\n                const valueArr = Array.isArray(value) ? value : [value];\n                valueArr.forEach((value) => {\n                    result.push({\n                        name: element.name,\n                        value,\n                    });\n                });\n            }\n        });\n    });\n    return result;\n};\n","import $ from '../$';\nimport param from '../functions/param';\nimport './serializeArray';\n$.fn.serialize = function () {\n    return param(this.serializeArray());\n};\n","import $ from '../$';\nimport { getStyle } from '../utils';\nimport './each';\nconst elementDisplay = {};\n/**\n * 获取元素的初始 display 值，用于 .show() 方法\n * @param nodeName\n */\nfunction defaultDisplay(nodeName) {\n    let element;\n    let display;\n    if (!elementDisplay[nodeName]) {\n        element = document.createElement(nodeName);\n        document.body.appendChild(element);\n        display = getStyle(element, 'display');\n        element.parentNode.removeChild(element);\n        if (display === 'none') {\n            display = 'block';\n        }\n        elementDisplay[nodeName] = display;\n    }\n    return elementDisplay[nodeName];\n}\n/**\n * 显示指定元素\n * @returns {JQ}\n */\n$.fn.show = function () {\n    return this.each(function () {\n        if (this.style.display === 'none') {\n            this.style.display = '';\n        }\n        if (getStyle(this, 'display') === 'none') {\n            this.style.display = defaultDisplay(this.nodeName);\n        }\n    });\n};\n","import $ from '../$';\nimport './add';\nimport './nextAll';\nimport './prevAll';\n/**\n * 取得同辈元素的集合\n * @param selector {String=}\n * @returns {JQ}\n */\n$.fn.siblings = function (selector) {\n    return this.prevAll(selector).add(this.nextAll(selector));\n};\n","import $ from '../$';\nimport { getStyle } from '../utils';\nimport './each';\nimport './hide';\nimport './show';\n/**\n * 切换元素的显示状态\n */\n$.fn.toggle = function () {\n    return this.each(function () {\n        getStyle(this, 'display') === 'none' ? $(this).show() : $(this).hide();\n    });\n};\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/each';\n\ndeclare module 'mdui.jq/es/JQ' {\n  interface JQ<T = HTMLElement> {\n    /**\n     * 强制重绘当前元素\n     *\n     * @example\n```js\n$('.box').reflow();\n```\n     */\n    reflow(): this;\n  }\n}\n\n$.fn.reflow = function (this: JQ): JQ {\n  return this.each(function () {\n    return this.clientLeft;\n  });\n};\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport { isNumber } from 'mdui.jq/es/utils';\nimport 'mdui.jq/es/methods/each';\n\ndeclare module 'mdui.jq/es/JQ' {\n  interface JQ<T = HTMLElement> {\n    /**\n     * 设置当前元素的 transition-duration 属性\n     * @param duration 可以是带单位的值；若不带单位，则自动添加 `ms` 作为单位\n     * @example\n```js\n$('.box').transition('300ms');\n$('.box').transition(300);\n```\n     */\n    transition(duration: string | number): this;\n  }\n}\n\n$.fn.transition = function (this: JQ, duration: string | number): JQ {\n  if (isNumber(duration)) {\n    duration = `${duration}ms`;\n  }\n\n  return this.each(function () {\n    this.style.webkitTransitionDuration = duration as string;\n    this.style.transitionDuration = duration as string;\n  });\n};\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport each from 'mdui.jq/es/functions/each';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/off';\n\ndeclare module 'mdui.jq/es/JQ' {\n  interface JQ<T = HTMLElement> {\n    /**\n     * 在当前元素上添加 transitionend 事件回调\n     * @param callback 回调函数的参数为 `transitionend` 事件对象；`this` 指向当前元素\n     * @example\n```js\n$('.box').transitionEnd(function() {\n  alert('.box 元素的 transitionend 事件已触发');\n});\n```\n     */\n    transitionEnd(callback: (this: T, e: Event) => void): this;\n  }\n}\n\n$.fn.transitionEnd = function (\n  this: JQ,\n  callback: (this: HTMLElement, e: Event) => void,\n): JQ {\n  // eslint-disable-next-line @typescript-eslint/no-this-alias\n  const that = this;\n  const events = ['webkitTransitionEnd', 'transitionend'];\n\n  function fireCallback(this: Element | Document | Window, e: Event): void {\n    if (e.target !== this) {\n      return;\n    }\n\n    // @ts-ignore\n    callback.call(this, e);\n\n    each(events, (_, event) => {\n      that.off(event, fireCallback);\n    });\n  }\n\n  each(events, (_, event) => {\n    that.on(event, fireCallback);\n  });\n\n  return this;\n};\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/each';\n\ndeclare module 'mdui.jq/es/JQ' {\n  interface JQ<T = HTMLElement> {\n    /**\n     * 设置当前元素的 transform-origin 属性\n     * @param transformOrigin\n     * @example\n```js\n$('.box').transformOrigin('top center');\n```\n     */\n    transformOrigin(transformOrigin: string): this;\n  }\n}\n\n$.fn.transformOrigin = function (this: JQ, transformOrigin: string): JQ {\n  return this.each(function () {\n    this.style.webkitTransformOrigin = transformOrigin;\n    this.style.transformOrigin = transformOrigin;\n  });\n};\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/each';\n\ndeclare module 'mdui.jq/es/JQ' {\n  interface JQ<T = HTMLElement> {\n    /**\n     * 设置当前元素的 transform 属性\n     * @param transform\n     * @example\n```js\n$('.box').transform('rotate(90deg)');\n```\n     */\n    transform(transform: string): this;\n  }\n}\n\n$.fn.transform = function (this: JQ, transform: string): JQ {\n  return this.each(function () {\n    this.style.webkitTransform = transform;\n    this.style.transform = transform;\n  });\n};\n","import PlainObject from 'mdui.jq/es/interfaces/PlainObject';\nimport data from 'mdui.jq/es/functions/data';\n\ntype TYPE_API_INIT = (\n  this: HTMLElement,\n  i: number,\n  element: HTMLElement,\n) => void;\n\n/**\n * CSS 选择器和初始化函数组成的对象\n */\nconst entries: PlainObject<TYPE_API_INIT> = {};\n\n/**\n * 注册并执行初始化函数\n * @param selector CSS 选择器\n * @param apiInit 初始化函数\n * @param i 元素索引\n * @param element 元素\n */\nfunction mutation(\n  selector: string,\n  apiInit: TYPE_API_INIT,\n  i: number,\n  element: HTMLElement,\n): void {\n  let selectors = data(element, '_mdui_mutation');\n\n  if (!selectors) {\n    selectors = [];\n    data(element, '_mdui_mutation', selectors);\n  }\n\n  if (selectors.indexOf(selector) === -1) {\n    selectors.push(selector);\n    apiInit.call(element, i, element);\n  }\n}\n\nexport { TYPE_API_INIT, entries, mutation };\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport each from 'mdui.jq/es/functions/each';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/is';\nimport { entries, mutation } from '../../utils/mutation';\n\ndeclare module 'mdui.jq/es/JQ' {\n  interface JQ<T = HTMLElement> {\n    /**\n     * 执行在当前元素及其子元素内注册的初始化函数\n     */\n    mutation(): this;\n  }\n}\n\n$.fn.mutation = function (this: JQ): JQ {\n  return this.each((i, element) => {\n    const $this = $(element);\n\n    each(entries, (selector: string, apiInit) => {\n      if ($this.is(selector)) {\n        mutation(selector, apiInit, i, element);\n      }\n\n      $this.find(selector).each((i, element) => {\n        mutation(selector, apiInit, i, element);\n      });\n    });\n  });\n};\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport { isUndefined } from 'mdui.jq/es/utils';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/css';\nimport 'mdui.jq/es/methods/appendTo';\nimport 'mdui.jq/es/methods/addClass';\nimport '../methods/reflow';\n\ndeclare module 'mdui.jq/es/interfaces/JQStatic' {\n  interface JQStatic {\n    /**\n     * 创建并显示遮罩，返回遮罩层的 JQ 对象\n     * @param zIndex 遮罩层的 `z-index` 值，默认为 `2000`\n     * @example\n```js\n$.showOverlay();\n```\n     * @example\n```js\n$.showOverlay(3000);\n```\n     */\n    showOverlay(zIndex?: number): JQ;\n  }\n}\n\n$.showOverlay = function (zIndex?: number): JQ {\n  let $overlay = $('.mdui-overlay');\n\n  if ($overlay.length) {\n    $overlay.data('_overlay_is_deleted', false);\n\n    if (!isUndefined(zIndex)) {\n      $overlay.css('z-index', zIndex);\n    }\n  } else {\n    if (isUndefined(zIndex)) {\n      zIndex = 2000;\n    }\n\n    $overlay = $('<div class=\"mdui-overlay\">')\n      .appendTo(document.body)\n      .reflow()\n      .css('z-index', zIndex);\n  }\n\n  let level = $overlay.data('_overlay_level') || 0;\n\n  return $overlay.data('_overlay_level', ++level).addClass('mdui-overlay-show');\n};\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/remove';\nimport '../methods/transitionEnd';\n\ndeclare module 'mdui.jq/es/interfaces/JQStatic' {\n  interface JQStatic {\n    /**\n     * 隐藏遮罩层\n     *\n     * 如果调用了多次 $.showOverlay() 来显示遮罩层，则也需要调用相同次数的 $.hideOverlay() 才能隐藏遮罩层。可以通过传入参数 true 来强制隐藏遮罩层。\n     * @param force 是否强制隐藏遮罩\n     * @example\n```js\n$.hideOverlay();\n```\n     * @example\n```js\n$.hideOverlay(true);\n```\n     */\n    hideOverlay(force?: boolean): void;\n  }\n}\n\n$.hideOverlay = function (force = false): void {\n  const $overlay = $('.mdui-overlay');\n\n  if (!$overlay.length) {\n    return;\n  }\n\n  let level = force ? 1 : $overlay.data('_overlay_level');\n\n  if (level > 1) {\n    $overlay.data('_overlay_level', --level);\n    return;\n  }\n\n  $overlay\n    .data('_overlay_level', 0)\n    .removeClass('mdui-overlay-show')\n    .data('_overlay_is_deleted', true)\n    .transitionEnd(() => {\n      if ($overlay.data('_overlay_is_deleted')) {\n        $overlay.remove();\n      }\n    });\n};\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/width';\n\ndeclare module 'mdui.jq/es/interfaces/JQStatic' {\n  interface JQStatic {\n    /**\n     * 锁定屏页面，禁止页面滚动\n     * @example\n```js\n$.lockScreen();\n```\n     */\n    lockScreen(): void;\n  }\n}\n\n$.lockScreen = function (): void {\n  const $body = $('body');\n\n  // 不直接把 body 设为 box-sizing: border-box，避免污染全局样式\n  const newBodyWidth = $body.width();\n  let level = $body.data('_lockscreen_level') || 0;\n\n  $body\n    .addClass('mdui-locked')\n    .width(newBodyWidth)\n    .data('_lockscreen_level', ++level);\n};\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/width';\n\ndeclare module 'mdui.jq/es/interfaces/JQStatic' {\n  interface JQStatic {\n    /**\n     * 解除页面锁定\n     *\n     * 如果调用了多次 $.lockScreen() 来显示遮罩层，则也需要调用相同次数的 $.unlockScreen() 才能隐藏遮罩层。可以通过传入参数 true 来强制隐藏遮罩层。\n     * @param force 是否强制解除锁定\n     * @example\n```js\n$.unlockScreen();\n```\n     * @example\n```js\n$.unlockScreen(true);\n```\n     */\n    unlockScreen(force?: boolean): void;\n  }\n}\n\n$.unlockScreen = function (force = false): void {\n  const $body = $('body');\n  let level = force ? 1 : $body.data('_lockscreen_level');\n\n  if (level > 1) {\n    $body.data('_lockscreen_level', --level);\n    return;\n  }\n\n  $body.data('_lockscreen_level', 0).removeClass('mdui-locked').width('');\n};\n","import $ from 'mdui.jq/es/$';\nimport { isNull } from 'mdui.jq/es/utils';\n\ndeclare module 'mdui.jq/es/interfaces/JQStatic' {\n  interface JQStatic {\n    /**\n     * 函数节流\n     * @param fn 执行的函数\n     * @param delay 最多多少毫秒执行一次\n     * @example\n```js\n$.throttle(function () {\n  console.log('这个函数最多 100ms 执行一次');\n}, 100)\n```\n     */\n    throttle(fn: () => void, delay: number): () => void;\n  }\n}\n\n$.throttle = function (fn: () => void, delay = 16): () => void {\n  let timer: any = null;\n\n  return function (this: any, ...args: any): void {\n    if (isNull(timer)) {\n      timer = setTimeout(() => {\n        fn.apply(this, args);\n        timer = null;\n      }, delay);\n    }\n  };\n};\n","import $ from 'mdui.jq/es/$';\nimport { isUndefined } from 'mdui.jq/es/utils';\nimport PlainObject from 'mdui.jq/es/interfaces/PlainObject';\n\ndeclare module 'mdui.jq/es/interfaces/JQStatic' {\n  interface JQStatic {\n    /**\n     * 生成一个全局唯一的 ID\n     * @param name 当该参数值对应的 guid 不存在时，会生成一个新的 guid，并返回；当该参数对应的 guid 已存在，则直接返回已有 guid\n     * @example\n```js\n$.guid();\n```\n     * @example\n```js\n$.guid('test');\n```\n     */\n    guid(name?: string): string;\n  }\n}\n\nconst GUID: PlainObject<string> = {};\n\n$.guid = function (name?: string): string {\n  if (!isUndefined(name) && !isUndefined(GUID[name])) {\n    return GUID[name];\n  }\n\n  function s4(): string {\n    return Math.floor((1 + Math.random()) * 0x10000)\n      .toString(16)\n      .substring(1);\n  }\n\n  const guid =\n    '_' +\n    s4() +\n    s4() +\n    '-' +\n    s4() +\n    '-' +\n    s4() +\n    '-' +\n    s4() +\n    '-' +\n    s4() +\n    s4() +\n    s4();\n\n  if (!isUndefined(name)) {\n    GUID[name] = guid;\n  }\n\n  return guid;\n};\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/each';\nimport mdui from '../mdui';\nimport '../jq_extends/methods/mutation';\nimport { isUndefined } from 'mdui.jq/es/utils';\nimport { TYPE_API_INIT, entries, mutation } from '../utils/mutation';\n\ndeclare module '../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 传入了两个参数时，注册并执行初始化函数\n     *\n     * 没有传入参数时，执行初始化\n     * @param selector CSS 选择器\n     * @param apiInit 初始化函数\n     * @example\n```js\nmdui.mutation();\n```\n     * @example\n```js\nmdui.mutation();\n```\n     */\n    mutation(selector?: string, apiInit?: TYPE_API_INIT): void;\n  }\n}\n\nmdui.mutation = function (selector?: string, apiInit?: TYPE_API_INIT): void {\n  if (isUndefined(selector) || isUndefined(apiInit)) {\n    $(document).mutation();\n    return;\n  }\n\n  entries[selector] = apiInit!;\n  $(selector).each((i, element) => mutation(selector, apiInit, i, element));\n};\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport PlainObject from 'mdui.jq/es/interfaces/PlainObject';\nimport 'mdui.jq/es/methods/trigger';\n\n/**\n * 触发组件上的事件\n * @param eventName 事件名\n * @param componentName 组件名\n * @param target 在该元素上触发事件\n * @param instance 组件实例\n * @param parameters 事件参数\n */\nfunction componentEvent(\n  eventName: string,\n  componentName: string,\n  target: HTMLElement | HTMLElement[] | JQ,\n  instance?: any,\n  parameters?: PlainObject,\n): void {\n  if (!parameters) {\n    parameters = {};\n  }\n\n  // @ts-ignore\n  parameters.inst = instance;\n\n  const fullEventName = `${eventName}.mdui.${componentName}`;\n\n  // jQuery 事件\n  // @ts-ignore\n  if (typeof jQuery !== 'undefined') {\n    // @ts-ignore\n    jQuery(target).trigger(fullEventName, parameters);\n  }\n\n  const $target = $(target);\n\n  // mdui.jq 事件\n  $target.trigger(fullEventName, parameters);\n\n  // 原生事件，供使用 addEventListener 监听\n  type EventParams = {\n    detail?: any;\n    bubbles: boolean;\n    cancelable: boolean;\n  };\n\n  const eventParams: EventParams = {\n    bubbles: true,\n    cancelable: true,\n    detail: parameters,\n  };\n\n  const eventObject: CustomEvent = new CustomEvent(fullEventName, eventParams);\n\n  // @ts-ignore\n  eventObject._detail = parameters;\n\n  $target[0].dispatchEvent(eventObject);\n}\n\nexport { componentEvent };\n","import $ from 'mdui.jq/es/$';\n\nconst $document = $(document);\nconst $window = $(window);\nconst $body = $('body');\n\nexport { $document, $window, $body };\n","import $ from 'mdui.jq/es/$';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/removeClass';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport { isNumber } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport '../../jq_extends/methods/transitionEnd';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $window } from '../../utils/dom';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * Headroom 插件\n     *\n     * 请通过 `new mdui.Headroom()` 调用\n     */\n    Headroom: {\n      /**\n       * 实例化 Headroom 组件\n       * @param selector CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Headroom;\n    };\n  }\n}\n\ntype TOLERANCE = {\n  /**\n   * 滚动条向下滚动多少距离开始隐藏或显示元素\n   */\n  down: number;\n\n  /**\n   * 滚动条向上滚动多少距离开始隐藏或显示元素\n   */\n  up: number;\n};\n\ntype OPTIONS = {\n  /**\n   * 滚动条滚动多少距离开始隐藏或显示元素\n   */\n  tolerance?: TOLERANCE | number;\n\n  /**\n   * 在页面顶部多少距离内滚动不会隐藏元素\n   */\n  offset?: number;\n\n  /**\n   * 初始化时添加的类\n   */\n  initialClass?: string;\n\n  /**\n   * 元素固定时添加的类\n   */\n  pinnedClass?: string;\n\n  /**\n   * 元素隐藏时添加的类\n   */\n  unpinnedClass?: string;\n};\n\ntype STATE = 'pinning' | 'pinned' | 'unpinning' | 'unpinned';\ntype EVENT = 'pin' | 'pinned' | 'unpin' | 'unpinned';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  tolerance: 5,\n  offset: 0,\n  initialClass: 'mdui-headroom',\n  pinnedClass: 'mdui-headroom-pinned-top',\n  unpinnedClass: 'mdui-headroom-unpinned-top',\n};\n\nclass Headroom {\n  /**\n   * headroom 元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * 当前 headroom 的状态\n   */\n  private state: STATE = 'pinned';\n\n  /**\n   * 当前是否启用\n   */\n  private isEnable = false;\n\n  /**\n   * 上次滚动后，垂直方向的距离\n   */\n  private lastScrollY = 0;\n\n  /**\n   * AnimationFrame ID\n   */\n  private rafId = 0;\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    this.$element = $(selector).first();\n\n    extend(this.options, options);\n\n    // tolerance 参数若为数值，转换为对象\n    const tolerance = this.options.tolerance;\n    if (isNumber(tolerance)) {\n      this.options.tolerance = {\n        down: tolerance,\n        up: tolerance,\n      };\n    }\n\n    this.enable();\n  }\n\n  /**\n   * 滚动时的处理\n   */\n  private onScroll(): void {\n    this.rafId = window.requestAnimationFrame(() => {\n      const currentScrollY = window.pageYOffset;\n      const direction = currentScrollY > this.lastScrollY ? 'down' : 'up';\n      const tolerance = (this.options.tolerance as TOLERANCE)[direction];\n      const scrolled = Math.abs(currentScrollY - this.lastScrollY);\n      const toleranceExceeded = scrolled >= tolerance;\n\n      if (\n        currentScrollY > this.lastScrollY &&\n        currentScrollY >= this.options.offset! &&\n        toleranceExceeded\n      ) {\n        this.unpin();\n      } else if (\n        (currentScrollY < this.lastScrollY && toleranceExceeded) ||\n        currentScrollY <= this.options.offset!\n      ) {\n        this.pin();\n      }\n\n      this.lastScrollY = currentScrollY;\n    });\n  }\n\n  /**\n   * 触发组件事件\n   * @param name\n   */\n  private triggerEvent(name: EVENT): void {\n    componentEvent(name, 'headroom', this.$element, this);\n  }\n\n  /**\n   * 动画结束的回调\n   */\n  private transitionEnd(): void {\n    if (this.state === 'pinning') {\n      this.state = 'pinned';\n      this.triggerEvent('pinned');\n    }\n\n    if (this.state === 'unpinning') {\n      this.state = 'unpinned';\n      this.triggerEvent('unpinned');\n    }\n  }\n\n  /**\n   * 使元素固定住\n   */\n  public pin(): void {\n    if (\n      this.state === 'pinning' ||\n      this.state === 'pinned' ||\n      !this.$element.hasClass(this.options.initialClass!)\n    ) {\n      return;\n    }\n\n    this.triggerEvent('pin');\n    this.state = 'pinning';\n    this.$element\n      .removeClass(this.options.unpinnedClass)\n      .addClass(this.options.pinnedClass!)\n      .transitionEnd(() => this.transitionEnd());\n  }\n\n  /**\n   * 使元素隐藏\n   */\n  public unpin(): void {\n    if (\n      this.state === 'unpinning' ||\n      this.state === 'unpinned' ||\n      !this.$element.hasClass(this.options.initialClass!)\n    ) {\n      return;\n    }\n\n    this.triggerEvent('unpin');\n    this.state = 'unpinning';\n    this.$element\n      .removeClass(this.options.pinnedClass)\n      .addClass(this.options.unpinnedClass!)\n      .transitionEnd(() => this.transitionEnd());\n  }\n\n  /**\n   * 启用 headroom 插件\n   */\n  public enable(): void {\n    if (this.isEnable) {\n      return;\n    }\n\n    this.isEnable = true;\n    this.state = 'pinned';\n    this.$element\n      .addClass(this.options.initialClass!)\n      .removeClass(this.options.pinnedClass)\n      .removeClass(this.options.unpinnedClass);\n    this.lastScrollY = window.pageYOffset;\n\n    $window.on('scroll', () => this.onScroll());\n  }\n\n  /**\n   * 禁用 headroom 插件\n   */\n  public disable(): void {\n    if (!this.isEnable) {\n      return;\n    }\n\n    this.isEnable = false;\n    this.$element\n      .removeClass(this.options.initialClass)\n      .removeClass(this.options.pinnedClass)\n      .removeClass(this.options.unpinnedClass);\n\n    $window.off('scroll', () => this.onScroll());\n    window.cancelAnimationFrame(this.rafId);\n  }\n\n  /**\n   * 获取当前状态。共包含四种状态：`pinning`、`pinned`、`unpinning`、`unpinned`\n   */\n  public getState(): STATE {\n    return this.state;\n  }\n}\n\nmdui.Headroom = Headroom;\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/attr';\nimport PlainObject from 'mdui.jq/es/interfaces/PlainObject';\n\n/**\n * 解析 DATA API 参数\n * @param element 元素\n * @param name 属性名\n */\nfunction parseOptions(element: HTMLElement, name: string): PlainObject {\n  const attr = $(element).attr(name);\n\n  if (!attr) {\n    return {};\n  }\n\n  return new Function(\n    '',\n    `var json = ${attr}; return JSON.parse(JSON.stringify(json));`,\n  )();\n}\n\nexport { parseOptions };\n","import $ from 'mdui.jq/es/$';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-headroom';\n\n$(() => {\n  mdui.mutation(`[${customAttr}]`, function () {\n    new mdui.Headroom(this, parseOptions(this, customAttr));\n  });\n});\n","import $ from 'mdui.jq/es/$';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/children';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/eq';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/height';\nimport 'mdui.jq/es/methods/is';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/parent';\nimport 'mdui.jq/es/methods/parents';\nimport 'mdui.jq/es/methods/removeClass';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport { isNumber } from 'mdui.jq/es/utils';\nimport '../../jq_extends/methods/reflow';\nimport '../../jq_extends/methods/transition';\nimport '../../jq_extends/methods/transitionEnd';\nimport { componentEvent } from '../../utils/componentEvent';\n\ntype OPTIONS = {\n  /**\n   * 是否启用手风琴效果\n   * 为 `true` 时，最多只能有一个面板项处于打开状态，打开一个面板项时会关闭其他面板项\n   * 为 `false` 时，可同时打开多个面板项\n   */\n  accordion?: boolean;\n};\n\ntype EVENT = 'open' | 'opened' | 'close' | 'closed';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  accordion: false,\n};\n\nabstract class CollapseAbstract {\n  /**\n   * collapse 元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * item 的 class 名\n   */\n  private classItem: string;\n\n  /**\n   * 打开状态的 item 的 class 名\n   */\n  private classItemOpen: string;\n\n  /**\n   * item-header 的 class 名\n   */\n  private classHeader: string;\n\n  /**\n   * item-body 的 class 名\n   */\n  private classBody: string;\n\n  /**\n   * 获取继承的组件名称\n   */\n  protected abstract getNamespace(): string;\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    // CSS 类名\n    const classPrefix = `mdui-${this.getNamespace()}-item`;\n    this.classItem = classPrefix;\n    this.classItemOpen = `${classPrefix}-open`;\n    this.classHeader = `${classPrefix}-header`;\n    this.classBody = `${classPrefix}-body`;\n\n    this.$element = $(selector).first();\n\n    extend(this.options, options);\n\n    this.bindEvent();\n  }\n\n  /**\n   * 绑定事件\n   */\n  private bindEvent(): void {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const that = this;\n\n    // 点击 header 时，打开/关闭 item\n    this.$element.on('click', `.${this.classHeader}`, function () {\n      const $header = $(this as HTMLElement);\n      const $item = $header.parent();\n      const $items = that.getItems();\n\n      $items.each((_, item) => {\n        if ($item.is(item)) {\n          that.toggle(item);\n        }\n      });\n    });\n\n    // 点击关闭按钮时，关闭 item\n    this.$element.on(\n      'click',\n      `[mdui-${this.getNamespace()}-item-close]`,\n      function () {\n        const $target = $(this as HTMLElement);\n        const $item = $target.parents(`.${that.classItem}`).first();\n\n        that.close($item);\n      },\n    );\n  }\n\n  /**\n   * 指定 item 是否处于打开状态\n   * @param $item\n   */\n  private isOpen($item: JQ): boolean {\n    return $item.hasClass(this.classItemOpen);\n  }\n\n  /**\n   * 获取所有 item\n   */\n  private getItems(): JQ {\n    return this.$element.children(`.${this.classItem}`);\n  }\n\n  /**\n   * 获取指定 item\n   * @param item\n   */\n  private getItem(\n    item: number | Selector | HTMLElement | ArrayLike<HTMLElement>,\n  ): JQ {\n    if (isNumber(item)) {\n      return this.getItems().eq(item);\n    }\n\n    return $(item).first();\n  }\n\n  /**\n   * 触发组件事件\n   * @param name 事件名\n   * @param $item 事件触发的目标 item\n   */\n  private triggerEvent(name: EVENT, $item: JQ): void {\n    componentEvent(name, this.getNamespace(), $item, this);\n  }\n\n  /**\n   * 动画结束回调\n   * @param $content body 元素\n   * @param $item item 元素\n   */\n  private transitionEnd($content: JQ, $item: JQ): void {\n    if (this.isOpen($item)) {\n      $content.transition(0).height('auto').reflow().transition('');\n\n      this.triggerEvent('opened', $item);\n    } else {\n      $content.height('');\n\n      this.triggerEvent('closed', $item);\n    }\n  }\n\n  /**\n   * 打开指定面板项\n   * @param item 面板项的索引号、或 CSS 选择器、或 DOM 元素、或 JQ 对象\n   */\n  public open(\n    item: number | Selector | HTMLElement | ArrayLike<HTMLElement>,\n  ): void {\n    const $item = this.getItem(item);\n\n    if (this.isOpen($item)) {\n      return;\n    }\n\n    // 关闭其他项\n    if (this.options.accordion) {\n      this.$element.children(`.${this.classItemOpen}`).each((_, element) => {\n        const $element = $(element);\n\n        if (!$element.is($item)) {\n          this.close($element);\n        }\n      });\n    }\n\n    const $content = $item.children(`.${this.classBody}`);\n\n    $content\n      .height($content[0].scrollHeight)\n      .transitionEnd(() => this.transitionEnd($content, $item));\n\n    this.triggerEvent('open', $item);\n\n    $item.addClass(this.classItemOpen);\n  }\n\n  /**\n   * 关闭指定面板项\n   * @param item 面板项的索引号、或 CSS 选择器、或 DOM 元素、或 JQ 对象\n   */\n  public close(\n    item: number | Selector | HTMLElement | ArrayLike<HTMLElement>,\n  ): void {\n    const $item = this.getItem(item);\n\n    if (!this.isOpen($item)) {\n      return;\n    }\n\n    const $content = $item.children(`.${this.classBody}`);\n\n    this.triggerEvent('close', $item);\n\n    $item.removeClass(this.classItemOpen);\n\n    $content\n      .transition(0)\n      .height($content[0].scrollHeight)\n      .reflow()\n      .transition('')\n      .height('')\n      .transitionEnd(() => this.transitionEnd($content, $item));\n  }\n\n  /**\n   * 切换指定面板项的打开状态\n   * @param item 面板项的索引号、或 CSS 选择器、或 DOM 元素、或 JQ 对象\n   */\n  public toggle(\n    item: number | Selector | HTMLElement | ArrayLike<HTMLElement>,\n  ): void {\n    const $item = this.getItem(item);\n\n    this.isOpen($item) ? this.close($item) : this.open($item);\n  }\n\n  /**\n   * 打开所有面板项\n   */\n  public openAll(): void {\n    this.getItems().each((_, element) => this.open(element));\n  }\n\n  /**\n   * 关闭所有面板项\n   */\n  public closeAll(): void {\n    this.getItems().each((_, element) => this.close(element));\n  }\n}\n\nexport { OPTIONS, CollapseAbstract };\n","import Selector from 'mdui.jq/es/types/Selector';\nimport mdui from '../../mdui';\nimport { CollapseAbstract, OPTIONS } from './collapseAbstract';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 折叠内容块组件\n     *\n     * 请通过 `new mdui.Collapse()` 调用\n     */\n    Collapse: {\n      /**\n       * 实例化 Collapse 组件\n       * @param selector CSS 选择器或 DOM 元素\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Collapse;\n    };\n  }\n}\n\nclass Collapse extends CollapseAbstract {\n  protected getNamespace(): string {\n    return 'collapse';\n  }\n}\n\nmdui.Collapse = Collapse;\n","import $ from 'mdui.jq/es/$';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-collapse';\n\n$(() => {\n  mdui.mutation(`[${customAttr}]`, function () {\n    new mdui.Collapse(this, parseOptions(this, customAttr));\n  });\n});\n","import Selector from 'mdui.jq/es/types/Selector';\nimport mdui from '../../mdui';\nimport { CollapseAbstract, OPTIONS } from '../collapse/collapseAbstract';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 可扩展面板组件\n     *\n     * 请通过 `new mdui.Panel()` 调用\n     */\n    Panel: {\n      /**\n       * 实例化 Panel 组件\n       * @param selector CSS 选择器或 DOM 元素\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Panel;\n    };\n  }\n}\n\nclass Panel extends CollapseAbstract {\n  protected getNamespace(): string {\n    return 'panel';\n  }\n}\n\nmdui.Panel = Panel;\n","import $ from 'mdui.jq/es/$';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-panel';\n\n$(() => {\n  mdui.mutation(`[${customAttr}]`, function () {\n    new mdui.Panel(this, parseOptions(this, customAttr));\n  });\n});\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/add';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/eq';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/prependTo';\nimport 'mdui.jq/es/methods/remove';\nimport 'mdui.jq/es/methods/removeClass';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport { isUndefined } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 动态修改了表格后，需要调用该方法重新初始化表格。\n     *\n     * 若传入了参数，则只初始化该参数对应的表格。若没有传入参数，则重新初始化所有表格。\n     * @param selector CSS 选择器、或 DOM 元素、或 DOM 元素组成的数组、或 JQ 对象\n     */\n    updateTables(\n      selector?: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    ): void;\n  }\n}\n\nclass Table {\n  /**\n   * table 元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 表头 tr 元素\n   */\n  private $thRow: JQ = $();\n\n  /**\n   * 表格 body 中的 tr 元素\n   */\n  private $tdRows: JQ = $();\n\n  /**\n   * 表头的 checkbox 元素\n   */\n  private $thCheckbox: JQ<HTMLInputElement> = $();\n\n  /**\n   * 表格 body 中的 checkbox 元素\n   */\n  private $tdCheckboxs: JQ<HTMLInputElement> = $();\n\n  /**\n   * 表格行是否可选择\n   */\n  private selectable = false;\n\n  /**\n   * 已选中的行数\n   */\n  private selectedRow = 0;\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n  ) {\n    this.$element = $(selector).first();\n    this.init();\n  }\n\n  /**\n   * 初始化表格\n   */\n  public init(): void {\n    this.$thRow = this.$element.find('thead tr');\n    this.$tdRows = this.$element.find('tbody tr');\n    this.selectable = this.$element.hasClass('mdui-table-selectable');\n\n    this.updateThCheckbox();\n    this.updateTdCheckbox();\n    this.updateNumericCol();\n  }\n\n  /**\n   * 生成 checkbox 的 HTML 结构\n   * @param tag 标签名\n   */\n  private createCheckboxHTML(tag: string): string {\n    return (\n      `<${tag} class=\"mdui-table-cell-checkbox\">` +\n      '<label class=\"mdui-checkbox\">' +\n      '<input type=\"checkbox\"/>' +\n      '<i class=\"mdui-checkbox-icon\"></i>' +\n      '</label>' +\n      `</${tag}>`\n    );\n  }\n\n  /**\n   * 更新表头 checkbox 的状态\n   */\n  private updateThCheckboxStatus(): void {\n    const checkbox = this.$thCheckbox[0];\n    const selectedRow = this.selectedRow;\n    const tdRowsLength = this.$tdRows.length;\n\n    checkbox.checked = selectedRow === tdRowsLength;\n    checkbox.indeterminate = !!selectedRow && selectedRow !== tdRowsLength;\n  }\n\n  /**\n   * 更新表格行的 checkbox\n   */\n  private updateTdCheckbox(): void {\n    const rowSelectedClass = 'mdui-table-row-selected';\n\n    this.$tdRows.each((_, row) => {\n      const $row = $(row);\n\n      // 移除旧的 checkbox\n      $row.find('.mdui-table-cell-checkbox').remove();\n\n      if (!this.selectable) {\n        return;\n      }\n\n      // 创建 DOM\n      const $checkbox = $(this.createCheckboxHTML('td'))\n        .prependTo($row)\n        .find('input[type=\"checkbox\"]') as JQ<HTMLInputElement>;\n\n      // 默认选中的行\n      if ($row.hasClass(rowSelectedClass)) {\n        $checkbox[0].checked = true;\n        this.selectedRow++;\n      }\n\n      this.updateThCheckboxStatus();\n\n      // 绑定事件\n      $checkbox.on('change', () => {\n        if ($checkbox[0].checked) {\n          $row.addClass(rowSelectedClass);\n          this.selectedRow++;\n        } else {\n          $row.removeClass(rowSelectedClass);\n          this.selectedRow--;\n        }\n\n        this.updateThCheckboxStatus();\n      });\n\n      this.$tdCheckboxs = this.$tdCheckboxs.add($checkbox);\n    });\n  }\n\n  /**\n   * 更新表头的 checkbox\n   */\n  private updateThCheckbox(): void {\n    // 移除旧的 checkbox\n    this.$thRow.find('.mdui-table-cell-checkbox').remove();\n\n    if (!this.selectable) {\n      return;\n    }\n\n    this.$thCheckbox = $(this.createCheckboxHTML('th'))\n      .prependTo(this.$thRow)\n      .find('input[type=\"checkbox\"]')\n      .on('change', () => {\n        const isCheckedAll = this.$thCheckbox[0].checked;\n        this.selectedRow = isCheckedAll ? this.$tdRows.length : 0;\n\n        this.$tdCheckboxs.each((_, checkbox) => {\n          checkbox.checked = isCheckedAll;\n        });\n\n        this.$tdRows.each((_, row) => {\n          isCheckedAll\n            ? $(row).addClass('mdui-table-row-selected')\n            : $(row).removeClass('mdui-table-row-selected');\n        });\n      }) as JQ<HTMLInputElement>;\n  }\n\n  /**\n   * 更新数值列\n   */\n  private updateNumericCol(): void {\n    const numericClass = 'mdui-table-col-numeric';\n\n    this.$thRow.find('th').each((i, th) => {\n      const isNumericCol = $(th).hasClass(numericClass);\n\n      this.$tdRows.each((_, row) => {\n        const $td = $(row).find('td').eq(i);\n\n        isNumericCol\n          ? $td.addClass(numericClass)\n          : $td.removeClass(numericClass);\n      });\n    });\n  }\n}\n\nconst dataName = '_mdui_table';\n\n$(() => {\n  mdui.mutation('.mdui-table', function () {\n    const $element = $(this);\n\n    if (!$element.data(dataName)) {\n      $element.data(dataName, new Table($element));\n    }\n  });\n});\n\nmdui.updateTables = function (\n  selector?: Selector | HTMLElement | ArrayLike<HTMLElement>,\n): void {\n  const $elements = isUndefined(selector) ? $('.mdui-table') : $(selector);\n\n  $elements.each((_, element) => {\n    const $element = $(element);\n    const instance = $element.data(dataName);\n\n    if (instance) {\n      instance.init();\n    } else {\n      $element.data(dataName, new Table($element));\n    }\n  });\n};\n","/**\n * touch 事件后的 500ms 内禁用 mousedown 事件\n *\n * 不支持触控的屏幕上事件顺序为 mousedown -> mouseup -> click\n * 支持触控的屏幕上事件顺序为 touchstart -> touchend -> mousedown -> mouseup -> click\n *\n * 在每一个事件中都使用 TouchHandler.isAllow(event) 判断事件是否可执行\n * 在 touchstart 和 touchmove、touchend、touchcancel\n *\n * (function () {\n *   $document\n *     .on(start, function (e) {\n *       if (!isAllow(e)) {\n *         return;\n *       }\n *       register(e);\n *       console.log(e.type);\n *     })\n *     .on(move, function (e) {\n *       if (!isAllow(e)) {\n *         return;\n *       }\n *       console.log(e.type);\n *     })\n *     .on(end, function (e) {\n *       if (!isAllow(e)) {\n *         return;\n *       }\n *       console.log(e.type);\n *     })\n *     .on(unlock, register);\n * })();\n */\n\nconst startEvent = 'touchstart mousedown';\nconst moveEvent = 'touchmove mousemove';\nconst endEvent = 'touchend mouseup';\nconst cancelEvent = 'touchcancel mouseleave';\nconst unlockEvent = 'touchend touchmove touchcancel';\n\nlet touches = 0;\n\n/**\n * 该事件是否被允许，在执行事件前调用该方法判断事件是否可以执行\n * 若已触发 touch 事件，则阻止之后的鼠标事件\n * @param event\n */\nfunction isAllow(event: Event): boolean {\n  return !(\n    touches &&\n    [\n      'mousedown',\n      'mouseup',\n      'mousemove',\n      'click',\n      'mouseover',\n      'mouseout',\n      'mouseenter',\n      'mouseleave',\n    ].indexOf(event.type) > -1\n  );\n}\n\n/**\n * 在 touchstart 和 touchmove、touchend、touchcancel 事件中调用该方法注册事件\n * @param event\n */\nfunction register(event: Event): void {\n  if (event.type === 'touchstart') {\n    // 触发了 touch 事件\n    touches += 1;\n  } else if (\n    ['touchmove', 'touchend', 'touchcancel'].indexOf(event.type) > -1\n  ) {\n    // touch 事件结束 500ms 后解除对鼠标事件的阻止\n    setTimeout(function () {\n      if (touches) {\n        touches -= 1;\n      }\n    }, 500);\n  }\n}\n\nexport {\n  startEvent,\n  moveEvent,\n  endEvent,\n  cancelEvent,\n  unlockEvent,\n  isAllow,\n  register,\n};\n","/**\n * Inspired by https://github.com/nolimits4web/Framework7/blob/master/src/js/fast-clicks.js\n * https://github.com/nolimits4web/Framework7/blob/master/LICENSE\n *\n * Inspired by https://github.com/fians/Waves\n */\n\nimport $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/attr';\nimport 'mdui.jq/es/methods/children';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/innerHeight';\nimport 'mdui.jq/es/methods/innerWidth';\nimport 'mdui.jq/es/methods/off';\nimport 'mdui.jq/es/methods/offset';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/parents';\nimport 'mdui.jq/es/methods/prependTo';\nimport 'mdui.jq/es/methods/prop';\nimport 'mdui.jq/es/methods/remove';\nimport { isUndefined } from 'mdui.jq/es/utils';\nimport '../../jq_extends/methods/reflow';\nimport '../../jq_extends/methods/transform';\nimport '../../jq_extends/methods/transitionEnd';\nimport { $document } from '../../utils/dom';\nimport {\n  cancelEvent,\n  endEvent,\n  isAllow,\n  moveEvent,\n  register,\n  startEvent,\n  unlockEvent,\n} from '../../utils/touchHandler';\n\n/**\n * 显示涟漪动画\n * @param event\n * @param $ripple\n */\nfunction show(event: Event, $ripple: JQ): void {\n  // 鼠标右键不产生涟漪\n  if (event instanceof MouseEvent && event.button === 2) {\n    return;\n  }\n\n  // 点击位置坐标\n  const touchPosition =\n    typeof TouchEvent !== 'undefined' &&\n    event instanceof TouchEvent &&\n    event.touches.length\n      ? event.touches[0]\n      : (event as MouseEvent);\n\n  const touchStartX = touchPosition.pageX;\n  const touchStartY = touchPosition.pageY;\n\n  // 涟漪位置\n  const offset = $ripple.offset();\n  const height = $ripple.innerHeight();\n  const width = $ripple.innerWidth();\n  const center = {\n    x: touchStartX - offset.left,\n    y: touchStartY - offset.top,\n  };\n  const diameter = Math.max(\n    Math.pow(Math.pow(height, 2) + Math.pow(width, 2), 0.5),\n    48,\n  );\n\n  // 涟漪扩散动画\n  const translate =\n    `translate3d(${-center.x + width / 2}px,` +\n    `${-center.y + height / 2}px, 0) scale(1)`;\n\n  // 涟漪的 DOM 结构，并缓存动画效果\n  $(\n    `<div class=\"mdui-ripple-wave\" ` +\n      `style=\"width:${diameter}px;height:${diameter}px;` +\n      `margin-top:-${diameter / 2}px;margin-left:-${diameter / 2}px;` +\n      `left:${center.x}px;top:${center.y}px;\"></div>`,\n  )\n    .data('_ripple_wave_translate', translate)\n    .prependTo($ripple)\n    .reflow()\n    .transform(translate);\n}\n\n/**\n * 隐藏并移除涟漪\n * @param $wave\n */\nfunction removeRipple($wave: JQ): void {\n  if (!$wave.length || $wave.data('_ripple_wave_removed')) {\n    return;\n  }\n\n  $wave.data('_ripple_wave_removed', true);\n\n  let removeTimer = setTimeout(() => $wave.remove(), 400);\n  const translate = $wave.data('_ripple_wave_translate');\n\n  $wave\n    .addClass('mdui-ripple-wave-fill')\n    .transform(translate.replace('scale(1)', 'scale(1.01)'))\n    .transitionEnd(() => {\n      clearTimeout(removeTimer);\n\n      $wave\n        .addClass('mdui-ripple-wave-out')\n        .transform(translate.replace('scale(1)', 'scale(1.01)'));\n\n      removeTimer = setTimeout(() => $wave.remove(), 700);\n\n      setTimeout(() => {\n        $wave.transitionEnd(() => {\n          clearTimeout(removeTimer);\n          $wave.remove();\n        });\n      }, 0);\n    });\n}\n\n/**\n * 隐藏涟漪动画\n * @param this\n */\nfunction hide(this: any): void {\n  const $ripple = $(this as HTMLElement);\n\n  $ripple.children('.mdui-ripple-wave').each((_, wave) => {\n    removeRipple($(wave));\n  });\n\n  $ripple.off(`${moveEvent} ${endEvent} ${cancelEvent}`, hide);\n}\n\n/**\n * 显示涟漪，并绑定 touchend 等事件\n * @param event\n */\nfunction showRipple(event: Event): void {\n  if (!isAllow(event)) {\n    return;\n  }\n\n  register(event);\n\n  // Chrome 59 点击滚动条时，会在 document 上触发事件\n  if (event.target === document) {\n    return;\n  }\n\n  const $target = $(event.target as HTMLElement);\n\n  // 获取含 .mdui-ripple 类的元素\n  const $ripple = $target.hasClass('mdui-ripple')\n    ? $target\n    : $target.parents('.mdui-ripple').first();\n\n  if (!$ripple.length) {\n    return;\n  }\n\n  // 禁用状态的元素上不产生涟漪效果\n  if ($ripple.prop('disabled') || !isUndefined($ripple.attr('disabled'))) {\n    return;\n  }\n\n  if (event.type === 'touchstart') {\n    let hidden = false;\n\n    // touchstart 触发指定时间后开始涟漪动画，避免手指滑动时也触发涟漪\n    let timer = setTimeout(() => {\n      timer = 0;\n      show(event, $ripple);\n    }, 200);\n\n    const hideRipple = (): void => {\n      // 如果手指没有移动，且涟漪动画还没有开始，则开始涟漪动画\n      if (timer) {\n        clearTimeout(timer);\n        timer = 0;\n        show(event, $ripple);\n      }\n\n      if (!hidden) {\n        hidden = true;\n        hide.call($ripple);\n      }\n    };\n\n    // 手指移动后，移除涟漪动画\n    const touchMove = (): void => {\n      if (timer) {\n        clearTimeout(timer);\n        timer = 0;\n      }\n\n      hideRipple();\n    };\n\n    $ripple.on('touchmove', touchMove).on('touchend touchcancel', hideRipple);\n  } else {\n    show(event, $ripple);\n    $ripple.on(`${moveEvent} ${endEvent} ${cancelEvent}`, hide);\n  }\n}\n\n$(() => {\n  $document.on(startEvent, showRipple).on(unlockEvent, register);\n});\n","import $ from 'mdui.jq/es/$';\nimport extend from 'mdui.jq/es/functions/extend';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/appendTo';\nimport 'mdui.jq/es/methods/attr';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/is';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/outerHeight';\nimport 'mdui.jq/es/methods/parent';\nimport 'mdui.jq/es/methods/parents';\nimport 'mdui.jq/es/methods/remove';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/text';\nimport 'mdui.jq/es/methods/trigger';\nimport 'mdui.jq/es/methods/val';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport { isUndefined } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport { $document } from '../../utils/dom';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 动态修改了文本框后，需要调用该方法重新初始化文本框。\n     *\n     * 若传入了参数，则只初始化该参数对应的文本框。若没有传入参数，则重新初始化所有文本框。\n     * @param selector CSS 选择器、或 DOM 元素、或 DOM 元素组成的数组、或 JQ 对象\n     */\n    updateTextFields(\n      selector?: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    ): void;\n  }\n}\n\ntype INPUT_EVENT_DATA = {\n  reInit?: boolean;\n  domLoadedEvent?: boolean;\n};\n\nconst defaultData: INPUT_EVENT_DATA = {\n  reInit: false,\n  domLoadedEvent: false,\n};\n\n/**\n * 输入框事件\n * @param event\n * @param data\n */\nfunction inputEvent(event: Event, data: INPUT_EVENT_DATA = {}): void {\n  data = extend({}, defaultData, data);\n\n  const input = event.target as HTMLInputElement;\n  const $input = $(input);\n  const eventType = event.type;\n  const value = $input.val() as string;\n\n  // 文本框类型\n  const inputType = $input.attr('type') || '';\n  if (\n    ['checkbox', 'button', 'submit', 'range', 'radio', 'image'].indexOf(\n      inputType,\n    ) > -1\n  ) {\n    return;\n  }\n\n  const $textfield = $input.parent('.mdui-textfield');\n\n  // 输入框是否聚焦\n  if (eventType === 'focus') {\n    $textfield.addClass('mdui-textfield-focus');\n  }\n\n  if (eventType === 'blur') {\n    $textfield.removeClass('mdui-textfield-focus');\n  }\n\n  // 输入框是否为空\n  if (eventType === 'blur' || eventType === 'input') {\n    value\n      ? $textfield.addClass('mdui-textfield-not-empty')\n      : $textfield.removeClass('mdui-textfield-not-empty');\n  }\n\n  // 输入框是否禁用\n  input.disabled\n    ? $textfield.addClass('mdui-textfield-disabled')\n    : $textfield.removeClass('mdui-textfield-disabled');\n\n  // 表单验证\n  if (\n    (eventType === 'input' || eventType === 'blur') &&\n    !data.domLoadedEvent &&\n    input.validity\n  ) {\n    input.validity.valid\n      ? $textfield.removeClass('mdui-textfield-invalid-html5')\n      : $textfield.addClass('mdui-textfield-invalid-html5');\n  }\n\n  // textarea 高度自动调整\n  if ($input.is('textarea')) {\n    // IE bug：textarea 的值仅为多个换行，不含其他内容时，textarea 的高度不准确\n    //         此时，在计算高度前，在值的开头加入一个空格，计算完后，移除空格\n    const inputValue = value;\n    let hasExtraSpace = false;\n\n    if (inputValue.replace(/[\\r\\n]/g, '') === '') {\n      $input.val(' ' + inputValue);\n      hasExtraSpace = true;\n    }\n\n    // 设置 textarea 高度\n    $input.outerHeight('');\n    const height = $input.outerHeight();\n    const scrollHeight = input.scrollHeight;\n\n    if (scrollHeight > height) {\n      $input.outerHeight(scrollHeight);\n    }\n\n    // 计算完，还原 textarea 的值\n    if (hasExtraSpace) {\n      $input.val(inputValue);\n    }\n  }\n\n  // 实时字数统计\n  if (data.reInit) {\n    $textfield.find('.mdui-textfield-counter').remove();\n  }\n\n  const maxLength = $input.attr('maxlength');\n  if (maxLength) {\n    if (data.reInit || data.domLoadedEvent) {\n      $(\n        '<div class=\"mdui-textfield-counter\">' +\n          `<span class=\"mdui-textfield-counter-inputed\"></span> / ${maxLength}` +\n          '</div>',\n      ).appendTo($textfield);\n    }\n\n    $textfield\n      .find('.mdui-textfield-counter-inputed')\n      .text(value.length.toString());\n  }\n\n  // 含 帮助文本、错误提示、字数统计 时，增加文本框底部内边距\n  if (\n    $textfield.find('.mdui-textfield-helper').length ||\n    $textfield.find('.mdui-textfield-error').length ||\n    maxLength\n  ) {\n    $textfield.addClass('mdui-textfield-has-bottom');\n  }\n}\n\n$(() => {\n  // 绑定事件\n  $document.on(\n    'input focus blur',\n    '.mdui-textfield-input',\n    { useCapture: true },\n    inputEvent,\n  );\n\n  // 可展开文本框展开\n  $document.on(\n    'click',\n    '.mdui-textfield-expandable .mdui-textfield-icon',\n    function () {\n      $(this as HTMLElement)\n        .parents('.mdui-textfield')\n        .addClass('mdui-textfield-expanded')\n        .find('.mdui-textfield-input')[0]\n        .focus();\n    },\n  );\n\n  // 可展开文本框关闭\n  $document.on(\n    'click',\n    '.mdui-textfield-expanded .mdui-textfield-close',\n    function () {\n      $(this)\n        .parents('.mdui-textfield')\n        .removeClass('mdui-textfield-expanded')\n        .find('.mdui-textfield-input')\n        .val('');\n    },\n  );\n\n  /**\n   * 初始化文本框\n   */\n  mdui.mutation('.mdui-textfield', function () {\n    $(this).find('.mdui-textfield-input').trigger('input', {\n      domLoadedEvent: true,\n    });\n  });\n});\n\nmdui.updateTextFields = function (\n  selector?: Selector | HTMLElement | ArrayLike<HTMLElement>,\n): void {\n  const $elements = isUndefined(selector) ? $('.mdui-textfield') : $(selector);\n\n  $elements.each((_, element) => {\n    $(element).find('.mdui-textfield-input').trigger('input', {\n      reInit: true,\n    });\n  });\n};\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/append';\nimport 'mdui.jq/es/methods/attr';\nimport 'mdui.jq/es/methods/css';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/empty';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/parent';\nimport 'mdui.jq/es/methods/remove';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/text';\nimport 'mdui.jq/es/methods/val';\nimport 'mdui.jq/es/methods/width';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport { isUndefined } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport { $document } from '../../utils/dom';\nimport {\n  endEvent,\n  isAllow,\n  register,\n  startEvent,\n  unlockEvent,\n} from '../../utils/touchHandler';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 动态修改了滑块后，需要调用该方法重新初始化滑块\n     *\n     * 若传入了参数，则只初始化该参数对应的滑块。若没有传入参数，则重新初始化所有滑块。\n     * @param selector CSS 选择器、或 DOM 元素、或 DOM 元素组成的数组、或 JQ 对象\n     */\n    updateSliders(\n      selector?: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    ): void;\n  }\n}\n\n/**\n * 滑块的值改变后修改滑块样式\n * @param $slider\n */\nfunction updateValueStyle($slider: JQ): void {\n  const data = $slider.data();\n\n  const $track = data._slider_$track;\n  const $fill = data._slider_$fill;\n  const $thumb = data._slider_$thumb;\n  const $input = data._slider_$input;\n  const min = data._slider_min;\n  const max = data._slider_max;\n  const isDisabled = data._slider_disabled;\n  const isDiscrete = data._slider_discrete;\n  const $thumbText = data._slider_$thumbText;\n  const value = $input.val();\n  const percent = ((value - min) / (max - min)) * 100;\n\n  $fill.width(`${percent}%`);\n  $track.width(`${100 - percent}%`);\n\n  if (isDisabled) {\n    $fill.css('padding-right', '6px');\n    $track.css('padding-left', '6px');\n  }\n\n  $thumb.css('left', `${percent}%`);\n\n  if (isDiscrete) {\n    $thumbText.text(value);\n  }\n\n  percent === 0\n    ? $slider.addClass('mdui-slider-zero')\n    : $slider.removeClass('mdui-slider-zero');\n}\n\n/**\n * 重新初始化滑块\n * @param $slider\n */\nfunction reInit($slider: JQ): void {\n  const $track = $('<div class=\"mdui-slider-track\"></div>');\n  const $fill = $('<div class=\"mdui-slider-fill\"></div>');\n  const $thumb = $('<div class=\"mdui-slider-thumb\"></div>');\n  const $input = $slider.find('input[type=\"range\"]') as JQ<HTMLInputElement>;\n  const isDisabled = $input[0].disabled;\n  const isDiscrete = $slider.hasClass('mdui-slider-discrete');\n\n  // 禁用状态\n  isDisabled\n    ? $slider.addClass('mdui-slider-disabled')\n    : $slider.removeClass('mdui-slider-disabled');\n\n  // 重新填充 HTML\n  $slider.find('.mdui-slider-track').remove();\n  $slider.find('.mdui-slider-fill').remove();\n  $slider.find('.mdui-slider-thumb').remove();\n  $slider.append($track).append($fill).append($thumb);\n\n  // 间续型滑块\n  let $thumbText = $();\n  if (isDiscrete) {\n    $thumbText = $('<span></span>');\n    $thumb.empty().append($thumbText);\n  }\n\n  $slider.data('_slider_$track', $track);\n  $slider.data('_slider_$fill', $fill);\n  $slider.data('_slider_$thumb', $thumb);\n  $slider.data('_slider_$input', $input);\n  $slider.data('_slider_min', $input.attr('min'));\n  $slider.data('_slider_max', $input.attr('max'));\n  $slider.data('_slider_disabled', isDisabled);\n  $slider.data('_slider_discrete', isDiscrete);\n  $slider.data('_slider_$thumbText', $thumbText);\n\n  // 设置默认值\n  updateValueStyle($slider);\n}\n\nconst rangeSelector = '.mdui-slider input[type=\"range\"]';\n\n$(() => {\n  // 滑块滑动事件\n  $document.on('input change', rangeSelector, function () {\n    const $slider = $(this).parent() as JQ<HTMLElement>;\n\n    updateValueStyle($slider);\n  });\n\n  // 开始触摸滑块事件\n  $document.on(startEvent, rangeSelector, function (event: Event) {\n    if (!isAllow(event)) {\n      return;\n    }\n\n    register(event);\n\n    if ((this as HTMLInputElement).disabled) {\n      return;\n    }\n\n    const $slider = $(this).parent() as JQ<HTMLElement>;\n\n    $slider.addClass('mdui-slider-focus');\n  });\n\n  // 结束触摸滑块事件\n  $document.on(endEvent, rangeSelector, function (event: Event) {\n    if (!isAllow(event)) {\n      return;\n    }\n\n    if ((this as HTMLInputElement).disabled) {\n      return;\n    }\n\n    const $slider = $(this).parent() as JQ<HTMLElement>;\n\n    $slider.removeClass('mdui-slider-focus');\n  });\n\n  $document.on(unlockEvent, rangeSelector, register);\n\n  /**\n   * 初始化滑块\n   */\n  mdui.mutation('.mdui-slider', function () {\n    reInit($(this));\n  });\n});\n\nmdui.updateSliders = function (\n  selector?: Selector | HTMLElement | ArrayLike<HTMLElement>,\n): void {\n  const $elements = isUndefined(selector) ? $('.mdui-slider') : $(selector);\n\n  $elements.each((_, element) => {\n    reInit($(element));\n  });\n};\n","import $ from 'mdui.jq/es/$';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/css';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/last';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/parents';\nimport 'mdui.jq/es/methods/removeClass';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport mdui from '../../mdui';\nimport '../../jq_extends/methods/transitionEnd';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $document } from '../../utils/dom';\nimport { startEvent } from '../../utils/touchHandler';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 浮动操作按钮组件\n     *\n     * 请通过 `new mdui.Fab()` 调用\n     */\n    Fab: {\n      /**\n       * 实例化 Fab 组件\n       * @param selector CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Fab;\n    };\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * 触发方式。`hover`: 鼠标悬浮触发；`click`: 点击触发\n   *\n   * 默认为 `hover`\n   */\n  trigger?: 'click' | 'hover';\n};\n\ntype STATE = 'opening' | 'opened' | 'closing' | 'closed';\ntype EVENT = 'open' | 'opened' | 'close' | 'closed';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  trigger: 'hover',\n};\n\nclass Fab {\n  /**\n   * Fab 元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * 当前 fab 的状态\n   */\n  private state: STATE = 'closed';\n\n  /**\n   * 按钮元素\n   */\n  private $btn: JQ;\n\n  /**\n   * 拨号菜单元素\n   */\n  private $dial: JQ;\n\n  /**\n   * 拨号菜单内的按钮\n   */\n  private $dialBtns: JQ;\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    this.$element = $(selector).first();\n\n    extend(this.options, options);\n\n    this.$btn = this.$element.find('.mdui-fab');\n    this.$dial = this.$element.find('.mdui-fab-dial');\n    this.$dialBtns = this.$dial.find('.mdui-fab');\n\n    if (this.options.trigger === 'hover') {\n      this.$btn.on('touchstart mouseenter', () => this.open());\n      this.$element.on('mouseleave', () => this.close());\n    }\n\n    if (this.options.trigger === 'click') {\n      this.$btn.on(startEvent, () => this.open());\n    }\n\n    // 触摸屏幕其他地方关闭快速拨号\n    $document.on(startEvent, (event) => {\n      if ($(event.target as HTMLElement).parents('.mdui-fab-wrapper').length) {\n        return;\n      }\n\n      this.close();\n    });\n  }\n\n  /**\n   * 触发组件事件\n   * @param name\n   */\n  private triggerEvent(name: EVENT): void {\n    componentEvent(name, 'fab', this.$element, this);\n  }\n\n  /**\n   * 当前是否为打开状态\n   */\n  private isOpen(): boolean {\n    return this.state === 'opening' || this.state === 'opened';\n  }\n\n  /**\n   * 打开快速拨号菜单\n   */\n  public open(): void {\n    if (this.isOpen()) {\n      return;\n    }\n\n    // 为菜单中的按钮添加不同的 transition-delay\n    this.$dialBtns.each((index, btn) => {\n      const delay = `${15 * (this.$dialBtns.length - index)}ms`;\n\n      btn.style.transitionDelay = delay;\n      btn.style.webkitTransitionDelay = delay;\n    });\n\n    this.$dial.css('height', 'auto').addClass('mdui-fab-dial-show');\n\n    // 如果按钮中存在 .mdui-fab-opened 的图标，则进行图标切换\n    if (this.$btn.find('.mdui-fab-opened').length) {\n      this.$btn.addClass('mdui-fab-opened');\n    }\n\n    this.state = 'opening';\n    this.triggerEvent('open');\n\n    // 打开顺序为从下到上逐个打开，最上面的打开后才表示动画完成\n    this.$dialBtns.first().transitionEnd(() => {\n      if (this.$btn.hasClass('mdui-fab-opened')) {\n        this.state = 'opened';\n        this.triggerEvent('opened');\n      }\n    });\n  }\n\n  /**\n   * 关闭快速拨号菜单\n   */\n  public close(): void {\n    if (!this.isOpen()) {\n      return;\n    }\n\n    // 为菜单中的按钮添加不同的 transition-delay\n    this.$dialBtns.each((index, btn) => {\n      const delay = `${15 * index}ms`;\n\n      btn.style.transitionDelay = delay;\n      btn.style.webkitTransitionDelay = delay;\n    });\n\n    this.$dial.removeClass('mdui-fab-dial-show');\n    this.$btn.removeClass('mdui-fab-opened');\n    this.state = 'closing';\n    this.triggerEvent('close');\n\n    // 从上往下依次关闭，最后一个关闭后才表示动画完成\n    this.$dialBtns.last().transitionEnd(() => {\n      if (this.$btn.hasClass('mdui-fab-opened')) {\n        return;\n      }\n\n      this.state = 'closed';\n      this.triggerEvent('closed');\n      this.$dial.css('height', 0);\n    });\n  }\n\n  /**\n   * 切换快速拨号菜单的打开状态\n   */\n  public toggle(): void {\n    this.isOpen() ? this.close() : this.open();\n  }\n\n  /**\n   * 以动画的形式显示整个浮动操作按钮\n   */\n  public show(): void {\n    this.$element.removeClass('mdui-fab-hide');\n  }\n\n  /**\n   * 以动画的形式隐藏整个浮动操作按钮\n   */\n  public hide(): void {\n    this.$element.addClass('mdui-fab-hide');\n  }\n\n  /**\n   * 返回当前快速拨号菜单的打开状态。共包含四种状态：`opening`、`opened`、`closing`、`closed`\n   */\n  public getState(): STATE {\n    return this.state;\n  }\n}\n\nmdui.Fab = Fab;\n","import $ from 'mdui.jq/es/$';\nimport mdui from '../../mdui';\nimport { $document } from '../../utils/dom';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-fab';\n\n$(() => {\n  // mouseenter 不冒泡，无法进行事件委托，这里用 mouseover 代替。\n  // 不管是 click 、 mouseover 还是 touchstart ，都先初始化。\n\n  $document.on(\n    'touchstart mousedown mouseover',\n    `[${customAttr}]`,\n    function () {\n      new mdui.Fab(\n        this as HTMLElement,\n        parseOptions(this as HTMLElement, customAttr),\n      );\n    },\n  );\n});\n","/**\n * 最终生成的元素结构为：\n *  <select class=\"mdui-select\" mdui-select=\"{position: 'top'}\" style=\"display: none;\"> // $native\n *    <option value=\"1\">State 1</option>\n *    <option value=\"2\">State 2</option>\n *    <option value=\"3\" disabled=\"\">State 3</option>\n *  </select>\n *  <div class=\"mdui-select mdui-select-position-top\" style=\"\" id=\"88dec0e4-d4a2-c6d0-0e7f-1ba4501e0553\"> // $element\n *    <span class=\"mdui-select-selected\">State 1</span> // $selected\n *    <div class=\"mdui-select-menu\" style=\"transform-origin: center 100% 0px;\"> // $menu\n *      <div class=\"mdui-select-menu-item mdui-ripple\" selected=\"\">State 1</div> // $items\n *      <div class=\"mdui-select-menu-item mdui-ripple\">State 2</div>\n *      <div class=\"mdui-select-menu-item mdui-ripple\" disabled=\"\">State 3</div>\n *    </div>\n *  </div>\n */\n\nimport $ from 'mdui.jq/es/$';\nimport contains from 'mdui.jq/es/functions/contains';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/add';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/after';\nimport 'mdui.jq/es/methods/append';\nimport 'mdui.jq/es/methods/appendTo';\nimport 'mdui.jq/es/methods/attr';\nimport 'mdui.jq/es/methods/css';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/height';\nimport 'mdui.jq/es/methods/hide';\nimport 'mdui.jq/es/methods/index';\nimport 'mdui.jq/es/methods/innerWidth';\nimport 'mdui.jq/es/methods/is';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/remove';\nimport 'mdui.jq/es/methods/removeAttr';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/show';\nimport 'mdui.jq/es/methods/text';\nimport 'mdui.jq/es/methods/trigger';\nimport 'mdui.jq/es/methods/val';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport mdui from '../../mdui';\nimport '../../jq_extends/methods/transitionEnd';\nimport '../../jq_extends/static/guid';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $document, $window } from '../../utils/dom';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 下拉选择组件\n     *\n     * 请通过 `new mdui.Select()` 调用\n     */\n    Select: {\n      /**\n       * 实例化 Select 组件\n       * @param selector CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Select;\n    };\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * 下拉框位置：`auto`、`top`、`bottom`\n   */\n  position?: 'auto' | 'top' | 'bottom';\n\n  /**\n   * 菜单与窗口上下边框至少保持多少间距\n   */\n  gutter?: number;\n};\n\ntype STATE = 'closing' | 'closed' | 'opening' | 'opened';\ntype EVENT = 'open' | 'opened' | 'close' | 'closed';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  position: 'auto',\n  gutter: 16,\n};\n\nclass Select {\n  /**\n   * 原生 `<select>` 元素的 JQ 对象\n   */\n  public $native: JQ<HTMLSelectElement>;\n\n  /**\n   * 生成的 `<div class=\"mdui-select\">` 元素的 JQ 对象\n   */\n  public $element: JQ = $();\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * select 的 size 属性的值，根据该值设置 select 的高度\n   */\n  private size = 0;\n\n  /**\n   * 占位元素，显示已选中菜单项的文本\n   */\n  private $selected: JQ = $();\n\n  /**\n   * 菜单项的外层元素的 JQ 对象\n   */\n  private $menu: JQ = $();\n\n  /**\n   * 菜单项数组的 JQ 对象\n   */\n  private $items: JQ = $();\n\n  /**\n   * 当前选中的菜单项的索引号\n   */\n  private selectedIndex = 0;\n\n  /**\n   * 当前选中菜单项的文本\n   */\n  private selectedText = '';\n\n  /**\n   * 当前选中菜单项的值\n   */\n  private selectedValue = '';\n\n  /**\n   * 唯一 ID\n   */\n  private uniqueID: string;\n\n  /**\n   * 当前 select 的状态\n   */\n  private state: STATE = 'closed';\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    this.$native = $(selector).first() as JQ<HTMLSelectElement>;\n    this.$native.hide();\n\n    extend(this.options, options);\n\n    // 为当前 select 生成唯一 ID\n    this.uniqueID = $.guid();\n\n    // 生成 select\n    this.handleUpdate();\n\n    // 点击 select 外面区域关闭\n    $document.on('click touchstart', (event: Event) => {\n      const $target = $(event.target as HTMLElement);\n\n      if (\n        this.isOpen() &&\n        !$target.is(this.$element) &&\n        !contains(this.$element[0], $target[0])\n      ) {\n        this.close();\n      }\n    });\n  }\n\n  /**\n   * 调整菜单位置\n   */\n  private readjustMenu(): void {\n    const windowHeight = $window.height();\n\n    // mdui-select 高度\n    const elementHeight = this.$element.height();\n\n    // 菜单项高度\n    const $itemFirst = this.$items.first();\n    const itemHeight = $itemFirst.height();\n    const itemMargin = parseInt($itemFirst.css('margin-top'));\n\n    // 菜单高度\n    const menuWidth = this.$element.innerWidth() + 0.01; // 必须比真实宽度多一点，不然会出现省略号\n    let menuHeight = itemHeight * this.size + itemMargin * 2;\n\n    // mdui-select 在窗口中的位置\n    const elementTop = this.$element[0].getBoundingClientRect().top;\n\n    let transformOriginY: string;\n    let menuMarginTop: number;\n\n    if (this.options.position === 'bottom') {\n      menuMarginTop = elementHeight;\n      transformOriginY = '0px';\n    } else if (this.options.position === 'top') {\n      menuMarginTop = -menuHeight - 1;\n      transformOriginY = '100%';\n    } else {\n      // 菜单高度不能超过窗口高度\n      const menuMaxHeight = windowHeight - this.options.gutter! * 2;\n      if (menuHeight > menuMaxHeight) {\n        menuHeight = menuMaxHeight;\n      }\n\n      // 菜单的 margin-top\n      menuMarginTop = -(\n        itemMargin +\n        this.selectedIndex * itemHeight +\n        (itemHeight - elementHeight) / 2\n      );\n\n      const menuMaxMarginTop = -(\n        itemMargin +\n        (this.size - 1) * itemHeight +\n        (itemHeight - elementHeight) / 2\n      );\n      if (menuMarginTop < menuMaxMarginTop) {\n        menuMarginTop = menuMaxMarginTop;\n      }\n\n      // 菜单不能超出窗口\n      const menuTop = elementTop + menuMarginTop;\n      if (menuTop < this.options.gutter!) {\n        // 不能超出窗口上方\n        menuMarginTop = -(elementTop - this.options.gutter!);\n      } else if (menuTop + menuHeight + this.options.gutter! > windowHeight) {\n        // 不能超出窗口下方\n        menuMarginTop = -(\n          elementTop +\n          menuHeight +\n          this.options.gutter! -\n          windowHeight\n        );\n      }\n\n      // transform 的 Y 轴坐标\n      transformOriginY = `${\n        this.selectedIndex * itemHeight + itemHeight / 2 + itemMargin\n      }px`;\n    }\n\n    // 设置样式\n    this.$element.innerWidth(menuWidth);\n    this.$menu\n      .innerWidth(menuWidth)\n      .height(menuHeight)\n      .css({\n        'margin-top': menuMarginTop + 'px',\n        'transform-origin': 'center ' + transformOriginY + ' 0',\n      });\n  }\n\n  /**\n   * select 是否为打开状态\n   */\n  private isOpen(): boolean {\n    return this.state === 'opening' || this.state === 'opened';\n  }\n\n  /**\n   * 对原生 select 组件进行了修改后，需要调用该方法\n   */\n  public handleUpdate(): void {\n    if (this.isOpen()) {\n      this.close();\n    }\n\n    this.selectedValue = this.$native.val() as string;\n\n    // 保存菜单项数据的数组\n    type typeItemsData = {\n      value: string;\n      text: string;\n      disabled: boolean;\n      selected: boolean;\n      index: number;\n    };\n    const itemsData: typeItemsData[] = [];\n    this.$items = $();\n\n    // 生成 HTML\n    this.$native.find('option').each((index, option) => {\n      const text = option.textContent || '';\n      const value = option.value;\n      const disabled = option.disabled;\n      const selected = this.selectedValue === value;\n\n      itemsData.push({\n        value,\n        text,\n        disabled,\n        selected,\n        index,\n      });\n\n      if (selected) {\n        this.selectedText = text;\n        this.selectedIndex = index;\n      }\n\n      this.$items = this.$items.add(\n        '<div class=\"mdui-select-menu-item mdui-ripple\"' +\n          (disabled ? ' disabled' : '') +\n          (selected ? ' selected' : '') +\n          `>${text}</div>`,\n      );\n    });\n\n    this.$selected = $(\n      `<span class=\"mdui-select-selected\">${this.selectedText}</span>`,\n    );\n\n    this.$element = $(\n      `<div class=\"mdui-select mdui-select-position-${this.options.position}\" ` +\n        `style=\"${this.$native.attr('style')}\" ` +\n        `id=\"${this.uniqueID}\"></div>`,\n    )\n      .show()\n      .append(this.$selected);\n\n    this.$menu = $('<div class=\"mdui-select-menu\"></div>')\n      .appendTo(this.$element)\n      .append(this.$items);\n\n    $(`#${this.uniqueID}`).remove();\n    this.$native.after(this.$element);\n\n    // 根据 select 的 size 属性设置高度\n    this.size = parseInt(this.$native.attr('size') || '0');\n\n    if (this.size <= 0) {\n      this.size = this.$items.length;\n\n      if (this.size > 8) {\n        this.size = 8;\n      }\n    }\n\n    // 点击选项时关闭下拉菜单\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const that = this;\n    this.$items.on('click', function () {\n      if (that.state === 'closing') {\n        return;\n      }\n\n      const $item = $(this);\n      const index = $item.index();\n      const data = itemsData[index];\n\n      if (data.disabled) {\n        return;\n      }\n\n      that.$selected.text(data.text);\n      that.$native.val(data.value);\n      that.$items.removeAttr('selected');\n      $item.attr('selected', '');\n      that.selectedIndex = data.index;\n      that.selectedValue = data.value;\n      that.selectedText = data.text;\n      that.$native.trigger('change');\n      that.close();\n    });\n\n    // 点击 $element 时打开下拉菜单\n    this.$element.on('click', (event: Event) => {\n      const $target = $(event.target as HTMLElement);\n\n      // 在菜单上点击时不打开\n      if (\n        $target.is('.mdui-select-menu') ||\n        $target.is('.mdui-select-menu-item')\n      ) {\n        return;\n      }\n\n      this.toggle();\n    });\n  }\n\n  /**\n   * 动画结束的回调\n   */\n  private transitionEnd(): void {\n    this.$element.removeClass('mdui-select-closing');\n\n    if (this.state === 'opening') {\n      this.state = 'opened';\n      this.triggerEvent('opened');\n      this.$menu.css('overflow-y', 'auto');\n    }\n\n    if (this.state === 'closing') {\n      this.state = 'closed';\n      this.triggerEvent('closed');\n\n      // 恢复样式\n      this.$element.innerWidth('');\n      this.$menu.css({\n        'margin-top': '',\n        height: '',\n        width: '',\n      });\n    }\n  }\n\n  /**\n   * 触发组件事件\n   * @param name\n   */\n  private triggerEvent(name: EVENT): void {\n    componentEvent(name, 'select', this.$native, this);\n  }\n\n  /**\n   * 切换下拉菜单的打开状态\n   */\n  public toggle(): void {\n    this.isOpen() ? this.close() : this.open();\n  }\n\n  /**\n   * 打开下拉菜单\n   */\n  public open(): void {\n    if (this.isOpen()) {\n      return;\n    }\n\n    this.state = 'opening';\n    this.triggerEvent('open');\n    this.readjustMenu();\n    this.$element.addClass('mdui-select-open');\n    this.$menu.transitionEnd(() => this.transitionEnd());\n  }\n\n  /**\n   * 关闭下拉菜单\n   */\n  public close(): void {\n    if (!this.isOpen()) {\n      return;\n    }\n\n    this.state = 'closing';\n    this.triggerEvent('close');\n    this.$menu.css('overflow-y', '');\n    this.$element\n      .removeClass('mdui-select-open')\n      .addClass('mdui-select-closing');\n    this.$menu.transitionEnd(() => this.transitionEnd());\n  }\n\n  /**\n   * 获取当前菜单的状态。共包含四种状态：`opening`、`opened`、`closing`、`closed`\n   */\n  public getState(): STATE {\n    return this.state;\n  }\n}\n\nmdui.Select = Select;\n","import $ from 'mdui.jq/es/$';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-select';\n\n$(() => {\n  mdui.mutation(`[${customAttr}]`, function () {\n    new mdui.Select(this, parseOptions(this, customAttr));\n  });\n});\n","import $ from 'mdui.jq/es/$';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport '../headroom';\n\n$(() => {\n  // 滚动时隐藏应用栏\n  mdui.mutation('.mdui-appbar-scroll-hide', function () {\n    new mdui.Headroom(this);\n  });\n\n  // 滚动时只隐藏应用栏中的工具栏\n  mdui.mutation('.mdui-appbar-scroll-toolbar-hide', function () {\n    new mdui.Headroom(this, {\n      pinnedClass: 'mdui-headroom-pinned-toolbar',\n      unpinnedClass: 'mdui-headroom-unpinned-toolbar',\n    });\n  });\n});\n","import $ from 'mdui.jq/es/$';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/appendTo';\nimport 'mdui.jq/es/methods/attr';\nimport 'mdui.jq/es/methods/children';\nimport 'mdui.jq/es/methods/css';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/eq';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/get';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/hide';\nimport 'mdui.jq/es/methods/index';\nimport 'mdui.jq/es/methods/innerWidth';\nimport 'mdui.jq/es/methods/offset';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/show';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport { isNumber } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport '../../jq_extends/static/throttle';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $window } from '../../utils/dom';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * Tab 选项卡组件\n     *\n     * 请通过 `new mdui.Tab()` 调用\n     */\n    Tab: {\n      /**\n       * 实例化 Tab 组件\n       * @param selector CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Tab;\n    };\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * 切换选项卡的触发方式。`click`: 点击切换；`hover`: 鼠标悬浮切换\n   */\n  trigger?: 'click' | 'hover';\n\n  /**\n   * 是否启用循环切换，若为 `true`，则最后一个选项激活时调用 `next` 方法将回到第一个选项，第一个选项激活时调用 `prev` 方法将回到最后一个选项。\n   */\n  loop?: boolean;\n};\n\ntype EVENT = 'change' | 'show';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  trigger: 'click',\n  loop: false,\n};\n\nclass Tab {\n  /**\n   * tab 元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * 当前激活的 tab 的索引号。为 -1 时表示没有激活的选项卡，或不存在选项卡\n   */\n  public activeIndex = -1;\n\n  /**\n   * 选项数组 JQ 对象\n   */\n  private $tabs: JQ;\n\n  /**\n   * 激活状态的 tab 底部的指示符\n   */\n  private $indicator: JQ;\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    this.$element = $(selector).first();\n\n    extend(this.options, options);\n\n    this.$tabs = this.$element.children('a');\n    this.$indicator = $('<div class=\"mdui-tab-indicator\"></div>').appendTo(\n      this.$element,\n    );\n\n    // 根据 url hash 获取默认激活的选项卡\n    const hash = window.location.hash;\n    if (hash) {\n      this.$tabs.each((index, tab) => {\n        if ($(tab).attr('href') === hash) {\n          this.activeIndex = index;\n          return false;\n        }\n\n        return true;\n      });\n    }\n\n    // 含 .mdui-tab-active 的元素默认激活\n    if (this.activeIndex === -1) {\n      this.$tabs.each((index, tab) => {\n        if ($(tab).hasClass('mdui-tab-active')) {\n          this.activeIndex = index;\n          return false;\n        }\n\n        return true;\n      });\n    }\n\n    // 存在选项卡时，默认激活第一个选项卡\n    if (this.$tabs.length && this.activeIndex === -1) {\n      this.activeIndex = 0;\n    }\n\n    // 设置激活状态选项卡\n    this.setActive();\n\n    // 监听窗口大小变化事件，调整指示器位置\n    $window.on(\n      'resize',\n      $.throttle(() => this.setIndicatorPosition(), 100),\n    );\n\n    // 监听点击选项卡事件\n    this.$tabs.each((_, tab) => {\n      this.bindTabEvent(tab);\n    });\n  }\n\n  /**\n   * 指定选项卡是否已禁用\n   * @param $tab\n   */\n  private isDisabled($tab: JQ): boolean {\n    return $tab.attr('disabled') !== undefined;\n  }\n\n  /**\n   * 绑定在 Tab 上点击或悬浮的事件\n   * @param tab\n   */\n  private bindTabEvent(tab: HTMLElement): void {\n    const $tab = $(tab);\n\n    // 点击或鼠标移入触发的事件\n    const clickEvent = (): void | false => {\n      // 禁用状态的选项卡无法选中\n      if (this.isDisabled($tab)) {\n        return false;\n      }\n\n      this.activeIndex = this.$tabs.index(tab);\n      this.setActive();\n    };\n\n    // 无论 trigger 是 click 还是 hover，都会响应 click 事件\n    $tab.on('click', clickEvent);\n\n    // trigger 为 hover 时，额外响应 mouseenter 事件\n    if (this.options.trigger === 'hover') {\n      $tab.on('mouseenter', clickEvent);\n    }\n\n    // 阻止链接的默认点击动作\n    $tab.on('click', (): void | false => {\n      if (($tab.attr('href') || '').indexOf('#') === 0) {\n        return false;\n      }\n    });\n  }\n\n  /**\n   * 触发组件事件\n   * @param name\n   * @param $element\n   * @param parameters\n   */\n  private triggerEvent(name: EVENT, $element: JQ, parameters = {}): void {\n    componentEvent(name, 'tab', $element, this, parameters);\n  }\n\n  /**\n   * 设置激活状态的选项卡\n   */\n  private setActive(): void {\n    this.$tabs.each((index, tab) => {\n      const $tab = $(tab);\n      const targetId = $tab.attr('href') || '';\n\n      // 设置选项卡激活状态\n      if (index === this.activeIndex && !this.isDisabled($tab)) {\n        if (!$tab.hasClass('mdui-tab-active')) {\n          this.triggerEvent('change', this.$element, {\n            index: this.activeIndex,\n            id: targetId.substr(1),\n          });\n          this.triggerEvent('show', $tab);\n\n          $tab.addClass('mdui-tab-active');\n        }\n\n        $(targetId).show();\n        this.setIndicatorPosition();\n      } else {\n        $tab.removeClass('mdui-tab-active');\n        $(targetId).hide();\n      }\n    });\n  }\n\n  /**\n   * 设置选项卡指示器的位置\n   */\n  private setIndicatorPosition(): void {\n    // 选项卡数量为 0 时，不显示指示器\n    if (this.activeIndex === -1) {\n      this.$indicator.css({\n        left: 0,\n        width: 0,\n      });\n\n      return;\n    }\n\n    const $activeTab = this.$tabs.eq(this.activeIndex);\n\n    if (this.isDisabled($activeTab)) {\n      return;\n    }\n\n    const activeTabOffset = $activeTab.offset();\n\n    this.$indicator.css({\n      left: `${\n        activeTabOffset.left +\n        this.$element[0].scrollLeft -\n        this.$element[0].getBoundingClientRect().left\n      }px`,\n      width: `${$activeTab.innerWidth()}px`,\n    });\n  }\n\n  /**\n   * 切换到下一个选项卡\n   */\n  public next(): void {\n    if (this.activeIndex === -1) {\n      return;\n    }\n\n    if (this.$tabs.length > this.activeIndex + 1) {\n      this.activeIndex++;\n    } else if (this.options.loop) {\n      this.activeIndex = 0;\n    }\n\n    this.setActive();\n  }\n\n  /**\n   * 切换到上一个选项卡\n   */\n  public prev(): void {\n    if (this.activeIndex === -1) {\n      return;\n    }\n\n    if (this.activeIndex > 0) {\n      this.activeIndex--;\n    } else if (this.options.loop) {\n      this.activeIndex = this.$tabs.length - 1;\n    }\n\n    this.setActive();\n  }\n\n  /**\n   * 显示指定索引号、或指定id的选项卡\n   * @param index 索引号、或id\n   */\n  public show(index: number | string): void {\n    if (this.activeIndex === -1) {\n      return;\n    }\n\n    if (isNumber(index)) {\n      this.activeIndex = index;\n    } else {\n      this.$tabs.each((i, tab): void | false => {\n        if (tab.id === index) {\n          this.activeIndex === i;\n          return false;\n        }\n      });\n    }\n\n    this.setActive();\n  }\n\n  /**\n   * 在父元素的宽度变化时，需要调用该方法重新调整指示器位置\n   * 在添加或删除选项卡时，需要调用该方法\n   */\n  public handleUpdate(): void {\n    const $oldTabs = this.$tabs; // 旧的 tabs JQ对象\n    const $newTabs = this.$element.children('a'); // 新的 tabs JQ对象\n    const oldTabsElement = $oldTabs.get(); // 旧的 tabs 元素数组\n    const newTabsElement = $newTabs.get(); // 新的 tabs 元素数组\n\n    if (!$newTabs.length) {\n      this.activeIndex = -1;\n      this.$tabs = $newTabs;\n      this.setIndicatorPosition();\n\n      return;\n    }\n\n    // 重新遍历选项卡，找出新增的选项卡\n    $newTabs.each((index, tab) => {\n      // 有新增的选项卡\n      if (oldTabsElement.indexOf(tab) < 0) {\n        this.bindTabEvent(tab);\n\n        if (this.activeIndex === -1) {\n          this.activeIndex = 0;\n        } else if (index <= this.activeIndex) {\n          this.activeIndex++;\n        }\n      }\n    });\n\n    // 找出被移除的选项卡\n    $oldTabs.each((index, tab) => {\n      // 有被移除的选项卡\n      if (newTabsElement.indexOf(tab) < 0) {\n        if (index < this.activeIndex) {\n          this.activeIndex--;\n        } else if (index === this.activeIndex) {\n          this.activeIndex = 0;\n        }\n      }\n    });\n\n    this.$tabs = $newTabs;\n\n    this.setActive();\n  }\n}\n\nmdui.Tab = Tab;\n","import $ from 'mdui.jq/es/$';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-tab';\n\n$(() => {\n  mdui.mutation(`[${customAttr}]`, function () {\n    new mdui.Tab(this, parseOptions(this, customAttr));\n  });\n});\n","/**\n * 在桌面设备上默认显示抽屉栏，不显示遮罩层\n * 在手机和平板设备上默认不显示抽屉栏，始终显示遮罩层，且覆盖导航栏\n */\n\nimport $ from 'mdui.jq/es/$';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/off';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/one';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/width';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport mdui from '../../mdui';\nimport '../../jq_extends/methods/transitionEnd';\nimport '../../jq_extends/static/hideOverlay';\nimport '../../jq_extends/static/lockScreen';\nimport '../../jq_extends/static/showOverlay';\nimport '../../jq_extends/static/throttle';\nimport '../../jq_extends/static/unlockScreen';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $window } from '../../utils/dom';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * Drawer 组件\n     *\n     * 请通过 `new mdui.Drawer()` 调用\n     */\n    Drawer: {\n      /**\n       * 实例化 Drawer 组件\n       * @param selector CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Drawer;\n    };\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * 打开抽屉栏时是否显示遮罩层。该参数只对中等屏幕及以上的设备有效，在超小屏和小屏设备上始终会显示遮罩层。\n   */\n  overlay?: boolean;\n\n  /**\n   * 是否启用滑动手势。\n   */\n  swipe?: boolean;\n};\n\ntype STATE = 'opening' | 'opened' | 'closing' | 'closed';\ntype EVENT = 'open' | 'opened' | 'close' | 'closed';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  overlay: false,\n  swipe: false,\n};\n\nclass Drawer {\n  /**\n   * drawer 元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * 当前是否显示着遮罩层\n   */\n  private overlay = false;\n\n  /**\n   * 抽屉栏的位置\n   */\n  private position: 'left' | 'right';\n\n  /**\n   * 当前抽屉栏状态\n   */\n  private state: STATE;\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    this.$element = $(selector).first();\n\n    extend(this.options, options);\n\n    this.position = this.$element.hasClass('mdui-drawer-right')\n      ? 'right'\n      : 'left';\n\n    if (this.$element.hasClass('mdui-drawer-close')) {\n      this.state = 'closed';\n    } else if (this.$element.hasClass('mdui-drawer-open')) {\n      this.state = 'opened';\n    } else if (this.isDesktop()) {\n      this.state = 'opened';\n    } else {\n      this.state = 'closed';\n    }\n\n    // 浏览器窗口大小调整时\n    $window.on(\n      'resize',\n      $.throttle(() => {\n        if (this.isDesktop()) {\n          // 由手机平板切换到桌面时\n          // 如果显示着遮罩，则隐藏遮罩\n          if (this.overlay && !this.options.overlay) {\n            $.hideOverlay();\n            this.overlay = false;\n            $.unlockScreen();\n          }\n\n          // 没有强制关闭，则状态为打开状态\n          if (!this.$element.hasClass('mdui-drawer-close')) {\n            this.state = 'opened';\n          }\n        } else if (!this.overlay && this.state === 'opened') {\n          // 由桌面切换到手机平板时。如果抽屉栏是打开着的且没有遮罩层，则关闭抽屉栏\n          if (this.$element.hasClass('mdui-drawer-open')) {\n            $.showOverlay();\n            this.overlay = true;\n            $.lockScreen();\n\n            $('.mdui-overlay').one('click', () => this.close());\n          } else {\n            this.state = 'closed';\n          }\n        }\n      }, 100),\n    );\n\n    // 绑定关闭按钮事件\n    this.$element.find('[mdui-drawer-close]').each((_, close) => {\n      $(close).on('click', () => this.close());\n    });\n\n    this.swipeSupport();\n  }\n\n  /**\n   * 是否是桌面设备\n   */\n  private isDesktop(): boolean {\n    return $window.width() >= 1024;\n  }\n\n  /**\n   * 滑动手势支持\n   */\n  private swipeSupport(): void {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const that = this;\n\n    // 抽屉栏滑动手势控制\n    let openNavEventHandler: (event: Event) => void;\n    let touchStartX: number;\n    let touchStartY: number;\n    let swipeStartX: number;\n    let swiping: null | 'opening' | 'closing' = null;\n    let maybeSwiping = false;\n    const $body = $('body');\n\n    // 手势触发的范围\n    const swipeAreaWidth = 24;\n\n    function setPosition(translateX: number): void {\n      const rtlTranslateMultiplier = that.position === 'right' ? -1 : 1;\n      const transformCSS = `translate(${\n        -1 * rtlTranslateMultiplier * translateX\n      }px, 0) !important;`;\n      const transitionCSS = 'initial !important;';\n\n      that.$element.css(\n        'cssText',\n        `transform: ${transformCSS}; transition: ${transitionCSS};`,\n      );\n    }\n\n    function cleanPosition(): void {\n      that.$element[0].style.transform = '';\n      that.$element[0].style.webkitTransform = '';\n      that.$element[0].style.transition = '';\n      that.$element[0].style.webkitTransition = '';\n    }\n\n    function getMaxTranslateX(): number {\n      return that.$element.width() + 10;\n    }\n\n    function getTranslateX(currentX: number): number {\n      return Math.min(\n        Math.max(\n          swiping === 'closing'\n            ? swipeStartX - currentX\n            : getMaxTranslateX() + swipeStartX - currentX,\n          0,\n        ),\n        getMaxTranslateX(),\n      );\n    }\n\n    function onBodyTouchEnd(event?: Event): void {\n      if (swiping) {\n        let touchX = (event as TouchEvent).changedTouches[0].pageX;\n        if (that.position === 'right') {\n          touchX = $body.width() - touchX;\n        }\n\n        const translateRatio = getTranslateX(touchX) / getMaxTranslateX();\n\n        maybeSwiping = false;\n        const swipingState = swiping;\n        swiping = null;\n\n        if (swipingState === 'opening') {\n          if (translateRatio < 0.92) {\n            cleanPosition();\n            that.open();\n          } else {\n            cleanPosition();\n          }\n        } else {\n          if (translateRatio > 0.08) {\n            cleanPosition();\n            that.close();\n          } else {\n            cleanPosition();\n          }\n        }\n\n        $.unlockScreen();\n      } else {\n        maybeSwiping = false;\n      }\n\n      $body.off({\n        // eslint-disable-next-line @typescript-eslint/no-use-before-define\n        touchmove: onBodyTouchMove,\n        touchend: onBodyTouchEnd,\n        // eslint-disable-next-line @typescript-eslint/no-use-before-define\n        touchcancel: onBodyTouchMove,\n      });\n    }\n\n    function onBodyTouchMove(event: Event): void {\n      let touchX = (event as TouchEvent).touches[0].pageX;\n      if (that.position === 'right') {\n        touchX = $body.width() - touchX;\n      }\n\n      const touchY = (event as TouchEvent).touches[0].pageY;\n\n      if (swiping) {\n        setPosition(getTranslateX(touchX));\n      } else if (maybeSwiping) {\n        const dXAbs = Math.abs(touchX - touchStartX);\n        const dYAbs = Math.abs(touchY - touchStartY);\n        const threshold = 8;\n\n        if (dXAbs > threshold && dYAbs <= threshold) {\n          swipeStartX = touchX;\n          swiping = that.state === 'opened' ? 'closing' : 'opening';\n          $.lockScreen();\n          setPosition(getTranslateX(touchX));\n        } else if (dXAbs <= threshold && dYAbs > threshold) {\n          onBodyTouchEnd();\n        }\n      }\n    }\n\n    function onBodyTouchStart(event: Event): void {\n      touchStartX = (event as TouchEvent).touches[0].pageX;\n      if (that.position === 'right') {\n        touchStartX = $body.width() - touchStartX;\n      }\n\n      touchStartY = (event as TouchEvent).touches[0].pageY;\n\n      if (that.state !== 'opened') {\n        if (\n          touchStartX > swipeAreaWidth ||\n          openNavEventHandler !== onBodyTouchStart\n        ) {\n          return;\n        }\n      }\n\n      maybeSwiping = true;\n\n      $body.on({\n        touchmove: onBodyTouchMove,\n        touchend: onBodyTouchEnd,\n        touchcancel: onBodyTouchMove,\n      });\n    }\n\n    function enableSwipeHandling(): void {\n      if (!openNavEventHandler) {\n        $body.on('touchstart', onBodyTouchStart);\n        openNavEventHandler = onBodyTouchStart;\n      }\n    }\n\n    if (this.options.swipe) {\n      enableSwipeHandling();\n    }\n  }\n\n  /**\n   * 触发组件事件\n   * @param name\n   */\n  private triggerEvent(name: EVENT): void {\n    componentEvent(name, 'drawer', this.$element, this);\n  }\n\n  /**\n   * 动画结束回调\n   */\n  private transitionEnd(): void {\n    if (this.$element.hasClass('mdui-drawer-open')) {\n      this.state = 'opened';\n      this.triggerEvent('opened');\n    } else {\n      this.state = 'closed';\n      this.triggerEvent('closed');\n    }\n  }\n\n  /**\n   * 是否处于打开状态\n   */\n  private isOpen(): boolean {\n    return this.state === 'opening' || this.state === 'opened';\n  }\n\n  /**\n   * 打开抽屉栏\n   */\n  public open(): void {\n    if (this.isOpen()) {\n      return;\n    }\n\n    this.state = 'opening';\n    this.triggerEvent('open');\n\n    if (!this.options.overlay) {\n      $('body').addClass(`mdui-drawer-body-${this.position}`);\n    }\n\n    this.$element\n      .removeClass('mdui-drawer-close')\n      .addClass('mdui-drawer-open')\n      .transitionEnd(() => this.transitionEnd());\n\n    if (!this.isDesktop() || this.options.overlay) {\n      this.overlay = true;\n      $.showOverlay().one('click', () => this.close());\n      $.lockScreen();\n    }\n  }\n\n  /**\n   * 关闭抽屉栏\n   */\n  public close(): void {\n    if (!this.isOpen()) {\n      return;\n    }\n\n    this.state = 'closing';\n    this.triggerEvent('close');\n\n    if (!this.options.overlay) {\n      $('body').removeClass(`mdui-drawer-body-${this.position}`);\n    }\n\n    this.$element\n      .addClass('mdui-drawer-close')\n      .removeClass('mdui-drawer-open')\n      .transitionEnd(() => this.transitionEnd());\n\n    if (this.overlay) {\n      $.hideOverlay();\n      this.overlay = false;\n      $.unlockScreen();\n    }\n  }\n\n  /**\n   * 切换抽屉栏打开/关闭状态\n   */\n  public toggle(): void {\n    this.isOpen() ? this.close() : this.open();\n  }\n\n  /**\n   * 返回当前抽屉栏的状态。共包含四种状态：`opening`、`opened`、`closing`、`closed`\n   */\n  public getState(): STATE {\n    return this.state;\n  }\n}\n\nmdui.Drawer = Drawer;\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/on';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-drawer';\n\ntype OPTIONS = {\n  target: string;\n  overlay?: boolean;\n  swipe?: boolean;\n};\n\n$(() => {\n  mdui.mutation(`[${customAttr}]`, function () {\n    const $element = $(this);\n    const options = parseOptions(this, customAttr) as OPTIONS;\n    const selector = options.target;\n    // @ts-ignore\n    delete options.target;\n\n    const $drawer = $(selector).first();\n    const instance = new mdui.Drawer($drawer, options);\n\n    $element.on('click', () => instance.toggle());\n  });\n});\n","import { isUndefined } from 'mdui.jq/es/utils';\nimport PlainObject from 'mdui.jq/es/interfaces/PlainObject';\n\ntype Func = () => any;\n\nconst container: PlainObject<Func[]> = {};\n\n/**\n * 根据队列名，获取队列中所有函数\n * @param name 队列名\n */\nfunction queue(name: string): Func[];\n\n/**\n * 写入队列\n * @param name 队列名\n * @param func 函数\n */\nfunction queue(name: string, func: Func): void;\n\nfunction queue(name: string, func?: Func): void | Func[] {\n  if (isUndefined(container[name])) {\n    container[name] = [];\n  }\n\n  if (isUndefined(func)) {\n    return container[name];\n  }\n\n  container[name].push(func);\n}\n\n/**\n * 从队列中移除第一个函数，并执行该函数\n * @param name 队列满\n */\nfunction dequeue(name: string): void {\n  if (isUndefined(container[name])) {\n    return;\n  }\n\n  if (!container[name].length) {\n    return;\n  }\n\n  const func = container[name].shift()!;\n\n  func();\n}\n\nexport { queue, dequeue };\n","import $ from 'mdui.jq/es/$';\nimport contains from 'mdui.jq/es/functions/contains';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/append';\nimport 'mdui.jq/es/methods/children';\nimport 'mdui.jq/es/methods/css';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/height';\nimport 'mdui.jq/es/methods/hide';\nimport 'mdui.jq/es/methods/innerHeight';\nimport 'mdui.jq/es/methods/off';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/remove';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/show';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport '../../jq_extends/methods/transitionEnd';\nimport '../../jq_extends/static/hideOverlay';\nimport '../../jq_extends/static/lockScreen';\nimport '../../jq_extends/static/showOverlay';\nimport '../../jq_extends/static/throttle';\nimport '../../jq_extends/static/unlockScreen';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $window } from '../../utils/dom';\nimport { dequeue, queue } from '../../utils/queue';\n\ntype OPTIONS = {\n  /**\n   * 打开对话框时是否添加 url hash，若为 `true`，则打开对话框后可用过浏览器的后退按钮或 Android 的返回键关闭对话框。\n   */\n  history?: boolean;\n\n  /**\n   * 打开对话框时是否显示遮罩。\n   */\n  overlay?: boolean;\n\n  /**\n   * 是否模态化对话框。为 `false` 时点击对话框外面的区域时关闭对话框，否则不关闭。\n   */\n  modal?: boolean;\n\n  /**\n   * 按下 Esc 键时是否关闭对话框。\n   */\n  closeOnEsc?: boolean;\n\n  /**\n   * 按下取消按钮时是否关闭对话框。\n   */\n  closeOnCancel?: boolean;\n\n  /**\n   * 按下确认按钮时是否关闭对话框。\n   */\n  closeOnConfirm?: boolean;\n\n  /**\n   * 关闭对话框后是否自动销毁对话框。\n   */\n  destroyOnClosed?: boolean;\n};\n\ntype STATE = 'opening' | 'opened' | 'closing' | 'closed';\ntype EVENT = 'open' | 'opened' | 'close' | 'closed' | 'cancel' | 'confirm';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  history: true,\n  overlay: true,\n  modal: false,\n  closeOnEsc: true,\n  closeOnCancel: true,\n  closeOnConfirm: true,\n  destroyOnClosed: false,\n};\n\n/**\n * 当前显示的对话框实例\n */\nlet currentInst: null | Dialog = null;\n\n/**\n * 队列名\n */\nconst queueName = '_mdui_dialog';\n\n/**\n * 窗口是否已锁定\n */\nlet isLockScreen = false;\n\n/**\n * 遮罩层元素\n */\nlet $overlay: null | JQ;\n\nclass Dialog {\n  /**\n   * dialog 元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * 当前 dialog 的状态\n   */\n  public state: STATE = 'closed';\n\n  /**\n   * dialog 元素是否是动态添加的\n   */\n  private append = false;\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    this.$element = $(selector).first();\n\n    // 如果对话框元素没有在当前文档中，则需要添加\n    if (!contains(document.body, this.$element[0])) {\n      this.append = true;\n      $('body').append(this.$element);\n    }\n\n    extend(this.options, options);\n\n    // 绑定取消按钮事件\n    this.$element.find('[mdui-dialog-cancel]').each((_, cancel) => {\n      $(cancel).on('click', () => {\n        this.triggerEvent('cancel');\n\n        if (this.options.closeOnCancel) {\n          this.close();\n        }\n      });\n    });\n\n    // 绑定确认按钮事件\n    this.$element.find('[mdui-dialog-confirm]').each((_, confirm) => {\n      $(confirm).on('click', () => {\n        this.triggerEvent('confirm');\n\n        if (this.options.closeOnConfirm) {\n          this.close();\n        }\n      });\n    });\n\n    // 绑定关闭按钮事件\n    this.$element.find('[mdui-dialog-close]').each((_, close) => {\n      $(close).on('click', () => this.close());\n    });\n  }\n\n  /**\n   * 触发组件事件\n   * @param name\n   */\n  private triggerEvent(name: EVENT): void {\n    componentEvent(name, 'dialog', this.$element, this);\n  }\n\n  /**\n   * 窗口宽度变化，或对话框内容变化时，调整对话框位置和对话框内的滚动条\n   */\n  private readjust(): void {\n    if (!currentInst) {\n      return;\n    }\n\n    const $element = currentInst.$element;\n    const $title = $element.children('.mdui-dialog-title');\n    const $content = $element.children('.mdui-dialog-content');\n    const $actions = $element.children('.mdui-dialog-actions');\n\n    // 调整 dialog 的 top 和 height 值\n    $element.height('');\n    $content.height('');\n\n    const elementHeight = $element.height();\n    $element.css({\n      top: `${($window.height() - elementHeight) / 2}px`,\n      height: `${elementHeight}px`,\n    });\n\n    // 调整 mdui-dialog-content 的高度\n    $content.innerHeight(\n      elementHeight -\n        ($title.innerHeight() || 0) -\n        ($actions.innerHeight() || 0),\n    );\n  }\n\n  /**\n   * hashchange 事件触发时关闭对话框\n   */\n  private hashchangeEvent(): void {\n    if (window.location.hash.substring(1).indexOf('mdui-dialog') < 0) {\n      currentInst!.close(true);\n    }\n  }\n\n  /**\n   * 点击遮罩层关闭对话框\n   * @param event\n   */\n  private overlayClick(event: Event): void {\n    if (\n      $(event.target as HTMLElement).hasClass('mdui-overlay') &&\n      currentInst\n    ) {\n      currentInst.close();\n    }\n  }\n\n  /**\n   * 动画结束回调\n   */\n  private transitionEnd(): void {\n    if (this.$element.hasClass('mdui-dialog-open')) {\n      this.state = 'opened';\n      this.triggerEvent('opened');\n    } else {\n      this.state = 'closed';\n      this.triggerEvent('closed');\n      this.$element.hide();\n\n      // 所有对话框都关闭，且当前没有打开的对话框时，解锁屏幕\n      if (!queue(queueName).length && !currentInst && isLockScreen) {\n        $.unlockScreen();\n        isLockScreen = false;\n      }\n\n      $window.off('resize', $.throttle(this.readjust, 100));\n\n      if (this.options.destroyOnClosed) {\n        this.destroy();\n      }\n    }\n  }\n\n  /**\n   * 打开指定对话框\n   */\n  private doOpen(): void {\n    currentInst = this;\n\n    if (!isLockScreen) {\n      $.lockScreen();\n      isLockScreen = true;\n    }\n\n    this.$element.show();\n    this.readjust();\n\n    $window.on('resize', $.throttle(this.readjust, 100));\n\n    // 打开消息框\n    this.state = 'opening';\n    this.triggerEvent('open');\n    this.$element\n      .addClass('mdui-dialog-open')\n      .transitionEnd(() => this.transitionEnd());\n\n    // 不存在遮罩层元素时，添加遮罩层\n    if (!$overlay) {\n      $overlay = $.showOverlay(5100);\n    }\n\n    // 点击遮罩层时是否关闭对话框\n    if (this.options.modal) {\n      $overlay.off('click', this.overlayClick);\n    } else {\n      $overlay.on('click', this.overlayClick);\n    }\n\n    // 是否显示遮罩层，不显示时，把遮罩层背景透明\n    $overlay.css('opacity', this.options.overlay ? '' : 0);\n\n    if (this.options.history) {\n      // 如果 hash 中原来就有 mdui-dialog，先删除，避免后退历史纪录后仍然有 mdui-dialog 导致无法关闭\n      // 包括 mdui-dialog 和 &mdui-dialog 和 ?mdui-dialog\n      let hash = window.location.hash.substring(1);\n      if (hash.indexOf('mdui-dialog') > -1) {\n        hash = hash.replace(/[&?]?mdui-dialog/g, '');\n      }\n\n      // 后退按钮关闭对话框\n      if (hash) {\n        window.location.hash = `${hash}${\n          hash.indexOf('?') > -1 ? '&' : '?'\n        }mdui-dialog`;\n      } else {\n        window.location.hash = 'mdui-dialog';\n      }\n\n      $window.on('hashchange', this.hashchangeEvent);\n    }\n  }\n\n  /**\n   * 当前对话框是否为打开状态\n   */\n  private isOpen(): boolean {\n    return this.state === 'opening' || this.state === 'opened';\n  }\n\n  /**\n   * 打开对话框\n   */\n  public open(): void {\n    if (this.isOpen()) {\n      return;\n    }\n\n    // 如果当前有正在打开或已经打开的对话框,或队列不为空，则先加入队列，等旧对话框开始关闭时再打开\n    if (\n      (currentInst &&\n        (currentInst.state === 'opening' || currentInst.state === 'opened')) ||\n      queue(queueName).length\n    ) {\n      queue(queueName, () => this.doOpen());\n\n      return;\n    }\n\n    this.doOpen();\n  }\n\n  /**\n   * 关闭对话框\n   */\n  public close(historyBack = false): void {\n    // historyBack 是否需要后退历史纪录，默认为 `false`。该参数仅内部使用\n    // 为 `false` 时是通过 js 关闭，需要后退一个历史记录\n    // 为 `true` 时是通过后退按钮关闭，不需要后退历史记录\n\n    // setTimeout 的作用是：\n    // 当同时关闭一个对话框，并打开另一个对话框时，使打开对话框的操作先执行，以使需要打开的对话框先加入队列\n    setTimeout(() => {\n      if (!this.isOpen()) {\n        return;\n      }\n\n      currentInst = null;\n\n      this.state = 'closing';\n      this.triggerEvent('close');\n\n      // 所有对话框都关闭，且当前没有打开的对话框时，隐藏遮罩\n      if (!queue(queueName).length && $overlay) {\n        $.hideOverlay();\n        $overlay = null;\n\n        // 若仍存在遮罩，恢复遮罩的 z-index\n        $('.mdui-overlay').css('z-index', 2000);\n      }\n\n      this.$element\n        .removeClass('mdui-dialog-open')\n        .transitionEnd(() => this.transitionEnd());\n\n      if (this.options.history && !queue(queueName).length) {\n        if (!historyBack) {\n          window.history.back();\n        }\n\n        $window.off('hashchange', this.hashchangeEvent);\n      }\n\n      // 关闭旧对话框，打开新对话框。\n      // 加一点延迟，仅仅为了视觉效果更好。不加延时也不影响功能\n      setTimeout(() => {\n        dequeue(queueName);\n      }, 100);\n    });\n  }\n\n  /**\n   * 切换对话框打开/关闭状态\n   */\n  public toggle(): void {\n    this.isOpen() ? this.close() : this.open();\n  }\n\n  /**\n   * 获取对话框状态。共包含四种状态：`opening`、`opened`、`closing`、`closed`\n   */\n  public getState(): STATE {\n    return this.state;\n  }\n\n  /**\n   * 销毁对话框\n   */\n  public destroy(): void {\n    if (this.append) {\n      this.$element.remove();\n    }\n\n    if (!queue(queueName).length && !currentInst) {\n      if ($overlay) {\n        $.hideOverlay();\n        $overlay = null;\n      }\n\n      if (isLockScreen) {\n        $.unlockScreen();\n        isLockScreen = false;\n      }\n    }\n  }\n\n  /**\n   * 对话框内容变化时，需要调用该方法来调整对话框位置和滚动条高度\n   */\n  public handleUpdate(): void {\n    this.readjust();\n  }\n}\n\nexport { currentInst, OPTIONS, Dialog };\n","import Selector from 'mdui.jq/es/types/Selector';\nimport mdui from '../../mdui';\nimport 'mdui.jq/es/methods/on';\nimport { $document } from '../../utils/dom';\nimport { currentInst, OPTIONS, Dialog } from './class';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * Dialog 组件\n     *\n     * 请通过 `new mdui.Dialog()` 调用\n     */\n    Dialog: {\n      /**\n       * 实例化 Dialog 组件\n       * @param selector CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Dialog;\n    };\n  }\n}\n\n// esc 按下时关闭对话框\n$document.on('keydown', (event: Event) => {\n  if (\n    currentInst &&\n    currentInst.options.closeOnEsc &&\n    currentInst.state === 'opened' &&\n    (event as KeyboardEvent).keyCode === 27\n  ) {\n    currentInst.close();\n  }\n});\n\nmdui.Dialog = Dialog;\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/on';\nimport mdui from '../../mdui';\nimport { $document } from '../../utils/dom';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-dialog';\nconst dataName = '_mdui_dialog';\n\ntype OPTIONS = {\n  target: string;\n  history?: boolean;\n  overlay?: boolean;\n  modal?: boolean;\n  closeOnEsc?: boolean;\n  closeOnCancel?: boolean;\n  closeOnConfirm?: boolean;\n  destroyOnClosed?: boolean;\n};\n\n$(() => {\n  $document.on('click', `[${customAttr}]`, function () {\n    const options = parseOptions(this as HTMLElement, customAttr) as OPTIONS;\n    const selector = options.target;\n    // @ts-ignore\n    delete options.target;\n\n    const $dialog = $(selector).first();\n    let instance = $dialog.data(dataName);\n\n    if (!instance) {\n      instance = new mdui.Dialog($dialog, options);\n      $dialog.data(dataName, instance);\n    }\n\n    instance.open();\n  });\n});\n","import $ from 'mdui.jq/es/$';\nimport each from 'mdui.jq/es/functions/each';\nimport extend from 'mdui.jq/es/functions/extend';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/on';\nimport mdui from '../../mdui';\nimport { Dialog } from './class';\nimport './index';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 打开一个对话框，标题、内容、按钮等都可以自定义\n     * @param options 配置参数\n     */\n    dialog(options: OPTIONS): Dialog;\n  }\n}\n\ntype BUTTON = {\n  /**\n   * 按钮文本\n   */\n  text?: string;\n\n  /**\n   * 按钮文本是否加粗，默认为 `false`\n   */\n  bold?: boolean;\n\n  /**\n   * 点击按钮后是否关闭对话框，默认为 `true`\n   */\n  close?: boolean;\n\n  /**\n   * 点击按钮的回调函数，参数为对话框的实例\n   */\n  onClick?: (dialog: Dialog) => void;\n};\n\ntype OPTIONS = {\n  /**\n   * 对话框的标题\n   */\n  title?: string;\n\n  /**\n   * 对话框的内容\n   */\n  content?: string;\n\n  /**\n   * 按钮数组，每个按钮都是一个带按钮参数的对象\n   */\n  buttons?: BUTTON[];\n\n  /**\n   * 按钮是否垂直排列，默认为 `false`\n   */\n  stackedButtons?: boolean;\n\n  /**\n   * 添加到 `.mdui-dialog` 上的 CSS 类\n   */\n  cssClass?: string;\n\n  /**\n   * 是否监听 `hashchange` 事件，为 `true` 时可以通过 Android 的返回键或浏览器后退按钮关闭对话框，默认为 `true`\n   */\n  history?: boolean;\n\n  /**\n   * 打开对话框后是否显示遮罩层，默认为 `true`\n   */\n  overlay?: boolean;\n\n  /**\n   * 是否模态化对话框。为 `false` 时点击对话框外面的区域时关闭对话框，否则不关闭\n   */\n  modal?: boolean;\n\n  /**\n   * 按下 Esc 键时是否关闭对话框，默认为 `true`\n   */\n  closeOnEsc?: boolean;\n\n  /**\n   * 关闭对话框后是否自动销毁对话框，默认为 `true`\n   */\n  destroyOnClosed?: boolean;\n\n  /**\n   * 打开动画开始时的回调，参数为对话框实例\n   */\n  onOpen?: (dialog: Dialog) => void;\n\n  /**\n   * 打开动画结束时的回调，参数为对话框实例\n   */\n  onOpened?: (dialog: Dialog) => void;\n\n  /**\n   * 关闭动画开始时的回调，参数为对话框实例\n   */\n  onClose?: (dialog: Dialog) => void;\n\n  /**\n   * 关闭动画结束时的回调，参数为对话框实例\n   */\n  onClosed?: (dialog: Dialog) => void;\n};\n\nconst DEFAULT_BUTTON: BUTTON = {\n  text: '',\n  bold: false,\n  close: true,\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onClick: () => {},\n};\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  title: '',\n  content: '',\n  buttons: [],\n  stackedButtons: false,\n  cssClass: '',\n  history: true,\n  overlay: true,\n  modal: false,\n  closeOnEsc: true,\n  destroyOnClosed: true,\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onOpen: () => {},\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onOpened: () => {},\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onClose: () => {},\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onClosed: () => {},\n};\n\nmdui.dialog = function (options: OPTIONS): Dialog {\n  // 合并配置参数\n  options = extend({}, DEFAULT_OPTIONS, options);\n\n  each(options.buttons!, (i, button) => {\n    options.buttons![i] = extend({}, DEFAULT_BUTTON, button);\n  });\n\n  // 按钮的 HTML\n  let buttonsHTML = '';\n  if (options.buttons?.length) {\n    buttonsHTML = `<div class=\"mdui-dialog-actions${\n      options.stackedButtons ? ' mdui-dialog-actions-stacked' : ''\n    }\">`;\n\n    each(options.buttons, (_, button) => {\n      buttonsHTML +=\n        '<a href=\"javascript:void(0)\" ' +\n        `class=\"mdui-btn mdui-ripple mdui-text-color-primary ${\n          button.bold ? 'mdui-btn-bold' : ''\n        }\">${button.text}</a>`;\n    });\n\n    buttonsHTML += '</div>';\n  }\n\n  // Dialog 的 HTML\n  const HTML =\n    `<div class=\"mdui-dialog ${options.cssClass}\">` +\n    (options.title\n      ? `<div class=\"mdui-dialog-title\">${options.title}</div>`\n      : '') +\n    (options.content\n      ? `<div class=\"mdui-dialog-content\">${options.content}</div>`\n      : '') +\n    buttonsHTML +\n    '</div>';\n\n  // 实例化 Dialog\n  const instance = new mdui.Dialog(HTML, {\n    history: options.history,\n    overlay: options.overlay,\n    modal: options.modal,\n    closeOnEsc: options.closeOnEsc,\n    destroyOnClosed: options.destroyOnClosed,\n  });\n\n  // 绑定按钮事件\n  if (options.buttons?.length) {\n    instance.$element\n      .find('.mdui-dialog-actions .mdui-btn')\n      .each((index, button) => {\n        $(button).on('click', () => {\n          options.buttons![index].onClick!(instance);\n\n          if (options.buttons![index].close) {\n            instance.close();\n          }\n        });\n      });\n  }\n\n  // 绑定打开关闭事件\n  instance.$element\n    .on('open.mdui.dialog', () => {\n      options.onOpen!(instance);\n    })\n    .on('opened.mdui.dialog', () => {\n      options.onOpened!(instance);\n    })\n    .on('close.mdui.dialog', () => {\n      options.onClose!(instance);\n    })\n    .on('closed.mdui.dialog', () => {\n      options.onClosed!(instance);\n    });\n\n  instance.open();\n\n  return instance;\n};\n","import extend from 'mdui.jq/es/functions/extend';\nimport { isFunction, isUndefined } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport { Dialog } from './class';\nimport './dialog';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 打开一个警告框，可以包含标题、内容和一个确认按钮\n     * @param text 警告框内容\n     * @param title 警告框标题\n     * @param onConfirm 点击确认按钮的回调函数，参数为对话框实例\n     * @param options 配置参数\n     */\n    alert(\n      text: string,\n      title: string,\n      onConfirm?: (dialog: Dialog) => void,\n      options?: OPTIONS,\n    ): Dialog;\n\n    /**\n     * 打开一个警告框，可以包含内容，和一个确认按钮\n     * @param text 警告框内容\n     * @param onConfirm 点击确认按钮的回调函数，参数为对话框实例\n     * @param options 配置参数\n     */\n    alert(\n      text: string,\n      onConfirm?: (dialog: Dialog) => void,\n      options?: OPTIONS,\n    ): Dialog;\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * 确认按钮的文本\n   */\n  confirmText?: string;\n\n  /**\n   * 是否监听 hashchange 事件，为 `true` 时可以通过 Android 的返回键或浏览器后退按钮关闭对话框，默认为 `true`\n   */\n  history?: boolean;\n\n  /**\n   * 是否模态化对话框。为 `false` 时点击对话框外面的区域时关闭对话框，否则不关闭，默认为 `false`\n   */\n  modal?: boolean;\n\n  /**\n   * 按下 Esc 键时是否关闭对话框，默认为 `true`\n   */\n  closeOnEsc?: boolean;\n\n  /**\n   * 是否在按下确认按钮时是否关闭对话框\n   */\n  closeOnConfirm?: boolean;\n};\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  confirmText: 'ok',\n  history: true,\n  modal: false,\n  closeOnEsc: true,\n  closeOnConfirm: true,\n};\n\nmdui.alert = function (\n  text: string,\n  title?: any,\n  onConfirm?: any,\n  options?: any,\n): Dialog {\n  if (isFunction(title)) {\n    options = onConfirm;\n    onConfirm = title;\n    title = '';\n  }\n\n  if (isUndefined(onConfirm)) {\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    onConfirm = (): void => {};\n  }\n\n  if (isUndefined(options)) {\n    options = {};\n  }\n\n  options = extend({}, DEFAULT_OPTIONS, options);\n\n  return mdui.dialog({\n    title: title,\n    content: text,\n    buttons: [\n      {\n        text: options.confirmText,\n        bold: false,\n        close: options.closeOnConfirm,\n        onClick: onConfirm,\n      },\n    ],\n    cssClass: 'mdui-dialog-alert',\n    history: options.history,\n    modal: options.modal,\n    closeOnEsc: options.closeOnEsc,\n  });\n};\n","import extend from 'mdui.jq/es/functions/extend';\nimport { isFunction, isUndefined } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport { Dialog } from './class';\nimport './dialog';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 打开一个确认框，可以包含标题、内容、一个确认按钮和一个取消按钮\n     * @param text 确认框内容\n     * @param title 确认框标题\n     * @param onConfirm 点击确认按钮的回调函数，参数为对话框实例\n     * @param onCancel 点击取消按钮的回调函数，参数为对话框实例\n     * @param options 配置参数\n     */\n    confirm(\n      text: string,\n      title: string,\n      onConfirm?: (dialog: Dialog) => void,\n      onCancel?: (dialog: Dialog) => void,\n      options?: OPTIONS,\n    ): Dialog;\n\n    /**\n     * 打开一个确认框，可以包含内容、一个确认按钮和一个取消按钮\n     * @param text 确认框内容\n     * @param onConfirm 点击确认按钮的回调函数，参数为对话框实例\n     * @param onCancel 点击取消按钮的回调函数，参数为对话框实例\n     * @param options 配置参数\n     */\n    confirm(\n      text: string,\n      onConfirm?: (dialog: Dialog) => void,\n      onCancel?: (dialog: Dialog) => void,\n      options?: OPTIONS,\n    ): Dialog;\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * 确认按钮的文本\n   */\n  confirmText?: string;\n\n  /**\n   * 取消按钮的文本\n   */\n  cancelText?: string;\n\n  /**\n   * 是否监听 hashchange 事件，为 `true` 时可以通过 Android 的返回键或浏览器后退按钮关闭对话框，默认为 `true`\n   */\n  history?: boolean;\n\n  /**\n   * 是否模态化对话框。为 `false` 时点击对话框外面的区域时关闭对话框，否则不关闭，默认为 `false`\n   */\n  modal?: boolean;\n\n  /**\n   * 按下 Esc 键时是否关闭对话框，默认为 `true`\n   */\n  closeOnEsc?: boolean;\n\n  /**\n   * 是否在按下取消按钮时是否关闭对话框\n   */\n  closeOnCancel?: boolean;\n\n  /**\n   * 是否在按下确认按钮时是否关闭对话框\n   */\n  closeOnConfirm?: boolean;\n};\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  confirmText: 'ok',\n  cancelText: 'cancel',\n  history: true,\n  modal: false,\n  closeOnEsc: true,\n  closeOnCancel: true,\n  closeOnConfirm: true,\n};\n\nmdui.confirm = function (\n  text: string,\n  title?: any,\n  onConfirm?: any,\n  onCancel?: any,\n  options?: any,\n): Dialog {\n  if (isFunction(title)) {\n    options = onCancel;\n    onCancel = onConfirm;\n    onConfirm = title;\n    title = '';\n  }\n\n  if (isUndefined(onConfirm)) {\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    onConfirm = (): void => {};\n  }\n\n  if (isUndefined(onCancel)) {\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    onCancel = (): void => {};\n  }\n\n  if (isUndefined(options)) {\n    options = {};\n  }\n\n  options = extend({}, DEFAULT_OPTIONS, options);\n\n  return mdui.dialog({\n    title: title,\n    content: text,\n    buttons: [\n      {\n        text: options.cancelText,\n        bold: false,\n        close: options.closeOnCancel,\n        onClick: onCancel,\n      },\n      {\n        text: options.confirmText,\n        bold: false,\n        close: options.closeOnConfirm,\n        onClick: onConfirm,\n      },\n    ],\n    cssClass: 'mdui-dialog-confirm',\n    history: options.history,\n    modal: options.modal,\n    closeOnEsc: options.closeOnEsc,\n  });\n};\n","import extend from 'mdui.jq/es/functions/extend';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/val';\nimport { isFunction, isUndefined } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport '../textfield';\nimport { Dialog } from './class';\nimport './dialog';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 打开一个提示用户输入的对话框，可以包含标题、文本框标签、文本框、一个确认按钮和一个取消按钮\n     * @param label 文本框浮动标签的文本\n     * @param title 标题\n     * @param onConfirm 点击确认按钮的回调。含两个参数，分别为文本框的值和对话框实例\n     * @param onCancel 点击取消按钮的回调。含两个参数，分别为文本框的值和对话框实例\n     * @param options 配置参数\n     */\n    prompt(\n      label: string,\n      title: string,\n      onConfirm?: (value: string, dialog: Dialog) => void,\n      onCancel?: (value: string, dialog: Dialog) => void,\n      options?: OPTIONS,\n    ): Dialog;\n\n    /**\n     * 打开一个提示用户输入的对话框，可以包含文本框标签、文本框、一个确认按钮和一个取消按钮\n     * @param label 文本框浮动标签的文本\n     * @param onConfirm 点击确认按钮的回调。含两个参数，分别为文本框的值和对话框实例\n     * @param onCancel 点击取消按钮的回调，含两个参数，分别为文本框的值和对话框实例\n     * @param options 配置参数\n     */\n    prompt(\n      label: string,\n      onConfirm?: (value: string, dialog: Dialog) => void,\n      onCancel?: (value: string, dialog: Dialog) => void,\n      options?: OPTIONS,\n    ): Dialog;\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * 确认按钮的文本\n   */\n  confirmText?: string;\n\n  /**\n   * 取消按钮的文本\n   */\n  cancelText?: string;\n\n  /**\n   * 是否监听 hashchange 事件，为 `true` 时可以通过 Android 的返回键或浏览器后退按钮关闭对话框，默认为 `true`\n   */\n  history?: boolean;\n\n  /**\n   * 是否模态化对话框。为 `false` 时点击对话框外面的区域时关闭对话框，否则不关闭，默认为 `false`\n   */\n  modal?: boolean;\n\n  /**\n   * 是否在按下 Esc 键时是否关闭对话框，默认为 `true`\n   */\n  closeOnEsc?: boolean;\n\n  /**\n   * 是否在按下取消按钮时是否关闭对话框\n   */\n  closeOnCancel?: boolean;\n\n  /**\n   * 是否在按下确认按钮时是否关闭对话框\n   */\n  closeOnConfirm?: boolean;\n\n  /**\n   * 是否在按下 Enter 键时触发 `onConfirm` 回调函数，默认为 `false`\n   */\n  confirmOnEnter?: boolean;\n\n  /**\n   * 文本框的类型。`text`: 单行文本框； `textarea`: 多行文本框\n   */\n  type?: 'text' | 'textarea';\n\n  /**\n   * 最大输入字符数量，为 0 时表示不限制\n   */\n  maxlength?: number;\n\n  /**\n   * 文本框的默认值\n   */\n  defaultValue?: string;\n};\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  confirmText: 'ok',\n  cancelText: 'cancel',\n  history: true,\n  modal: false,\n  closeOnEsc: true,\n  closeOnCancel: true,\n  closeOnConfirm: true,\n  type: 'text',\n  maxlength: 0,\n  defaultValue: '',\n  confirmOnEnter: false,\n};\n\nmdui.prompt = function (\n  label: string,\n  title?: any,\n  onConfirm?: any,\n  onCancel?: any,\n  options?: any,\n): Dialog {\n  if (isFunction(title)) {\n    options = onCancel;\n    onCancel = onConfirm;\n    onConfirm = title;\n    title = '';\n  }\n\n  if (isUndefined(onConfirm)) {\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    onConfirm = (): void => {};\n  }\n\n  if (isUndefined(onCancel)) {\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    onCancel = (): void => {};\n  }\n\n  if (isUndefined(options)) {\n    options = {};\n  }\n\n  options = extend({}, DEFAULT_OPTIONS, options);\n\n  const content =\n    '<div class=\"mdui-textfield\">' +\n    (label ? `<label class=\"mdui-textfield-label\">${label}</label>` : '') +\n    (options.type === 'text'\n      ? `<input class=\"mdui-textfield-input\" type=\"text\" value=\"${\n          options.defaultValue\n        }\" ${\n          options.maxlength ? 'maxlength=\"' + options.maxlength + '\"' : ''\n        }/>`\n      : '') +\n    (options.type === 'textarea'\n      ? `<textarea class=\"mdui-textfield-input\" ${\n          options.maxlength ? 'maxlength=\"' + options.maxlength + '\"' : ''\n        }>${options.defaultValue}</textarea>`\n      : '') +\n    '</div>';\n\n  const onCancelClick = (dialog: Dialog): void => {\n    const value = dialog.$element.find('.mdui-textfield-input').val();\n    onCancel(value, dialog);\n  };\n\n  const onConfirmClick = (dialog: Dialog): void => {\n    const value = dialog.$element.find('.mdui-textfield-input').val();\n    onConfirm(value, dialog);\n  };\n\n  return mdui.dialog({\n    title,\n    content,\n    buttons: [\n      {\n        text: options.cancelText,\n        bold: false,\n        close: options.closeOnCancel,\n        onClick: onCancelClick,\n      },\n      {\n        text: options.confirmText,\n        bold: false,\n        close: options.closeOnConfirm,\n        onClick: onConfirmClick,\n      },\n    ],\n    cssClass: 'mdui-dialog-prompt',\n    history: options.history,\n    modal: options.modal,\n    closeOnEsc: options.closeOnEsc,\n    onOpen: (dialog) => {\n      // 初始化输入框\n      const $input = dialog.$element.find('.mdui-textfield-input');\n      mdui.updateTextFields($input);\n\n      // 聚焦到输入框\n      $input[0].focus();\n\n      // 捕捉文本框回车键，在单行文本框的情况下触发回调\n      if (options.type !== 'textarea' && options.confirmOnEnter === true) {\n        $input.on('keydown', (event) => {\n          if ((event as KeyboardEvent).keyCode === 13) {\n            const value = dialog.$element.find('.mdui-textfield-input').val();\n            onConfirm(value, dialog);\n\n            if (options.closeOnConfirm) {\n              dialog.close();\n            }\n\n            return false;\n          }\n\n          return;\n        });\n      }\n\n      // 如果是多行输入框，监听输入框的 input 事件，更新对话框高度\n      if (options.type === 'textarea') {\n        $input.on('input', () => dialog.handleUpdate());\n      }\n\n      // 有字符数限制时，加载完文本框后 DOM 会变化，需要更新对话框高度\n      if (options.maxlength) {\n        dialog.handleUpdate();\n      }\n    },\n  });\n};\n","import $ from 'mdui.jq/es/$';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/appendTo';\nimport 'mdui.jq/es/methods/attr';\nimport 'mdui.jq/es/methods/css';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/height';\nimport 'mdui.jq/es/methods/html';\nimport 'mdui.jq/es/methods/offset';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/width';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport mdui from '../../mdui';\nimport '../../jq_extends/methods/transformOrigin';\nimport '../../jq_extends/methods/transitionEnd';\nimport '../../jq_extends/static/guid';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $window } from '../../utils/dom';\nimport { isAllow, register, unlockEvent } from '../../utils/touchHandler';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * Tooltip 组件\n     *\n     * 请通过 `new mdui.Tooltip()` 调用\n     */\n    Tooltip: {\n      /**\n       * 实例化 Tooltip 组件\n       * @param selector CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Tooltip;\n    };\n  }\n}\n\ntype POSITION = 'auto' | 'bottom' | 'top' | 'left' | 'right';\n\ntype OPTIONS = {\n  /**\n   * Tooltip 的位置。取值范围包括 `auto`、`bottom`、`top`、`left`、`right`。\n   * 为 `auto` 时，会自动判断位置。默认在下方。优先级为 `bottom` > `top` > `left` > `right`。\n   * 默认为 `auto`\n   */\n  position?: POSITION;\n\n  /**\n   * 延时触发，单位毫秒。默认为 `0`，即没有延时。\n   */\n  delay?: number;\n\n  /**\n   * Tooltip 的内容\n   */\n  content?: string;\n};\n\ntype STATE = 'opening' | 'opened' | 'closing' | 'closed';\ntype EVENT = 'open' | 'opened' | 'close' | 'closed';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  position: 'auto',\n  delay: 0,\n  content: '',\n};\n\nclass Tooltip {\n  /**\n   * 触发 tooltip 元素的 JQ 对象\n   */\n  public $target: JQ;\n\n  /**\n   * tooltip 元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * 当前 tooltip 的状态\n   */\n  private state: STATE = 'closed';\n\n  /**\n   * setTimeout 的返回值\n   */\n  private timeoutId: any = null;\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    this.$target = $(selector).first();\n\n    extend(this.options, options);\n\n    // 创建 Tooltip HTML\n    this.$element = $(\n      `<div class=\"mdui-tooltip\" id=\"${$.guid()}\">${\n        this.options.content\n      }</div>`,\n    ).appendTo(document.body);\n\n    // 绑定事件。元素处于 disabled 状态时无法触发鼠标事件，为了统一，把 touch 事件也禁用\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const that = this;\n    this.$target\n      .on('touchstart mouseenter', function (event) {\n        if (that.isDisabled(this as HTMLElement)) {\n          return;\n        }\n\n        if (!isAllow(event)) {\n          return;\n        }\n\n        register(event);\n\n        that.open();\n      })\n      .on('touchend mouseleave', function (event) {\n        if (that.isDisabled(this as HTMLElement)) {\n          return;\n        }\n\n        if (!isAllow(event)) {\n          return;\n        }\n\n        that.close();\n      })\n      .on(unlockEvent, function (event) {\n        if (that.isDisabled(this as HTMLElement)) {\n          return;\n        }\n\n        register(event);\n      });\n  }\n\n  /**\n   * 元素是否已禁用\n   * @param element\n   */\n  private isDisabled(element: HTMLElement): boolean {\n    return (\n      (element as HTMLInputElement).disabled ||\n      $(element).attr('disabled') !== undefined\n    );\n  }\n\n  /**\n   * 是否是桌面设备\n   */\n  private isDesktop(): boolean {\n    return $window.width() > 1024;\n  }\n\n  /**\n   * 设置 Tooltip 的位置\n   */\n  private setPosition(): void {\n    let marginLeft: number;\n    let marginTop: number;\n\n    // 触发的元素\n    const targetProps = this.$target[0].getBoundingClientRect();\n\n    // 触发的元素和 Tooltip 之间的距离\n    const targetMargin = this.isDesktop() ? 14 : 24;\n\n    // Tooltip 的宽度和高度\n    const tooltipWidth = this.$element[0].offsetWidth;\n    const tooltipHeight = this.$element[0].offsetHeight;\n\n    // Tooltip 的方向\n    let position: POSITION = this.options.position!;\n\n    // 自动判断位置，加 2px，使 Tooltip 距离窗口边框至少有 2px 的间距\n    if (position === 'auto') {\n      if (\n        targetProps.top +\n          targetProps.height +\n          targetMargin +\n          tooltipHeight +\n          2 <\n        $window.height()\n      ) {\n        position = 'bottom';\n      } else if (targetMargin + tooltipHeight + 2 < targetProps.top) {\n        position = 'top';\n      } else if (targetMargin + tooltipWidth + 2 < targetProps.left) {\n        position = 'left';\n      } else if (\n        targetProps.width + targetMargin + tooltipWidth + 2 <\n        $window.width() - targetProps.left\n      ) {\n        position = 'right';\n      } else {\n        position = 'bottom';\n      }\n    }\n\n    // 设置位置\n    switch (position) {\n      case 'bottom':\n        marginLeft = -1 * (tooltipWidth / 2);\n        marginTop = targetProps.height / 2 + targetMargin;\n        this.$element.transformOrigin('top center');\n        break;\n\n      case 'top':\n        marginLeft = -1 * (tooltipWidth / 2);\n        marginTop =\n          -1 * (tooltipHeight + targetProps.height / 2 + targetMargin);\n        this.$element.transformOrigin('bottom center');\n        break;\n\n      case 'left':\n        marginLeft = -1 * (tooltipWidth + targetProps.width / 2 + targetMargin);\n        marginTop = -1 * (tooltipHeight / 2);\n        this.$element.transformOrigin('center right');\n        break;\n\n      case 'right':\n        marginLeft = targetProps.width / 2 + targetMargin;\n        marginTop = -1 * (tooltipHeight / 2);\n        this.$element.transformOrigin('center left');\n        break;\n    }\n\n    const targetOffset = this.$target.offset();\n\n    this.$element.css({\n      top: `${targetOffset.top + targetProps.height / 2}px`,\n      left: `${targetOffset.left + targetProps.width / 2}px`,\n      'margin-left': `${marginLeft}px`,\n      'margin-top': `${marginTop}px`,\n    });\n  }\n\n  /**\n   * 触发组件事件\n   * @param name\n   */\n  private triggerEvent(name: EVENT): void {\n    componentEvent(name, 'tooltip', this.$target, this);\n  }\n\n  /**\n   * 动画结束回调\n   */\n  private transitionEnd(): void {\n    if (this.$element.hasClass('mdui-tooltip-open')) {\n      this.state = 'opened';\n      this.triggerEvent('opened');\n    } else {\n      this.state = 'closed';\n      this.triggerEvent('closed');\n    }\n  }\n\n  /**\n   * 当前 tooltip 是否为打开状态\n   */\n  private isOpen(): boolean {\n    return this.state === 'opening' || this.state === 'opened';\n  }\n\n  /**\n   * 执行打开 tooltip\n   */\n  private doOpen(): void {\n    this.state = 'opening';\n    this.triggerEvent('open');\n\n    this.$element\n      .addClass('mdui-tooltip-open')\n      .transitionEnd(() => this.transitionEnd());\n  }\n\n  /**\n   * 打开 Tooltip\n   * @param options 允许每次打开时设置不同的参数\n   */\n  public open(options?: OPTIONS): void {\n    if (this.isOpen()) {\n      return;\n    }\n\n    const oldOptions = extend({}, this.options);\n\n    if (options) {\n      extend(this.options, options);\n    }\n\n    // tooltip 的内容有更新\n    if (oldOptions.content !== this.options.content) {\n      this.$element.html(this.options.content);\n    }\n\n    this.setPosition();\n\n    if (this.options.delay) {\n      this.timeoutId = setTimeout(() => this.doOpen(), this.options.delay);\n    } else {\n      this.timeoutId = null;\n      this.doOpen();\n    }\n  }\n\n  /**\n   * 关闭 Tooltip\n   */\n  public close(): void {\n    if (this.timeoutId) {\n      clearTimeout(this.timeoutId);\n      this.timeoutId = null;\n    }\n\n    if (!this.isOpen()) {\n      return;\n    }\n\n    this.state = 'closing';\n    this.triggerEvent('close');\n\n    this.$element\n      .removeClass('mdui-tooltip-open')\n      .transitionEnd(() => this.transitionEnd());\n  }\n\n  /**\n   * 切换 Tooltip 的打开状态\n   */\n  public toggle(): void {\n    this.isOpen() ? this.close() : this.open();\n  }\n\n  /**\n   * 获取 Tooltip 状态。共包含四种状态：`opening`、`opened`、`closing`、`closed`\n   */\n  public getState(): STATE {\n    return this.state;\n  }\n}\n\nmdui.Tooltip = Tooltip;\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/on';\nimport mdui from '../../mdui';\nimport { $document } from '../../utils/dom';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-tooltip';\nconst dataName = '_mdui_tooltip';\n\n$(() => {\n  // mouseenter 不能冒泡，所以这里用 mouseover 代替\n  $document.on('touchstart mouseover', `[${customAttr}]`, function () {\n    const $target = $(this);\n    let instance = $target.data(dataName);\n\n    if (!instance) {\n      instance = new mdui.Tooltip(\n        this as HTMLElement,\n        parseOptions(this as HTMLElement, customAttr),\n      );\n      $target.data(dataName, instance);\n    }\n  });\n});\n","import $ from 'mdui.jq/es/$';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/appendTo';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/off';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/parents';\nimport 'mdui.jq/es/methods/remove';\nimport { isString } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport '../../jq_extends/methods/reflow';\nimport '../../jq_extends/methods/transform';\nimport '../../jq_extends/methods/transitionEnd';\nimport { $document } from '../../utils/dom';\nimport { dequeue, queue } from '../../utils/queue';\nimport { startEvent } from '../../utils/touchHandler';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 打开一个 Snackbar\n     * @param message Snackbar 的文本\n     * @param options 配置参数\n     */\n    snackbar(message: string, options?: OPTIONS): Snackbar;\n\n    /**\n     * 打开一个 Snackbar\n     * @param options 配置参数\n     */\n    snackbar(options: OPTIONS): Snackbar;\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * Snackbar 的文本。通过 `mdui.snackbar(options)` 调用时，该参数不能为空\n   */\n  message?: string;\n\n  /**\n   * 在用户没有操作时多长时间自动隐藏，单位（毫秒）。为 `0` 时表示不自动关闭，默认为 `4000`\n   */\n  timeout?: number;\n\n  /**\n   * Snackbar 的位置，默认为 `bottom`。\n   * 取值范围包括：\n   *   `bottom`: 下方\n   *   `top`: 上方\n   *   `left-top`: 左上角\n   *   `left-bottom`: 左下角\n   *   `right-top`: 右上角\n   *   `right-bottom`: 右下角\n   */\n  position?:\n    | 'bottom'\n    | 'top'\n    | 'left-top'\n    | 'left-bottom'\n    | 'right-top'\n    | 'right-bottom';\n\n  /**\n   * 按钮的文本\n   */\n  buttonText?: string;\n\n  /**\n   * 按钮的文本颜色，可以是颜色名或颜色值，如 `red`、`#ffffff`、`rgba(255, 255, 255, 0.3)` 等。默认为 `#90CAF9`\n   */\n  buttonColor?: string;\n\n  /**\n   * 点击按钮时是否关闭 Snackbar，默认为 `true`\n   */\n  closeOnButtonClick?: boolean;\n\n  /**\n   * 点击或触摸 Snackbar 以外的区域时是否关闭 Snackbar，默认为 `true`\n   */\n  closeOnOutsideClick?: boolean;\n\n  /**\n   * 在 Snackbar 上点击的回调函数，参数为 Snackbar 的实例\n   */\n  onClick?: (snackbar: Snackbar) => void;\n\n  /**\n   * 点击 Snackbar 上的按钮时的回调函数，参数为 Snackbar 的实例\n   */\n  onButtonClick?: (snackbar: Snackbar) => void;\n\n  /**\n   * Snackbar 开始打开时的回调函数，参数为 Snackbar 的实例\n   */\n  onOpen?: (snackbar: Snackbar) => void;\n\n  /**\n   * Snackbar 打开后的回调函数，参数为 Snackbar 的实例\n   */\n  onOpened?: (snackbar: Snackbar) => void;\n\n  /**\n   * Snackbar 开始关闭时的回调函数，参数为 Snackbar 的实例\n   */\n  onClose?: (snackbar: Snackbar) => void;\n\n  /**\n   * Snackbar 关闭后的回调函数，参数为 Snackbar 的实例\n   */\n  onClosed?: (snackbar: Snackbar) => void;\n};\n\ntype STATE = 'opening' | 'opened' | 'closing' | 'closed';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  message: '',\n  timeout: 4000,\n  position: 'bottom',\n  buttonText: '',\n  buttonColor: '',\n  closeOnButtonClick: true,\n  closeOnOutsideClick: true,\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onClick: () => {},\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onButtonClick: () => {},\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onOpen: () => {},\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onOpened: () => {},\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onClose: () => {},\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onClosed: () => {},\n};\n\n/**\n * 当前打开着的 Snackbar\n */\nlet currentInst: null | Snackbar = null;\n\n/**\n * 队列名\n */\nconst queueName = '_mdui_snackbar';\n\nclass Snackbar {\n  /**\n   * Snackbar 元素\n   */\n  public $element: JQ;\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * 当前 Snackbar 的状态\n   */\n  private state: STATE = 'closed';\n\n  /**\n   * setTimeout 的 ID\n   */\n  private timeoutId: any = null;\n\n  public constructor(options: OPTIONS) {\n    extend(this.options, options);\n\n    // 按钮颜色\n    let buttonColorStyle = '';\n    let buttonColorClass = '';\n\n    if (\n      this.options.buttonColor!.indexOf('#') === 0 ||\n      this.options.buttonColor!.indexOf('rgb') === 0\n    ) {\n      buttonColorStyle = `style=\"color:${this.options.buttonColor}\"`;\n    } else if (this.options.buttonColor !== '') {\n      buttonColorClass = `mdui-text-color-${this.options.buttonColor}`;\n    }\n\n    // 添加 HTML\n    this.$element = $(\n      '<div class=\"mdui-snackbar\">' +\n        `<div class=\"mdui-snackbar-text\">${this.options.message}</div>` +\n        (this.options.buttonText\n          ? `<a href=\"javascript:void(0)\" class=\"mdui-snackbar-action mdui-btn mdui-ripple mdui-ripple-white ${buttonColorClass}\" ${buttonColorStyle}>${this.options.buttonText}</a>`\n          : '') +\n        '</div>',\n    ).appendTo(document.body);\n\n    // 设置位置\n    this.setPosition('close');\n\n    this.$element.reflow().addClass(`mdui-snackbar-${this.options.position}`);\n  }\n\n  /**\n   * 点击 Snackbar 外面的区域关闭\n   * @param event\n   */\n  private closeOnOutsideClick(event: Event): void {\n    const $target = $(event.target as HTMLElement);\n\n    if (\n      !$target.hasClass('mdui-snackbar') &&\n      !$target.parents('.mdui-snackbar').length\n    ) {\n      currentInst!.close();\n    }\n  }\n\n  /**\n   * 设置 Snackbar 的位置\n   * @param state\n   */\n  private setPosition(state: 'open' | 'close'): void {\n    const snackbarHeight = this.$element[0].clientHeight;\n    const position = this.options.position;\n\n    let translateX;\n    let translateY;\n\n    // translateX\n    if (position === 'bottom' || position === 'top') {\n      translateX = '-50%';\n    } else {\n      translateX = '0';\n    }\n\n    // translateY\n    if (state === 'open') {\n      translateY = '0';\n    } else {\n      if (position === 'bottom') {\n        translateY = snackbarHeight;\n      }\n\n      if (position === 'top') {\n        translateY = -snackbarHeight;\n      }\n\n      if (position === 'left-top' || position === 'right-top') {\n        translateY = -snackbarHeight - 24;\n      }\n\n      if (position === 'left-bottom' || position === 'right-bottom') {\n        translateY = snackbarHeight + 24;\n      }\n    }\n\n    this.$element.transform(`translate(${translateX},${translateY}px`);\n  }\n\n  /**\n   * 打开 Snackbar\n   */\n  public open(): void {\n    if (this.state === 'opening' || this.state === 'opened') {\n      return;\n    }\n\n    // 如果当前有正在显示的 Snackbar，则先加入队列，等旧 Snackbar 关闭后再打开\n    if (currentInst) {\n      queue(queueName, () => this.open());\n      return;\n    }\n\n    currentInst = this;\n\n    // 开始打开\n    this.state = 'opening';\n    this.options.onOpen!(this);\n\n    this.setPosition('open');\n\n    this.$element.transitionEnd(() => {\n      if (this.state !== 'opening') {\n        return;\n      }\n\n      this.state = 'opened';\n      this.options.onOpened!(this);\n\n      // 有按钮时绑定事件\n      if (this.options.buttonText) {\n        this.$element.find('.mdui-snackbar-action').on('click', () => {\n          this.options.onButtonClick!(this);\n          if (this.options.closeOnButtonClick) {\n            this.close();\n          }\n        });\n      }\n\n      // 点击 snackbar 的事件\n      this.$element.on('click', (event) => {\n        if (!$(event.target as HTMLElement).hasClass('mdui-snackbar-action')) {\n          this.options.onClick!(this);\n        }\n      });\n\n      // 点击 Snackbar 外面的区域关闭\n      if (this.options.closeOnOutsideClick) {\n        $document.on(startEvent, this.closeOnOutsideClick);\n      }\n\n      // 超时后自动关闭\n      if (this.options.timeout) {\n        this.timeoutId = setTimeout(() => this.close(), this.options.timeout);\n      }\n    });\n  }\n\n  /**\n   * 关闭 Snackbar\n   */\n  public close(): void {\n    if (this.state === 'closing' || this.state === 'closed') {\n      return;\n    }\n\n    if (this.timeoutId) {\n      clearTimeout(this.timeoutId);\n    }\n\n    if (this.options.closeOnOutsideClick) {\n      $document.off(startEvent, this.closeOnOutsideClick);\n    }\n\n    this.state = 'closing';\n    this.options.onClose!(this);\n\n    this.setPosition('close');\n\n    this.$element.transitionEnd(() => {\n      if (this.state !== 'closing') {\n        return;\n      }\n\n      currentInst = null;\n      this.state = 'closed';\n      this.options.onClosed!(this);\n      this.$element.remove();\n      dequeue(queueName);\n    });\n  }\n}\n\nmdui.snackbar = function (message: any, options: any = {}): Snackbar {\n  if (isString(message)) {\n    options.message = message;\n  } else {\n    options = message;\n  }\n\n  const instance = new Snackbar(options);\n\n  instance.open();\n\n  return instance;\n};\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/children';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/is';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/parent';\nimport 'mdui.jq/es/methods/removeClass';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $document } from '../../utils/dom';\nimport '../headroom';\n\n$(() => {\n  // 切换导航项\n  $document.on('click', '.mdui-bottom-nav>a', function () {\n    const $item = $(this as HTMLElement);\n    const $bottomNav = $item.parent();\n\n    $bottomNav.children('a').each((index, item) => {\n      const isThis = $item.is(item);\n\n      if (isThis) {\n        componentEvent('change', 'bottomNav', $bottomNav[0], undefined, {\n          index,\n        });\n      }\n\n      isThis\n        ? $(item).addClass('mdui-bottom-nav-active')\n        : $(item).removeClass('mdui-bottom-nav-active');\n    });\n  });\n\n  // 滚动时隐藏 mdui-bottom-nav-scroll-hide\n  mdui.mutation('.mdui-bottom-nav-scroll-hide', function () {\n    new mdui.Headroom(this, {\n      pinnedClass: 'mdui-headroom-pinned-down',\n      unpinnedClass: 'mdui-headroom-unpinned-down',\n    });\n  });\n});\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/html';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport { isUndefined } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 如果需要修改已有的圆形进度条组件，需要调用该方法来重新初始化组件。\n     *\n     * 若传入了参数，则只重新初始化该参数对应的圆形进度条。若没有传入参数，则重新初始化所有圆形进度条。\n     * @param selector CSS 选择器、或 DOM 元素、或 DOM 元素组成的数组、或 JQ 对象\n     */\n    updateSpinners(\n      selector?: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    ): void;\n  }\n}\n\n/**\n * layer 的 HTML 结构\n * @param index\n */\nfunction layerHTML(index: number | false = false): string {\n  return (\n    `<div class=\"mdui-spinner-layer ${\n      index ? `mdui-spinner-layer-${index}` : ''\n    }\">` +\n    '<div class=\"mdui-spinner-circle-clipper mdui-spinner-left\">' +\n    '<div class=\"mdui-spinner-circle\"></div>' +\n    '</div>' +\n    '<div class=\"mdui-spinner-gap-patch\">' +\n    '<div class=\"mdui-spinner-circle\"></div>' +\n    '</div>' +\n    '<div class=\"mdui-spinner-circle-clipper mdui-spinner-right\">' +\n    '<div class=\"mdui-spinner-circle\"></div>' +\n    '</div>' +\n    '</div>'\n  );\n}\n\n/**\n * 填充 HTML\n * @param spinner\n */\nfunction fillHTML(spinner: HTMLElement): void {\n  const $spinner = $(spinner);\n\n  const layer = $spinner.hasClass('mdui-spinner-colorful')\n    ? layerHTML(1) + layerHTML(2) + layerHTML(3) + layerHTML(4)\n    : layerHTML();\n\n  $spinner.html(layer);\n}\n\n$(() => {\n  // 页面加载完后自动填充 HTML 结构\n  mdui.mutation('.mdui-spinner', function () {\n    fillHTML(this);\n  });\n});\n\nmdui.updateSpinners = function (\n  selector?: Selector | HTMLElement | ArrayLike<HTMLElement>,\n): void {\n  const $elements = isUndefined(selector) ? $('.mdui-spinner') : $(selector);\n\n  $elements.each(function () {\n    fillHTML(this);\n  });\n};\n","import $ from 'mdui.jq/es/$';\nimport contains from 'mdui.jq/es/functions/contains';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/attr';\nimport 'mdui.jq/es/methods/children';\nimport 'mdui.jq/es/methods/css';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/height';\nimport 'mdui.jq/es/methods/is';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/parent';\nimport 'mdui.jq/es/methods/parents';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/width';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport mdui from '../../mdui';\nimport '../../jq_extends/methods/transformOrigin';\nimport '../../jq_extends/methods/transitionEnd';\nimport '../../jq_extends/static/throttle';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $document, $window } from '../../utils/dom';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * Menu 组件\n     *\n     * 请通过 `new mdui.Menu()` 调用\n     */\n    Menu: {\n      /**\n       * 实例化 Menu 组件\n       * @param anchorSelector 触发菜单的元素的 CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param menuSelector 菜单的 CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param options 配置参数\n       */\n      new (\n        anchorSelector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        menuSelector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Menu;\n    };\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * 菜单相对于触发它的元素的位置，默认为 `auto`。\n   * 取值范围包括：\n   *   `top`: 菜单在触发它的元素的上方\n   *   `bottom`: 菜单在触发它的元素的下方\n   *   `center`: 菜单在窗口中垂直居中\n   *   `auto`: 自动判断位置。优先级为：`bottom` > `top` > `center`\n   */\n  position?: 'auto' | 'top' | 'bottom' | 'center';\n\n  /**\n   * 菜单与触发它的元素的对其方式，默认为 `auto`。\n   * 取值范围包括：\n   *   `left`: 菜单与触发它的元素左对齐\n   *   `right`: 菜单与触发它的元素右对齐\n   *   `center`: 菜单在窗口中水平居中\n   *   `auto`: 自动判断位置：优先级为：`left` > `right` > `center`\n   */\n  align?: 'auto' | 'left' | 'right' | 'center';\n\n  /**\n   * 菜单与窗口边框至少保持多少间距，单位为 px，默认为 `16`\n   */\n  gutter?: number;\n\n  /**\n   * 菜单的定位方式，默认为 `false`。\n   * 为 `true` 时，菜单使用 fixed 定位。在页面滚动时，菜单将保持在窗口固定位置，不随滚动条滚动。\n   * 为 `false` 时，菜单使用 absolute 定位。在页面滚动时，菜单将随着页面一起滚动。\n   */\n  fixed?: boolean;\n\n  /**\n   * 菜单是否覆盖在触发它的元素的上面，默认为 `auto`\n   * 为 `true` 时，使菜单覆盖在触发它的元素的上面\n   * 为 `false` 时，使菜单不覆盖触发它的元素\n   * 为 `auto` 时，简单菜单覆盖触发它的元素。级联菜单不覆盖触发它的元素\n   */\n  covered?: boolean | 'auto';\n\n  /**\n   * 子菜单的触发方式，默认为 `hover`\n   * 为 `click` 时，点击时触发子菜单\n   * 为 `hover` 时，鼠标悬浮时触发子菜单\n   */\n  subMenuTrigger?: 'click' | 'hover';\n\n  /**\n   * 子菜单的触发延迟时间（单位：毫秒），只有在 `subMenuTrigger: hover` 时，这个参数才有效，默认为 `200`\n   */\n  subMenuDelay?: number;\n};\n\ntype EVENT = 'open' | 'opened' | 'close' | 'closed';\ntype STATE = 'opening' | 'opened' | 'closing' | 'closed';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  position: 'auto',\n  align: 'auto',\n  gutter: 16,\n  fixed: false,\n  covered: 'auto',\n  subMenuTrigger: 'hover',\n  subMenuDelay: 200,\n};\n\nclass Menu {\n  /**\n   * 触发菜单的元素的 JQ 对象\n   */\n  public $anchor: JQ;\n\n  /**\n   * 菜单元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * 当前菜单状态\n   */\n  private state: STATE = 'closed';\n\n  /**\n   * 是否是级联菜单\n   */\n  private isCascade: boolean;\n\n  /**\n   * 菜单是否覆盖在触发它的元素的上面\n   */\n  private isCovered: boolean;\n\n  public constructor(\n    anchorSelector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    menuSelector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    this.$anchor = $(anchorSelector).first();\n    this.$element = $(menuSelector).first();\n\n    // 触发菜单的元素 和 菜单必须是同级的元素，否则菜单可能不能定位\n    if (!this.$anchor.parent().is(this.$element.parent())) {\n      throw new Error('anchorSelector and menuSelector must be siblings');\n    }\n\n    extend(this.options, options);\n\n    // 是否是级联菜单\n    this.isCascade = this.$element.hasClass('mdui-menu-cascade');\n\n    // covered 参数处理\n    this.isCovered =\n      this.options.covered === 'auto' ? !this.isCascade : this.options.covered!;\n\n    // 点击触发菜单切换\n    this.$anchor.on('click', () => this.toggle());\n\n    // 点击菜单外面区域关闭菜单\n    $document.on('click touchstart', (event: Event) => {\n      const $target = $(event.target as HTMLElement);\n\n      if (\n        this.isOpen() &&\n        !$target.is(this.$element) &&\n        !contains(this.$element[0], $target[0]) &&\n        !$target.is(this.$anchor) &&\n        !contains(this.$anchor[0], $target[0])\n      ) {\n        this.close();\n      }\n    });\n\n    // 点击不含子菜单的菜单条目关闭菜单\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const that = this;\n    $document.on('click', '.mdui-menu-item', function () {\n      const $item = $(this);\n\n      if (\n        !$item.find('.mdui-menu').length &&\n        $item.attr('disabled') === undefined\n      ) {\n        that.close();\n      }\n    });\n\n    // 绑定点击或鼠标移入含子菜单的条目的事件\n    this.bindSubMenuEvent();\n\n    // 窗口大小变化时，重新调整菜单位置\n    $window.on(\n      'resize',\n      $.throttle(() => this.readjust(), 100),\n    );\n  }\n\n  /**\n   * 是否为打开状态\n   */\n  private isOpen(): boolean {\n    return this.state === 'opening' || this.state === 'opened';\n  }\n\n  /**\n   * 触发组件事件\n   * @param name\n   */\n  private triggerEvent(name: EVENT): void {\n    componentEvent(name, 'menu', this.$element, this);\n  }\n\n  /**\n   * 调整主菜单位置\n   */\n  private readjust(): void {\n    let menuLeft;\n    let menuTop;\n\n    // 菜单位置和方向\n    let position: 'bottom' | 'top' | 'center';\n    let align: 'left' | 'right' | 'center';\n\n    // window 窗口的宽度和高度\n    const windowHeight = $window.height();\n    const windowWidth = $window.width();\n\n    // 配置参数\n    const gutter = this.options.gutter!;\n    const isCovered = this.isCovered;\n    const isFixed = this.options.fixed;\n\n    // 动画方向参数\n    let transformOriginX;\n    let transformOriginY;\n\n    // 菜单的原始宽度和高度\n    const menuWidth = this.$element.width();\n    const menuHeight = this.$element.height();\n\n    // 触发菜单的元素在窗口中的位置\n    const anchorRect = this.$anchor[0].getBoundingClientRect();\n    const anchorTop = anchorRect.top;\n    const anchorLeft = anchorRect.left;\n    const anchorHeight = anchorRect.height;\n    const anchorWidth = anchorRect.width;\n    const anchorBottom = windowHeight - anchorTop - anchorHeight;\n    const anchorRight = windowWidth - anchorLeft - anchorWidth;\n\n    // 触发元素相对其拥有定位属性的父元素的位置\n    const anchorOffsetTop = this.$anchor[0].offsetTop;\n    const anchorOffsetLeft = this.$anchor[0].offsetLeft;\n\n    // 自动判断菜单位置\n    if (this.options.position === 'auto') {\n      if (anchorBottom + (isCovered ? anchorHeight : 0) > menuHeight + gutter) {\n        // 判断下方是否放得下菜单\n        position = 'bottom';\n      } else if (\n        anchorTop + (isCovered ? anchorHeight : 0) >\n        menuHeight + gutter\n      ) {\n        // 判断上方是否放得下菜单\n        position = 'top';\n      } else {\n        // 上下都放不下，居中显示\n        position = 'center';\n      }\n    } else {\n      position = this.options.position!;\n    }\n\n    // 自动判断菜单对齐方式\n    if (this.options.align === 'auto') {\n      if (anchorRight + anchorWidth > menuWidth + gutter) {\n        // 判断右侧是否放得下菜单\n        align = 'left';\n      } else if (anchorLeft + anchorWidth > menuWidth + gutter) {\n        // 判断左侧是否放得下菜单\n        align = 'right';\n      } else {\n        // 左右都放不下，居中显示\n        align = 'center';\n      }\n    } else {\n      align = this.options.align!;\n    }\n\n    // 设置菜单位置\n    if (position === 'bottom') {\n      transformOriginY = '0';\n      menuTop =\n        (isCovered ? 0 : anchorHeight) +\n        (isFixed ? anchorTop : anchorOffsetTop);\n    } else if (position === 'top') {\n      transformOriginY = '100%';\n      menuTop =\n        (isCovered ? anchorHeight : 0) +\n        (isFixed ? anchorTop - menuHeight : anchorOffsetTop - menuHeight);\n    } else {\n      transformOriginY = '50%';\n\n      // =====================在窗口中居中\n      // 显示的菜单的高度，简单菜单高度不超过窗口高度，若超过了则在菜单内部显示滚动条\n      // 级联菜单内部不允许出现滚动条\n      let menuHeightTemp = menuHeight;\n\n      // 简单菜单比窗口高时，限制菜单高度\n      if (!this.isCascade) {\n        if (menuHeight + gutter * 2 > windowHeight) {\n          menuHeightTemp = windowHeight - gutter * 2;\n          this.$element.height(menuHeightTemp);\n        }\n      }\n\n      menuTop =\n        (windowHeight - menuHeightTemp) / 2 +\n        (isFixed ? 0 : anchorOffsetTop - anchorTop);\n    }\n\n    this.$element.css('top', `${menuTop}px`);\n\n    // 设置菜单对齐方式\n    if (align === 'left') {\n      transformOriginX = '0';\n      menuLeft = isFixed ? anchorLeft : anchorOffsetLeft;\n    } else if (align === 'right') {\n      transformOriginX = '100%';\n      menuLeft = isFixed\n        ? anchorLeft + anchorWidth - menuWidth\n        : anchorOffsetLeft + anchorWidth - menuWidth;\n    } else {\n      transformOriginX = '50%';\n\n      //=======================在窗口中居中\n      // 显示的菜单的宽度，菜单宽度不能超过窗口宽度\n      let menuWidthTemp = menuWidth;\n\n      // 菜单比窗口宽，限制菜单宽度\n      if (menuWidth + gutter * 2 > windowWidth) {\n        menuWidthTemp = windowWidth - gutter * 2;\n        this.$element.width(menuWidthTemp);\n      }\n\n      menuLeft =\n        (windowWidth - menuWidthTemp) / 2 +\n        (isFixed ? 0 : anchorOffsetLeft - anchorLeft);\n    }\n\n    this.$element.css('left', `${menuLeft}px`);\n\n    // 设置菜单动画方向\n    this.$element.transformOrigin(`${transformOriginX} ${transformOriginY}`);\n  }\n\n  /**\n   * 调整子菜单的位置\n   * @param $submenu\n   */\n  private readjustSubmenu($submenu: JQ): void {\n    const $item = $submenu.parent('.mdui-menu-item');\n\n    let submenuTop;\n    let submenuLeft;\n\n    // 子菜单位置和方向\n    let position: 'top' | 'bottom';\n    let align: 'left' | 'right';\n\n    // window 窗口的宽度和高度\n    const windowHeight = $window.height();\n    const windowWidth = $window.width();\n\n    // 动画方向参数\n    let transformOriginX;\n    let transformOriginY;\n\n    // 子菜单的原始宽度和高度\n    const submenuWidth = $submenu.width();\n    const submenuHeight = $submenu.height();\n\n    // 触发子菜单的菜单项的宽度高度\n    const itemRect = $item[0].getBoundingClientRect();\n    const itemWidth = itemRect.width;\n    const itemHeight = itemRect.height;\n    const itemLeft = itemRect.left;\n    const itemTop = itemRect.top;\n\n    // 判断菜单上下位置\n    if (windowHeight - itemTop > submenuHeight) {\n      // 判断下方是否放得下菜单\n      position = 'bottom';\n    } else if (itemTop + itemHeight > submenuHeight) {\n      // 判断上方是否放得下菜单\n      position = 'top';\n    } else {\n      // 默认放在下方\n      position = 'bottom';\n    }\n\n    // 判断菜单左右位置\n    if (windowWidth - itemLeft - itemWidth > submenuWidth) {\n      // 判断右侧是否放得下菜单\n      align = 'left';\n    } else if (itemLeft > submenuWidth) {\n      // 判断左侧是否放得下菜单\n      align = 'right';\n    } else {\n      // 默认放在右侧\n      align = 'left';\n    }\n\n    // 设置菜单位置\n    if (position === 'bottom') {\n      transformOriginY = '0';\n      submenuTop = '0';\n    } else if (position === 'top') {\n      transformOriginY = '100%';\n      submenuTop = -submenuHeight + itemHeight;\n    }\n\n    $submenu.css('top', `${submenuTop}px`);\n\n    // 设置菜单对齐方式\n    if (align === 'left') {\n      transformOriginX = '0';\n      submenuLeft = itemWidth;\n    } else if (align === 'right') {\n      transformOriginX = '100%';\n      submenuLeft = -submenuWidth;\n    }\n\n    $submenu.css('left', `${submenuLeft}px`);\n\n    // 设置菜单动画方向\n    $submenu.transformOrigin(`${transformOriginX} ${transformOriginY}`);\n  }\n\n  /**\n   * 打开子菜单\n   * @param $submenu\n   */\n  private openSubMenu($submenu: JQ): void {\n    this.readjustSubmenu($submenu);\n\n    $submenu\n      .addClass('mdui-menu-open')\n      .parent('.mdui-menu-item')\n      .addClass('mdui-menu-item-active');\n  }\n\n  /**\n   * 关闭子菜单，及其嵌套的子菜单\n   * @param $submenu\n   */\n  private closeSubMenu($submenu: JQ): void {\n    // 关闭子菜单\n    $submenu\n      .removeClass('mdui-menu-open')\n      .addClass('mdui-menu-closing')\n      .transitionEnd(() => $submenu.removeClass('mdui-menu-closing'))\n\n      // 移除激活状态的样式\n      .parent('.mdui-menu-item')\n      .removeClass('mdui-menu-item-active');\n\n    // 循环关闭嵌套的子菜单\n    $submenu.find('.mdui-menu').each((_, menu) => {\n      const $subSubmenu = $(menu);\n\n      $subSubmenu\n        .removeClass('mdui-menu-open')\n        .addClass('mdui-menu-closing')\n        .transitionEnd(() => $subSubmenu.removeClass('mdui-menu-closing'))\n        .parent('.mdui-menu-item')\n        .removeClass('mdui-menu-item-active');\n    });\n  }\n\n  /**\n   * 切换子菜单状态\n   * @param $submenu\n   */\n  private toggleSubMenu($submenu: JQ): void {\n    $submenu.hasClass('mdui-menu-open')\n      ? this.closeSubMenu($submenu)\n      : this.openSubMenu($submenu);\n  }\n\n  /**\n   * 绑定子菜单事件\n   */\n  private bindSubMenuEvent(): void {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const that = this;\n\n    // 点击打开子菜单\n    this.$element.on('click', '.mdui-menu-item', function (event) {\n      const $item = $(this as HTMLElement);\n      const $target = $(event.target as HTMLElement);\n\n      // 禁用状态菜单不操作\n      if ($item.attr('disabled') !== undefined) {\n        return;\n      }\n\n      // 没有点击在子菜单的菜单项上时，不操作（点在了子菜单的空白区域、或分隔线上）\n      if ($target.is('.mdui-menu') || $target.is('.mdui-divider')) {\n        return;\n      }\n\n      // 阻止冒泡，点击菜单项时只在最后一级的 mdui-menu-item 上生效，不向上冒泡\n      if (!$target.parents('.mdui-menu-item').first().is($item)) {\n        return;\n      }\n\n      // 当前菜单的子菜单\n      const $submenu = $item.children('.mdui-menu');\n\n      // 先关闭除当前子菜单外的所有同级子菜单\n      $item\n        .parent('.mdui-menu')\n        .children('.mdui-menu-item')\n        .each((_, item) => {\n          const $tmpSubmenu = $(item).children('.mdui-menu');\n\n          if (\n            $tmpSubmenu.length &&\n            (!$submenu.length || !$tmpSubmenu.is($submenu))\n          ) {\n            that.closeSubMenu($tmpSubmenu);\n          }\n        });\n\n      // 切换当前子菜单\n      if ($submenu.length) {\n        that.toggleSubMenu($submenu);\n      }\n    });\n\n    if (this.options.subMenuTrigger === 'hover') {\n      // 临时存储 setTimeout 对象\n      let timeout: any = null;\n      let timeoutOpen: any = null;\n\n      this.$element.on('mouseover mouseout', '.mdui-menu-item', function (\n        event,\n      ) {\n        const $item = $(this as HTMLElement);\n        const eventType = event.type;\n        const $relatedTarget = $(\n          (event as MouseEvent).relatedTarget as HTMLElement,\n        );\n\n        // 禁用状态的菜单不操作\n        if ($item.attr('disabled') !== undefined) {\n          return;\n        }\n\n        // 用 mouseover 模拟 mouseenter\n        if (eventType === 'mouseover') {\n          if (\n            !$item.is($relatedTarget) &&\n            contains($item[0], $relatedTarget[0])\n          ) {\n            return;\n          }\n        }\n\n        // 用 mouseout 模拟 mouseleave\n        else if (eventType === 'mouseout') {\n          if (\n            $item.is($relatedTarget) ||\n            contains($item[0], $relatedTarget[0])\n          ) {\n            return;\n          }\n        }\n\n        // 当前菜单项下的子菜单，未必存在\n        const $submenu = $item.children('.mdui-menu');\n\n        // 鼠标移入菜单项时，显示菜单项下的子菜单\n        if (eventType === 'mouseover') {\n          if ($submenu.length) {\n            // 当前子菜单准备打开时，如果当前子菜单正准备着关闭，不用再关闭了\n            const tmpClose = $submenu.data('timeoutClose.mdui.menu');\n            if (tmpClose) {\n              clearTimeout(tmpClose);\n            }\n\n            // 如果当前子菜单已经打开，不操作\n            if ($submenu.hasClass('mdui-menu-open')) {\n              return;\n            }\n\n            // 当前子菜单准备打开时，其他准备打开的子菜单不用再打开了\n            clearTimeout(timeoutOpen);\n\n            // 准备打开当前子菜单\n            timeout = timeoutOpen = setTimeout(\n              () => that.openSubMenu($submenu),\n              that.options.subMenuDelay,\n            );\n\n            $submenu.data('timeoutOpen.mdui.menu', timeout);\n          }\n        }\n\n        // 鼠标移出菜单项时，关闭菜单项下的子菜单\n        else if (eventType === 'mouseout') {\n          if ($submenu.length) {\n            // 鼠标移出菜单项时，如果当前菜单项下的子菜单正准备打开，不用再打开了\n            const tmpOpen = $submenu.data('timeoutOpen.mdui.menu');\n            if (tmpOpen) {\n              clearTimeout(tmpOpen);\n            }\n\n            // 准备关闭当前子菜单\n            timeout = setTimeout(\n              () => that.closeSubMenu($submenu),\n              that.options.subMenuDelay,\n            );\n\n            $submenu.data('timeoutClose.mdui.menu', timeout);\n          }\n        }\n      });\n    }\n  }\n\n  /**\n   * 动画结束回调\n   */\n  private transitionEnd(): void {\n    this.$element.removeClass('mdui-menu-closing');\n\n    if (this.state === 'opening') {\n      this.state = 'opened';\n      this.triggerEvent('opened');\n    }\n\n    if (this.state === 'closing') {\n      this.state = 'closed';\n      this.triggerEvent('closed');\n\n      // 关闭后，恢复菜单样式到默认状态，并恢复 fixed 定位\n      this.$element.css({\n        top: '',\n        left: '',\n        width: '',\n        position: 'fixed',\n      });\n    }\n  }\n\n  /**\n   * 切换菜单状态\n   */\n  public toggle(): void {\n    this.isOpen() ? this.close() : this.open();\n  }\n\n  /**\n   * 打开菜单\n   */\n  public open(): void {\n    if (this.isOpen()) {\n      return;\n    }\n\n    this.state = 'opening';\n    this.triggerEvent('open');\n\n    this.readjust();\n\n    this.$element\n      // 菜单隐藏状态使用使用 fixed 定位。\n      .css('position', this.options.fixed ? 'fixed' : 'absolute')\n      .addClass('mdui-menu-open')\n      .transitionEnd(() => this.transitionEnd());\n  }\n\n  /**\n   * 关闭菜单\n   */\n  public close(): void {\n    if (!this.isOpen()) {\n      return;\n    }\n\n    this.state = 'closing';\n    this.triggerEvent('close');\n\n    // 菜单开始关闭时，关闭所有子菜单\n    this.$element.find('.mdui-menu').each((_, submenu) => {\n      this.closeSubMenu($(submenu));\n    });\n\n    this.$element\n      .removeClass('mdui-menu-open')\n      .addClass('mdui-menu-closing')\n      .transitionEnd(() => this.transitionEnd());\n  }\n}\n\nmdui.Menu = Menu;\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/on';\nimport mdui from '../../mdui';\nimport { $document } from '../../utils/dom';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-menu';\nconst dataName = '_mdui_menu';\n\ntype OPTIONS = {\n  target: string;\n  position?: 'auto' | 'top' | 'bottom' | 'center';\n  align?: 'auto' | 'left' | 'right' | 'center';\n  gutter?: number;\n  fixed?: boolean;\n  covered?: boolean | 'auto';\n  subMenuTrigger?: 'click' | 'hover';\n  subMenuDelay?: number;\n};\n\n$(() => {\n  $document.on('click', `[${customAttr}]`, function () {\n    const $this = $(this as HTMLElement);\n    let instance = $this.data(dataName);\n\n    if (!instance) {\n      const options = parseOptions(this as HTMLElement, customAttr) as OPTIONS;\n      const menuSelector = options.target;\n      // @ts-ignore\n      delete options.target;\n\n      instance = new mdui.Menu($this, menuSelector, options);\n      $this.data(dataName, instance);\n\n      instance.toggle();\n    }\n  });\n});\n"]}]}