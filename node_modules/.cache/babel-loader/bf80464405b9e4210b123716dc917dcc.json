{"remainingRequest":"C:\\Users\\zsq17_d1v4dt0\\IdeaProjects\\zsq001-index\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\zsq17_d1v4dt0\\IdeaProjects\\zsq001-index\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\zsq17_d1v4dt0\\IdeaProjects\\zsq001-index\\src\\assets\\js\\mdui.js","dependencies":[{"path":"C:\\Users\\zsq17_d1v4dt0\\IdeaProjects\\zsq001-index\\src\\assets\\js\\mdui.js","mtime":1615631084004},{"path":"C:\\Users\\zsq17_d1v4dt0\\IdeaProjects\\zsq001-index\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1615630767429},{"path":"C:\\Users\\zsq17_d1v4dt0\\IdeaProjects\\zsq001-index\\node_modules\\babel-loader\\lib\\index.js","mtime":1615630767414},{"path":"C:\\Users\\zsq17_d1v4dt0\\IdeaProjects\\zsq001-index\\node_modules\\eslint-loader\\index.js","mtime":1615630791370}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyohDQogKiBtZHVpIDEuMC4xIChodHRwczovL21kdWkub3JnKQ0KICogQ29weXJpZ2h0IDIwMTYtMjAyMCB6ZGh4aW9uZw0KICogTGljZW5zZWQgdW5kZXIgTUlUDQogKi8KKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHsKICB0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKSA6IHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShmYWN0b3J5KSA6IChnbG9iYWwgPSB0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWxUaGlzIDogZ2xvYmFsIHx8IHNlbGYsIGdsb2JhbC5tZHVpID0gZmFjdG9yeSgpKTsKfSkodGhpcywgZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgIWZ1bmN0aW9uICgpIHsKICAgIHRyeSB7CiAgICAgIHJldHVybiBuZXcgTW91c2VFdmVudCgidGVzdCIpOwogICAgfSBjYXRjaCAoZSQxKSB7fQoKICAgIHZhciBlID0gZnVuY3Rpb24gKGUsIHQpIHsKICAgICAgdCA9IHQgfHwgewogICAgICAgIGJ1YmJsZXM6ICExLAogICAgICAgIGNhbmNlbGFibGU6ICExCiAgICAgIH07CiAgICAgIHZhciBuID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoIk1vdXNlRXZlbnQiKTsKICAgICAgcmV0dXJuIG4uaW5pdE1vdXNlRXZlbnQoZSwgdC5idWJibGVzLCB0LmNhbmNlbGFibGUsIHdpbmRvdywgMCwgdC5zY3JlZW5YIHx8IDAsIHQuc2NyZWVuWSB8fCAwLCB0LmNsaWVudFggfHwgMCwgdC5jbGllbnRZIHx8IDAsIHQuY3RybEtleSB8fCAhMSwgdC5hbHRLZXkgfHwgITEsIHQuc2hpZnRLZXkgfHwgITEsIHQubWV0YUtleSB8fCAhMSwgdC5idXR0b24gfHwgMCwgdC5yZWxhdGVkVGFyZ2V0IHx8IG51bGwpLCBuOwogICAgfTsKCiAgICBlLnByb3RvdHlwZSA9IEV2ZW50LnByb3RvdHlwZSwgd2luZG93Lk1vdXNlRXZlbnQgPSBlOwogIH0oKTsKICAhZnVuY3Rpb24gKCkgewogICAgZnVuY3Rpb24gdCh0LCBlKSB7CiAgICAgIGUgPSBlIHx8IHsKICAgICAgICBidWJibGVzOiAhMSwKICAgICAgICBjYW5jZWxhYmxlOiAhMSwKICAgICAgICBkZXRhaWw6IHZvaWQgMAogICAgICB9OwogICAgICB2YXIgbiA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCJDdXN0b21FdmVudCIpOwogICAgICByZXR1cm4gbi5pbml0Q3VzdG9tRXZlbnQodCwgZS5idWJibGVzLCBlLmNhbmNlbGFibGUsIGUuZGV0YWlsKSwgbjsKICAgIH0KCiAgICAiZnVuY3Rpb24iICE9IHR5cGVvZiB3aW5kb3cuQ3VzdG9tRXZlbnQgJiYgKHQucHJvdG90eXBlID0gd2luZG93LkV2ZW50LnByb3RvdHlwZSwgd2luZG93LkN1c3RvbUV2ZW50ID0gdCk7CiAgfSgpOwogIC8qKg0KICAgKiBAdGhpcyB7UHJvbWlzZX0NCiAgICovCgogIGZ1bmN0aW9uIGZpbmFsbHlDb25zdHJ1Y3RvcihjYWxsYmFjaykgewogICAgdmFyIGNvbnN0cnVjdG9yID0gdGhpcy5jb25zdHJ1Y3RvcjsKICAgIHJldHVybiB0aGlzLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yLnJlc29sdmUoY2FsbGJhY2soKSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICB9KTsKICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgLy8gQHRzLWlnbm9yZQogICAgICByZXR1cm4gY29uc3RydWN0b3IucmVzb2x2ZShjYWxsYmFjaygpKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yLnJlamVjdChyZWFzb24pOwogICAgICB9KTsKICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gYWxsU2V0dGxlZChhcnIpIHsKICAgIHZhciBQID0gdGhpczsKICAgIHJldHVybiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIGlmICghKGFyciAmJiB0eXBlb2YgYXJyLmxlbmd0aCAhPT0gJ3VuZGVmaW5lZCcpKSB7CiAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgVHlwZUVycm9yKHR5cGVvZiBhcnIgKyAnICcgKyBhcnIgKyAnIGlzIG5vdCBpdGVyYWJsZShjYW5ub3QgcmVhZCBwcm9wZXJ0eSBTeW1ib2woU3ltYm9sLml0ZXJhdG9yKSknKSk7CiAgICAgIH0KCiAgICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKTsKCiAgICAgIGlmIChhcmdzLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiByZXNvbHZlKFtdKTsKICAgICAgfQoKICAgICAgdmFyIHJlbWFpbmluZyA9IGFyZ3MubGVuZ3RoOwoKICAgICAgZnVuY3Rpb24gcmVzKGksIHZhbCkgewogICAgICAgIGlmICh2YWwgJiYgKHR5cGVvZiB2YWwgPT09ICdvYmplY3QnIHx8IHR5cGVvZiB2YWwgPT09ICdmdW5jdGlvbicpKSB7CiAgICAgICAgICB2YXIgdGhlbiA9IHZhbC50aGVuOwoKICAgICAgICAgIGlmICh0eXBlb2YgdGhlbiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICB0aGVuLmNhbGwodmFsLCBmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICAgICAgcmVzKGksIHZhbCk7CiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgYXJnc1tpXSA9IHsKICAgICAgICAgICAgICAgIHN0YXR1czogJ3JlamVjdGVkJywKICAgICAgICAgICAgICAgIHJlYXNvbjogZQogICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgIGlmICgtLXJlbWFpbmluZyA9PT0gMCkgewogICAgICAgICAgICAgICAgcmVzb2x2ZShhcmdzKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBhcmdzW2ldID0gewogICAgICAgICAgc3RhdHVzOiAnZnVsZmlsbGVkJywKICAgICAgICAgIHZhbHVlOiB2YWwKICAgICAgICB9OwoKICAgICAgICBpZiAoLS1yZW1haW5pbmcgPT09IDApIHsKICAgICAgICAgIHJlc29sdmUoYXJncyk7CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICByZXMoaSwgYXJnc1tpXSk7CiAgICAgIH0KICAgIH0pOwogIH0gLy8gU3RvcmUgc2V0VGltZW91dCByZWZlcmVuY2Ugc28gcHJvbWlzZS1wb2x5ZmlsbCB3aWxsIGJlIHVuYWZmZWN0ZWQgYnkKICAvLyBvdGhlciBjb2RlIG1vZGlmeWluZyBzZXRUaW1lb3V0IChsaWtlIHNpbm9uLnVzZUZha2VUaW1lcnMoKSkKCgogIHZhciBzZXRUaW1lb3V0RnVuYyA9IHNldFRpbWVvdXQ7CgogIGZ1bmN0aW9uIGlzQXJyYXkoeCkgewogICAgcmV0dXJuIEJvb2xlYW4oeCAmJiB0eXBlb2YgeC5sZW5ndGggIT09ICd1bmRlZmluZWQnKTsKICB9CgogIGZ1bmN0aW9uIG5vb3AoKSB7fSAvLyBQb2x5ZmlsbCBmb3IgRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQKCgogIGZ1bmN0aW9uIGJpbmQoZm4sIHRoaXNBcmcpIHsKICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgIGZuLmFwcGx5KHRoaXNBcmcsIGFyZ3VtZW50cyk7CiAgICB9OwogIH0KICAvKioNCiAgICogQGNvbnN0cnVjdG9yDQogICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuDQogICAqLwoKCiAgZnVuY3Rpb24gUHJvbWlzZSQxKGZuKSB7CiAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgUHJvbWlzZSQxKSkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdQcm9taXNlcyBtdXN0IGJlIGNvbnN0cnVjdGVkIHZpYSBuZXcnKTsKICAgIH0KCiAgICBpZiAodHlwZW9mIGZuICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ25vdCBhIGZ1bmN0aW9uJyk7CiAgICB9CiAgICAvKiogQHR5cGUgeyFudW1iZXJ9ICovCgoKICAgIHRoaXMuX3N0YXRlID0gMDsKICAgIC8qKiBAdHlwZSB7IWJvb2xlYW59ICovCgogICAgdGhpcy5faGFuZGxlZCA9IGZhbHNlOwogICAgLyoqIEB0eXBlIHtQcm9taXNlfHVuZGVmaW5lZH0gKi8KCiAgICB0aGlzLl92YWx1ZSA9IHVuZGVmaW5lZDsKICAgIC8qKiBAdHlwZSB7IUFycmF5PCFGdW5jdGlvbj59ICovCgogICAgdGhpcy5fZGVmZXJyZWRzID0gW107CiAgICBkb1Jlc29sdmUoZm4sIHRoaXMpOwogIH0KCiAgZnVuY3Rpb24gaGFuZGxlKHNlbGYsIGRlZmVycmVkKSB7CiAgICB3aGlsZSAoc2VsZi5fc3RhdGUgPT09IDMpIHsKICAgICAgc2VsZiA9IHNlbGYuX3ZhbHVlOwogICAgfQoKICAgIGlmIChzZWxmLl9zdGF0ZSA9PT0gMCkgewogICAgICBzZWxmLl9kZWZlcnJlZHMucHVzaChkZWZlcnJlZCk7CgogICAgICByZXR1cm47CiAgICB9CgogICAgc2VsZi5faGFuZGxlZCA9IHRydWU7CgogICAgUHJvbWlzZSQxLl9pbW1lZGlhdGVGbihmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBjYiA9IHNlbGYuX3N0YXRlID09PSAxID8gZGVmZXJyZWQub25GdWxmaWxsZWQgOiBkZWZlcnJlZC5vblJlamVjdGVkOwoKICAgICAgaWYgKGNiID09PSBudWxsKSB7CiAgICAgICAgKHNlbGYuX3N0YXRlID09PSAxID8gcmVzb2x2ZSA6IHJlamVjdCkoZGVmZXJyZWQucHJvbWlzZSwgc2VsZi5fdmFsdWUpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHJldDsKCiAgICAgIHRyeSB7CiAgICAgICAgcmV0ID0gY2Ioc2VsZi5fdmFsdWUpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgcmVqZWN0KGRlZmVycmVkLnByb21pc2UsIGUpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgcmVzb2x2ZShkZWZlcnJlZC5wcm9taXNlLCByZXQpOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiByZXNvbHZlKHNlbGYsIG5ld1ZhbHVlKSB7CiAgICB0cnkgewogICAgICAvLyBQcm9taXNlIFJlc29sdXRpb24gUHJvY2VkdXJlOiBodHRwczovL2dpdGh1Yi5jb20vcHJvbWlzZXMtYXBsdXMvcHJvbWlzZXMtc3BlYyN0aGUtcHJvbWlzZS1yZXNvbHV0aW9uLXByb2NlZHVyZQogICAgICBpZiAobmV3VmFsdWUgPT09IHNlbGYpIHsKICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBIHByb21pc2UgY2Fubm90IGJlIHJlc29sdmVkIHdpdGggaXRzZWxmLicpOwogICAgICB9CgogICAgICBpZiAobmV3VmFsdWUgJiYgKHR5cGVvZiBuZXdWYWx1ZSA9PT0gJ29iamVjdCcgfHwgdHlwZW9mIG5ld1ZhbHVlID09PSAnZnVuY3Rpb24nKSkgewogICAgICAgIHZhciB0aGVuID0gbmV3VmFsdWUudGhlbjsKCiAgICAgICAgaWYgKG5ld1ZhbHVlIGluc3RhbmNlb2YgUHJvbWlzZSQxKSB7CiAgICAgICAgICBzZWxmLl9zdGF0ZSA9IDM7CiAgICAgICAgICBzZWxmLl92YWx1ZSA9IG5ld1ZhbHVlOwogICAgICAgICAgZmluYWxlKHNlbGYpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHRoZW4gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIGRvUmVzb2x2ZShiaW5kKHRoZW4sIG5ld1ZhbHVlKSwgc2VsZik7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CgogICAgICBzZWxmLl9zdGF0ZSA9IDE7CiAgICAgIHNlbGYuX3ZhbHVlID0gbmV3VmFsdWU7CiAgICAgIGZpbmFsZShzZWxmKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgcmVqZWN0KHNlbGYsIGUpOwogICAgfQogIH0KCiAgZnVuY3Rpb24gcmVqZWN0KHNlbGYsIG5ld1ZhbHVlKSB7CiAgICBzZWxmLl9zdGF0ZSA9IDI7CiAgICBzZWxmLl92YWx1ZSA9IG5ld1ZhbHVlOwogICAgZmluYWxlKHNlbGYpOwogIH0KCiAgZnVuY3Rpb24gZmluYWxlKHNlbGYpIHsKICAgIGlmIChzZWxmLl9zdGF0ZSA9PT0gMiAmJiBzZWxmLl9kZWZlcnJlZHMubGVuZ3RoID09PSAwKSB7CiAgICAgIFByb21pc2UkMS5faW1tZWRpYXRlRm4oZnVuY3Rpb24gKCkgewogICAgICAgIGlmICghc2VsZi5faGFuZGxlZCkgewogICAgICAgICAgUHJvbWlzZSQxLl91bmhhbmRsZWRSZWplY3Rpb25GbihzZWxmLl92YWx1ZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gc2VsZi5fZGVmZXJyZWRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgIGhhbmRsZShzZWxmLCBzZWxmLl9kZWZlcnJlZHNbaV0pOwogICAgfQoKICAgIHNlbGYuX2RlZmVycmVkcyA9IG51bGw7CiAgfQogIC8qKg0KICAgKiBAY29uc3RydWN0b3INCiAgICovCgoKICBmdW5jdGlvbiBIYW5kbGVyKG9uRnVsZmlsbGVkLCBvblJlamVjdGVkLCBwcm9taXNlKSB7CiAgICB0aGlzLm9uRnVsZmlsbGVkID0gdHlwZW9mIG9uRnVsZmlsbGVkID09PSAnZnVuY3Rpb24nID8gb25GdWxmaWxsZWQgOiBudWxsOwogICAgdGhpcy5vblJlamVjdGVkID0gdHlwZW9mIG9uUmVqZWN0ZWQgPT09ICdmdW5jdGlvbicgPyBvblJlamVjdGVkIDogbnVsbDsKICAgIHRoaXMucHJvbWlzZSA9IHByb21pc2U7CiAgfQogIC8qKg0KICAgKiBUYWtlIGEgcG90ZW50aWFsbHkgbWlzYmVoYXZpbmcgcmVzb2x2ZXIgZnVuY3Rpb24gYW5kIG1ha2Ugc3VyZQ0KICAgKiBvbkZ1bGZpbGxlZCBhbmQgb25SZWplY3RlZCBhcmUgb25seSBjYWxsZWQgb25jZS4NCiAgICoNCiAgICogTWFrZXMgbm8gZ3VhcmFudGVlcyBhYm91dCBhc3luY2hyb255Lg0KICAgKi8KCgogIGZ1bmN0aW9uIGRvUmVzb2x2ZShmbiwgc2VsZikgewogICAgdmFyIGRvbmUgPSBmYWxzZTsKCiAgICB0cnkgewogICAgICBmbihmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICBpZiAoZG9uZSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgZG9uZSA9IHRydWU7CiAgICAgICAgcmVzb2x2ZShzZWxmLCB2YWx1ZSk7CiAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgICBpZiAoZG9uZSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgZG9uZSA9IHRydWU7CiAgICAgICAgcmVqZWN0KHNlbGYsIHJlYXNvbik7CiAgICAgIH0pOwogICAgfSBjYXRjaCAoZXgpIHsKICAgICAgaWYgKGRvbmUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGRvbmUgPSB0cnVlOwogICAgICByZWplY3Qoc2VsZiwgZXgpOwogICAgfQogIH0KCiAgUHJvbWlzZSQxLnByb3RvdHlwZVsnY2F0Y2gnXSA9IGZ1bmN0aW9uIChvblJlamVjdGVkKSB7CiAgICByZXR1cm4gdGhpcy50aGVuKG51bGwsIG9uUmVqZWN0ZWQpOwogIH07CgogIFByb21pc2UkMS5wcm90b3R5cGUudGhlbiA9IGZ1bmN0aW9uIChvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCkgewogICAgLy8gQHRzLWlnbm9yZQogICAgdmFyIHByb20gPSBuZXcgdGhpcy5jb25zdHJ1Y3Rvcihub29wKTsKICAgIGhhbmRsZSh0aGlzLCBuZXcgSGFuZGxlcihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCwgcHJvbSkpOwogICAgcmV0dXJuIHByb207CiAgfTsKCiAgUHJvbWlzZSQxLnByb3RvdHlwZVsnZmluYWxseSddID0gZmluYWxseUNvbnN0cnVjdG9yOwoKICBQcm9taXNlJDEuYWxsID0gZnVuY3Rpb24gKGFycikgewogICAgcmV0dXJuIG5ldyBQcm9taXNlJDEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBpZiAoIWlzQXJyYXkoYXJyKSkgewogICAgICAgIHJldHVybiByZWplY3QobmV3IFR5cGVFcnJvcignUHJvbWlzZS5hbGwgYWNjZXB0cyBhbiBhcnJheScpKTsKICAgICAgfQoKICAgICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpOwoKICAgICAgaWYgKGFyZ3MubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHJlc29sdmUoW10pOwogICAgICB9CgogICAgICB2YXIgcmVtYWluaW5nID0gYXJncy5sZW5ndGg7CgogICAgICBmdW5jdGlvbiByZXMoaSwgdmFsKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGlmICh2YWwgJiYgKHR5cGVvZiB2YWwgPT09ICdvYmplY3QnIHx8IHR5cGVvZiB2YWwgPT09ICdmdW5jdGlvbicpKSB7CiAgICAgICAgICAgIHZhciB0aGVuID0gdmFsLnRoZW47CgogICAgICAgICAgICBpZiAodHlwZW9mIHRoZW4gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgICB0aGVuLmNhbGwodmFsLCBmdW5jdGlvbiAodmFsKSB7CiAgICAgICAgICAgICAgICByZXMoaSwgdmFsKTsKICAgICAgICAgICAgICB9LCByZWplY3QpOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGFyZ3NbaV0gPSB2YWw7CgogICAgICAgICAgaWYgKC0tcmVtYWluaW5nID09PSAwKSB7CiAgICAgICAgICAgIHJlc29sdmUoYXJncyk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAgIHJlamVjdChleCk7CiAgICAgICAgfQogICAgICB9CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHsKICAgICAgICByZXMoaSwgYXJnc1tpXSk7CiAgICAgIH0KICAgIH0pOwogIH07CgogIFByb21pc2UkMS5hbGxTZXR0bGVkID0gYWxsU2V0dGxlZDsKCiAgUHJvbWlzZSQxLnJlc29sdmUgPSBmdW5jdGlvbiAodmFsdWUpIHsKICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlLmNvbnN0cnVjdG9yID09PSBQcm9taXNlJDEpIHsKICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQoKICAgIHJldHVybiBuZXcgUHJvbWlzZSQxKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgIHJlc29sdmUodmFsdWUpOwogICAgfSk7CiAgfTsKCiAgUHJvbWlzZSQxLnJlamVjdCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogICAgcmV0dXJuIG5ldyBQcm9taXNlJDEoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICByZWplY3QodmFsdWUpOwogICAgfSk7CiAgfTsKCiAgUHJvbWlzZSQxLnJhY2UgPSBmdW5jdGlvbiAoYXJyKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UkMShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIGlmICghaXNBcnJheShhcnIpKSB7CiAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgVHlwZUVycm9yKCdQcm9taXNlLnJhY2UgYWNjZXB0cyBhbiBhcnJheScpKTsKICAgICAgfQoKICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFyci5sZW5ndGg7IGkgPCBsZW47IGkrKykgewogICAgICAgIFByb21pc2UkMS5yZXNvbHZlKGFycltpXSkudGhlbihyZXNvbHZlLCByZWplY3QpOwogICAgICB9CiAgICB9KTsKICB9OyAvLyBVc2UgcG9seWZpbGwgZm9yIHNldEltbWVkaWF0ZSBmb3IgcGVyZm9ybWFuY2UgZ2FpbnMKCgogIFByb21pc2UkMS5faW1tZWRpYXRlRm4gPSAvLyBAdHMtaWdub3JlCiAgdHlwZW9mIHNldEltbWVkaWF0ZSA9PT0gJ2Z1bmN0aW9uJyAmJiBmdW5jdGlvbiAoZm4pIHsKICAgIC8vIEB0cy1pZ25vcmUKICAgIHNldEltbWVkaWF0ZShmbik7CiAgfSB8fCBmdW5jdGlvbiAoZm4pIHsKICAgIHNldFRpbWVvdXRGdW5jKGZuLCAwKTsKICB9OwoKICBQcm9taXNlJDEuX3VuaGFuZGxlZFJlamVjdGlvbkZuID0gZnVuY3Rpb24gX3VuaGFuZGxlZFJlamVjdGlvbkZuKGVycikgewogICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiBjb25zb2xlKSB7CiAgICAgIGNvbnNvbGUud2FybignUG9zc2libGUgVW5oYW5kbGVkIFByb21pc2UgUmVqZWN0aW9uOicsIGVycik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZQogICAgfQogIH07CiAgLyoqIEBzdXBwcmVzcyB7dW5kZWZpbmVkVmFyc30gKi8KCgogIHZhciBnbG9iYWxOUyA9IGZ1bmN0aW9uICgpIHsKICAgIC8vIHRoZSBvbmx5IHJlbGlhYmxlIG1lYW5zIHRvIGdldCB0aGUgZ2xvYmFsIG9iamVjdCBpcwogICAgLy8gYEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKClgCiAgICAvLyBIb3dldmVyLCB0aGlzIGNhdXNlcyBDU1AgdmlvbGF0aW9ucyBpbiBDaHJvbWUgYXBwcy4KICAgIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgcmV0dXJuIHNlbGY7CiAgICB9CgogICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7CiAgICAgIHJldHVybiB3aW5kb3c7CiAgICB9CgogICAgaWYgKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnKSB7CiAgICAgIHJldHVybiBnbG9iYWw7CiAgICB9CgogICAgdGhyb3cgbmV3IEVycm9yKCd1bmFibGUgdG8gbG9jYXRlIGdsb2JhbCBvYmplY3QnKTsKICB9KCk7IC8vIEV4cG9zZSB0aGUgcG9seWZpbGwgaWYgUHJvbWlzZSBpcyB1bmRlZmluZWQgb3Igc2V0IHRvIGEKICAvLyBub24tZnVuY3Rpb24gdmFsdWUuIFRoZSBsYXR0ZXIgY2FuIGJlIGR1ZSB0byBhIG5hbWVkIEhUTUxFbGVtZW50CiAgLy8gYmVpbmcgZXhwb3NlZCBieSBicm93c2VycyBmb3IgbGVnYWN5IHJlYXNvbnMuCiAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3RheWxvcmhha2VzL3Byb21pc2UtcG9seWZpbGwvaXNzdWVzLzExNAoKCiAgaWYgKHR5cGVvZiBnbG9iYWxOU1snUHJvbWlzZSddICE9PSAnZnVuY3Rpb24nKSB7CiAgICBnbG9iYWxOU1snUHJvbWlzZSddID0gUHJvbWlzZSQxOwogIH0gZWxzZSBpZiAoIWdsb2JhbE5TLlByb21pc2UucHJvdG90eXBlWydmaW5hbGx5J10pIHsKICAgIGdsb2JhbE5TLlByb21pc2UucHJvdG90eXBlWydmaW5hbGx5J10gPSBmaW5hbGx5Q29uc3RydWN0b3I7CiAgfSBlbHNlIGlmICghZ2xvYmFsTlMuUHJvbWlzZS5hbGxTZXR0bGVkKSB7CiAgICBnbG9iYWxOUy5Qcm9taXNlLmFsbFNldHRsZWQgPSBhbGxTZXR0bGVkOwogIH0KCiAgZnVuY3Rpb24gaXNGdW5jdGlvbih0YXJnZXQpIHsKICAgIHJldHVybiB0eXBlb2YgdGFyZ2V0ID09PSAnZnVuY3Rpb24nOwogIH0KCiAgZnVuY3Rpb24gaXNTdHJpbmcodGFyZ2V0KSB7CiAgICByZXR1cm4gdHlwZW9mIHRhcmdldCA9PT0gJ3N0cmluZyc7CiAgfQoKICBmdW5jdGlvbiBpc051bWJlcih0YXJnZXQpIHsKICAgIHJldHVybiB0eXBlb2YgdGFyZ2V0ID09PSAnbnVtYmVyJzsKICB9CgogIGZ1bmN0aW9uIGlzQm9vbGVhbih0YXJnZXQpIHsKICAgIHJldHVybiB0eXBlb2YgdGFyZ2V0ID09PSAnYm9vbGVhbic7CiAgfQoKICBmdW5jdGlvbiBpc1VuZGVmaW5lZCh0YXJnZXQpIHsKICAgIHJldHVybiB0eXBlb2YgdGFyZ2V0ID09PSAndW5kZWZpbmVkJzsKICB9CgogIGZ1bmN0aW9uIGlzTnVsbCh0YXJnZXQpIHsKICAgIHJldHVybiB0YXJnZXQgPT09IG51bGw7CiAgfQoKICBmdW5jdGlvbiBpc1dpbmRvdyh0YXJnZXQpIHsKICAgIHJldHVybiB0YXJnZXQgaW5zdGFuY2VvZiBXaW5kb3c7CiAgfQoKICBmdW5jdGlvbiBpc0RvY3VtZW50KHRhcmdldCkgewogICAgcmV0dXJuIHRhcmdldCBpbnN0YW5jZW9mIERvY3VtZW50OwogIH0KCiAgZnVuY3Rpb24gaXNFbGVtZW50KHRhcmdldCkgewogICAgcmV0dXJuIHRhcmdldCBpbnN0YW5jZW9mIEVsZW1lbnQ7CiAgfQoKICBmdW5jdGlvbiBpc05vZGUodGFyZ2V0KSB7CiAgICByZXR1cm4gdGFyZ2V0IGluc3RhbmNlb2YgTm9kZTsKICB9CiAgLyoqDQogICAqIOaYr+WQpuaYryBJRSDmtY/op4jlmagNCiAgICovCgoKICBmdW5jdGlvbiBpc0lFKCkgewogICAgLy8gQHRzLWlnbm9yZQogICAgcmV0dXJuICEhd2luZG93LmRvY3VtZW50LmRvY3VtZW50TW9kZTsKICB9CgogIGZ1bmN0aW9uIGlzQXJyYXlMaWtlKHRhcmdldCkgewogICAgaWYgKGlzRnVuY3Rpb24odGFyZ2V0KSB8fCBpc1dpbmRvdyh0YXJnZXQpKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gaXNOdW1iZXIodGFyZ2V0Lmxlbmd0aCk7CiAgfQoKICBmdW5jdGlvbiBpc09iamVjdExpa2UodGFyZ2V0KSB7CiAgICByZXR1cm4gdHlwZW9mIHRhcmdldCA9PT0gJ29iamVjdCcgJiYgdGFyZ2V0ICE9PSBudWxsOwogIH0KCiAgZnVuY3Rpb24gdG9FbGVtZW50KHRhcmdldCkgewogICAgcmV0dXJuIGlzRG9jdW1lbnQodGFyZ2V0KSA/IHRhcmdldC5kb2N1bWVudEVsZW1lbnQgOiB0YXJnZXQ7CiAgfQogIC8qKg0KICAgKiDmiornlKggLSDliIbpmpTnmoTlrZfnrKbkuLLovazkuLrpqbzls7DvvIjlpoIgYm94LXNpemluZyDovazmjaLkuLogYm94U2l6aW5n77yJDQogICAqIEBwYXJhbSBzdHJpbmcNCiAgICovCgoKICBmdW5jdGlvbiB0b0NhbWVsQ2FzZShzdHJpbmcpIHsKICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvXi1tcy0vLCAnbXMtJykucmVwbGFjZSgvLShbYS16XSkvZywgZnVuY3Rpb24gKF8sIGxldHRlcikgewogICAgICByZXR1cm4gbGV0dGVyLnRvVXBwZXJDYXNlKCk7CiAgICB9KTsKICB9CiAgLyoqDQogICAqIOaKiumpvOWzsOazlei9rOS4uueUqCAtIOWIhumalOeahOWtl+espuS4su+8iOWmgiBib3hTaXppbmcg6L2s5o2i5Li6IGJveC1zaXppbmfvvIkNCiAgICogQHBhcmFtIHN0cmluZw0KICAgKi8KCgogIGZ1bmN0aW9uIHRvS2ViYWJDYXNlKHN0cmluZykgewogICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC9bQS1aXS9nLCBmdW5jdGlvbiAocmVwbGFjZXIpIHsKICAgICAgcmV0dXJuICctJyArIHJlcGxhY2VyLnRvTG93ZXJDYXNlKCk7CiAgICB9KTsKICB9CiAgLyoqDQogICAqIOiOt+WPluWFg+e0oOeahOagt+W8j+WAvA0KICAgKiBAcGFyYW0gZWxlbWVudA0KICAgKiBAcGFyYW0gbmFtZQ0KICAgKi8KCgogIGZ1bmN0aW9uIGdldENvbXB1dGVkU3R5bGVWYWx1ZShlbGVtZW50LCBuYW1lKSB7CiAgICByZXR1cm4gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCkuZ2V0UHJvcGVydHlWYWx1ZSh0b0tlYmFiQ2FzZShuYW1lKSk7CiAgfQogIC8qKg0KICAgKiDmo4Dmn6XlhYPntKDnmoQgYm94LXNpemluZyDmmK/lkKbmmK8gYm9yZGVyLWJveA0KICAgKiBAcGFyYW0gZWxlbWVudA0KICAgKi8KCgogIGZ1bmN0aW9uIGlzQm9yZGVyQm94KGVsZW1lbnQpIHsKICAgIHJldHVybiBnZXRDb21wdXRlZFN0eWxlVmFsdWUoZWxlbWVudCwgJ2JveC1zaXppbmcnKSA9PT0gJ2JvcmRlci1ib3gnOwogIH0KICAvKioNCiAgICog6I635Y+W5YWD57Sg55qEIHBhZGRpbmcsIGJvcmRlciwgbWFyZ2luIOWuveW6pu+8iOS4pOS+p+WuveW6pueahOWSjO+8jOWNleS9jeS4unB477yJDQogICAqIEBwYXJhbSBlbGVtZW50DQogICAqIEBwYXJhbSBkaXJlY3Rpb24NCiAgICogQHBhcmFtIGV4dHJhDQogICAqLwoKCiAgZnVuY3Rpb24gZ2V0RXh0cmFXaWR0aChlbGVtZW50LCBkaXJlY3Rpb24sIGV4dHJhKSB7CiAgICB2YXIgcG9zaXRpb24gPSBkaXJlY3Rpb24gPT09ICd3aWR0aCcgPyBbJ0xlZnQnLCAnUmlnaHQnXSA6IFsnVG9wJywgJ0JvdHRvbSddOwogICAgcmV0dXJuIFswLCAxXS5yZWR1Y2UoZnVuY3Rpb24gKHByZXYsIF8sIGluZGV4KSB7CiAgICAgIHZhciBwcm9wID0gZXh0cmEgKyBwb3NpdGlvbltpbmRleF07CgogICAgICBpZiAoZXh0cmEgPT09ICdib3JkZXInKSB7CiAgICAgICAgcHJvcCArPSAnV2lkdGgnOwogICAgICB9CgogICAgICByZXR1cm4gcHJldiArIHBhcnNlRmxvYXQoZ2V0Q29tcHV0ZWRTdHlsZVZhbHVlKGVsZW1lbnQsIHByb3ApIHx8ICcwJyk7CiAgICB9LCAwKTsKICB9CiAgLyoqDQogICAqIOiOt+WPluWFg+e0oOeahOagt+W8j+WAvO+8jOWvuSB3aWR0aCDlkowgaGVpZ2h0IOi/m+ihjOi/h+WkhOeQhg0KICAgKiBAcGFyYW0gZWxlbWVudA0KICAgKiBAcGFyYW0gbmFtZQ0KICAgKi8KCgogIGZ1bmN0aW9uIGdldFN0eWxlKGVsZW1lbnQsIG5hbWUpIHsKICAgIC8vIHdpZHRo44CBaGVpZ2h0IOWxnuaAp+S9v+eUqCBnZXRDb21wdXRlZFN0eWxlIOW+l+WIsOeahOWAvOS4jeWHhuehru+8jOmcgOimgeS9v+eUqCBnZXRCb3VuZGluZ0NsaWVudFJlY3Qg6I635Y+WCiAgICBpZiAobmFtZSA9PT0gJ3dpZHRoJyB8fCBuYW1lID09PSAnaGVpZ2h0JykgewogICAgICB2YXIgdmFsdWVOdW1iZXIgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpW25hbWVdOwoKICAgICAgaWYgKGlzQm9yZGVyQm94KGVsZW1lbnQpKSB7CiAgICAgICAgcmV0dXJuIHZhbHVlTnVtYmVyICsgInB4IjsKICAgICAgfQoKICAgICAgcmV0dXJuIHZhbHVlTnVtYmVyIC0gZ2V0RXh0cmFXaWR0aChlbGVtZW50LCBuYW1lLCAnYm9yZGVyJykgLSBnZXRFeHRyYVdpZHRoKGVsZW1lbnQsIG5hbWUsICdwYWRkaW5nJykgKyAicHgiOwogICAgfQoKICAgIHJldHVybiBnZXRDb21wdXRlZFN0eWxlVmFsdWUoZWxlbWVudCwgbmFtZSk7CiAgfQogIC8qKg0KICAgKiDojrflj5blrZDoioLngrnnu4TmiJDnmoTmlbDnu4QNCiAgICogQHBhcmFtIHRhcmdldA0KICAgKiBAcGFyYW0gcGFyZW50DQogICAqLwoKCiAgZnVuY3Rpb24gZ2V0Q2hpbGROb2Rlc0FycmF5KHRhcmdldCwgcGFyZW50KSB7CiAgICB2YXIgdGVtcFBhcmVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQocGFyZW50KTsKICAgIHRlbXBQYXJlbnQuaW5uZXJIVE1MID0gdGFyZ2V0OwogICAgcmV0dXJuIFtdLnNsaWNlLmNhbGwodGVtcFBhcmVudC5jaGlsZE5vZGVzKTsKICB9CiAgLyoqDQogICAqIOWni+e7iOi/lOWbniBmYWxzZSDnmoTlh73mlbANCiAgICovCgoKICBmdW5jdGlvbiByZXR1cm5GYWxzZSgpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgLyoqDQogICAqIOaVsOWAvOWNleS9jeeahCBDU1Mg5bGe5oCnDQogICAqLwoKCiAgdmFyIGNzc051bWJlciA9IFsnYW5pbWF0aW9uSXRlcmF0aW9uQ291bnQnLCAnY29sdW1uQ291bnQnLCAnZmlsbE9wYWNpdHknLCAnZmxleEdyb3cnLCAnZmxleFNocmluaycsICdmb250V2VpZ2h0JywgJ2dyaWRBcmVhJywgJ2dyaWRDb2x1bW4nLCAnZ3JpZENvbHVtbkVuZCcsICdncmlkQ29sdW1uU3RhcnQnLCAnZ3JpZFJvdycsICdncmlkUm93RW5kJywgJ2dyaWRSb3dTdGFydCcsICdsaW5lSGVpZ2h0JywgJ29wYWNpdHknLCAnb3JkZXInLCAnb3JwaGFucycsICd3aWRvd3MnLCAnekluZGV4JywgJ3pvb20nXTsKCiAgZnVuY3Rpb24gZWFjaCh0YXJnZXQsIGNhbGxiYWNrKSB7CiAgICBpZiAoaXNBcnJheUxpa2UodGFyZ2V0KSkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhcmdldC5sZW5ndGg7IGkgKz0gMSkgewogICAgICAgIGlmIChjYWxsYmFjay5jYWxsKHRhcmdldFtpXSwgaSwgdGFyZ2V0W2ldKSA9PT0gZmFsc2UpIHsKICAgICAgICAgIHJldHVybiB0YXJnZXQ7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHRhcmdldCk7CgogICAgICBmb3IgKHZhciBpJDEgPSAwOyBpJDEgPCBrZXlzLmxlbmd0aDsgaSQxICs9IDEpIHsKICAgICAgICBpZiAoY2FsbGJhY2suY2FsbCh0YXJnZXRba2V5c1tpJDFdXSwga2V5c1tpJDFdLCB0YXJnZXRba2V5c1tpJDFdXSkgPT09IGZhbHNlKSB7CiAgICAgICAgICByZXR1cm4gdGFyZ2V0OwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiB0YXJnZXQ7CiAgfQogIC8qKg0KICAgKiDkuLrkuobkvb/nlKjmqKHlnZfmianlhYXvvIzov5nph4zkuI3og73kvb/nlKjpu5jorqTlr7zlh7oNCiAgICovCgoKICB2YXIgSlEgPSBmdW5jdGlvbiBKUShhcnIpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgdGhpcy5sZW5ndGggPSAwOwoKICAgIGlmICghYXJyKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIGVhY2goYXJyLCBmdW5jdGlvbiAoaSwgaXRlbSkgewogICAgICAvLyBAdHMtaWdub3JlCiAgICAgIHRoaXMkMVtpXSA9IGl0ZW07CiAgICB9KTsKICAgIHRoaXMubGVuZ3RoID0gYXJyLmxlbmd0aDsKICAgIHJldHVybiB0aGlzOwogIH07CgogIGZ1bmN0aW9uIGdldCQoKSB7CiAgICB2YXIgJCA9IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgICBpZiAoIXNlbGVjdG9yKSB7CiAgICAgICAgcmV0dXJuIG5ldyBKUSgpOwogICAgICB9IC8vIEpRCgoKICAgICAgaWYgKHNlbGVjdG9yIGluc3RhbmNlb2YgSlEpIHsKICAgICAgICByZXR1cm4gc2VsZWN0b3I7CiAgICAgIH0gLy8gZnVuY3Rpb24KCgogICAgICBpZiAoaXNGdW5jdGlvbihzZWxlY3RvcikpIHsKICAgICAgICBpZiAoL2NvbXBsZXRlfGxvYWRlZHxpbnRlcmFjdGl2ZS8udGVzdChkb2N1bWVudC5yZWFkeVN0YXRlKSAmJiBkb2N1bWVudC5ib2R5KSB7CiAgICAgICAgICBzZWxlY3Rvci5jYWxsKGRvY3VtZW50LCAkKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIHNlbGVjdG9yLmNhbGwoZG9jdW1lbnQsICQpOwogICAgICAgICAgfSwgZmFsc2UpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG5ldyBKUShbZG9jdW1lbnRdKTsKICAgICAgfSAvLyBTdHJpbmcKCgogICAgICBpZiAoaXNTdHJpbmcoc2VsZWN0b3IpKSB7CiAgICAgICAgdmFyIGh0bWwgPSBzZWxlY3Rvci50cmltKCk7IC8vIOagueaNriBIVE1MIOWtl+espuS4suWIm+W7uiBKUSDlr7nosaEKCiAgICAgICAgaWYgKGh0bWxbMF0gPT09ICc8JyAmJiBodG1sW2h0bWwubGVuZ3RoIC0gMV0gPT09ICc+JykgewogICAgICAgICAgdmFyIHRvQ3JlYXRlID0gJ2Rpdic7CiAgICAgICAgICB2YXIgdGFncyA9IHsKICAgICAgICAgICAgbGk6ICd1bCcsCiAgICAgICAgICAgIHRyOiAndGJvZHknLAogICAgICAgICAgICB0ZDogJ3RyJywKICAgICAgICAgICAgdGg6ICd0cicsCiAgICAgICAgICAgIHRib2R5OiAndGFibGUnLAogICAgICAgICAgICBvcHRpb246ICdzZWxlY3QnCiAgICAgICAgICB9OwogICAgICAgICAgZWFjaCh0YWdzLCBmdW5jdGlvbiAoY2hpbGRUYWcsIHBhcmVudFRhZykgewogICAgICAgICAgICBpZiAoaHRtbC5pbmRleE9mKCI8IiArIGNoaWxkVGFnKSA9PT0gMCkgewogICAgICAgICAgICAgIHRvQ3JlYXRlID0gcGFyZW50VGFnOwogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gbmV3IEpRKGdldENoaWxkTm9kZXNBcnJheShodG1sLCB0b0NyZWF0ZSkpOwogICAgICAgIH0gLy8g5qC55o2uIENTUyDpgInmi6nlmajliJvlu7ogSlEg5a+56LGhCgoKICAgICAgICB2YXIgaXNJZFNlbGVjdG9yID0gc2VsZWN0b3JbMF0gPT09ICcjJyAmJiAhc2VsZWN0b3IubWF0Y2goL1sgLjw+On5dLyk7CgogICAgICAgIGlmICghaXNJZFNlbGVjdG9yKSB7CiAgICAgICAgICByZXR1cm4gbmV3IEpRKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTsKICAgICAgICB9CgogICAgICAgIHZhciBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2VsZWN0b3Iuc2xpY2UoMSkpOwoKICAgICAgICBpZiAoZWxlbWVudCkgewogICAgICAgICAgcmV0dXJuIG5ldyBKUShbZWxlbWVudF0pOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG5ldyBKUSgpOwogICAgICB9CgogICAgICBpZiAoaXNBcnJheUxpa2Uoc2VsZWN0b3IpICYmICFpc05vZGUoc2VsZWN0b3IpKSB7CiAgICAgICAgcmV0dXJuIG5ldyBKUShzZWxlY3Rvcik7CiAgICAgIH0KCiAgICAgIHJldHVybiBuZXcgSlEoW3NlbGVjdG9yXSk7CiAgICB9OwoKICAgICQuZm4gPSBKUS5wcm90b3R5cGU7CiAgICByZXR1cm4gJDsKICB9CgogIHZhciAkID0gZ2V0JCgpOyAvLyDpgb/lhY3pobXpnaLliqDovb3lrozlkI7nm7TmjqXmiafooYxjc3PliqjnlLsKICAvLyBodHRwczovL2Nzcy10cmlja3MuY29tL3RyYW5zaXRpb25zLW9ubHktYWZ0ZXItcGFnZS1sb2FkLwoKICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiAkKCdib2R5JykuYWRkQ2xhc3MoJ21kdWktbG9hZGVkJyk7CiAgfSk7CiAgdmFyIG1kdWkgPSB7CiAgICAkOiAkCiAgfTsKCiAgJC5mbi5lYWNoID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICByZXR1cm4gZWFjaCh0aGlzLCBjYWxsYmFjayk7CiAgfTsKICAvKioNCiAgICog5qOA5p+lIGNvbnRhaW5lciDlhYPntKDlhoXmmK/lkKbljIXlkKsgY29udGFpbnMg5YWD57SgDQogICAqIEBwYXJhbSBjb250YWluZXIg54i25YWD57SgDQogICAqIEBwYXJhbSBjb250YWlucyDlrZDlhYPntKANCiAgICogQGV4YW1wbGUNCiAgYGBganMNCiAgY29udGFpbnMoIGRvY3VtZW50LCBkb2N1bWVudC5ib2R5ICk7IC8vIHRydWUNCiAgY29udGFpbnMoIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZXN0JyksIGRvY3VtZW50ICk7IC8vIGZhbHNlDQogIGNvbnRhaW5zKCAkKCcuY29udGFpbmVyJykuZ2V0KDApLCAkKCcuY29udGFpbnMnKS5nZXQoMCkgKTsgLy8gZmFsc2UNCiAgYGBgDQogICAqLwoKCiAgZnVuY3Rpb24gY29udGFpbnMoY29udGFpbmVyLCBjb250YWlucykgewogICAgcmV0dXJuIGNvbnRhaW5lciAhPT0gY29udGFpbnMgJiYgdG9FbGVtZW50KGNvbnRhaW5lcikuY29udGFpbnMoY29udGFpbnMpOwogIH0KICAvKioNCiAgICog5oqK56ys5LqM5Liq5pWw57uE55qE5YWD57Sg6L+95Yqg5Yiw56ys5LiA5Liq5pWw57uE5Lit77yM5bm26L+U5Zue5ZCI5bm25ZCO55qE5pWw57uEDQogICAqIEBwYXJhbSBmaXJzdCDnrKzkuIDkuKrmlbDnu4QNCiAgICogQHBhcmFtIHNlY29uZCDor6XmlbDnu4TnmoTlhYPntKDlsIbooqvov73liqDliLDnrKzkuIDkuKrmlbDnu4TkuK0NCiAgICogQGV4YW1wbGUNCiAgYGBganMNCiAgbWVyZ2UoIFsgMCwgMSwgMiBdLCBbIDIsIDMsIDQgXSApDQogIC8vIFsgMCwgMSwgMiwgMiwgMywgNCBdDQogIGBgYA0KICAgKi8KCgogIGZ1bmN0aW9uIG1lcmdlKGZpcnN0LCBzZWNvbmQpIHsKICAgIGVhY2goc2Vjb25kLCBmdW5jdGlvbiAoXywgdmFsdWUpIHsKICAgICAgZmlyc3QucHVzaCh2YWx1ZSk7CiAgICB9KTsKICAgIHJldHVybiBmaXJzdDsKICB9CgogICQuZm4uZ2V0ID0gZnVuY3Rpb24gKGluZGV4KSB7CiAgICByZXR1cm4gaW5kZXggPT09IHVuZGVmaW5lZCA/IFtdLnNsaWNlLmNhbGwodGhpcykgOiB0aGlzW2luZGV4ID49IDAgPyBpbmRleCA6IGluZGV4ICsgdGhpcy5sZW5ndGhdOwogIH07CgogICQuZm4uZmluZCA9IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgdmFyIGZvdW5kRWxlbWVudHMgPSBbXTsKICAgIHRoaXMuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICBtZXJnZShmb3VuZEVsZW1lbnRzLCAkKGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikpLmdldCgpKTsKICAgIH0pOwogICAgcmV0dXJuIG5ldyBKUShmb3VuZEVsZW1lbnRzKTsKICB9OyAvLyDlrZjlgqjkuovku7YKCgogIHZhciBoYW5kbGVycyA9IHt9OyAvLyDlhYPntKBJRAoKICB2YXIgbWR1aUVsZW1lbnRJZCA9IDE7CiAgLyoqDQogICAqIOS4uuWFg+e0oOi1i+S6iOS4gOS4quWUr+S4gOeahElEDQogICAqLwoKICBmdW5jdGlvbiBnZXRFbGVtZW50SWQoZWxlbWVudCkgewogICAgdmFyIGtleSA9ICdfbWR1aUV2ZW50SWQnOyAvLyBAdHMtaWdub3JlCgogICAgaWYgKCFlbGVtZW50W2tleV0pIHsKICAgICAgLy8gQHRzLWlnbm9yZQogICAgICBlbGVtZW50W2tleV0gPSArK21kdWlFbGVtZW50SWQ7CiAgICB9IC8vIEB0cy1pZ25vcmUKCgogICAgcmV0dXJuIGVsZW1lbnRba2V5XTsKICB9CiAgLyoqDQogICAqIOino+aekOS6i+S7tuWQjeS4reeahOWRveWQjeepuumXtA0KICAgKi8KCgogIGZ1bmN0aW9uIHBhcnNlKHR5cGUpIHsKICAgIHZhciBwYXJ0cyA9IHR5cGUuc3BsaXQoJy4nKTsKICAgIHJldHVybiB7CiAgICAgIHR5cGU6IHBhcnRzWzBdLAogICAgICBuczogcGFydHMuc2xpY2UoMSkuc29ydCgpLmpvaW4oJyAnKQogICAgfTsKICB9CiAgLyoqDQogICAqIOWRveWQjeepuumXtOWMuemFjeinhOWImQ0KICAgKi8KCgogIGZ1bmN0aW9uIG1hdGNoZXJGb3IobnMpIHsKICAgIHJldHVybiBuZXcgUmVnRXhwKCcoPzpefCApJyArIG5zLnJlcGxhY2UoJyAnLCAnIC4qID8nKSArICcoPzogfCQpJyk7CiAgfQogIC8qKg0KICAgKiDojrflj5bljLnphY3nmoTkuovku7YNCiAgICogQHBhcmFtIGVsZW1lbnQNCiAgICogQHBhcmFtIHR5cGUNCiAgICogQHBhcmFtIGZ1bmMNCiAgICogQHBhcmFtIHNlbGVjdG9yDQogICAqLwoKCiAgZnVuY3Rpb24gZ2V0SGFuZGxlcnMoZWxlbWVudCwgdHlwZSwgZnVuYywgc2VsZWN0b3IpIHsKICAgIHZhciBldmVudCA9IHBhcnNlKHR5cGUpOwogICAgcmV0dXJuIChoYW5kbGVyc1tnZXRFbGVtZW50SWQoZWxlbWVudCldIHx8IFtdKS5maWx0ZXIoZnVuY3Rpb24gKGhhbmRsZXIpIHsKICAgICAgcmV0dXJuIGhhbmRsZXIgJiYgKCFldmVudC50eXBlIHx8IGhhbmRsZXIudHlwZSA9PT0gZXZlbnQudHlwZSkgJiYgKCFldmVudC5ucyB8fCBtYXRjaGVyRm9yKGV2ZW50Lm5zKS50ZXN0KGhhbmRsZXIubnMpKSAmJiAoIWZ1bmMgfHwgZ2V0RWxlbWVudElkKGhhbmRsZXIuZnVuYykgPT09IGdldEVsZW1lbnRJZChmdW5jKSkgJiYgKCFzZWxlY3RvciB8fCBoYW5kbGVyLnNlbGVjdG9yID09PSBzZWxlY3Rvcik7CiAgICB9KTsKICB9CiAgLyoqDQogICAqIOa3u+WKoOS6i+S7tuebkeWQrA0KICAgKiBAcGFyYW0gZWxlbWVudA0KICAgKiBAcGFyYW0gdHlwZXMNCiAgICogQHBhcmFtIGZ1bmMNCiAgICogQHBhcmFtIGRhdGENCiAgICogQHBhcmFtIHNlbGVjdG9yDQogICAqLwoKCiAgZnVuY3Rpb24gYWRkKGVsZW1lbnQsIHR5cGVzLCBmdW5jLCBkYXRhLCBzZWxlY3RvcikgewogICAgdmFyIGVsZW1lbnRJZCA9IGdldEVsZW1lbnRJZChlbGVtZW50KTsKCiAgICBpZiAoIWhhbmRsZXJzW2VsZW1lbnRJZF0pIHsKICAgICAgaGFuZGxlcnNbZWxlbWVudElkXSA9IFtdOwogICAgfSAvLyDkvKDlhaUgZGF0YS51c2VDYXB0dXJlIOadpeiuvue9riB1c2VDYXB0dXJlOiB0cnVlCgoKICAgIHZhciB1c2VDYXB0dXJlID0gZmFsc2U7CgogICAgaWYgKGlzT2JqZWN0TGlrZShkYXRhKSAmJiBkYXRhLnVzZUNhcHR1cmUpIHsKICAgICAgdXNlQ2FwdHVyZSA9IHRydWU7CiAgICB9CgogICAgdHlwZXMuc3BsaXQoJyAnKS5mb3JFYWNoKGZ1bmN0aW9uICh0eXBlKSB7CiAgICAgIGlmICghdHlwZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGV2ZW50ID0gcGFyc2UodHlwZSk7CgogICAgICBmdW5jdGlvbiBjYWxsRm4oZSwgZWxlbSkgewogICAgICAgIC8vIOWboOS4uum8oOagh+S6i+S7tuaooeaLn+S6i+S7tueahCBkZXRhaWwg5bGe5oCn5piv5Y+q6K+755qE77yM5Zug5q2k5ZyoIGUuX2RldGFpbCDkuK3lrZjlgqjlj4LmlbAKICAgICAgICB2YXIgcmVzdWx0ID0gZnVuYy5hcHBseShlbGVtLCAvLyBAdHMtaWdub3JlCiAgICAgICAgZS5fZGV0YWlsID09PSB1bmRlZmluZWQgPyBbZV0gOiBbZV0uY29uY2F0KGUuX2RldGFpbCkpOwoKICAgICAgICBpZiAocmVzdWx0ID09PSBmYWxzZSkgewogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHByb3h5Rm4oZSkgewogICAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgICBpZiAoZS5fbnMgJiYgIW1hdGNoZXJGb3IoZS5fbnMpLnRlc3QoZXZlbnQubnMpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSAvLyBAdHMtaWdub3JlCgoKICAgICAgICBlLl9kYXRhID0gZGF0YTsKCiAgICAgICAgaWYgKHNlbGVjdG9yKSB7CiAgICAgICAgICAvLyDkuovku7bku6PnkIYKICAgICAgICAgICQoZWxlbWVudCkuZmluZChzZWxlY3RvcikuZ2V0KCkucmV2ZXJzZSgpLmZvckVhY2goZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgICAgICAgaWYgKGVsZW0gPT09IGUudGFyZ2V0IHx8IGNvbnRhaW5zKGVsZW0sIGUudGFyZ2V0KSkgewogICAgICAgICAgICAgIGNhbGxGbihlLCBlbGVtKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIOS4jeS9v+eUqOS6i+S7tuS7o+eQhgogICAgICAgICAgY2FsbEZuKGUsIGVsZW1lbnQpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdmFyIGhhbmRsZXIgPSB7CiAgICAgICAgdHlwZTogZXZlbnQudHlwZSwKICAgICAgICBuczogZXZlbnQubnMsCiAgICAgICAgZnVuYzogZnVuYywKICAgICAgICBzZWxlY3Rvcjogc2VsZWN0b3IsCiAgICAgICAgaWQ6IGhhbmRsZXJzW2VsZW1lbnRJZF0ubGVuZ3RoLAogICAgICAgIHByb3h5OiBwcm94eUZuCiAgICAgIH07CiAgICAgIGhhbmRsZXJzW2VsZW1lbnRJZF0ucHVzaChoYW5kbGVyKTsKICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGhhbmRsZXIudHlwZSwgcHJveHlGbiwgdXNlQ2FwdHVyZSk7CiAgICB9KTsKICB9CiAgLyoqDQogICAqIOenu+mZpOS6i+S7tuebkeWQrA0KICAgKiBAcGFyYW0gZWxlbWVudA0KICAgKiBAcGFyYW0gdHlwZXMNCiAgICogQHBhcmFtIGZ1bmMNCiAgICogQHBhcmFtIHNlbGVjdG9yDQogICAqLwoKCiAgZnVuY3Rpb24gcmVtb3ZlKGVsZW1lbnQsIHR5cGVzLCBmdW5jLCBzZWxlY3RvcikgewogICAgdmFyIGhhbmRsZXJzSW5FbGVtZW50ID0gaGFuZGxlcnNbZ2V0RWxlbWVudElkKGVsZW1lbnQpXSB8fCBbXTsKCiAgICB2YXIgcmVtb3ZlRXZlbnQgPSBmdW5jdGlvbiAoaGFuZGxlcikgewogICAgICBkZWxldGUgaGFuZGxlcnNJbkVsZW1lbnRbaGFuZGxlci5pZF07CiAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihoYW5kbGVyLnR5cGUsIGhhbmRsZXIucHJveHksIGZhbHNlKTsKICAgIH07CgogICAgaWYgKCF0eXBlcykgewogICAgICBoYW5kbGVyc0luRWxlbWVudC5mb3JFYWNoKGZ1bmN0aW9uIChoYW5kbGVyKSB7CiAgICAgICAgcmV0dXJuIHJlbW92ZUV2ZW50KGhhbmRsZXIpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIHR5cGVzLnNwbGl0KCcgJykuZm9yRWFjaChmdW5jdGlvbiAodHlwZSkgewogICAgICAgIGlmICh0eXBlKSB7CiAgICAgICAgICBnZXRIYW5kbGVycyhlbGVtZW50LCB0eXBlLCBmdW5jLCBzZWxlY3RvcikuZm9yRWFjaChmdW5jdGlvbiAoaGFuZGxlcikgewogICAgICAgICAgICByZXR1cm4gcmVtb3ZlRXZlbnQoaGFuZGxlcik7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KCiAgJC5mbi50cmlnZ2VyID0gZnVuY3Rpb24gKHR5cGUsIGV4dHJhUGFyYW1ldGVycykgewogICAgdmFyIGV2ZW50ID0gcGFyc2UodHlwZSk7CiAgICB2YXIgZXZlbnRPYmplY3Q7CiAgICB2YXIgZXZlbnRQYXJhbXMgPSB7CiAgICAgIGJ1YmJsZXM6IHRydWUsCiAgICAgIGNhbmNlbGFibGU6IHRydWUKICAgIH07CiAgICB2YXIgaXNNb3VzZUV2ZW50ID0gWydjbGljaycsICdtb3VzZWRvd24nLCAnbW91c2V1cCcsICdtb3VzZW1vdmUnXS5pbmRleE9mKGV2ZW50LnR5cGUpID4gLTE7CgogICAgaWYgKGlzTW91c2VFdmVudCkgewogICAgICAvLyBOb3RlOiBNb3VzZUV2ZW50IOaXoOazleS8oOWFpSBkZXRhaWwg5Y+C5pWwCiAgICAgIGV2ZW50T2JqZWN0ID0gbmV3IE1vdXNlRXZlbnQoZXZlbnQudHlwZSwgZXZlbnRQYXJhbXMpOwogICAgfSBlbHNlIHsKICAgICAgZXZlbnRQYXJhbXMuZGV0YWlsID0gZXh0cmFQYXJhbWV0ZXJzOwogICAgICBldmVudE9iamVjdCA9IG5ldyBDdXN0b21FdmVudChldmVudC50eXBlLCBldmVudFBhcmFtcyk7CiAgICB9IC8vIEB0cy1pZ25vcmUKCgogICAgZXZlbnRPYmplY3QuX2RldGFpbCA9IGV4dHJhUGFyYW1ldGVyczsgLy8gQHRzLWlnbm9yZQoKICAgIGV2ZW50T2JqZWN0Ll9ucyA9IGV2ZW50Lm5zOwogICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChldmVudE9iamVjdCk7CiAgICB9KTsKICB9OwoKICBmdW5jdGlvbiBleHRlbmQodGFyZ2V0LCBvYmplY3QxKSB7CiAgICB2YXIgb2JqZWN0TiA9IFtdLAogICAgICAgIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGggLSAyOwoKICAgIHdoaWxlIChsZW4tLSA+IDApIG9iamVjdE5bbGVuXSA9IGFyZ3VtZW50c1tsZW4gKyAyXTsKCiAgICBvYmplY3ROLnVuc2hpZnQob2JqZWN0MSk7CiAgICBlYWNoKG9iamVjdE4sIGZ1bmN0aW9uIChfLCBvYmplY3QpIHsKICAgICAgZWFjaChvYmplY3QsIGZ1bmN0aW9uIChwcm9wLCB2YWx1ZSkgewogICAgICAgIGlmICghaXNVbmRlZmluZWQodmFsdWUpKSB7CiAgICAgICAgICB0YXJnZXRbcHJvcF0gPSB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CiAgICByZXR1cm4gdGFyZ2V0OwogIH0KICAvKioNCiAgICog5bCG5pWw57uE5oiW5a+56LGh5bqP5YiX5YyW77yM5bqP5YiX5YyW5ZCO55qE5a2X56ym5Liy5Y+v5L2c5Li6IFVSTCDmn6Xor6LlrZfnrKbkuLLkvb/nlKgNCiAgICoNCiAgICog6Iul5Lyg5YWl5pWw57uE77yM5YiZ5qC85byP5b+F6aG75ZKMIHNlcmlhbGl6ZUFycmF5IOaWueazleeahOi/lOWbnuWAvOS4gOagtw0KICAgKiBAcGFyYW0gb2JqIOWvueixoeaIluaVsOe7hA0KICAgKiBAZXhhbXBsZQ0KICBgYGBqcw0KICBwYXJhbSh7IHdpZHRoOiAxNjgwLCBoZWlnaHQ6IDEwNTAgfSk7DQogIC8vIHdpZHRoPTE2ODAmaGVpZ2h0PTEwNTANCiAgYGBgDQogICAqIEBleGFtcGxlDQogIGBgYGpzDQogIHBhcmFtKHsgZm9vOiB7IG9uZTogMSwgdHdvOiAyIH19KQ0KICAvLyBmb29bb25lXT0xJmZvb1t0d29dPTINCiAgYGBgDQogICAqIEBleGFtcGxlDQogIGBgYGpzDQogIHBhcmFtKHtpZHM6IFsxLCAyLCAzXX0pDQogIC8vIGlkc1tdPTEmaWRzW109MiZpZHNbXT0zDQogIGBgYA0KICAgKiBAZXhhbXBsZQ0KICBgYGBqcw0KICBwYXJhbShbDQogICAgeyJuYW1lIjoibmFtZSIsInZhbHVlIjoibWR1aSJ9LA0KICAgIHsibmFtZSI6InBhc3N3b3JkIiwidmFsdWUiOiIxMjM0NTYifQ0KICBdKQ0KICAvLyBuYW1lPW1kdWkmcGFzc3dvcmQ9MTIzNDU2DQogIGBgYA0KICAgKi8KCgogIGZ1bmN0aW9uIHBhcmFtKG9iaikgewogICAgaWYgKCFpc09iamVjdExpa2Uob2JqKSAmJiAhQXJyYXkuaXNBcnJheShvYmopKSB7CiAgICAgIHJldHVybiAnJzsKICAgIH0KCiAgICB2YXIgYXJncyA9IFtdOwoKICAgIGZ1bmN0aW9uIGRlc3RydWN0dXJlKGtleSwgdmFsdWUpIHsKICAgICAgdmFyIGtleVRtcDsKCiAgICAgIGlmIChpc09iamVjdExpa2UodmFsdWUpKSB7CiAgICAgICAgZWFjaCh2YWx1ZSwgZnVuY3Rpb24gKGksIHYpIHsKICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSAmJiAhaXNPYmplY3RMaWtlKHYpKSB7CiAgICAgICAgICAgIGtleVRtcCA9ICcnOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAga2V5VG1wID0gaTsKICAgICAgICAgIH0KCiAgICAgICAgICBkZXN0cnVjdHVyZShrZXkgKyAiWyIgKyBrZXlUbXAgKyAiXSIsIHYpOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICh2YWx1ZSA9PSBudWxsIHx8IHZhbHVlID09PSAnJykgewogICAgICAgICAga2V5VG1wID0gJz0nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBrZXlUbXAgPSAiPSIgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpOwogICAgICAgIH0KCiAgICAgICAgYXJncy5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChrZXkpICsga2V5VG1wKTsKICAgICAgfQogICAgfQoKICAgIGlmIChBcnJheS5pc0FycmF5KG9iaikpIHsKICAgICAgZWFjaChvYmosIGZ1bmN0aW9uICgpIHsKICAgICAgICBkZXN0cnVjdHVyZSh0aGlzLm5hbWUsIHRoaXMudmFsdWUpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGVhY2gob2JqLCBkZXN0cnVjdHVyZSk7CiAgICB9CgogICAgcmV0dXJuIGFyZ3Muam9pbignJicpOwogIH0gLy8g5YWo5bGA6YWN572u5Y+C5pWwCgoKICB2YXIgZ2xvYmFsT3B0aW9ucyA9IHt9OyAvLyDlhajlsYDkuovku7blkI0KCiAgdmFyIGFqYXhFdmVudHMgPSB7CiAgICBhamF4U3RhcnQ6ICdzdGFydC5tZHVpLmFqYXgnLAogICAgYWpheFN1Y2Nlc3M6ICdzdWNjZXNzLm1kdWkuYWpheCcsCiAgICBhamF4RXJyb3I6ICdlcnJvci5tZHVpLmFqYXgnLAogICAgYWpheENvbXBsZXRlOiAnY29tcGxldGUubWR1aS5hamF4JwogIH07CiAgLyoqDQogICAqIOWIpOaWreatpOivt+axguaWueazleaYr+WQpumAmui/h+afpeivouWtl+espuS4suaPkOS6pOWPguaVsA0KICAgKiBAcGFyYW0gbWV0aG9kIOivt+axguaWueazle+8jOWkp+WGmQ0KICAgKi8KCiAgZnVuY3Rpb24gaXNRdWVyeVN0cmluZ0RhdGEobWV0aG9kKSB7CiAgICByZXR1cm4gWydHRVQnLCAnSEVBRCddLmluZGV4T2YobWV0aG9kKSA+PSAwOwogIH0KICAvKioNCiAgICog5re75Yqg5Y+C5pWw5YiwIFVSTCDkuIrvvIzkuJQgVVJMIOS4reS4jeWtmOWcqCA/IOaXtu+8jOiHquWKqOaKiuesrOS4gOS4qiAmIOabv+aNouS4uiA/DQogICAqIEBwYXJhbSB1cmwNCiAgICogQHBhcmFtIHF1ZXJ5DQogICAqLwoKCiAgZnVuY3Rpb24gYXBwZW5kUXVlcnkodXJsLCBxdWVyeSkgewogICAgcmV0dXJuICh1cmwgKyAiJiIgKyBxdWVyeSkucmVwbGFjZSgvWyY/XXsxLDJ9LywgJz8nKTsKICB9CiAgLyoqDQogICAqIOWQiOW5tuivt+axguWPguaVsO+8jOWPguaVsOS8mOWFiOe6p++8mm9wdGlvbnMgPiBnbG9iYWxPcHRpb25zID4gZGVmYXVsdHMNCiAgICogQHBhcmFtIG9wdGlvbnMNCiAgICovCgoKICBmdW5jdGlvbiBtZXJnZU9wdGlvbnMob3B0aW9ucykgewogICAgLy8g6buY6K6k5Y+C5pWwCiAgICB2YXIgZGVmYXVsdHMgPSB7CiAgICAgIHVybDogJycsCiAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgIGRhdGE6ICcnLAogICAgICBwcm9jZXNzRGF0YTogdHJ1ZSwKICAgICAgYXN5bmM6IHRydWUsCiAgICAgIGNhY2hlOiB0cnVlLAogICAgICB1c2VybmFtZTogJycsCiAgICAgIHBhc3N3b3JkOiAnJywKICAgICAgaGVhZGVyczoge30sCiAgICAgIHhockZpZWxkczoge30sCiAgICAgIHN0YXR1c0NvZGU6IHt9LAogICAgICBkYXRhVHlwZTogJ3RleHQnLAogICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsCiAgICAgIHRpbWVvdXQ6IDAsCiAgICAgIGdsb2JhbDogdHJ1ZQogICAgfTsgLy8gZ2xvYmFsT3B0aW9ucyDkuK3nmoTlm57osIPlh73mlbDkuI3lkIjlubYKCiAgICBlYWNoKGdsb2JhbE9wdGlvbnMsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICAgIHZhciBjYWxsYmFja3MgPSBbJ2JlZm9yZVNlbmQnLCAnc3VjY2VzcycsICdlcnJvcicsICdjb21wbGV0ZScsICdzdGF0dXNDb2RlJ107IC8vIEB0cy1pZ25vcmUKCiAgICAgIGlmIChjYWxsYmFja3MuaW5kZXhPZihrZXkpIDwgMCAmJiAhaXNVbmRlZmluZWQodmFsdWUpKSB7CiAgICAgICAgZGVmYXVsdHNba2V5XSA9IHZhbHVlOwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiBleHRlbmQoe30sIGRlZmF1bHRzLCBvcHRpb25zKTsKICB9CiAgLyoqDQogICAqIOWPkemAgSBhamF4IOivt+axgg0KICAgKiBAcGFyYW0gb3B0aW9ucw0KICAgKiBAZXhhbXBsZQ0KICBgYGBqcw0KICBhamF4KHsNCiAgICBtZXRob2Q6ICJQT1NUIiwNCiAgICB1cmw6ICJzb21lLnBocCIsDQogICAgZGF0YTogeyBuYW1lOiAiSm9obiIsIGxvY2F0aW9uOiAiQm9zdG9uIiB9DQogIH0pLnRoZW4oZnVuY3Rpb24oIG1zZyApIHsNCiAgICBhbGVydCggIkRhdGEgU2F2ZWQ6ICIgKyBtc2cgKTsNCiAgfSk7DQogIGBgYA0KICAgKi8KCgogIGZ1bmN0aW9uIGFqYXgob3B0aW9ucykgewogICAgLy8g5piv5ZCm5bey5Y+W5raI6K+35rGCCiAgICB2YXIgaXNDYW5jZWxlZCA9IGZhbHNlOyAvLyDkuovku7blj4LmlbAKCiAgICB2YXIgZXZlbnRQYXJhbXMgPSB7fTsgLy8g5Y+C5pWw5ZCI5bm2CgogICAgdmFyIG1lcmdlZE9wdGlvbnMgPSBtZXJnZU9wdGlvbnMob3B0aW9ucyk7CiAgICB2YXIgdXJsID0gbWVyZ2VkT3B0aW9ucy51cmwgfHwgd2luZG93LmxvY2F0aW9uLnRvU3RyaW5nKCk7CiAgICB2YXIgbWV0aG9kID0gbWVyZ2VkT3B0aW9ucy5tZXRob2QudG9VcHBlckNhc2UoKTsKICAgIHZhciBkYXRhID0gbWVyZ2VkT3B0aW9ucy5kYXRhOwogICAgdmFyIHByb2Nlc3NEYXRhID0gbWVyZ2VkT3B0aW9ucy5wcm9jZXNzRGF0YTsKICAgIHZhciBhc3luYyA9IG1lcmdlZE9wdGlvbnMuYXN5bmM7CiAgICB2YXIgY2FjaGUgPSBtZXJnZWRPcHRpb25zLmNhY2hlOwogICAgdmFyIHVzZXJuYW1lID0gbWVyZ2VkT3B0aW9ucy51c2VybmFtZTsKICAgIHZhciBwYXNzd29yZCA9IG1lcmdlZE9wdGlvbnMucGFzc3dvcmQ7CiAgICB2YXIgaGVhZGVycyA9IG1lcmdlZE9wdGlvbnMuaGVhZGVyczsKICAgIHZhciB4aHJGaWVsZHMgPSBtZXJnZWRPcHRpb25zLnhockZpZWxkczsKICAgIHZhciBzdGF0dXNDb2RlID0gbWVyZ2VkT3B0aW9ucy5zdGF0dXNDb2RlOwogICAgdmFyIGRhdGFUeXBlID0gbWVyZ2VkT3B0aW9ucy5kYXRhVHlwZTsKICAgIHZhciBjb250ZW50VHlwZSA9IG1lcmdlZE9wdGlvbnMuY29udGVudFR5cGU7CiAgICB2YXIgdGltZW91dCA9IG1lcmdlZE9wdGlvbnMudGltZW91dDsKICAgIHZhciBnbG9iYWwgPSBtZXJnZWRPcHRpb25zLmdsb2JhbDsgLy8g6ZyA6KaB5Y+R6YCB55qE5pWw5o2uCiAgICAvLyBHRVQvSEVBRCDor7fmsYLlkowgcHJvY2Vzc0RhdGEg5Li6IHRydWUg5pe277yM6L2s5o2i5Li65p+l6K+i5a2X56ym5Liy5qC85byP77yM54m55q6K5qC85byP5LiN6L2s5o2iCgogICAgaWYgKGRhdGEgJiYgKGlzUXVlcnlTdHJpbmdEYXRhKG1ldGhvZCkgfHwgcHJvY2Vzc0RhdGEpICYmICFpc1N0cmluZyhkYXRhKSAmJiAhKGRhdGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgJiYgIShkYXRhIGluc3RhbmNlb2YgQmxvYikgJiYgIShkYXRhIGluc3RhbmNlb2YgRG9jdW1lbnQpICYmICEoZGF0YSBpbnN0YW5jZW9mIEZvcm1EYXRhKSkgewogICAgICBkYXRhID0gcGFyYW0oZGF0YSk7CiAgICB9IC8vIOWvueS6jiBHRVTjgIFIRUFEIOexu+Wei+eahOivt+axgu+8jOaKiiBkYXRhIOaVsOaNrua3u+WKoOWIsCBVUkwg5LitCgoKICAgIGlmIChkYXRhICYmIGlzUXVlcnlTdHJpbmdEYXRhKG1ldGhvZCkpIHsKICAgICAgLy8g5p+l6K+i5a2X56ym5Liy5ou85o6l5YiwIFVSTCDkuK0KICAgICAgdXJsID0gYXBwZW5kUXVlcnkodXJsLCBkYXRhKTsKICAgICAgZGF0YSA9IG51bGw7CiAgICB9CiAgICAvKioNCiAgICAgKiDop6blj5Hkuovku7blkozlm57osIPlh73mlbANCiAgICAgKiBAcGFyYW0gZXZlbnQNCiAgICAgKiBAcGFyYW0gcGFyYW1zDQogICAgICogQHBhcmFtIGNhbGxiYWNrDQogICAgICogQHBhcmFtIGFyZ3MNCiAgICAgKi8KCgogICAgZnVuY3Rpb24gdHJpZ2dlcihldmVudCwgcGFyYW1zLCBjYWxsYmFjaykgewogICAgICB2YXIgYXJncyA9IFtdLAogICAgICAgICAgbGVuID0gYXJndW1lbnRzLmxlbmd0aCAtIDM7CgogICAgICB3aGlsZSAobGVuLS0gPiAwKSBhcmdzW2xlbl0gPSBhcmd1bWVudHNbbGVuICsgM107IC8vIOinpuWPkeWFqOWxgOS6i+S7tgoKCiAgICAgIGlmIChnbG9iYWwpIHsKICAgICAgICAkKGRvY3VtZW50KS50cmlnZ2VyKGV2ZW50LCBwYXJhbXMpOwogICAgICB9IC8vIOinpuWPkSBhamF4IOWbnuiwg+WSjOS6i+S7tgoKCiAgICAgIHZhciByZXN1bHQxOwogICAgICB2YXIgcmVzdWx0MjsKCiAgICAgIGlmIChjYWxsYmFjaykgewogICAgICAgIC8vIOWFqOWxgOWbnuiwgwogICAgICAgIGlmIChjYWxsYmFjayBpbiBnbG9iYWxPcHRpb25zKSB7CiAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICByZXN1bHQxID0gZ2xvYmFsT3B0aW9uc1tjYWxsYmFja10uYXBwbHkoZ2xvYmFsT3B0aW9ucywgYXJncyk7CiAgICAgICAgfSAvLyDoh6rlrprkuYnlm57osIMKCgogICAgICAgIGlmIChtZXJnZWRPcHRpb25zW2NhbGxiYWNrXSkgewogICAgICAgICAgLy8gQHRzLWlnbm9yZQogICAgICAgICAgcmVzdWx0MiA9IG1lcmdlZE9wdGlvbnNbY2FsbGJhY2tdLmFwcGx5KG1lcmdlZE9wdGlvbnMsIGFyZ3MpOwogICAgICAgIH0gLy8gYmVmb3JlU2VuZCDlm57osIPov5Tlm54gZmFsc2Ug5pe25Y+W5raIIGFqYXgg6K+35rGCCgoKICAgICAgICBpZiAoY2FsbGJhY2sgPT09ICdiZWZvcmVTZW5kJyAmJiAocmVzdWx0MSA9PT0gZmFsc2UgfHwgcmVzdWx0MiA9PT0gZmFsc2UpKSB7CiAgICAgICAgICBpc0NhbmNlbGVkID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gLy8gWE1MSHR0cFJlcXVlc3Qg6K+35rGCCgoKICAgIGZ1bmN0aW9uIFhIUigpIHsKICAgICAgdmFyIHRleHRTdGF0dXM7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgLy8gR0VUL0hFQUQg6K+35rGC55qE57yT5a2Y5aSE55CGCiAgICAgICAgaWYgKGlzUXVlcnlTdHJpbmdEYXRhKG1ldGhvZCkgJiYgIWNhY2hlKSB7CiAgICAgICAgICB1cmwgPSBhcHBlbmRRdWVyeSh1cmwsICJfPSIgKyBEYXRlLm5vdygpKTsKICAgICAgICB9IC8vIOWIm+W7uiBYSFIKCgogICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKICAgICAgICB4aHIub3BlbihtZXRob2QsIHVybCwgYXN5bmMsIHVzZXJuYW1lLCBwYXNzd29yZCk7CgogICAgICAgIGlmIChjb250ZW50VHlwZSB8fCBkYXRhICYmICFpc1F1ZXJ5U3RyaW5nRGF0YShtZXRob2QpICYmIGNvbnRlbnRUeXBlICE9PSBmYWxzZSkgewogICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScsIGNvbnRlbnRUeXBlKTsKICAgICAgICB9IC8vIOiuvue9riBBY2NlcHQKCgogICAgICAgIGlmIChkYXRhVHlwZSA9PT0gJ2pzb24nKSB7CiAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQWNjZXB0JywgJ2FwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCcpOwogICAgICAgIH0gLy8g5re75YqgIGhlYWRlcnMKCgogICAgICAgIGlmIChoZWFkZXJzKSB7CiAgICAgICAgICBlYWNoKGhlYWRlcnMsIGZ1bmN0aW9uIChrZXksIHZhbHVlKSB7CiAgICAgICAgICAgIC8vIHVuZGVmaW5lZCDlgLzkuI3lj5HpgIHvvIxzdHJpbmcg5ZKMIG51bGwg6ZyA6KaB5Y+R6YCBCiAgICAgICAgICAgIGlmICghaXNVbmRlZmluZWQodmFsdWUpKSB7CiAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoa2V5LCB2YWx1ZSArICcnKTsgLy8g5oqKIG51bGwg6L2s5o2i5oiQ5a2X56ym5LiyCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gLy8g5qOA5p+l5piv5ZCm5piv6Leo5Z+f6K+35rGC77yM6Leo5Z+f6K+35rGC5pe25LiN5re75YqgIFgtUmVxdWVzdGVkLVdpdGgKCgogICAgICAgIHZhciBjcm9zc0RvbWFpbiA9IC9eKFtcdy1dKzopP1wvXC8oW14vXSspLy50ZXN0KHVybCkgJiYgUmVnRXhwLiQyICE9PSB3aW5kb3cubG9jYXRpb24uaG9zdDsKCiAgICAgICAgaWYgKCFjcm9zc0RvbWFpbikgewogICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ1gtUmVxdWVzdGVkLVdpdGgnLCAnWE1MSHR0cFJlcXVlc3QnKTsKICAgICAgICB9CgogICAgICAgIGlmICh4aHJGaWVsZHMpIHsKICAgICAgICAgIGVhY2goeGhyRmllbGRzLCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICAgIHhocltrZXldID0gdmFsdWU7CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGV2ZW50UGFyYW1zLnhociA9IHhocjsKICAgICAgICBldmVudFBhcmFtcy5vcHRpb25zID0gbWVyZ2VkT3B0aW9uczsKICAgICAgICB2YXIgeGhyVGltZW91dDsKCiAgICAgICAgeGhyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmICh4aHJUaW1lb3V0KSB7CiAgICAgICAgICAgIGNsZWFyVGltZW91dCh4aHJUaW1lb3V0KTsKICAgICAgICAgIH0gLy8gQUpBWCDov5Tlm57nmoQgSFRUUCDlk43lupTnoIHmmK/lkKbooajnpLrmiJDlip8KCgogICAgICAgICAgdmFyIGlzSHR0cFN0YXR1c1N1Y2Nlc3MgPSB4aHIuc3RhdHVzID49IDIwMCAmJiB4aHIuc3RhdHVzIDwgMzAwIHx8IHhoci5zdGF0dXMgPT09IDMwNCB8fCB4aHIuc3RhdHVzID09PSAwOwogICAgICAgICAgdmFyIHJlc3BvbnNlRGF0YTsKCiAgICAgICAgICBpZiAoaXNIdHRwU3RhdHVzU3VjY2VzcykgewogICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA9PT0gMjA0IHx8IG1ldGhvZCA9PT0gJ0hFQUQnKSB7CiAgICAgICAgICAgICAgdGV4dFN0YXR1cyA9ICdub2NvbnRlbnQnOwogICAgICAgICAgICB9IGVsc2UgaWYgKHhoci5zdGF0dXMgPT09IDMwNCkgewogICAgICAgICAgICAgIHRleHRTdGF0dXMgPSAnbm90bW9kaWZpZWQnOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRleHRTdGF0dXMgPSAnc3VjY2Vzcyc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChkYXRhVHlwZSA9PT0gJ2pzb24nKSB7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJlc3BvbnNlRGF0YSA9IG1ldGhvZCA9PT0gJ0hFQUQnID8gdW5kZWZpbmVkIDogSlNPTi5wYXJzZSh4aHIucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICAgIGV2ZW50UGFyYW1zLmRhdGEgPSByZXNwb25zZURhdGE7CiAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICB0ZXh0U3RhdHVzID0gJ3BhcnNlcmVycm9yJzsKICAgICAgICAgICAgICAgIHRyaWdnZXIoYWpheEV2ZW50cy5hamF4RXJyb3IsIGV2ZW50UGFyYW1zLCAnZXJyb3InLCB4aHIsIHRleHRTdGF0dXMpOwogICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcih0ZXh0U3RhdHVzKSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAodGV4dFN0YXR1cyAhPT0gJ3BhcnNlcmVycm9yJykgewogICAgICAgICAgICAgICAgdHJpZ2dlcihhamF4RXZlbnRzLmFqYXhTdWNjZXNzLCBldmVudFBhcmFtcywgJ3N1Y2Nlc3MnLCByZXNwb25zZURhdGEsIHRleHRTdGF0dXMsIHhocik7CiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlRGF0YSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJlc3BvbnNlRGF0YSA9IG1ldGhvZCA9PT0gJ0hFQUQnID8gdW5kZWZpbmVkIDogeGhyLnJlc3BvbnNlVHlwZSA9PT0gJ3RleHQnIHx8IHhoci5yZXNwb25zZVR5cGUgPT09ICcnID8geGhyLnJlc3BvbnNlVGV4dCA6IHhoci5yZXNwb25zZTsKICAgICAgICAgICAgICBldmVudFBhcmFtcy5kYXRhID0gcmVzcG9uc2VEYXRhOwogICAgICAgICAgICAgIHRyaWdnZXIoYWpheEV2ZW50cy5hamF4U3VjY2VzcywgZXZlbnRQYXJhbXMsICdzdWNjZXNzJywgcmVzcG9uc2VEYXRhLCB0ZXh0U3RhdHVzLCB4aHIpOwogICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2VEYXRhKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGV4dFN0YXR1cyA9ICdlcnJvcic7CiAgICAgICAgICAgIHRyaWdnZXIoYWpheEV2ZW50cy5hamF4RXJyb3IsIGV2ZW50UGFyYW1zLCAnZXJyb3InLCB4aHIsIHRleHRTdGF0dXMpOwogICAgICAgICAgICByZWplY3QobmV3IEVycm9yKHRleHRTdGF0dXMpKTsKICAgICAgICAgIH0gLy8gc3RhdHVzQ29kZQoKCiAgICAgICAgICBlYWNoKFtnbG9iYWxPcHRpb25zLnN0YXR1c0NvZGUsIHN0YXR1c0NvZGVdLCBmdW5jdGlvbiAoXywgZnVuYykgewogICAgICAgICAgICBpZiAoZnVuYyAmJiBmdW5jW3hoci5zdGF0dXNdKSB7CiAgICAgICAgICAgICAgaWYgKGlzSHR0cFN0YXR1c1N1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgIGZ1bmNbeGhyLnN0YXR1c10ocmVzcG9uc2VEYXRhLCB0ZXh0U3RhdHVzLCB4aHIpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBmdW5jW3hoci5zdGF0dXNdKHhociwgdGV4dFN0YXR1cyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIHRyaWdnZXIoYWpheEV2ZW50cy5hamF4Q29tcGxldGUsIGV2ZW50UGFyYW1zLCAnY29tcGxldGUnLCB4aHIsIHRleHRTdGF0dXMpOwogICAgICAgIH07CgogICAgICAgIHhoci5vbmVycm9yID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKHhoclRpbWVvdXQpIHsKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHhoclRpbWVvdXQpOwogICAgICAgICAgfQoKICAgICAgICAgIHRyaWdnZXIoYWpheEV2ZW50cy5hamF4RXJyb3IsIGV2ZW50UGFyYW1zLCAnZXJyb3InLCB4aHIsIHhoci5zdGF0dXNUZXh0KTsKICAgICAgICAgIHRyaWdnZXIoYWpheEV2ZW50cy5hamF4Q29tcGxldGUsIGV2ZW50UGFyYW1zLCAnY29tcGxldGUnLCB4aHIsICdlcnJvcicpOwogICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcih4aHIuc3RhdHVzVGV4dCkpOwogICAgICAgIH07CgogICAgICAgIHhoci5vbmFib3J0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIHN0YXR1c1RleHQgPSAnYWJvcnQnOwoKICAgICAgICAgIGlmICh4aHJUaW1lb3V0KSB7CiAgICAgICAgICAgIHN0YXR1c1RleHQgPSAndGltZW91dCc7CiAgICAgICAgICAgIGNsZWFyVGltZW91dCh4aHJUaW1lb3V0KTsKICAgICAgICAgIH0KCiAgICAgICAgICB0cmlnZ2VyKGFqYXhFdmVudHMuYWpheEVycm9yLCBldmVudFBhcmFtcywgJ2Vycm9yJywgeGhyLCBzdGF0dXNUZXh0KTsKICAgICAgICAgIHRyaWdnZXIoYWpheEV2ZW50cy5hamF4Q29tcGxldGUsIGV2ZW50UGFyYW1zLCAnY29tcGxldGUnLCB4aHIsIHN0YXR1c1RleHQpOwogICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihzdGF0dXNUZXh0KSk7CiAgICAgICAgfTsgLy8gYWpheCBzdGFydCDlm57osIMKCgogICAgICAgIHRyaWdnZXIoYWpheEV2ZW50cy5hamF4U3RhcnQsIGV2ZW50UGFyYW1zLCAnYmVmb3JlU2VuZCcsIHhocik7CgogICAgICAgIGlmIChpc0NhbmNlbGVkKSB7CiAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdjYW5jZWwnKSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSAvLyBUaW1lb3V0CgoKICAgICAgICBpZiAodGltZW91dCA+IDApIHsKICAgICAgICAgIHhoclRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgeGhyLmFib3J0KCk7CiAgICAgICAgICB9LCB0aW1lb3V0KTsKICAgICAgICB9IC8vIOWPkemAgSBYSFIKCgogICAgICAgIHhoci5zZW5kKGRhdGEpOwogICAgICB9KTsKICAgIH0KCiAgICByZXR1cm4gWEhSKCk7CiAgfQoKICAkLmFqYXggPSBhamF4OwogIC8qKg0KICAgKiDkuLogQWpheCDor7fmsYLorr7nva7lhajlsYDphY3nva7lj4LmlbANCiAgICogQHBhcmFtIG9wdGlvbnMg6ZSu5YC85a+55Y+C5pWwDQogICAqIEBleGFtcGxlDQogIGBgYGpzDQogIGFqYXhTZXR1cCh7DQogICAgZGF0YVR5cGU6ICdqc29uJywNCiAgICBtZXRob2Q6ICdQT1NUJywNCiAgfSk7DQogIGBgYA0KICAgKi8KCiAgZnVuY3Rpb24gYWpheFNldHVwKG9wdGlvbnMpIHsKICAgIHJldHVybiBleHRlbmQoZ2xvYmFsT3B0aW9ucywgb3B0aW9ucyk7CiAgfQoKICAkLmFqYXhTZXR1cCA9IGFqYXhTZXR1cDsKICAkLmNvbnRhaW5zID0gY29udGFpbnM7CiAgdmFyIGRhdGFOUyA9ICdfbWR1aUVsZW1lbnREYXRhU3RvcmFnZSc7CiAgLyoqDQogICAqIOWcqOWFg+e0oOS4iuiuvue9rumUruWAvOWvueaVsOaNrg0KICAgKiBAcGFyYW0gZWxlbWVudA0KICAgKiBAcGFyYW0gb2JqZWN0DQogICAqLwoKICBmdW5jdGlvbiBzZXRPYmplY3RUb0VsZW1lbnQoZWxlbWVudCwgb2JqZWN0KSB7CiAgICAvLyBAdHMtaWdub3JlCiAgICBpZiAoIWVsZW1lbnRbZGF0YU5TXSkgewogICAgICAvLyBAdHMtaWdub3JlCiAgICAgIGVsZW1lbnRbZGF0YU5TXSA9IHt9OwogICAgfQoKICAgIGVhY2gob2JqZWN0LCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgICAvLyBAdHMtaWdub3JlCiAgICAgIGVsZW1lbnRbZGF0YU5TXVt0b0NhbWVsQ2FzZShrZXkpXSA9IHZhbHVlOwogICAgfSk7CiAgfQoKICBmdW5jdGlvbiBkYXRhKGVsZW1lbnQsIGtleSwgdmFsdWUpIHsKICAgIHZhciBvYmo7IC8vIOagueaNrumUruWAvOWvueiuvue9ruWAvAogICAgLy8gZGF0YShlbGVtZW50LCB7ICdrZXknIDogJ3ZhbHVlJyB9KQoKICAgIGlmIChpc09iamVjdExpa2Uoa2V5KSkgewogICAgICBzZXRPYmplY3RUb0VsZW1lbnQoZWxlbWVudCwga2V5KTsKICAgICAgcmV0dXJuIGtleTsKICAgIH0gLy8g5qC55o2uIGtleeOAgXZhbHVlIOiuvue9ruWAvAogICAgLy8gZGF0YShlbGVtZW50LCAna2V5JywgJ3ZhbHVlJykKCgogICAgaWYgKCFpc1VuZGVmaW5lZCh2YWx1ZSkpIHsKICAgICAgc2V0T2JqZWN0VG9FbGVtZW50KGVsZW1lbnQsIChvYmogPSB7fSwgb2JqW2tleV0gPSB2YWx1ZSwgb2JqKSk7CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH0gLy8g6I635Y+W5omA5pyJ5YC8CiAgICAvLyBkYXRhKGVsZW1lbnQpCgoKICAgIGlmIChpc1VuZGVmaW5lZChrZXkpKSB7CiAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgcmV0dXJuIGVsZW1lbnRbZGF0YU5TXSA/IGVsZW1lbnRbZGF0YU5TXSA6IHt9OwogICAgfSAvLyDku44gZGF0YU5TIOS4reiOt+WPluaMh+WumuWAvAogICAgLy8gZGF0YShlbGVtZW50LCAna2V5JykKCgogICAga2V5ID0gdG9DYW1lbENhc2Uoa2V5KTsgLy8gQHRzLWlnbm9yZQoKICAgIGlmIChlbGVtZW50W2RhdGFOU10gJiYga2V5IGluIGVsZW1lbnRbZGF0YU5TXSkgewogICAgICAvLyBAdHMtaWdub3JlCiAgICAgIHJldHVybiBlbGVtZW50W2RhdGFOU11ba2V5XTsKICAgIH0KCiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KCiAgJC5kYXRhID0gZGF0YTsKICAkLmVhY2ggPSBlYWNoOwoKICAkLmV4dGVuZCA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgdmFyIG9iamVjdE4gPSBbXSwKICAgICAgICBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOwoKICAgIHdoaWxlIChsZW4tLSkgb2JqZWN0TltsZW5dID0gYXJndW1lbnRzW2xlbl07CgogICAgaWYgKG9iamVjdE4ubGVuZ3RoID09PSAxKSB7CiAgICAgIGVhY2gob2JqZWN0TlswXSwgZnVuY3Rpb24gKHByb3AsIHZhbHVlKSB7CiAgICAgICAgdGhpcyQxW3Byb3BdID0gdmFsdWU7CiAgICAgIH0pOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICByZXR1cm4gZXh0ZW5kLmFwcGx5KHZvaWQgMCwgW29iamVjdE4uc2hpZnQoKSwgb2JqZWN0Ti5zaGlmdCgpXS5jb25jYXQob2JqZWN0TikpOwogIH07CgogIGZ1bmN0aW9uIG1hcChlbGVtZW50cywgY2FsbGJhY2spIHsKICAgIHZhciByZWY7CiAgICB2YXIgdmFsdWU7CiAgICB2YXIgcmV0ID0gW107CiAgICBlYWNoKGVsZW1lbnRzLCBmdW5jdGlvbiAoaSwgZWxlbWVudCkgewogICAgICB2YWx1ZSA9IGNhbGxiYWNrLmNhbGwod2luZG93LCBlbGVtZW50LCBpKTsKCiAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSB7CiAgICAgICAgcmV0LnB1c2godmFsdWUpOwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiAocmVmID0gW10pLmNvbmNhdC5hcHBseShyZWYsIHJldCk7CiAgfQoKICAkLm1hcCA9IG1hcDsKICAkLm1lcmdlID0gbWVyZ2U7CiAgJC5wYXJhbSA9IHBhcmFtOwogIC8qKg0KICAgKiDnp7vpmaTmjIflrprlhYPntKDkuIrlrZjmlL7nmoTmlbDmja4NCiAgICogQHBhcmFtIGVsZW1lbnQg5a2Y5pS+5pWw5o2u55qE5YWD57SgDQogICAqIEBwYXJhbSBuYW1lDQogICAqIOaVsOaNrumUruWQjQ0KICAgKg0KICAgKiDoi6XmnKrmjIflrprplK7lkI3vvIzlsIbnp7vpmaTlhYPntKDkuIrmiYDmnInmlbDmja4NCiAgICoNCiAgICog5aSa5Liq6ZSu5ZCN5Y+v5Lul55So56m65qC85YiG6ZqU77yM5oiW6ICF55So5pWw57uE6KGo56S65aSa5Liq6ZSu5ZCNDQogICAgQGV4YW1wbGUNCiAgYGBganMNCiAgLy8g56e76Zmk5YWD57Sg5LiK6ZSu5ZCN5Li6IG5hbWUg55qE5pWw5o2uDQogIHJlbW92ZURhdGEoZG9jdW1lbnQuYm9keSwgJ25hbWUnKTsNCiAgYGBgDQogICAqIEBleGFtcGxlDQogIGBgYGpzDQogIC8vIOenu+mZpOWFg+e0oOS4iumUruWQjeS4uiBuYW1lMSDlkowgbmFtZTIg55qE5pWw5o2uDQogIHJlbW92ZURhdGEoZG9jdW1lbnQuYm9keSwgJ25hbWUxIG5hbWUyJyk7DQogIGBgYA0KICAgKiBAZXhhbXBsZQ0KICBgYGBqcw0KICAvLyDnp7vpmaTlhYPntKDkuIrplK7lkI3kuLogbmFtZTEg5ZKMIG5hbWUyIOeahOaVsOaNrg0KICByZW1vdmVEYXRhKGRvY3VtZW50LmJvZHksIFsnbmFtZTEnLCAnbmFtZTInXSk7DQogIGBgYA0KICAgKiBAZXhhbXBsZQ0KICBgYGBqcw0KICAvLyDnp7vpmaTlhYPntKDkuIrmiYDmnInmlbDmja4NCiAgcmVtb3ZlRGF0YShkb2N1bWVudC5ib2R5KTsNCiAgYGBgDQogICAqLwoKICBmdW5jdGlvbiByZW1vdmVEYXRhKGVsZW1lbnQsIG5hbWUpIHsKICAgIC8vIEB0cy1pZ25vcmUKICAgIGlmICghZWxlbWVudFtkYXRhTlNdKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgcmVtb3ZlID0gZnVuY3Rpb24gKG5hbWVJdGVtKSB7CiAgICAgIG5hbWVJdGVtID0gdG9DYW1lbENhc2UobmFtZUl0ZW0pOyAvLyBAdHMtaWdub3JlCgogICAgICBpZiAoZWxlbWVudFtkYXRhTlNdW25hbWVJdGVtXSkgewogICAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgICBlbGVtZW50W2RhdGFOU11bbmFtZUl0ZW1dID0gbnVsbDsgLy8gQHRzLWlnbm9yZQoKICAgICAgICBkZWxldGUgZWxlbWVudFtkYXRhTlNdW25hbWVJdGVtXTsKICAgICAgfQogICAgfTsKCiAgICBpZiAoaXNVbmRlZmluZWQobmFtZSkpIHsKICAgICAgLy8gQHRzLWlnbm9yZQogICAgICBlbGVtZW50W2RhdGFOU10gPSBudWxsOyAvLyBAdHMtaWdub3JlCgogICAgICBkZWxldGUgZWxlbWVudFtkYXRhTlNdOyAvLyBAdHMtaWdub3JlCiAgICB9IGVsc2UgaWYgKGlzU3RyaW5nKG5hbWUpKSB7CiAgICAgIG5hbWUuc3BsaXQoJyAnKS5maWx0ZXIoZnVuY3Rpb24gKG5hbWVJdGVtKSB7CiAgICAgICAgcmV0dXJuIG5hbWVJdGVtOwogICAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lSXRlbSkgewogICAgICAgIHJldHVybiByZW1vdmUobmFtZUl0ZW0pOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGVhY2gobmFtZSwgZnVuY3Rpb24gKF8sIG5hbWVJdGVtKSB7CiAgICAgICAgcmV0dXJuIHJlbW92ZShuYW1lSXRlbSk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgJC5yZW1vdmVEYXRhID0gcmVtb3ZlRGF0YTsKICAvKioNCiAgICog6L+H5ruk5o6J5pWw57uE5Lit55qE6YeN5aSN5YWD57SgDQogICAqIEBwYXJhbSBhcnIg5pWw57uEDQogICAqIEBleGFtcGxlDQogIGBgYGpzDQogIHVuaXF1ZShbMSwgMiwgMTIsIDMsIDIsIDEsIDIsIDEsIDFdKTsNCiAgLy8gWzEsIDIsIDEyLCAzXQ0KICBgYGANCiAgICovCgogIGZ1bmN0aW9uIHVuaXF1ZShhcnIpIHsKICAgIHZhciByZXN1bHQgPSBbXTsKICAgIGVhY2goYXJyLCBmdW5jdGlvbiAoXywgdmFsKSB7CiAgICAgIGlmIChyZXN1bHQuaW5kZXhPZih2YWwpID09PSAtMSkgewogICAgICAgIHJlc3VsdC5wdXNoKHZhbCk7CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIHJlc3VsdDsKICB9CgogICQudW5pcXVlID0gdW5pcXVlOwoKICAkLmZuLmFkZCA9IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgcmV0dXJuIG5ldyBKUSh1bmlxdWUobWVyZ2UodGhpcy5nZXQoKSwgJChzZWxlY3RvcikuZ2V0KCkpKSk7CiAgfTsKCiAgZWFjaChbJ2FkZCcsICdyZW1vdmUnLCAndG9nZ2xlJ10sIGZ1bmN0aW9uIChfLCBuYW1lKSB7CiAgICAkLmZuW25hbWUgKyAiQ2xhc3MiXSA9IGZ1bmN0aW9uIChjbGFzc05hbWUpIHsKICAgICAgaWYgKG5hbWUgPT09ICdyZW1vdmUnICYmICFhcmd1bWVudHMubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJycpOwogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChpLCBlbGVtZW50KSB7CiAgICAgICAgaWYgKCFpc0VsZW1lbnQoZWxlbWVudCkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHZhciBjbGFzc2VzID0gKGlzRnVuY3Rpb24oY2xhc3NOYW1lKSA/IGNsYXNzTmFtZS5jYWxsKGVsZW1lbnQsIGksIGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdjbGFzcycpIHx8ICcnKSA6IGNsYXNzTmFtZSkuc3BsaXQoJyAnKS5maWx0ZXIoZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgICAgIHJldHVybiBuYW1lOwogICAgICAgIH0pOwogICAgICAgIGVhY2goY2xhc3NlcywgZnVuY3Rpb24gKF8sIGNscykgewogICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3RbbmFtZV0oY2xzKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9OwogIH0pOwogIGVhY2goWydpbnNlcnRCZWZvcmUnLCAnaW5zZXJ0QWZ0ZXInXSwgZnVuY3Rpb24gKG5hbWVJbmRleCwgbmFtZSkgewogICAgJC5mbltuYW1lXSA9IGZ1bmN0aW9uICh0YXJnZXQpIHsKICAgICAgdmFyICRlbGVtZW50ID0gbmFtZUluZGV4ID8gJCh0aGlzLmdldCgpLnJldmVyc2UoKSkgOiB0aGlzOyAvLyDpobrluo/lkowgalF1ZXJ5IOS/neaMgeS4gOiHtAoKICAgICAgdmFyICR0YXJnZXQgPSAkKHRhcmdldCk7CiAgICAgIHZhciByZXN1bHQgPSBbXTsKICAgICAgJHRhcmdldC5lYWNoKGZ1bmN0aW9uIChpbmRleCwgdGFyZ2V0KSB7CiAgICAgICAgaWYgKCF0YXJnZXQucGFyZW50Tm9kZSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgJGVsZW1lbnQuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICAgICAgdmFyIG5ld0l0ZW0gPSBpbmRleCA/IGVsZW1lbnQuY2xvbmVOb2RlKHRydWUpIDogZWxlbWVudDsKICAgICAgICAgIHZhciBleGlzdGluZ0l0ZW0gPSBuYW1lSW5kZXggPyB0YXJnZXQubmV4dFNpYmxpbmcgOiB0YXJnZXQ7CiAgICAgICAgICByZXN1bHQucHVzaChuZXdJdGVtKTsKICAgICAgICAgIHRhcmdldC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShuZXdJdGVtLCBleGlzdGluZ0l0ZW0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgcmV0dXJuICQobmFtZUluZGV4ID8gcmVzdWx0LnJldmVyc2UoKSA6IHJlc3VsdCk7CiAgICB9OwogIH0pOwogIC8qKg0KICAgKiDmmK/lkKbkuI3mmK8gSFRNTCDlrZfnrKbkuLLvvIjljIXoo7nlnKggPD4g5Lit77yJDQogICAqIEBwYXJhbSB0YXJnZXQNCiAgICovCgogIGZ1bmN0aW9uIGlzUGxhaW5UZXh0KHRhcmdldCkgewogICAgcmV0dXJuIGlzU3RyaW5nKHRhcmdldCkgJiYgKHRhcmdldFswXSAhPT0gJzwnIHx8IHRhcmdldFt0YXJnZXQubGVuZ3RoIC0gMV0gIT09ICc+Jyk7CiAgfQoKICBlYWNoKFsnYmVmb3JlJywgJ2FmdGVyJ10sIGZ1bmN0aW9uIChuYW1lSW5kZXgsIG5hbWUpIHsKICAgICQuZm5bbmFtZV0gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBhcmdzID0gW10sCiAgICAgICAgICBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOwoKICAgICAgd2hpbGUgKGxlbi0tKSBhcmdzW2xlbl0gPSBhcmd1bWVudHNbbGVuXTsgLy8gYWZ0ZXIg5pa55rOV77yM5aSa5Liq5Y+C5pWw6ZyA6KaB5oyJ5Y+C5pWw6aG65bqP5re75Yqg5Yiw5YWD57Sg5ZCO6Z2i77yM5omA5Lul6ZyA6KaB5bCG5Y+C5pWw6aG65bqP5Y+N5ZCR5aSE55CGCgoKICAgICAgaWYgKG5hbWVJbmRleCA9PT0gMSkgewogICAgICAgIGFyZ3MgPSBhcmdzLnJldmVyc2UoKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGVsZW1lbnQpIHsKICAgICAgICB2YXIgdGFyZ2V0cyA9IGlzRnVuY3Rpb24oYXJnc1swXSkgPyBbYXJnc1swXS5jYWxsKGVsZW1lbnQsIGluZGV4LCBlbGVtZW50LmlubmVySFRNTCldIDogYXJnczsKICAgICAgICBlYWNoKHRhcmdldHMsIGZ1bmN0aW9uIChfLCB0YXJnZXQpIHsKICAgICAgICAgIHZhciAkdGFyZ2V0OwoKICAgICAgICAgIGlmIChpc1BsYWluVGV4dCh0YXJnZXQpKSB7CiAgICAgICAgICAgICR0YXJnZXQgPSAkKGdldENoaWxkTm9kZXNBcnJheSh0YXJnZXQsICdkaXYnKSk7CiAgICAgICAgICB9IGVsc2UgaWYgKGluZGV4ICYmIGlzRWxlbWVudCh0YXJnZXQpKSB7CiAgICAgICAgICAgICR0YXJnZXQgPSAkKHRhcmdldC5jbG9uZU5vZGUodHJ1ZSkpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJHRhcmdldCA9ICQodGFyZ2V0KTsKICAgICAgICAgIH0KCiAgICAgICAgICAkdGFyZ2V0W25hbWVJbmRleCA/ICdpbnNlcnRBZnRlcicgOiAnaW5zZXJ0QmVmb3JlJ10oZWxlbWVudCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfTsKICB9KTsKCiAgJC5mbi5vZmYgPSBmdW5jdGlvbiAodHlwZXMsIHNlbGVjdG9yLCBjYWxsYmFjaykgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7IC8vIHR5cGVzIOaYr+WvueixoQoKICAgIGlmIChpc09iamVjdExpa2UodHlwZXMpKSB7CiAgICAgIGVhY2godHlwZXMsIGZ1bmN0aW9uICh0eXBlLCBmbikgewogICAgICAgIC8vIHRoaXMub2ZmKCdjbGljaycsIHVuZGVmaW5lZCwgZnVuY3Rpb24gKCkge30pCiAgICAgICAgLy8gdGhpcy5vZmYoJ2NsaWNrJywgJy5ib3gnLCBmdW5jdGlvbiAoKSB7fSkKICAgICAgICB0aGlzJDEub2ZmKHR5cGUsIHNlbGVjdG9yLCBmbik7CiAgICAgIH0pOwogICAgICByZXR1cm4gdGhpczsKICAgIH0gLy8gc2VsZWN0b3Ig5LiN5a2Y5ZyoCgoKICAgIGlmIChzZWxlY3RvciA9PT0gZmFsc2UgfHwgaXNGdW5jdGlvbihzZWxlY3RvcikpIHsKICAgICAgY2FsbGJhY2sgPSBzZWxlY3RvcjsKICAgICAgc2VsZWN0b3IgPSB1bmRlZmluZWQ7IC8vIHRoaXMub2ZmKCdjbGljaycsIHVuZGVmaW5lZCwgZnVuY3Rpb24gKCkge30pCiAgICB9IC8vIGNhbGxiYWNrIOS8oOWFpSBgZmFsc2Vg77yM55u45b2T5LqOIGByZXR1cm4gZmFsc2VgCgoKICAgIGlmIChjYWxsYmFjayA9PT0gZmFsc2UpIHsKICAgICAgY2FsbGJhY2sgPSByZXR1cm5GYWxzZTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgcmVtb3ZlKHRoaXMsIHR5cGVzLCBjYWxsYmFjaywgc2VsZWN0b3IpOwogICAgfSk7CiAgfTsKCiAgJC5mbi5vbiA9IGZ1bmN0aW9uICh0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGNhbGxiYWNrLCBvbmUpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOyAvLyB0eXBlcyDlj6/ku6XmmK8gdHlwZS9mdW5jIOWvueixoQoKICAgIGlmIChpc09iamVjdExpa2UodHlwZXMpKSB7CiAgICAgIC8vICh0eXBlcy1PYmplY3QsIHNlbGVjdG9yLCBkYXRhKQogICAgICBpZiAoIWlzU3RyaW5nKHNlbGVjdG9yKSkgewogICAgICAgIC8vICh0eXBlcy1PYmplY3QsIGRhdGEpCiAgICAgICAgZGF0YSA9IGRhdGEgfHwgc2VsZWN0b3I7CiAgICAgICAgc2VsZWN0b3IgPSB1bmRlZmluZWQ7CiAgICAgIH0KCiAgICAgIGVhY2godHlwZXMsIGZ1bmN0aW9uICh0eXBlLCBmbikgewogICAgICAgIC8vIHNlbGVjdG9yIOWSjCBkYXRhIOmDveWPr+iDveaYryB1bmRlZmluZWQKICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgdGhpcyQxLm9uKHR5cGUsIHNlbGVjdG9yLCBkYXRhLCBmbiwgb25lKTsKICAgICAgfSk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIGlmIChkYXRhID09IG51bGwgJiYgY2FsbGJhY2sgPT0gbnVsbCkgewogICAgICAvLyAodHlwZXMsIGZuKQogICAgICBjYWxsYmFjayA9IHNlbGVjdG9yOwogICAgICBkYXRhID0gc2VsZWN0b3IgPSB1bmRlZmluZWQ7CiAgICB9IGVsc2UgaWYgKGNhbGxiYWNrID09IG51bGwpIHsKICAgICAgaWYgKGlzU3RyaW5nKHNlbGVjdG9yKSkgewogICAgICAgIC8vICh0eXBlcywgc2VsZWN0b3IsIGZuKQogICAgICAgIGNhbGxiYWNrID0gZGF0YTsKICAgICAgICBkYXRhID0gdW5kZWZpbmVkOwogICAgICB9IGVsc2UgewogICAgICAgIC8vICh0eXBlcywgZGF0YSwgZm4pCiAgICAgICAgY2FsbGJhY2sgPSBkYXRhOwogICAgICAgIGRhdGEgPSBzZWxlY3RvcjsKICAgICAgICBzZWxlY3RvciA9IHVuZGVmaW5lZDsKICAgICAgfQogICAgfQoKICAgIGlmIChjYWxsYmFjayA9PT0gZmFsc2UpIHsKICAgICAgY2FsbGJhY2sgPSByZXR1cm5GYWxzZTsKICAgIH0gZWxzZSBpZiAoIWNhbGxiYWNrKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSAvLyAkKCkub25lKCkKCgogICAgaWYgKG9uZSkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXRoaXMtYWxpYXMKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBvcmlnQ2FsbGJhY2sgPSBjYWxsYmFjazsKCiAgICAgIGNhbGxiYWNrID0gZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgX3RoaXMub2ZmKGV2ZW50LnR5cGUsIHNlbGVjdG9yLCBjYWxsYmFjayk7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItcmVzdC1wYXJhbXMKCgogICAgICAgIHJldHVybiBvcmlnQ2FsbGJhY2suYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgYWRkKHRoaXMsIHR5cGVzLCBjYWxsYmFjaywgZGF0YSwgc2VsZWN0b3IpOwogICAgfSk7CiAgfTsKCiAgZWFjaChhamF4RXZlbnRzLCBmdW5jdGlvbiAobmFtZSwgZXZlbnROYW1lKSB7CiAgICAkLmZuW25hbWVdID0gZnVuY3Rpb24gKGZuKSB7CiAgICAgIHJldHVybiB0aGlzLm9uKGV2ZW50TmFtZSwgZnVuY3Rpb24gKGUsIHBhcmFtcykgewogICAgICAgIGZuKGUsIHBhcmFtcy54aHIsIHBhcmFtcy5vcHRpb25zLCBwYXJhbXMuZGF0YSk7CiAgICAgIH0pOwogICAgfTsKICB9KTsKCiAgJC5mbi5tYXAgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHsKICAgIHJldHVybiBuZXcgSlEobWFwKHRoaXMsIGZ1bmN0aW9uIChlbGVtZW50LCBpKSB7CiAgICAgIHJldHVybiBjYWxsYmFjay5jYWxsKGVsZW1lbnQsIGksIGVsZW1lbnQpOwogICAgfSkpOwogIH07CgogICQuZm4uY2xvbmUgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcy5jbG9uZU5vZGUodHJ1ZSk7CiAgICB9KTsKICB9OwoKICAkLmZuLmlzID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICB2YXIgaXNNYXRjaGVkID0gZmFsc2U7CgogICAgaWYgKGlzRnVuY3Rpb24oc2VsZWN0b3IpKSB7CiAgICAgIHRoaXMuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGVsZW1lbnQpIHsKICAgICAgICBpZiAoc2VsZWN0b3IuY2FsbChlbGVtZW50LCBpbmRleCwgZWxlbWVudCkpIHsKICAgICAgICAgIGlzTWF0Y2hlZCA9IHRydWU7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIGlzTWF0Y2hlZDsKICAgIH0KCiAgICBpZiAoaXNTdHJpbmcoc2VsZWN0b3IpKSB7CiAgICAgIHRoaXMuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICAgIGlmIChpc0RvY3VtZW50KGVsZW1lbnQpIHx8IGlzV2luZG93KGVsZW1lbnQpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSAvLyBAdHMtaWdub3JlCgoKICAgICAgICB2YXIgbWF0Y2hlcyA9IGVsZW1lbnQubWF0Y2hlcyB8fCBlbGVtZW50Lm1zTWF0Y2hlc1NlbGVjdG9yOwoKICAgICAgICBpZiAobWF0Y2hlcy5jYWxsKGVsZW1lbnQsIHNlbGVjdG9yKSkgewogICAgICAgICAgaXNNYXRjaGVkID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gaXNNYXRjaGVkOwogICAgfQoKICAgIHZhciAkY29tcGFyZVdpdGggPSAkKHNlbGVjdG9yKTsKICAgIHRoaXMuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICAkY29tcGFyZVdpdGguZWFjaChmdW5jdGlvbiAoXywgY29tcGFyZSkgewogICAgICAgIGlmIChlbGVtZW50ID09PSBjb21wYXJlKSB7CiAgICAgICAgICBpc01hdGNoZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9KTsKICAgIHJldHVybiBpc01hdGNoZWQ7CiAgfTsKCiAgJC5mbi5yZW1vdmUgPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKF8sIGVsZW1lbnQpIHsKICAgICAgaWYgKGVsZW1lbnQucGFyZW50Tm9kZSAmJiAoIXNlbGVjdG9yIHx8ICQoZWxlbWVudCkuaXMoc2VsZWN0b3IpKSkgewogICAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbGVtZW50KTsKICAgICAgfQogICAgfSk7CiAgfTsKCiAgZWFjaChbJ3ByZXBlbmQnLCAnYXBwZW5kJ10sIGZ1bmN0aW9uIChuYW1lSW5kZXgsIG5hbWUpIHsKICAgICQuZm5bbmFtZV0gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBhcmdzID0gW10sCiAgICAgICAgICBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOwoKICAgICAgd2hpbGUgKGxlbi0tKSBhcmdzW2xlbl0gPSBhcmd1bWVudHNbbGVuXTsKCiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKGluZGV4LCBlbGVtZW50KSB7CiAgICAgICAgdmFyIHJlZjsKICAgICAgICB2YXIgY2hpbGROb2RlcyA9IGVsZW1lbnQuY2hpbGROb2RlczsKICAgICAgICB2YXIgY2hpbGRMZW5ndGggPSBjaGlsZE5vZGVzLmxlbmd0aDsKICAgICAgICB2YXIgY2hpbGQgPSBjaGlsZExlbmd0aCA/IGNoaWxkTm9kZXNbbmFtZUluZGV4ID8gY2hpbGRMZW5ndGggLSAxIDogMF0gOiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKCiAgICAgICAgaWYgKCFjaGlsZExlbmd0aCkgewogICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChjaGlsZCk7CiAgICAgICAgfQoKICAgICAgICB2YXIgY29udGVudHMgPSBpc0Z1bmN0aW9uKGFyZ3NbMF0pID8gW2FyZ3NbMF0uY2FsbChlbGVtZW50LCBpbmRleCwgZWxlbWVudC5pbm5lckhUTUwpXSA6IGFyZ3M7IC8vIOWmguaenOS4jeaYr+Wtl+espuS4su+8jOWImeS7heesrOS4gOS4quWFg+e0oOS9v+eUqOWOn+Wni+WFg+e0oO+8jOWFtuS7lueahOmDveWFi+mahuiHquesrOS4gOS4quWFg+e0oAoKICAgICAgICBpZiAoaW5kZXgpIHsKICAgICAgICAgIGNvbnRlbnRzID0gY29udGVudHMubWFwKGZ1bmN0aW9uIChjb250ZW50KSB7CiAgICAgICAgICAgIHJldHVybiBpc1N0cmluZyhjb250ZW50KSA/IGNvbnRlbnQgOiAkKGNvbnRlbnQpLmNsb25lKCk7CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIChyZWYgPSAkKGNoaWxkKSlbbmFtZUluZGV4ID8gJ2FmdGVyJyA6ICdiZWZvcmUnXS5hcHBseShyZWYsIGNvbnRlbnRzKTsKCiAgICAgICAgaWYgKCFjaGlsZExlbmd0aCkgewogICAgICAgICAgZWxlbWVudC5yZW1vdmVDaGlsZChjaGlsZCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH07CiAgfSk7CiAgZWFjaChbJ2FwcGVuZFRvJywgJ3ByZXBlbmRUbyddLCBmdW5jdGlvbiAobmFtZUluZGV4LCBuYW1lKSB7CiAgICAkLmZuW25hbWVdID0gZnVuY3Rpb24gKHRhcmdldCkgewogICAgICB2YXIgZXh0cmFDaGlsZHMgPSBbXTsKICAgICAgdmFyICR0YXJnZXQgPSAkKHRhcmdldCkubWFwKGZ1bmN0aW9uIChfLCBlbGVtZW50KSB7CiAgICAgICAgdmFyIGNoaWxkTm9kZXMgPSBlbGVtZW50LmNoaWxkTm9kZXM7CiAgICAgICAgdmFyIGNoaWxkTGVuZ3RoID0gY2hpbGROb2Rlcy5sZW5ndGg7CgogICAgICAgIGlmIChjaGlsZExlbmd0aCkgewogICAgICAgICAgcmV0dXJuIGNoaWxkTm9kZXNbbmFtZUluZGV4ID8gMCA6IGNoaWxkTGVuZ3RoIC0gMV07CiAgICAgICAgfQoKICAgICAgICB2YXIgY2hpbGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGNoaWxkKTsKICAgICAgICBleHRyYUNoaWxkcy5wdXNoKGNoaWxkKTsKICAgICAgICByZXR1cm4gY2hpbGQ7CiAgICAgIH0pOwogICAgICB2YXIgJHJlc3VsdCA9IHRoaXNbbmFtZUluZGV4ID8gJ2luc2VydEJlZm9yZScgOiAnaW5zZXJ0QWZ0ZXInXSgkdGFyZ2V0KTsKICAgICAgJChleHRyYUNoaWxkcykucmVtb3ZlKCk7CiAgICAgIHJldHVybiAkcmVzdWx0OwogICAgfTsKICB9KTsKICBlYWNoKFsnYXR0cicsICdwcm9wJywgJ2NzcyddLCBmdW5jdGlvbiAobmFtZUluZGV4LCBuYW1lKSB7CiAgICBmdW5jdGlvbiBzZXQoZWxlbWVudCwga2V5LCB2YWx1ZSkgewogICAgICAvLyDlgLzkuLogdW5kZWZpbmVkIOaXtu+8jOS4jeS/ruaUuQogICAgICBpZiAoaXNVbmRlZmluZWQodmFsdWUpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBzd2l0Y2ggKG5hbWVJbmRleCkgewogICAgICAgIC8vIGF0dHIKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBpZiAoaXNOdWxsKHZhbHVlKSkgewogICAgICAgICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShrZXkpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoa2V5LCB2YWx1ZSk7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CiAgICAgICAgLy8gcHJvcAoKICAgICAgICBjYXNlIDE6CiAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICBlbGVtZW50W2tleV0gPSB2YWx1ZTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIC8vIGNzcwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAga2V5ID0gdG9DYW1lbENhc2Uoa2V5KTsgLy8gQHRzLWlnbm9yZQoKICAgICAgICAgIGVsZW1lbnQuc3R5bGVba2V5XSA9IGlzTnVtYmVyKHZhbHVlKSA/ICIiICsgdmFsdWUgKyAoY3NzTnVtYmVyLmluZGV4T2Yoa2V5KSA+IC0xID8gJycgOiAncHgnKSA6IHZhbHVlOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBnZXQoZWxlbWVudCwga2V5KSB7CiAgICAgIHN3aXRjaCAobmFtZUluZGV4KSB7CiAgICAgICAgLy8gYXR0cgogICAgICAgIGNhc2UgMDoKICAgICAgICAgIC8vIOWxnuaAp+S4jeWtmOWcqOaXtu+8jOWOn+eUnyBnZXRBdHRyaWJ1dGUg5pa55rOV6L+U5ZueIG51bGzvvIzogIwganF1ZXJ5IOi/lOWbniB1bmRlZmluZWTjgILov5nph4zlkowganF1ZXJ5IOS/neaMgeS4gOiHtAogICAgICAgICAgdmFyIHZhbHVlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoa2V5KTsKICAgICAgICAgIHJldHVybiBpc051bGwodmFsdWUpID8gdW5kZWZpbmVkIDogdmFsdWU7CiAgICAgICAgLy8gcHJvcAoKICAgICAgICBjYXNlIDE6CiAgICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgICByZXR1cm4gZWxlbWVudFtrZXldOwogICAgICAgIC8vIGNzcwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgcmV0dXJuIGdldFN0eWxlKGVsZW1lbnQsIGtleSk7CiAgICAgIH0KICAgIH0KCiAgICAkLmZuW25hbWVdID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHsKICAgICAgdmFyIHRoaXMkMSA9IHRoaXM7CgogICAgICBpZiAoaXNPYmplY3RMaWtlKGtleSkpIHsKICAgICAgICBlYWNoKGtleSwgZnVuY3Rpb24gKGssIHYpIHsKICAgICAgICAgIC8vIEB0cy1pZ25vcmUKICAgICAgICAgIHRoaXMkMVtuYW1lXShrLCB2KTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gdGhpczsKICAgICAgfQoKICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHsKICAgICAgICB2YXIgZWxlbWVudCA9IHRoaXNbMF07CiAgICAgICAgcmV0dXJuIGlzRWxlbWVudChlbGVtZW50KSA/IGdldChlbGVtZW50LCBrZXkpIDogdW5kZWZpbmVkOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChpLCBlbGVtZW50KSB7CiAgICAgICAgc2V0KGVsZW1lbnQsIGtleSwgaXNGdW5jdGlvbih2YWx1ZSkgPyB2YWx1ZS5jYWxsKGVsZW1lbnQsIGksIGdldChlbGVtZW50LCBrZXkpKSA6IHZhbHVlKTsKICAgICAgfSk7CiAgICB9OwogIH0pOwoKICAkLmZuLmNoaWxkcmVuID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICB2YXIgY2hpbGRyZW4gPSBbXTsKICAgIHRoaXMuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICBlYWNoKGVsZW1lbnQuY2hpbGROb2RlcywgZnVuY3Rpb24gKF9fLCBjaGlsZE5vZGUpIHsKICAgICAgICBpZiAoIWlzRWxlbWVudChjaGlsZE5vZGUpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoIXNlbGVjdG9yIHx8ICQoY2hpbGROb2RlKS5pcyhzZWxlY3RvcikpIHsKICAgICAgICAgIGNoaWxkcmVuLnB1c2goY2hpbGROb2RlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CiAgICByZXR1cm4gbmV3IEpRKHVuaXF1ZShjaGlsZHJlbikpOwogIH07CgogICQuZm4uc2xpY2UgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgYXJncyA9IFtdLAogICAgICAgIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7CgogICAgd2hpbGUgKGxlbi0tKSBhcmdzW2xlbl0gPSBhcmd1bWVudHNbbGVuXTsKCiAgICByZXR1cm4gbmV3IEpRKFtdLnNsaWNlLmFwcGx5KHRoaXMsIGFyZ3MpKTsKICB9OwoKICAkLmZuLmVxID0gZnVuY3Rpb24gKGluZGV4KSB7CiAgICB2YXIgcmV0ID0gaW5kZXggPT09IC0xID8gdGhpcy5zbGljZShpbmRleCkgOiB0aGlzLnNsaWNlKGluZGV4LCAraW5kZXggKyAxKTsKICAgIHJldHVybiBuZXcgSlEocmV0KTsKICB9OwoKICBmdW5jdGlvbiBkaXIoJGVsZW1lbnRzLCBuYW1lSW5kZXgsIG5vZGUsIHNlbGVjdG9yLCBmaWx0ZXIpIHsKICAgIHZhciByZXQgPSBbXTsKICAgIHZhciB0YXJnZXQ7CiAgICAkZWxlbWVudHMuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICB0YXJnZXQgPSBlbGVtZW50W25vZGVdOyAvLyDkuI3og73ljIXlkKvmnIDpobblsYLnmoQgZG9jdW1lbnQg5YWD57SgCgogICAgICB3aGlsZSAodGFyZ2V0ICYmIGlzRWxlbWVudCh0YXJnZXQpKSB7CiAgICAgICAgLy8gcHJldlVudGlsLCBuZXh0VW50aWwsIHBhcmVudHNVbnRpbAogICAgICAgIGlmIChuYW1lSW5kZXggPT09IDIpIHsKICAgICAgICAgIGlmIChzZWxlY3RvciAmJiAkKHRhcmdldCkuaXMoc2VsZWN0b3IpKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghZmlsdGVyIHx8ICQodGFyZ2V0KS5pcyhmaWx0ZXIpKSB7CiAgICAgICAgICAgIHJldC5wdXNoKHRhcmdldCk7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBwcmV2LCBuZXh0LCBwYXJlbnQKICAgICAgICBlbHNlIGlmIChuYW1lSW5kZXggPT09IDApIHsKICAgICAgICAgICAgaWYgKCFzZWxlY3RvciB8fCAkKHRhcmdldCkuaXMoc2VsZWN0b3IpKSB7CiAgICAgICAgICAgICAgcmV0LnB1c2godGFyZ2V0KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9IC8vIHByZXZBbGwsIG5leHRBbGwsIHBhcmVudHMKICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgIGlmICghc2VsZWN0b3IgfHwgJCh0YXJnZXQpLmlzKHNlbGVjdG9yKSkgewogICAgICAgICAgICAgICAgcmV0LnB1c2godGFyZ2V0KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gLy8gQHRzLWlnbm9yZQoKCiAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0W25vZGVdOwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiBuZXcgSlEodW5pcXVlKHJldCkpOwogIH0KCiAgZWFjaChbJycsICdzJywgJ3NVbnRpbCddLCBmdW5jdGlvbiAobmFtZUluZGV4LCBuYW1lKSB7CiAgICAkLmZuWyJwYXJlbnQiICsgbmFtZV0gPSBmdW5jdGlvbiAoc2VsZWN0b3IsIGZpbHRlcikgewogICAgICAvLyBwYXJlbnRz44CBcGFyZW50c1VudGlsIOmcgOimgeaKiuWFg+e0oOeahOmhuuW6j+WPjeWQkeWkhOeQhu+8jOS7peS+v+WSjCBqUXVlcnkg55qE57uT5p6c5LiA6Ie0CiAgICAgIHZhciAkbm9kZXMgPSAhbmFtZUluZGV4ID8gdGhpcyA6ICQodGhpcy5nZXQoKS5yZXZlcnNlKCkpOwogICAgICByZXR1cm4gZGlyKCRub2RlcywgbmFtZUluZGV4LCAncGFyZW50Tm9kZScsIHNlbGVjdG9yLCBmaWx0ZXIpOwogICAgfTsKICB9KTsKCiAgJC5mbi5jbG9zZXN0ID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICBpZiAodGhpcy5pcyhzZWxlY3RvcikpIHsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgogICAgdmFyIG1hdGNoZWQgPSBbXTsKICAgIHRoaXMucGFyZW50cygpLmVhY2goZnVuY3Rpb24gKF8sIGVsZW1lbnQpIHsKICAgICAgaWYgKCQoZWxlbWVudCkuaXMoc2VsZWN0b3IpKSB7CiAgICAgICAgbWF0Y2hlZC5wdXNoKGVsZW1lbnQpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSk7CiAgICByZXR1cm4gbmV3IEpRKG1hdGNoZWQpOwogIH07CgogIHZhciByYnJhY2UgPSAvXig/OntbXHdcV10qXH18XFtbXHdcV10qXF0pJC87IC8vIOS7jiBgZGF0YS0qYCDkuK3ojrflj5bnmoTlgLzvvIzpnIDopoHnu4/ov4for6Xlh73mlbDovazmjaIKCiAgZnVuY3Rpb24gZ2V0RGF0YSh2YWx1ZSkgewogICAgaWYgKHZhbHVlID09PSAndHJ1ZScpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgaWYgKHZhbHVlID09PSAnZmFsc2UnKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBpZiAodmFsdWUgPT09ICdudWxsJykgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBpZiAodmFsdWUgPT09ICt2YWx1ZSArICcnKSB7CiAgICAgIHJldHVybiArdmFsdWU7CiAgICB9CgogICAgaWYgKHJicmFjZS50ZXN0KHZhbHVlKSkgewogICAgICByZXR1cm4gSlNPTi5wYXJzZSh2YWx1ZSk7CiAgICB9CgogICAgcmV0dXJuIHZhbHVlOwogIH0gLy8g6IulIHZhbHVlIOS4jeWtmOWcqO+8jOWImeS7jiBgZGF0YS0qYCDkuK3ojrflj5blgLwKCgogIGZ1bmN0aW9uIGRhdGFBdHRyKGVsZW1lbnQsIGtleSwgdmFsdWUpIHsKICAgIGlmIChpc1VuZGVmaW5lZCh2YWx1ZSkgJiYgZWxlbWVudC5ub2RlVHlwZSA9PT0gMSkgewogICAgICB2YXIgbmFtZSA9ICdkYXRhLScgKyB0b0tlYmFiQ2FzZShrZXkpOwogICAgICB2YWx1ZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKG5hbWUpOwoKICAgICAgaWYgKGlzU3RyaW5nKHZhbHVlKSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICB2YWx1ZSA9IGdldERhdGEodmFsdWUpOwogICAgICAgIH0gY2F0Y2ggKGUpIHt9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFsdWUgPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdmFsdWU7CiAgfQoKICAkLmZuLmRhdGEgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkgewogICAgLy8g6I635Y+W5omA5pyJ5YC8CiAgICBpZiAoaXNVbmRlZmluZWQoa2V5KSkgewogICAgICBpZiAoIXRoaXMubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfQoKICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzWzBdOwogICAgICB2YXIgcmVzdWx0RGF0YSA9IGRhdGEoZWxlbWVudCk7IC8vIHdpbmRvdywgZG9jdW1lbnQg5LiK5LiN5a2Y5ZyoIGBkYXRhLSpgIOWxnuaApwoKICAgICAgaWYgKGVsZW1lbnQubm9kZVR5cGUgIT09IDEpIHsKICAgICAgICByZXR1cm4gcmVzdWx0RGF0YTsKICAgICAgfSAvLyDku44gYGRhdGEtKmAg5Lit6I635Y+W5YC8CgoKICAgICAgdmFyIGF0dHJzID0gZWxlbWVudC5hdHRyaWJ1dGVzOwogICAgICB2YXIgaSA9IGF0dHJzLmxlbmd0aDsKCiAgICAgIHdoaWxlIChpLS0pIHsKICAgICAgICBpZiAoYXR0cnNbaV0pIHsKICAgICAgICAgIHZhciBuYW1lID0gYXR0cnNbaV0ubmFtZTsKCiAgICAgICAgICBpZiAobmFtZS5pbmRleE9mKCdkYXRhLScpID09PSAwKSB7CiAgICAgICAgICAgIG5hbWUgPSB0b0NhbWVsQ2FzZShuYW1lLnNsaWNlKDUpKTsKICAgICAgICAgICAgcmVzdWx0RGF0YVtuYW1lXSA9IGRhdGFBdHRyKGVsZW1lbnQsIG5hbWUsIHJlc3VsdERhdGFbbmFtZV0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdERhdGE7CiAgICB9IC8vIOWQjOaXtuiuvue9ruWkmuS4quWAvAoKCiAgICBpZiAoaXNPYmplY3RMaWtlKGtleSkpIHsKICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgZGF0YSh0aGlzLCBrZXkpOwogICAgICB9KTsKICAgIH0gLy8gdmFsdWUg5Lyg5YWl5LqGIHVuZGVmaW5lZAoKCiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMiAmJiBpc1VuZGVmaW5lZCh2YWx1ZSkpIHsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9IC8vIOiuvue9ruWAvAoKCiAgICBpZiAoIWlzVW5kZWZpbmVkKHZhbHVlKSkgewogICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICBkYXRhKHRoaXMsIGtleSwgdmFsdWUpOwogICAgICB9KTsKICAgIH0gLy8g6I635Y+W5YC8CgoKICAgIGlmICghdGhpcy5sZW5ndGgpIHsKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICByZXR1cm4gZGF0YUF0dHIodGhpc1swXSwga2V5LCBkYXRhKHRoaXNbMF0sIGtleSkpOwogIH07CgogICQuZm4uZW1wdHkgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5pbm5lckhUTUwgPSAnJzsKICAgIH0pOwogIH07CgogICQuZm4uZXh0ZW5kID0gZnVuY3Rpb24gKG9iaikgewogICAgZWFjaChvYmosIGZ1bmN0aW9uIChwcm9wLCB2YWx1ZSkgewogICAgICAvLyDlnKggSlEg5a+56LGh5LiK5omp5bGV5pa55rOV5pe277yM6ZyA6KaB6Ieq5bex5re75YqgIHR5cGVzY3JpcHQg55qE57G75Z6L5a6a5LmJCiAgICAgICQuZm5bcHJvcF0gPSB2YWx1ZTsKICAgIH0pOwogICAgcmV0dXJuIHRoaXM7CiAgfTsKCiAgJC5mbi5maWx0ZXIgPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgIGlmIChpc0Z1bmN0aW9uKHNlbGVjdG9yKSkgewogICAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKGluZGV4LCBlbGVtZW50KSB7CiAgICAgICAgcmV0dXJuIHNlbGVjdG9yLmNhbGwoZWxlbWVudCwgaW5kZXgsIGVsZW1lbnQpID8gZWxlbWVudCA6IHVuZGVmaW5lZDsKICAgICAgfSk7CiAgICB9CgogICAgaWYgKGlzU3RyaW5nKHNlbGVjdG9yKSkgewogICAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKF8sIGVsZW1lbnQpIHsKICAgICAgICByZXR1cm4gJChlbGVtZW50KS5pcyhzZWxlY3RvcikgPyBlbGVtZW50IDogdW5kZWZpbmVkOwogICAgICB9KTsKICAgIH0KCiAgICB2YXIgJHNlbGVjdG9yID0gJChzZWxlY3Rvcik7CiAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKF8sIGVsZW1lbnQpIHsKICAgICAgcmV0dXJuICRzZWxlY3Rvci5nZXQoKS5pbmRleE9mKGVsZW1lbnQpID4gLTEgPyBlbGVtZW50IDogdW5kZWZpbmVkOwogICAgfSk7CiAgfTsKCiAgJC5mbi5maXJzdCA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzLmVxKDApOwogIH07CgogICQuZm4uaGFzID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICB2YXIgJHRhcmdldHMgPSBpc1N0cmluZyhzZWxlY3RvcikgPyB0aGlzLmZpbmQoc2VsZWN0b3IpIDogJChzZWxlY3Rvcik7CiAgICB2YXIgbGVuZ3RoID0gJHRhcmdldHMubGVuZ3RoOwogICAgcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uICgpIHsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkgewogICAgICAgIGlmIChjb250YWlucyh0aGlzLCAkdGFyZ2V0c1tpXSkpIHsKICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuOwogICAgfSk7CiAgfTsKCiAgJC5mbi5oYXNDbGFzcyA9IGZ1bmN0aW9uIChjbGFzc05hbWUpIHsKICAgIHJldHVybiB0aGlzWzBdLmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpOwogIH07CiAgLyoqDQogICAqIOWAvOS4iumdoueahCBwYWRkaW5n44CBYm9yZGVy44CBbWFyZ2luIOWkhOeQhg0KICAgKiBAcGFyYW0gZWxlbWVudA0KICAgKiBAcGFyYW0gbmFtZQ0KICAgKiBAcGFyYW0gdmFsdWUNCiAgICogQHBhcmFtIGZ1bmNJbmRleA0KICAgKiBAcGFyYW0gaW5jbHVkZU1hcmdpbg0KICAgKiBAcGFyYW0gbXVsdGlwbHkNCiAgICovCgoKICBmdW5jdGlvbiBoYW5kbGVFeHRyYVdpZHRoKGVsZW1lbnQsIG5hbWUsIHZhbHVlLCBmdW5jSW5kZXgsIGluY2x1ZGVNYXJnaW4sIG11bHRpcGx5KSB7CiAgICAvLyDojrflj5blhYPntKDnmoQgcGFkZGluZywgYm9yZGVyLCBtYXJnaW4g5a695bqm77yI5Lik5L6n5a695bqm55qE5ZKM77yJCiAgICB2YXIgZ2V0RXh0cmFXaWR0aFZhbHVlID0gZnVuY3Rpb24gKGV4dHJhKSB7CiAgICAgIHJldHVybiBnZXRFeHRyYVdpZHRoKGVsZW1lbnQsIG5hbWUudG9Mb3dlckNhc2UoKSwgZXh0cmEpICogbXVsdGlwbHk7CiAgICB9OwoKICAgIGlmIChmdW5jSW5kZXggPT09IDIgJiYgaW5jbHVkZU1hcmdpbikgewogICAgICB2YWx1ZSArPSBnZXRFeHRyYVdpZHRoVmFsdWUoJ21hcmdpbicpOwogICAgfQoKICAgIGlmIChpc0JvcmRlckJveChlbGVtZW50KSkgewogICAgICAvLyBJRSDkuLogYm94LXNpemluZzogYm9yZGVyLWJveCDml7bvvIzlvpfliLDnmoTlgLzkuI3lkKsgYm9yZGVyIOWSjCBwYWRkaW5n77yM6L+Z6YeM5YWI5L+u5aSNCiAgICAgIC8vIOS7heiOt+WPluaXtumcgOimgeWkhOeQhu+8jG11bHRpcGx5ID09PSAxIOS4uiBnZXQKICAgICAgaWYgKGlzSUUoKSAmJiBtdWx0aXBseSA9PT0gMSkgewogICAgICAgIHZhbHVlICs9IGdldEV4dHJhV2lkdGhWYWx1ZSgnYm9yZGVyJyk7CiAgICAgICAgdmFsdWUgKz0gZ2V0RXh0cmFXaWR0aFZhbHVlKCdwYWRkaW5nJyk7CiAgICAgIH0KCiAgICAgIGlmIChmdW5jSW5kZXggPT09IDApIHsKICAgICAgICB2YWx1ZSAtPSBnZXRFeHRyYVdpZHRoVmFsdWUoJ2JvcmRlcicpOwogICAgICB9CgogICAgICBpZiAoZnVuY0luZGV4ID09PSAxKSB7CiAgICAgICAgdmFsdWUgLT0gZ2V0RXh0cmFXaWR0aFZhbHVlKCdib3JkZXInKTsKICAgICAgICB2YWx1ZSAtPSBnZXRFeHRyYVdpZHRoVmFsdWUoJ3BhZGRpbmcnKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKGZ1bmNJbmRleCA9PT0gMCkgewogICAgICAgIHZhbHVlICs9IGdldEV4dHJhV2lkdGhWYWx1ZSgncGFkZGluZycpOwogICAgICB9CgogICAgICBpZiAoZnVuY0luZGV4ID09PSAyKSB7CiAgICAgICAgdmFsdWUgKz0gZ2V0RXh0cmFXaWR0aFZhbHVlKCdib3JkZXInKTsKICAgICAgICB2YWx1ZSArPSBnZXRFeHRyYVdpZHRoVmFsdWUoJ3BhZGRpbmcnKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB2YWx1ZTsKICB9CiAgLyoqDQogICAqIOiOt+WPluWFg+e0oOeahOagt+W8j+WAvA0KICAgKiBAcGFyYW0gZWxlbWVudA0KICAgKiBAcGFyYW0gbmFtZQ0KICAgKiBAcGFyYW0gZnVuY0luZGV4IDA6IGlubmVyV2lkdGgsIGlubmVySGVpZ2h0OyAxOiB3aWR0aCwgaGVpZ2h0OyAyOiBvdXRlcldpZHRoLCBvdXRlckhlaWdodA0KICAgKiBAcGFyYW0gaW5jbHVkZU1hcmdpbg0KICAgKi8KCgogIGZ1bmN0aW9uIGdldChlbGVtZW50LCBuYW1lLCBmdW5jSW5kZXgsIGluY2x1ZGVNYXJnaW4pIHsKICAgIHZhciBjbGllbnRQcm9wID0gImNsaWVudCIgKyBuYW1lOwogICAgdmFyIHNjcm9sbFByb3AgPSAic2Nyb2xsIiArIG5hbWU7CiAgICB2YXIgb2Zmc2V0UHJvcCA9ICJvZmZzZXQiICsgbmFtZTsKICAgIHZhciBpbm5lclByb3AgPSAiaW5uZXIiICsgbmFtZTsgLy8gJCh3aW5kb3cpLndpZHRoKCkKCiAgICBpZiAoaXNXaW5kb3coZWxlbWVudCkpIHsKICAgICAgLy8gb3V0ZXJXaWR0aCwgb3V0ZXJIZWlnaHQg6ZyA6KaB5YyF5ZCr5rua5Yqo5p2h55qE5a695bqmCiAgICAgIHJldHVybiBmdW5jSW5kZXggPT09IDIgPyBlbGVtZW50W2lubmVyUHJvcF0gOiB0b0VsZW1lbnQoZG9jdW1lbnQpW2NsaWVudFByb3BdOwogICAgfSAvLyAkKGRvY3VtZW50KS53aWR0aCgpCgoKICAgIGlmIChpc0RvY3VtZW50KGVsZW1lbnQpKSB7CiAgICAgIHZhciBkb2MgPSB0b0VsZW1lbnQoZWxlbWVudCk7CiAgICAgIHJldHVybiBNYXRoLm1heCggLy8gQHRzLWlnbm9yZQogICAgICBlbGVtZW50LmJvZHlbc2Nyb2xsUHJvcF0sIGRvY1tzY3JvbGxQcm9wXSwgLy8gQHRzLWlnbm9yZQogICAgICBlbGVtZW50LmJvZHlbb2Zmc2V0UHJvcF0sIGRvY1tvZmZzZXRQcm9wXSwgZG9jW2NsaWVudFByb3BdKTsKICAgIH0KCiAgICB2YXIgdmFsdWUgPSBwYXJzZUZsb2F0KGdldENvbXB1dGVkU3R5bGVWYWx1ZShlbGVtZW50LCBuYW1lLnRvTG93ZXJDYXNlKCkpIHx8ICcwJyk7CiAgICByZXR1cm4gaGFuZGxlRXh0cmFXaWR0aChlbGVtZW50LCBuYW1lLCB2YWx1ZSwgZnVuY0luZGV4LCBpbmNsdWRlTWFyZ2luLCAxKTsKICB9CiAgLyoqDQogICAqIOiuvue9ruWFg+e0oOeahOagt+W8j+WAvA0KICAgKiBAcGFyYW0gZWxlbWVudA0KICAgKiBAcGFyYW0gZWxlbWVudEluZGV4DQogICAqIEBwYXJhbSBuYW1lDQogICAqIEBwYXJhbSBmdW5jSW5kZXggMDogaW5uZXJXaWR0aCwgaW5uZXJIZWlnaHQ7IDE6IHdpZHRoLCBoZWlnaHQ7IDI6IG91dGVyV2lkdGgsIG91dGVySGVpZ2h0DQogICAqIEBwYXJhbSBpbmNsdWRlTWFyZ2luDQogICAqIEBwYXJhbSB2YWx1ZQ0KICAgKi8KCgogIGZ1bmN0aW9uIHNldChlbGVtZW50LCBlbGVtZW50SW5kZXgsIG5hbWUsIGZ1bmNJbmRleCwgaW5jbHVkZU1hcmdpbiwgdmFsdWUpIHsKICAgIHZhciBjb21wdXRlZFZhbHVlID0gaXNGdW5jdGlvbih2YWx1ZSkgPyB2YWx1ZS5jYWxsKGVsZW1lbnQsIGVsZW1lbnRJbmRleCwgZ2V0KGVsZW1lbnQsIG5hbWUsIGZ1bmNJbmRleCwgaW5jbHVkZU1hcmdpbikpIDogdmFsdWU7CgogICAgaWYgKGNvbXB1dGVkVmFsdWUgPT0gbnVsbCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyICRlbGVtZW50ID0gJChlbGVtZW50KTsKICAgIHZhciBkaW1lbnNpb24gPSBuYW1lLnRvTG93ZXJDYXNlKCk7IC8vIOeJueauiueahOWAvO+8jOS4jemcgOimgeiuoeeulyBwYWRkaW5n44CBYm9yZGVy44CBbWFyZ2luCgogICAgaWYgKFsnYXV0bycsICdpbmhlcml0JywgJyddLmluZGV4T2YoY29tcHV0ZWRWYWx1ZSkgPiAtMSkgewogICAgICAkZWxlbWVudC5jc3MoZGltZW5zaW9uLCBjb21wdXRlZFZhbHVlKTsKICAgICAgcmV0dXJuOwogICAgfSAvLyDlhbbku5blgLzkv53nlZnljp/lp4vljZXkvY3jgILms6jmhI/vvJrlpoLmnpzkuI3kvb/nlKggcHgg5L2c5Li65Y2V5L2N77yM5YiZ566X5Ye655qE5YC85LiA6Iis5piv5LiN5YeG56Gu55qECgoKICAgIHZhciBzdWZmaXggPSBjb21wdXRlZFZhbHVlLnRvU3RyaW5nKCkucmVwbGFjZSgvXGJbMC05Ll0qLywgJycpOwogICAgdmFyIG51bWVyaWNhbCA9IHBhcnNlRmxvYXQoY29tcHV0ZWRWYWx1ZSk7CiAgICBjb21wdXRlZFZhbHVlID0gaGFuZGxlRXh0cmFXaWR0aChlbGVtZW50LCBuYW1lLCBudW1lcmljYWwsIGZ1bmNJbmRleCwgaW5jbHVkZU1hcmdpbiwgLTEpICsgKHN1ZmZpeCB8fCAncHgnKTsKICAgICRlbGVtZW50LmNzcyhkaW1lbnNpb24sIGNvbXB1dGVkVmFsdWUpOwogIH0KCiAgZWFjaChbJ1dpZHRoJywgJ0hlaWdodCddLCBmdW5jdGlvbiAoXywgbmFtZSkgewogICAgZWFjaChbImlubmVyIiArIG5hbWUsIG5hbWUudG9Mb3dlckNhc2UoKSwgIm91dGVyIiArIG5hbWVdLCBmdW5jdGlvbiAoZnVuY0luZGV4LCBmdW5jTmFtZSkgewogICAgICAkLmZuW2Z1bmNOYW1lXSA9IGZ1bmN0aW9uIChtYXJnaW4sIHZhbHVlKSB7CiAgICAgICAgLy8g5piv5ZCm5piv6LWL5YC85pON5L2cCiAgICAgICAgdmFyIGlzU2V0ID0gYXJndW1lbnRzLmxlbmd0aCAmJiAoZnVuY0luZGV4IDwgMiB8fCAhaXNCb29sZWFuKG1hcmdpbikpOwogICAgICAgIHZhciBpbmNsdWRlTWFyZ2luID0gbWFyZ2luID09PSB0cnVlIHx8IHZhbHVlID09PSB0cnVlOyAvLyDojrflj5bnrKzkuIDkuKrlhYPntKDnmoTlgLwKCiAgICAgICAgaWYgKCFpc1NldCkgewogICAgICAgICAgcmV0dXJuIHRoaXMubGVuZ3RoID8gZ2V0KHRoaXNbMF0sIG5hbWUsIGZ1bmNJbmRleCwgaW5jbHVkZU1hcmdpbikgOiB1bmRlZmluZWQ7CiAgICAgICAgfSAvLyDorr7nva7mr4/kuKrlhYPntKDnmoTlgLwKCgogICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKGluZGV4LCBlbGVtZW50KSB7CiAgICAgICAgICByZXR1cm4gc2V0KGVsZW1lbnQsIGluZGV4LCBuYW1lLCBmdW5jSW5kZXgsIGluY2x1ZGVNYXJnaW4sIG1hcmdpbik7CiAgICAgICAgfSk7CiAgICAgIH07CiAgICB9KTsKICB9KTsKCiAgJC5mbi5oaWRlID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgIH0pOwogIH07CgogIGVhY2goWyd2YWwnLCAnaHRtbCcsICd0ZXh0J10sIGZ1bmN0aW9uIChuYW1lSW5kZXgsIG5hbWUpIHsKICAgIHZhciBwcm9wcyA9IHsKICAgICAgMDogJ3ZhbHVlJywKICAgICAgMTogJ2lubmVySFRNTCcsCiAgICAgIDI6ICd0ZXh0Q29udGVudCcKICAgIH07CiAgICB2YXIgcHJvcE5hbWUgPSBwcm9wc1tuYW1lSW5kZXhdOwoKICAgIGZ1bmN0aW9uIGdldCgkZWxlbWVudHMpIHsKICAgICAgLy8gdGV4dCgpIOiOt+WPluaJgOacieWFg+e0oOeahOaWh+acrAogICAgICBpZiAobmFtZUluZGV4ID09PSAyKSB7CiAgICAgICAgLy8gQHRzLWlnbm9yZQogICAgICAgIHJldHVybiBtYXAoJGVsZW1lbnRzLCBmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgcmV0dXJuIHRvRWxlbWVudChlbGVtZW50KVtwcm9wTmFtZV07CiAgICAgICAgfSkuam9pbignJyk7CiAgICAgIH0gLy8g56m66ZuG5ZCI5pe277yMdmFsKCkg5ZKMIGh0bWwoKSDov5Tlm54gdW5kZWZpbmVkCgoKICAgICAgaWYgKCEkZWxlbWVudHMubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfSAvLyB2YWwoKSDlkowgaHRtbCgpIOS7heiOt+WPluesrOS4gOS4quWFg+e0oOeahOWGheWuuQoKCiAgICAgIHZhciBmaXJzdEVsZW1lbnQgPSAkZWxlbWVudHNbMF07IC8vIHNlbGVjdCBtdWx0aXBsZSDov5Tlm57mlbDnu4QKCiAgICAgIGlmIChuYW1lSW5kZXggPT09IDAgJiYgJChmaXJzdEVsZW1lbnQpLmlzKCdzZWxlY3RbbXVsdGlwbGVdJykpIHsKICAgICAgICByZXR1cm4gbWFwKCQoZmlyc3RFbGVtZW50KS5maW5kKCdvcHRpb246Y2hlY2tlZCcpLCBmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgcmV0dXJuIGVsZW1lbnQudmFsdWU7CiAgICAgICAgfSk7CiAgICAgIH0gLy8gQHRzLWlnbm9yZQoKCiAgICAgIHJldHVybiBmaXJzdEVsZW1lbnRbcHJvcE5hbWVdOwogICAgfQoKICAgIGZ1bmN0aW9uIHNldChlbGVtZW50LCB2YWx1ZSkgewogICAgICAvLyB0ZXh0KCkg5ZKMIGh0bWwoKSDotYvlgLzkuLogdW5kZWZpbmVk77yM5YiZ5L+d5oyB5Y6f5YaF5a655LiN5Y+YCiAgICAgIC8vIHZhbCgpIOi1i+WAvOS4uiB1bmRlZmluZWQg5YiZ6LWL5YC85Li656m6CiAgICAgIGlmIChpc1VuZGVmaW5lZCh2YWx1ZSkpIHsKICAgICAgICBpZiAobmFtZUluZGV4ICE9PSAwKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB2YWx1ZSA9ICcnOwogICAgICB9CgogICAgICBpZiAobmFtZUluZGV4ID09PSAxICYmIGlzRWxlbWVudCh2YWx1ZSkpIHsKICAgICAgICB2YWx1ZSA9IHZhbHVlLm91dGVySFRNTDsKICAgICAgfSAvLyBAdHMtaWdub3JlCgoKICAgICAgZWxlbWVudFtwcm9wTmFtZV0gPSB2YWx1ZTsKICAgIH0KCiAgICAkLmZuW25hbWVdID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgIC8vIOiOt+WPluWAvAogICAgICBpZiAoIWFyZ3VtZW50cy5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gZ2V0KHRoaXMpOwogICAgICB9IC8vIOiuvue9ruWAvAoKCiAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKGksIGVsZW1lbnQpIHsKICAgICAgICB2YXIgY29tcHV0ZWRWYWx1ZSA9IGlzRnVuY3Rpb24odmFsdWUpID8gdmFsdWUuY2FsbChlbGVtZW50LCBpLCBnZXQoJChlbGVtZW50KSkpIDogdmFsdWU7IC8vIHZhbHVlIOaYr+aVsOe7hO+8jOWImemAieS4reaVsOe7hOS4reeahOWFg+e0oO+8jOWPjemAieS4jeWcqOaVsOe7hOS4reeahOWFg+e0oAoKICAgICAgICBpZiAobmFtZUluZGV4ID09PSAwICYmIEFycmF5LmlzQXJyYXkoY29tcHV0ZWRWYWx1ZSkpIHsKICAgICAgICAgIC8vIHNlbGVjdFttdWx0aXBsZV0KICAgICAgICAgIGlmICgkKGVsZW1lbnQpLmlzKCdzZWxlY3RbbXVsdGlwbGVdJykpIHsKICAgICAgICAgICAgbWFwKCQoZWxlbWVudCkuZmluZCgnb3B0aW9uJyksIGZ1bmN0aW9uIChvcHRpb24pIHsKICAgICAgICAgICAgICByZXR1cm4gb3B0aW9uLnNlbGVjdGVkID0gY29tcHV0ZWRWYWx1ZS5pbmRleE9mKG9wdGlvbi52YWx1ZSkgPiAtMTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IC8vIOWFtuS7liBjaGVja2JveCwgcmFkaW8g562J5YWD57SgCiAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICBlbGVtZW50LmNoZWNrZWQgPSBjb21wdXRlZFZhbHVlLmluZGV4T2YoZWxlbWVudC52YWx1ZSkgPiAtMTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzZXQoZWxlbWVudCwgY29tcHV0ZWRWYWx1ZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH07CiAgfSk7CgogICQuZm4uaW5kZXggPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgewogICAgICByZXR1cm4gdGhpcy5lcSgwKS5wYXJlbnQoKS5jaGlsZHJlbigpLmdldCgpLmluZGV4T2YodGhpc1swXSk7CiAgICB9CgogICAgaWYgKGlzU3RyaW5nKHNlbGVjdG9yKSkgewogICAgICByZXR1cm4gJChzZWxlY3RvcikuZ2V0KCkuaW5kZXhPZih0aGlzWzBdKTsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5nZXQoKS5pbmRleE9mKCQoc2VsZWN0b3IpWzBdKTsKICB9OwoKICAkLmZuLmxhc3QgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gdGhpcy5lcSgtMSk7CiAgfTsKCiAgZWFjaChbJycsICdBbGwnLCAnVW50aWwnXSwgZnVuY3Rpb24gKG5hbWVJbmRleCwgbmFtZSkgewogICAgJC5mblsibmV4dCIgKyBuYW1lXSA9IGZ1bmN0aW9uIChzZWxlY3RvciwgZmlsdGVyKSB7CiAgICAgIHJldHVybiBkaXIodGhpcywgbmFtZUluZGV4LCAnbmV4dEVsZW1lbnRTaWJsaW5nJywgc2VsZWN0b3IsIGZpbHRlcik7CiAgICB9OwogIH0pOwoKICAkLmZuLm5vdCA9IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgdmFyICRleGNsdWRlcyA9IHRoaXMuZmlsdGVyKHNlbGVjdG9yKTsKICAgIHJldHVybiB0aGlzLm1hcChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICByZXR1cm4gJGV4Y2x1ZGVzLmluZGV4KGVsZW1lbnQpID4gLTEgPyB1bmRlZmluZWQgOiBlbGVtZW50OwogICAgfSk7CiAgfTsKICAvKioNCiAgICog6L+U5Zue5pyA6L+R55qE55So5LqO5a6a5L2N55qE54i25YWD57SgDQogICAqLwoKCiAgJC5mbi5vZmZzZXRQYXJlbnQgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKCkgewogICAgICB2YXIgb2Zmc2V0UGFyZW50ID0gdGhpcy5vZmZzZXRQYXJlbnQ7CgogICAgICB3aGlsZSAob2Zmc2V0UGFyZW50ICYmICQob2Zmc2V0UGFyZW50KS5jc3MoJ3Bvc2l0aW9uJykgPT09ICdzdGF0aWMnKSB7CiAgICAgICAgb2Zmc2V0UGFyZW50ID0gb2Zmc2V0UGFyZW50Lm9mZnNldFBhcmVudDsKICAgICAgfQoKICAgICAgcmV0dXJuIG9mZnNldFBhcmVudCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7CiAgICB9KTsKICB9OwoKICBmdW5jdGlvbiBmbG9hdFN0eWxlKCRlbGVtZW50LCBuYW1lKSB7CiAgICByZXR1cm4gcGFyc2VGbG9hdCgkZWxlbWVudC5jc3MobmFtZSkpOwogIH0KCiAgJC5mbi5wb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgIGlmICghdGhpcy5sZW5ndGgpIHsKICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KCiAgICB2YXIgJGVsZW1lbnQgPSB0aGlzLmVxKDApOwogICAgdmFyIGN1cnJlbnRPZmZzZXQ7CiAgICB2YXIgcGFyZW50T2Zmc2V0ID0gewogICAgICBsZWZ0OiAwLAogICAgICB0b3A6IDAKICAgIH07CgogICAgaWYgKCRlbGVtZW50LmNzcygncG9zaXRpb24nKSA9PT0gJ2ZpeGVkJykgewogICAgICBjdXJyZW50T2Zmc2V0ID0gJGVsZW1lbnRbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICB9IGVsc2UgewogICAgICBjdXJyZW50T2Zmc2V0ID0gJGVsZW1lbnQub2Zmc2V0KCk7CiAgICAgIHZhciAkb2Zmc2V0UGFyZW50ID0gJGVsZW1lbnQub2Zmc2V0UGFyZW50KCk7CiAgICAgIHBhcmVudE9mZnNldCA9ICRvZmZzZXRQYXJlbnQub2Zmc2V0KCk7CiAgICAgIHBhcmVudE9mZnNldC50b3AgKz0gZmxvYXRTdHlsZSgkb2Zmc2V0UGFyZW50LCAnYm9yZGVyLXRvcC13aWR0aCcpOwogICAgICBwYXJlbnRPZmZzZXQubGVmdCArPSBmbG9hdFN0eWxlKCRvZmZzZXRQYXJlbnQsICdib3JkZXItbGVmdC13aWR0aCcpOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIHRvcDogY3VycmVudE9mZnNldC50b3AgLSBwYXJlbnRPZmZzZXQudG9wIC0gZmxvYXRTdHlsZSgkZWxlbWVudCwgJ21hcmdpbi10b3AnKSwKICAgICAgbGVmdDogY3VycmVudE9mZnNldC5sZWZ0IC0gcGFyZW50T2Zmc2V0LmxlZnQgLSBmbG9hdFN0eWxlKCRlbGVtZW50LCAnbWFyZ2luLWxlZnQnKQogICAgfTsKICB9OwoKICBmdW5jdGlvbiBnZXQkMShlbGVtZW50KSB7CiAgICBpZiAoIWVsZW1lbnQuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICB0b3A6IDAsCiAgICAgICAgbGVmdDogMAogICAgICB9OwogICAgfQoKICAgIHZhciByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIHZhciB3aW4gPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXc7CiAgICByZXR1cm4gewogICAgICB0b3A6IHJlY3QudG9wICsgd2luLnBhZ2VZT2Zmc2V0LAogICAgICBsZWZ0OiByZWN0LmxlZnQgKyB3aW4ucGFnZVhPZmZzZXQKICAgIH07CiAgfQoKICBmdW5jdGlvbiBzZXQkMShlbGVtZW50LCB2YWx1ZSwgaW5kZXgpIHsKICAgIHZhciAkZWxlbWVudCA9ICQoZWxlbWVudCk7CiAgICB2YXIgcG9zaXRpb24gPSAkZWxlbWVudC5jc3MoJ3Bvc2l0aW9uJyk7CgogICAgaWYgKHBvc2l0aW9uID09PSAnc3RhdGljJykgewogICAgICAkZWxlbWVudC5jc3MoJ3Bvc2l0aW9uJywgJ3JlbGF0aXZlJyk7CiAgICB9CgogICAgdmFyIGN1cnJlbnRPZmZzZXQgPSBnZXQkMShlbGVtZW50KTsKICAgIHZhciBjdXJyZW50VG9wU3RyaW5nID0gJGVsZW1lbnQuY3NzKCd0b3AnKTsKICAgIHZhciBjdXJyZW50TGVmdFN0cmluZyA9ICRlbGVtZW50LmNzcygnbGVmdCcpOwogICAgdmFyIGN1cnJlbnRUb3A7CiAgICB2YXIgY3VycmVudExlZnQ7CiAgICB2YXIgY2FsY3VsYXRlUG9zaXRpb24gPSAocG9zaXRpb24gPT09ICdhYnNvbHV0ZScgfHwgcG9zaXRpb24gPT09ICdmaXhlZCcpICYmIChjdXJyZW50VG9wU3RyaW5nICsgY3VycmVudExlZnRTdHJpbmcpLmluZGV4T2YoJ2F1dG8nKSA+IC0xOwoKICAgIGlmIChjYWxjdWxhdGVQb3NpdGlvbikgewogICAgICB2YXIgY3VycmVudFBvc2l0aW9uID0gJGVsZW1lbnQucG9zaXRpb24oKTsKICAgICAgY3VycmVudFRvcCA9IGN1cnJlbnRQb3NpdGlvbi50b3A7CiAgICAgIGN1cnJlbnRMZWZ0ID0gY3VycmVudFBvc2l0aW9uLmxlZnQ7CiAgICB9IGVsc2UgewogICAgICBjdXJyZW50VG9wID0gcGFyc2VGbG9hdChjdXJyZW50VG9wU3RyaW5nKTsKICAgICAgY3VycmVudExlZnQgPSBwYXJzZUZsb2F0KGN1cnJlbnRMZWZ0U3RyaW5nKTsKICAgIH0KCiAgICB2YXIgY29tcHV0ZWRWYWx1ZSA9IGlzRnVuY3Rpb24odmFsdWUpID8gdmFsdWUuY2FsbChlbGVtZW50LCBpbmRleCwgZXh0ZW5kKHt9LCBjdXJyZW50T2Zmc2V0KSkgOiB2YWx1ZTsKICAgICRlbGVtZW50LmNzcyh7CiAgICAgIHRvcDogY29tcHV0ZWRWYWx1ZS50b3AgIT0gbnVsbCA/IGNvbXB1dGVkVmFsdWUudG9wIC0gY3VycmVudE9mZnNldC50b3AgKyBjdXJyZW50VG9wIDogdW5kZWZpbmVkLAogICAgICBsZWZ0OiBjb21wdXRlZFZhbHVlLmxlZnQgIT0gbnVsbCA/IGNvbXB1dGVkVmFsdWUubGVmdCAtIGN1cnJlbnRPZmZzZXQubGVmdCArIGN1cnJlbnRMZWZ0IDogdW5kZWZpbmVkCiAgICB9KTsKICB9CgogICQuZm4ub2Zmc2V0ID0gZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAvLyDojrflj5blnZDmoIcKICAgIGlmICghYXJndW1lbnRzLmxlbmd0aCkgewogICAgICBpZiAoIXRoaXMubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldCQxKHRoaXNbMF0pOwogICAgfSAvLyDorr7nva7lnZDmoIcKCgogICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoaW5kZXgpIHsKICAgICAgc2V0JDEodGhpcywgdmFsdWUsIGluZGV4KTsKICAgIH0pOwogIH07CgogICQuZm4ub25lID0gZnVuY3Rpb24gKHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgY2FsbGJhY2spIHsKICAgIC8vIEB0cy1pZ25vcmUKICAgIHJldHVybiB0aGlzLm9uKHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgY2FsbGJhY2ssIHRydWUpOwogIH07CgogIGVhY2goWycnLCAnQWxsJywgJ1VudGlsJ10sIGZ1bmN0aW9uIChuYW1lSW5kZXgsIG5hbWUpIHsKICAgICQuZm5bInByZXYiICsgbmFtZV0gPSBmdW5jdGlvbiAoc2VsZWN0b3IsIGZpbHRlcikgewogICAgICAvLyBwcmV2QWxs44CBcHJldlVudGlsIOmcgOimgeaKiuWFg+e0oOeahOmhuuW6j+WAkuW6j+WkhOeQhu+8jOS7peS+v+WSjCBqUXVlcnkg55qE57uT5p6c5LiA6Ie0CiAgICAgIHZhciAkbm9kZXMgPSAhbmFtZUluZGV4ID8gdGhpcyA6ICQodGhpcy5nZXQoKS5yZXZlcnNlKCkpOwogICAgICByZXR1cm4gZGlyKCRub2RlcywgbmFtZUluZGV4LCAncHJldmlvdXNFbGVtZW50U2libGluZycsIHNlbGVjdG9yLCBmaWx0ZXIpOwogICAgfTsKICB9KTsKCiAgJC5mbi5yZW1vdmVBdHRyID0gZnVuY3Rpb24gKGF0dHJpYnV0ZU5hbWUpIHsKICAgIHZhciBuYW1lcyA9IGF0dHJpYnV0ZU5hbWUuc3BsaXQoJyAnKS5maWx0ZXIoZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgcmV0dXJuIG5hbWU7CiAgICB9KTsKICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgICAgZWFjaChuYW1lcywgZnVuY3Rpb24gKF8sIG5hbWUpIHsKICAgICAgICB0aGlzJDEucmVtb3ZlQXR0cmlidXRlKG5hbWUpOwogICAgICB9KTsKICAgIH0pOwogIH07CgogICQuZm4ucmVtb3ZlRGF0YSA9IGZ1bmN0aW9uIChuYW1lKSB7CiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgcmVtb3ZlRGF0YSh0aGlzLCBuYW1lKTsKICAgIH0pOwogIH07CgogICQuZm4ucmVtb3ZlUHJvcCA9IGZ1bmN0aW9uIChuYW1lKSB7CiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgdHJ5IHsKICAgICAgICAvLyBAdHMtaWdub3JlCiAgICAgICAgZGVsZXRlIHRoaXNbbmFtZV07CiAgICAgIH0gY2F0Y2ggKGUpIHt9CiAgICB9KTsKICB9OwoKICAkLmZuLnJlcGxhY2VXaXRoID0gZnVuY3Rpb24gKG5ld0NvbnRlbnQpIHsKICAgIHRoaXMuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGVsZW1lbnQpIHsKICAgICAgdmFyIGNvbnRlbnQgPSBuZXdDb250ZW50OwoKICAgICAgaWYgKGlzRnVuY3Rpb24oY29udGVudCkpIHsKICAgICAgICBjb250ZW50ID0gY29udGVudC5jYWxsKGVsZW1lbnQsIGluZGV4LCBlbGVtZW50LmlubmVySFRNTCk7CiAgICAgIH0gZWxzZSBpZiAoaW5kZXggJiYgIWlzU3RyaW5nKGNvbnRlbnQpKSB7CiAgICAgICAgY29udGVudCA9ICQoY29udGVudCkuY2xvbmUoKTsKICAgICAgfQoKICAgICAgJChlbGVtZW50KS5iZWZvcmUoY29udGVudCk7CiAgICB9KTsKICAgIHJldHVybiB0aGlzLnJlbW92ZSgpOwogIH07CgogICQuZm4ucmVwbGFjZUFsbCA9IGZ1bmN0aW9uICh0YXJnZXQpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgcmV0dXJuICQodGFyZ2V0KS5tYXAoZnVuY3Rpb24gKGluZGV4LCBlbGVtZW50KSB7CiAgICAgICQoZWxlbWVudCkucmVwbGFjZVdpdGgoaW5kZXggPyB0aGlzJDEuY2xvbmUoKSA6IHRoaXMkMSk7CiAgICAgIHJldHVybiB0aGlzJDEuZ2V0KCk7CiAgICB9KTsKICB9OwogIC8qKg0KICAgKiDlsIbooajljZXlhYPntKDnmoTlgLznu4TlkIjmiJDplK7lgLzlr7nmlbDnu4QNCiAgICogQHJldHVybnMge0FycmF5fQ0KICAgKi8KCgogICQuZm4uc2VyaWFsaXplQXJyYXkgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgcmVzdWx0ID0gW107CiAgICB0aGlzLmVhY2goZnVuY3Rpb24gKF8sIGVsZW1lbnQpIHsKICAgICAgdmFyIGVsZW1lbnRzID0gZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxGb3JtRWxlbWVudCA/IGVsZW1lbnQuZWxlbWVudHMgOiBbZWxlbWVudF07CiAgICAgICQoZWxlbWVudHMpLmVhY2goZnVuY3Rpb24gKF8sIGVsZW1lbnQpIHsKICAgICAgICB2YXIgJGVsZW1lbnQgPSAkKGVsZW1lbnQpOwogICAgICAgIHZhciB0eXBlID0gZWxlbWVudC50eXBlOwogICAgICAgIHZhciBub2RlTmFtZSA9IGVsZW1lbnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKCiAgICAgICAgaWYgKG5vZGVOYW1lICE9PSAnZmllbGRzZXQnICYmIGVsZW1lbnQubmFtZSAmJiAhZWxlbWVudC5kaXNhYmxlZCAmJiBbJ2lucHV0JywgJ3NlbGVjdCcsICd0ZXh0YXJlYScsICdrZXlnZW4nXS5pbmRleE9mKG5vZGVOYW1lKSA+IC0xICYmIFsnc3VibWl0JywgJ2J1dHRvbicsICdpbWFnZScsICdyZXNldCcsICdmaWxlJ10uaW5kZXhPZih0eXBlKSA9PT0gLTEgJiYgKFsncmFkaW8nLCAnY2hlY2tib3gnXS5pbmRleE9mKHR5cGUpID09PSAtMSB8fCBlbGVtZW50LmNoZWNrZWQpKSB7CiAgICAgICAgICB2YXIgdmFsdWUgPSAkZWxlbWVudC52YWwoKTsKICAgICAgICAgIHZhciB2YWx1ZUFyciA9IEFycmF5LmlzQXJyYXkodmFsdWUpID8gdmFsdWUgOiBbdmFsdWVdOwogICAgICAgICAgdmFsdWVBcnIuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgICAgcmVzdWx0LnB1c2goewogICAgICAgICAgICAgIG5hbWU6IGVsZW1lbnQubmFtZSwKICAgICAgICAgICAgICB2YWx1ZTogdmFsdWUKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0OwogIH07CgogICQuZm4uc2VyaWFsaXplID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHBhcmFtKHRoaXMuc2VyaWFsaXplQXJyYXkoKSk7CiAgfTsKCiAgdmFyIGVsZW1lbnREaXNwbGF5ID0ge307CiAgLyoqDQogICAqIOiOt+WPluWFg+e0oOeahOWIneWniyBkaXNwbGF5IOWAvO+8jOeUqOS6jiAuc2hvdygpIOaWueazlQ0KICAgKiBAcGFyYW0gbm9kZU5hbWUNCiAgICovCgogIGZ1bmN0aW9uIGRlZmF1bHREaXNwbGF5KG5vZGVOYW1lKSB7CiAgICB2YXIgZWxlbWVudDsKICAgIHZhciBkaXNwbGF5OwoKICAgIGlmICghZWxlbWVudERpc3BsYXlbbm9kZU5hbWVdKSB7CiAgICAgIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5vZGVOYW1lKTsKICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtZW50KTsKICAgICAgZGlzcGxheSA9IGdldFN0eWxlKGVsZW1lbnQsICdkaXNwbGF5Jyk7CiAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbGVtZW50KTsKCiAgICAgIGlmIChkaXNwbGF5ID09PSAnbm9uZScpIHsKICAgICAgICBkaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgfQoKICAgICAgZWxlbWVudERpc3BsYXlbbm9kZU5hbWVdID0gZGlzcGxheTsKICAgIH0KCiAgICByZXR1cm4gZWxlbWVudERpc3BsYXlbbm9kZU5hbWVdOwogIH0KICAvKioNCiAgICog5pi+56S65oyH5a6a5YWD57SgDQogICAqIEByZXR1cm5zIHtKUX0NCiAgICovCgoKICAkLmZuLnNob3cgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHRoaXMuc3R5bGUuZGlzcGxheSA9PT0gJ25vbmUnKSB7CiAgICAgICAgdGhpcy5zdHlsZS5kaXNwbGF5ID0gJyc7CiAgICAgIH0KCiAgICAgIGlmIChnZXRTdHlsZSh0aGlzLCAnZGlzcGxheScpID09PSAnbm9uZScpIHsKICAgICAgICB0aGlzLnN0eWxlLmRpc3BsYXkgPSBkZWZhdWx0RGlzcGxheSh0aGlzLm5vZGVOYW1lKTsKICAgICAgfQogICAgfSk7CiAgfTsKICAvKioNCiAgICog5Y+W5b6X5ZCM6L6I5YWD57Sg55qE6ZuG5ZCIDQogICAqIEBwYXJhbSBzZWxlY3RvciB7U3RyaW5nPX0NCiAgICogQHJldHVybnMge0pRfQ0KICAgKi8KCgogICQuZm4uc2libGluZ3MgPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgIHJldHVybiB0aGlzLnByZXZBbGwoc2VsZWN0b3IpLmFkZCh0aGlzLm5leHRBbGwoc2VsZWN0b3IpKTsKICB9OwogIC8qKg0KICAgKiDliIfmjaLlhYPntKDnmoTmmL7npLrnirbmgIENCiAgICovCgoKICAkLmZuLnRvZ2dsZSA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICBnZXRTdHlsZSh0aGlzLCAnZGlzcGxheScpID09PSAnbm9uZScgPyAkKHRoaXMpLnNob3coKSA6ICQodGhpcykuaGlkZSgpOwogICAgfSk7CiAgfTsKCiAgJC5mbi5yZWZsb3cgPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMuY2xpZW50TGVmdDsKICAgIH0pOwogIH07CgogICQuZm4udHJhbnNpdGlvbiA9IGZ1bmN0aW9uIChkdXJhdGlvbikgewogICAgaWYgKGlzTnVtYmVyKGR1cmF0aW9uKSkgewogICAgICBkdXJhdGlvbiA9IGR1cmF0aW9uICsgIm1zIjsKICAgIH0KCiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5zdHlsZS53ZWJraXRUcmFuc2l0aW9uRHVyYXRpb24gPSBkdXJhdGlvbjsKICAgICAgdGhpcy5zdHlsZS50cmFuc2l0aW9uRHVyYXRpb24gPSBkdXJhdGlvbjsKICAgIH0pOwogIH07CgogICQuZm4udHJhbnNpdGlvbkVuZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykgewogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby10aGlzLWFsaWFzCiAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICB2YXIgZXZlbnRzID0gWyd3ZWJraXRUcmFuc2l0aW9uRW5kJywgJ3RyYW5zaXRpb25lbmQnXTsKCiAgICBmdW5jdGlvbiBmaXJlQ2FsbGJhY2soZSkgewogICAgICBpZiAoZS50YXJnZXQgIT09IHRoaXMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gQHRzLWlnbm9yZQoKCiAgICAgIGNhbGxiYWNrLmNhbGwodGhpcywgZSk7CiAgICAgIGVhY2goZXZlbnRzLCBmdW5jdGlvbiAoXywgZXZlbnQpIHsKICAgICAgICB0aGF0Lm9mZihldmVudCwgZmlyZUNhbGxiYWNrKTsKICAgICAgfSk7CiAgICB9CgogICAgZWFjaChldmVudHMsIGZ1bmN0aW9uIChfLCBldmVudCkgewogICAgICB0aGF0Lm9uKGV2ZW50LCBmaXJlQ2FsbGJhY2spOwogICAgfSk7CiAgICByZXR1cm4gdGhpczsKICB9OwoKICAkLmZuLnRyYW5zZm9ybU9yaWdpbiA9IGZ1bmN0aW9uICh0cmFuc2Zvcm1PcmlnaW4pIHsKICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICB0aGlzLnN0eWxlLndlYmtpdFRyYW5zZm9ybU9yaWdpbiA9IHRyYW5zZm9ybU9yaWdpbjsKICAgICAgdGhpcy5zdHlsZS50cmFuc2Zvcm1PcmlnaW4gPSB0cmFuc2Zvcm1PcmlnaW47CiAgICB9KTsKICB9OwoKICAkLmZuLnRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0cmFuc2Zvcm0pIHsKICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgewogICAgICB0aGlzLnN0eWxlLndlYmtpdFRyYW5zZm9ybSA9IHRyYW5zZm9ybTsKICAgICAgdGhpcy5zdHlsZS50cmFuc2Zvcm0gPSB0cmFuc2Zvcm07CiAgICB9KTsKICB9OwogIC8qKg0KICAgKiBDU1Mg6YCJ5oup5Zmo5ZKM5Yid5aeL5YyW5Ye95pWw57uE5oiQ55qE5a+56LGhDQogICAqLwoKCiAgdmFyIGVudHJpZXMgPSB7fTsKICAvKioNCiAgICog5rOo5YaM5bm25omn6KGM5Yid5aeL5YyW5Ye95pWwDQogICAqIEBwYXJhbSBzZWxlY3RvciBDU1Mg6YCJ5oup5ZmoDQogICAqIEBwYXJhbSBhcGlJbml0IOWIneWni+WMluWHveaVsA0KICAgKiBAcGFyYW0gaSDlhYPntKDntKLlvJUNCiAgICogQHBhcmFtIGVsZW1lbnQg5YWD57SgDQogICAqLwoKICBmdW5jdGlvbiBtdXRhdGlvbihzZWxlY3RvciwgYXBpSW5pdCwgaSwgZWxlbWVudCkgewogICAgdmFyIHNlbGVjdG9ycyA9IGRhdGEoZWxlbWVudCwgJ19tZHVpX211dGF0aW9uJyk7CgogICAgaWYgKCFzZWxlY3RvcnMpIHsKICAgICAgc2VsZWN0b3JzID0gW107CiAgICAgIGRhdGEoZWxlbWVudCwgJ19tZHVpX211dGF0aW9uJywgc2VsZWN0b3JzKTsKICAgIH0KCiAgICBpZiAoc2VsZWN0b3JzLmluZGV4T2Yoc2VsZWN0b3IpID09PSAtMSkgewogICAgICBzZWxlY3RvcnMucHVzaChzZWxlY3Rvcik7CiAgICAgIGFwaUluaXQuY2FsbChlbGVtZW50LCBpLCBlbGVtZW50KTsKICAgIH0KICB9CgogICQuZm4ubXV0YXRpb24gPSBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChpLCBlbGVtZW50KSB7CiAgICAgIHZhciAkdGhpcyA9ICQoZWxlbWVudCk7CiAgICAgIGVhY2goZW50cmllcywgZnVuY3Rpb24gKHNlbGVjdG9yLCBhcGlJbml0KSB7CiAgICAgICAgaWYgKCR0aGlzLmlzKHNlbGVjdG9yKSkgewogICAgICAgICAgbXV0YXRpb24oc2VsZWN0b3IsIGFwaUluaXQsIGksIGVsZW1lbnQpOwogICAgICAgIH0KCiAgICAgICAgJHRoaXMuZmluZChzZWxlY3RvcikuZWFjaChmdW5jdGlvbiAoaSwgZWxlbWVudCkgewogICAgICAgICAgbXV0YXRpb24oc2VsZWN0b3IsIGFwaUluaXQsIGksIGVsZW1lbnQpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0pOwogIH07CgogICQuc2hvd092ZXJsYXkgPSBmdW5jdGlvbiAoekluZGV4KSB7CiAgICB2YXIgJG92ZXJsYXkgPSAkKCcubWR1aS1vdmVybGF5Jyk7CgogICAgaWYgKCRvdmVybGF5Lmxlbmd0aCkgewogICAgICAkb3ZlcmxheS5kYXRhKCdfb3ZlcmxheV9pc19kZWxldGVkJywgZmFsc2UpOwoKICAgICAgaWYgKCFpc1VuZGVmaW5lZCh6SW5kZXgpKSB7CiAgICAgICAgJG92ZXJsYXkuY3NzKCd6LWluZGV4JywgekluZGV4KTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKGlzVW5kZWZpbmVkKHpJbmRleCkpIHsKICAgICAgICB6SW5kZXggPSAyMDAwOwogICAgICB9CgogICAgICAkb3ZlcmxheSA9ICQoJzxkaXYgY2xhc3M9Im1kdWktb3ZlcmxheSI+JykuYXBwZW5kVG8oZG9jdW1lbnQuYm9keSkucmVmbG93KCkuY3NzKCd6LWluZGV4JywgekluZGV4KTsKICAgIH0KCiAgICB2YXIgbGV2ZWwgPSAkb3ZlcmxheS5kYXRhKCdfb3ZlcmxheV9sZXZlbCcpIHx8IDA7CiAgICByZXR1cm4gJG92ZXJsYXkuZGF0YSgnX292ZXJsYXlfbGV2ZWwnLCArK2xldmVsKS5hZGRDbGFzcygnbWR1aS1vdmVybGF5LXNob3cnKTsKICB9OwoKICAkLmhpZGVPdmVybGF5ID0gZnVuY3Rpb24gKGZvcmNlKSB7CiAgICBpZiAoZm9yY2UgPT09IHZvaWQgMCkgZm9yY2UgPSBmYWxzZTsKICAgIHZhciAkb3ZlcmxheSA9ICQoJy5tZHVpLW92ZXJsYXknKTsKCiAgICBpZiAoISRvdmVybGF5Lmxlbmd0aCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyIGxldmVsID0gZm9yY2UgPyAxIDogJG92ZXJsYXkuZGF0YSgnX292ZXJsYXlfbGV2ZWwnKTsKCiAgICBpZiAobGV2ZWwgPiAxKSB7CiAgICAgICRvdmVybGF5LmRhdGEoJ19vdmVybGF5X2xldmVsJywgLS1sZXZlbCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICAkb3ZlcmxheS5kYXRhKCdfb3ZlcmxheV9sZXZlbCcsIDApLnJlbW92ZUNsYXNzKCdtZHVpLW92ZXJsYXktc2hvdycpLmRhdGEoJ19vdmVybGF5X2lzX2RlbGV0ZWQnLCB0cnVlKS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKCRvdmVybGF5LmRhdGEoJ19vdmVybGF5X2lzX2RlbGV0ZWQnKSkgewogICAgICAgICRvdmVybGF5LnJlbW92ZSgpOwogICAgICB9CiAgICB9KTsKICB9OwoKICAkLmxvY2tTY3JlZW4gPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgJGJvZHkgPSAkKCdib2R5Jyk7IC8vIOS4jeebtOaOpeaKiiBib2R5IOiuvuS4uiBib3gtc2l6aW5nOiBib3JkZXItYm9477yM6YG/5YWN5rGh5p+T5YWo5bGA5qC35byPCgogICAgdmFyIG5ld0JvZHlXaWR0aCA9ICRib2R5LndpZHRoKCk7CiAgICB2YXIgbGV2ZWwgPSAkYm9keS5kYXRhKCdfbG9ja3NjcmVlbl9sZXZlbCcpIHx8IDA7CiAgICAkYm9keS5hZGRDbGFzcygnbWR1aS1sb2NrZWQnKS53aWR0aChuZXdCb2R5V2lkdGgpLmRhdGEoJ19sb2Nrc2NyZWVuX2xldmVsJywgKytsZXZlbCk7CiAgfTsKCiAgJC51bmxvY2tTY3JlZW4gPSBmdW5jdGlvbiAoZm9yY2UpIHsKICAgIGlmIChmb3JjZSA9PT0gdm9pZCAwKSBmb3JjZSA9IGZhbHNlOwogICAgdmFyICRib2R5ID0gJCgnYm9keScpOwogICAgdmFyIGxldmVsID0gZm9yY2UgPyAxIDogJGJvZHkuZGF0YSgnX2xvY2tzY3JlZW5fbGV2ZWwnKTsKCiAgICBpZiAobGV2ZWwgPiAxKSB7CiAgICAgICRib2R5LmRhdGEoJ19sb2Nrc2NyZWVuX2xldmVsJywgLS1sZXZlbCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICAkYm9keS5kYXRhKCdfbG9ja3NjcmVlbl9sZXZlbCcsIDApLnJlbW92ZUNsYXNzKCdtZHVpLWxvY2tlZCcpLndpZHRoKCcnKTsKICB9OwoKICAkLnRocm90dGxlID0gZnVuY3Rpb24gKGZuLCBkZWxheSkgewogICAgaWYgKGRlbGF5ID09PSB2b2lkIDApIGRlbGF5ID0gMTY7CiAgICB2YXIgdGltZXIgPSBudWxsOwogICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHRoaXMkMSA9IHRoaXM7CiAgICAgIHZhciBhcmdzID0gW10sCiAgICAgICAgICBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOwoKICAgICAgd2hpbGUgKGxlbi0tKSBhcmdzW2xlbl0gPSBhcmd1bWVudHNbbGVuXTsKCiAgICAgIGlmIChpc051bGwodGltZXIpKSB7CiAgICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGZuLmFwcGx5KHRoaXMkMSwgYXJncyk7CiAgICAgICAgICB0aW1lciA9IG51bGw7CiAgICAgICAgfSwgZGVsYXkpOwogICAgICB9CiAgICB9OwogIH07CgogIHZhciBHVUlEID0ge307CgogICQuZ3VpZCA9IGZ1bmN0aW9uIChuYW1lKSB7CiAgICBpZiAoIWlzVW5kZWZpbmVkKG5hbWUpICYmICFpc1VuZGVmaW5lZChHVUlEW25hbWVdKSkgewogICAgICByZXR1cm4gR1VJRFtuYW1lXTsKICAgIH0KCiAgICBmdW5jdGlvbiBzNCgpIHsKICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApLnRvU3RyaW5nKDE2KS5zdWJzdHJpbmcoMSk7CiAgICB9CgogICAgdmFyIGd1aWQgPSAnXycgKyBzNCgpICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyBzNCgpICsgczQoKTsKCiAgICBpZiAoIWlzVW5kZWZpbmVkKG5hbWUpKSB7CiAgICAgIEdVSURbbmFtZV0gPSBndWlkOwogICAgfQoKICAgIHJldHVybiBndWlkOwogIH07CgogIG1kdWkubXV0YXRpb24gPSBmdW5jdGlvbiAoc2VsZWN0b3IsIGFwaUluaXQpIHsKICAgIGlmIChpc1VuZGVmaW5lZChzZWxlY3RvcikgfHwgaXNVbmRlZmluZWQoYXBpSW5pdCkpIHsKICAgICAgJChkb2N1bWVudCkubXV0YXRpb24oKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGVudHJpZXNbc2VsZWN0b3JdID0gYXBpSW5pdDsKICAgICQoc2VsZWN0b3IpLmVhY2goZnVuY3Rpb24gKGksIGVsZW1lbnQpIHsKICAgICAgcmV0dXJuIG11dGF0aW9uKHNlbGVjdG9yLCBhcGlJbml0LCBpLCBlbGVtZW50KTsKICAgIH0pOwogIH07CiAgLyoqDQogICAqIOinpuWPkee7hOS7tuS4iueahOS6i+S7tg0KICAgKiBAcGFyYW0gZXZlbnROYW1lIOS6i+S7tuWQjQ0KICAgKiBAcGFyYW0gY29tcG9uZW50TmFtZSDnu4Tku7blkI0NCiAgICogQHBhcmFtIHRhcmdldCDlnKjor6XlhYPntKDkuIrop6blj5Hkuovku7YNCiAgICogQHBhcmFtIGluc3RhbmNlIOe7hOS7tuWunuS+iw0KICAgKiBAcGFyYW0gcGFyYW1ldGVycyDkuovku7blj4LmlbANCiAgICovCgoKICBmdW5jdGlvbiBjb21wb25lbnRFdmVudChldmVudE5hbWUsIGNvbXBvbmVudE5hbWUsIHRhcmdldCwgaW5zdGFuY2UsIHBhcmFtZXRlcnMpIHsKICAgIGlmICghcGFyYW1ldGVycykgewogICAgICBwYXJhbWV0ZXJzID0ge307CiAgICB9IC8vIEB0cy1pZ25vcmUKCgogICAgcGFyYW1ldGVycy5pbnN0ID0gaW5zdGFuY2U7CiAgICB2YXIgZnVsbEV2ZW50TmFtZSA9IGV2ZW50TmFtZSArICIubWR1aS4iICsgY29tcG9uZW50TmFtZTsgLy8galF1ZXJ5IOS6i+S7tgogICAgLy8gQHRzLWlnbm9yZQoKICAgIGlmICh0eXBlb2YgalF1ZXJ5ICE9PSAndW5kZWZpbmVkJykgewogICAgICAvLyBAdHMtaWdub3JlCiAgICAgIGpRdWVyeSh0YXJnZXQpLnRyaWdnZXIoZnVsbEV2ZW50TmFtZSwgcGFyYW1ldGVycyk7CiAgICB9CgogICAgdmFyICR0YXJnZXQgPSAkKHRhcmdldCk7IC8vIG1kdWkuanEg5LqL5Lu2CgogICAgJHRhcmdldC50cmlnZ2VyKGZ1bGxFdmVudE5hbWUsIHBhcmFtZXRlcnMpOwogICAgdmFyIGV2ZW50UGFyYW1zID0gewogICAgICBidWJibGVzOiB0cnVlLAogICAgICBjYW5jZWxhYmxlOiB0cnVlLAogICAgICBkZXRhaWw6IHBhcmFtZXRlcnMKICAgIH07CiAgICB2YXIgZXZlbnRPYmplY3QgPSBuZXcgQ3VzdG9tRXZlbnQoZnVsbEV2ZW50TmFtZSwgZXZlbnRQYXJhbXMpOyAvLyBAdHMtaWdub3JlCgogICAgZXZlbnRPYmplY3QuX2RldGFpbCA9IHBhcmFtZXRlcnM7CiAgICAkdGFyZ2V0WzBdLmRpc3BhdGNoRXZlbnQoZXZlbnRPYmplY3QpOwogIH0KCiAgdmFyICRkb2N1bWVudCA9ICQoZG9jdW1lbnQpOwogIHZhciAkd2luZG93ID0gJCh3aW5kb3cpOwogIHZhciAkYm9keSA9ICQoJ2JvZHknKTsKICB2YXIgREVGQVVMVF9PUFRJT05TID0gewogICAgdG9sZXJhbmNlOiA1LAogICAgb2Zmc2V0OiAwLAogICAgaW5pdGlhbENsYXNzOiAnbWR1aS1oZWFkcm9vbScsCiAgICBwaW5uZWRDbGFzczogJ21kdWktaGVhZHJvb20tcGlubmVkLXRvcCcsCiAgICB1bnBpbm5lZENsYXNzOiAnbWR1aS1oZWFkcm9vbS11bnBpbm5lZC10b3AnCiAgfTsKCiAgdmFyIEhlYWRyb29tID0gZnVuY3Rpb24gSGVhZHJvb20oc2VsZWN0b3IsIG9wdGlvbnMpIHsKICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIG9wdGlvbnMgPSB7fTsKICAgIC8qKg0KICAgICAqIOmFjee9ruWPguaVsA0KICAgICAqLwoKICAgIHRoaXMub3B0aW9ucyA9IGV4dGVuZCh7fSwgREVGQVVMVF9PUFRJT05TKTsKICAgIC8qKg0KICAgICAqIOW9k+WJjSBoZWFkcm9vbSDnmoTnirbmgIENCiAgICAgKi8KCiAgICB0aGlzLnN0YXRlID0gJ3Bpbm5lZCc7CiAgICAvKioNCiAgICAgKiDlvZPliY3mmK/lkKblkK/nlKgNCiAgICAgKi8KCiAgICB0aGlzLmlzRW5hYmxlID0gZmFsc2U7CiAgICAvKioNCiAgICAgKiDkuIrmrKHmu5rliqjlkI7vvIzlnoLnm7TmlrnlkJHnmoTot53nprsNCiAgICAgKi8KCiAgICB0aGlzLmxhc3RTY3JvbGxZID0gMDsKICAgIC8qKg0KICAgICAqIEFuaW1hdGlvbkZyYW1lIElEDQogICAgICovCgogICAgdGhpcy5yYWZJZCA9IDA7CiAgICB0aGlzLiRlbGVtZW50ID0gJChzZWxlY3RvcikuZmlyc3QoKTsKICAgIGV4dGVuZCh0aGlzLm9wdGlvbnMsIG9wdGlvbnMpOyAvLyB0b2xlcmFuY2Ug5Y+C5pWw6Iul5Li65pWw5YC877yM6L2s5o2i5Li65a+56LGhCgogICAgdmFyIHRvbGVyYW5jZSA9IHRoaXMub3B0aW9ucy50b2xlcmFuY2U7CgogICAgaWYgKGlzTnVtYmVyKHRvbGVyYW5jZSkpIHsKICAgICAgdGhpcy5vcHRpb25zLnRvbGVyYW5jZSA9IHsKICAgICAgICBkb3duOiB0b2xlcmFuY2UsCiAgICAgICAgdXA6IHRvbGVyYW5jZQogICAgICB9OwogICAgfQoKICAgIHRoaXMuZW5hYmxlKCk7CiAgfTsKICAvKioNCiAgICog5rua5Yqo5pe255qE5aSE55CGDQogICAqLwoKCiAgSGVhZHJvb20ucHJvdG90eXBlLm9uU2Nyb2xsID0gZnVuY3Rpb24gb25TY3JvbGwoKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgIHRoaXMucmFmSWQgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGN1cnJlbnRTY3JvbGxZID0gd2luZG93LnBhZ2VZT2Zmc2V0OwogICAgICB2YXIgZGlyZWN0aW9uID0gY3VycmVudFNjcm9sbFkgPiB0aGlzJDEubGFzdFNjcm9sbFkgPyAnZG93bicgOiAndXAnOwogICAgICB2YXIgdG9sZXJhbmNlID0gdGhpcyQxLm9wdGlvbnMudG9sZXJhbmNlW2RpcmVjdGlvbl07CiAgICAgIHZhciBzY3JvbGxlZCA9IE1hdGguYWJzKGN1cnJlbnRTY3JvbGxZIC0gdGhpcyQxLmxhc3RTY3JvbGxZKTsKICAgICAgdmFyIHRvbGVyYW5jZUV4Y2VlZGVkID0gc2Nyb2xsZWQgPj0gdG9sZXJhbmNlOwoKICAgICAgaWYgKGN1cnJlbnRTY3JvbGxZID4gdGhpcyQxLmxhc3RTY3JvbGxZICYmIGN1cnJlbnRTY3JvbGxZID49IHRoaXMkMS5vcHRpb25zLm9mZnNldCAmJiB0b2xlcmFuY2VFeGNlZWRlZCkgewogICAgICAgIHRoaXMkMS51bnBpbigpOwogICAgICB9IGVsc2UgaWYgKGN1cnJlbnRTY3JvbGxZIDwgdGhpcyQxLmxhc3RTY3JvbGxZICYmIHRvbGVyYW5jZUV4Y2VlZGVkIHx8IGN1cnJlbnRTY3JvbGxZIDw9IHRoaXMkMS5vcHRpb25zLm9mZnNldCkgewogICAgICAgIHRoaXMkMS5waW4oKTsKICAgICAgfQoKICAgICAgdGhpcyQxLmxhc3RTY3JvbGxZID0gY3VycmVudFNjcm9sbFk7CiAgICB9KTsKICB9OwogIC8qKg0KICAgKiDop6blj5Hnu4Tku7bkuovku7YNCiAgICogQHBhcmFtIG5hbWUNCiAgICovCgoKICBIZWFkcm9vbS5wcm90b3R5cGUudHJpZ2dlckV2ZW50ID0gZnVuY3Rpb24gdHJpZ2dlckV2ZW50KG5hbWUpIHsKICAgIGNvbXBvbmVudEV2ZW50KG5hbWUsICdoZWFkcm9vbScsIHRoaXMuJGVsZW1lbnQsIHRoaXMpOwogIH07CiAgLyoqDQogICAqIOWKqOeUu+e7k+adn+eahOWbnuiwgw0KICAgKi8KCgogIEhlYWRyb29tLnByb3RvdHlwZS50cmFuc2l0aW9uRW5kID0gZnVuY3Rpb24gdHJhbnNpdGlvbkVuZCgpIHsKICAgIGlmICh0aGlzLnN0YXRlID09PSAncGlubmluZycpIHsKICAgICAgdGhpcy5zdGF0ZSA9ICdwaW5uZWQnOwogICAgICB0aGlzLnRyaWdnZXJFdmVudCgncGlubmVkJyk7CiAgICB9CgogICAgaWYgKHRoaXMuc3RhdGUgPT09ICd1bnBpbm5pbmcnKSB7CiAgICAgIHRoaXMuc3RhdGUgPSAndW5waW5uZWQnOwogICAgICB0aGlzLnRyaWdnZXJFdmVudCgndW5waW5uZWQnKTsKICAgIH0KICB9OwogIC8qKg0KICAgKiDkvb/lhYPntKDlm7rlrprkvY8NCiAgICovCgoKICBIZWFkcm9vbS5wcm90b3R5cGUucGluID0gZnVuY3Rpb24gcGluKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CgogICAgaWYgKHRoaXMuc3RhdGUgPT09ICdwaW5uaW5nJyB8fCB0aGlzLnN0YXRlID09PSAncGlubmVkJyB8fCAhdGhpcy4kZWxlbWVudC5oYXNDbGFzcyh0aGlzLm9wdGlvbnMuaW5pdGlhbENsYXNzKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy50cmlnZ2VyRXZlbnQoJ3BpbicpOwogICAgdGhpcy5zdGF0ZSA9ICdwaW5uaW5nJzsKICAgIHRoaXMuJGVsZW1lbnQucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLnVucGlubmVkQ2xhc3MpLmFkZENsYXNzKHRoaXMub3B0aW9ucy5waW5uZWRDbGFzcykudHJhbnNpdGlvbkVuZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzJDEudHJhbnNpdGlvbkVuZCgpOwogICAgfSk7CiAgfTsKICAvKioNCiAgICog5L2/5YWD57Sg6ZqQ6JePDQogICAqLwoKCiAgSGVhZHJvb20ucHJvdG90eXBlLnVucGluID0gZnVuY3Rpb24gdW5waW4oKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKCiAgICBpZiAodGhpcy5zdGF0ZSA9PT0gJ3VucGlubmluZycgfHwgdGhpcy5zdGF0ZSA9PT0gJ3VucGlubmVkJyB8fCAhdGhpcy4kZWxlbWVudC5oYXNDbGFzcyh0aGlzLm9wdGlvbnMuaW5pdGlhbENsYXNzKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy50cmlnZ2VyRXZlbnQoJ3VucGluJyk7CiAgICB0aGlzLnN0YXRlID0gJ3VucGlubmluZyc7CiAgICB0aGlzLiRlbGVtZW50LnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5waW5uZWRDbGFzcykuYWRkQ2xhc3ModGhpcy5vcHRpb25zLnVucGlubmVkQ2xhc3MpLnRyYW5zaXRpb25FbmQoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcyQxLnRyYW5zaXRpb25FbmQoKTsKICAgIH0pOwogIH07CiAgLyoqDQogICAqIOWQr+eUqCBoZWFkcm9vbSDmj5Lku7YNCiAgICovCgoKICBIZWFkcm9vbS5wcm90b3R5cGUuZW5hYmxlID0gZnVuY3Rpb24gZW5hYmxlKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CgogICAgaWYgKHRoaXMuaXNFbmFibGUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuaXNFbmFibGUgPSB0cnVlOwogICAgdGhpcy5zdGF0ZSA9ICdwaW5uZWQnOwogICAgdGhpcy4kZWxlbWVudC5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuaW5pdGlhbENsYXNzKS5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMucGlubmVkQ2xhc3MpLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy51bnBpbm5lZENsYXNzKTsKICAgIHRoaXMubGFzdFNjcm9sbFkgPSB3aW5kb3cucGFnZVlPZmZzZXQ7CiAgICAkd2luZG93Lm9uKCdzY3JvbGwnLCBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzJDEub25TY3JvbGwoKTsKICAgIH0pOwogIH07CiAgLyoqDQogICAqIOemgeeUqCBoZWFkcm9vbSDmj5Lku7YNCiAgICovCgoKICBIZWFkcm9vbS5wcm90b3R5cGUuZGlzYWJsZSA9IGZ1bmN0aW9uIGRpc2FibGUoKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKCiAgICBpZiAoIXRoaXMuaXNFbmFibGUpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuaXNFbmFibGUgPSBmYWxzZTsKICAgIHRoaXMuJGVsZW1lbnQucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmluaXRpYWxDbGFzcykucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLnBpbm5lZENsYXNzKS5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMudW5waW5uZWRDbGFzcyk7CiAgICAkd2luZG93Lm9mZignc2Nyb2xsJywgZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcyQxLm9uU2Nyb2xsKCk7CiAgICB9KTsKICAgIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLnJhZklkKTsKICB9OwogIC8qKg0KICAgKiDojrflj5blvZPliY3nirbmgIHjgILlhbHljIXlkKvlm5vnp43nirbmgIHvvJpgcGlubmluZ2DjgIFgcGlubmVkYOOAgWB1bnBpbm5pbmdg44CBYHVucGlubmVkYA0KICAgKi8KCgogIEhlYWRyb29tLnByb3RvdHlwZS5nZXRTdGF0ZSA9IGZ1bmN0aW9uIGdldFN0YXRlKCkgewogICAgcmV0dXJuIHRoaXMuc3RhdGU7CiAgfTsKCiAgbWR1aS5IZWFkcm9vbSA9IEhlYWRyb29tOwogIC8qKg0KICAgKiDop6PmnpAgREFUQSBBUEkg5Y+C5pWwDQogICAqIEBwYXJhbSBlbGVtZW50IOWFg+e0oA0KICAgKiBAcGFyYW0gbmFtZSDlsZ7mgKflkI0NCiAgICovCgogIGZ1bmN0aW9uIHBhcnNlT3B0aW9ucyhlbGVtZW50LCBuYW1lKSB7CiAgICB2YXIgYXR0ciA9ICQoZWxlbWVudCkuYXR0cihuYW1lKTsKCiAgICBpZiAoIWF0dHIpIHsKICAgICAgcmV0dXJuIHt9OwogICAgfQoKICAgIHJldHVybiBuZXcgRnVuY3Rpb24oJycsICJ2YXIganNvbiA9ICIgKyBhdHRyICsgIjsgcmV0dXJuIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoanNvbikpOyIpKCk7CiAgfQoKICB2YXIgY3VzdG9tQXR0ciA9ICdtZHVpLWhlYWRyb29tJzsKICAkKGZ1bmN0aW9uICgpIHsKICAgIG1kdWkubXV0YXRpb24oIlsiICsgY3VzdG9tQXR0ciArICJdIiwgZnVuY3Rpb24gKCkgewogICAgICBuZXcgbWR1aS5IZWFkcm9vbSh0aGlzLCBwYXJzZU9wdGlvbnModGhpcywgY3VzdG9tQXR0cikpOwogICAgfSk7CiAgfSk7CiAgdmFyIERFRkFVTFRfT1BUSU9OUyQxID0gewogICAgYWNjb3JkaW9uOiBmYWxzZQogIH07CgogIHZhciBDb2xsYXBzZUFic3RyYWN0ID0gZnVuY3Rpb24gQ29sbGFwc2VBYnN0cmFjdChzZWxlY3Rvciwgb3B0aW9ucykgewogICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgb3B0aW9ucyA9IHt9OwogICAgLyoqDQogICAgICog6YWN572u5Y+C5pWwDQogICAgICovCgogICAgdGhpcy5vcHRpb25zID0gZXh0ZW5kKHt9LCBERUZBVUxUX09QVElPTlMkMSk7IC8vIENTUyDnsbvlkI0KCiAgICB2YXIgY2xhc3NQcmVmaXggPSAibWR1aS0iICsgdGhpcy5nZXROYW1lc3BhY2UoKSArICItaXRlbSI7CiAgICB0aGlzLmNsYXNzSXRlbSA9IGNsYXNzUHJlZml4OwogICAgdGhpcy5jbGFzc0l0ZW1PcGVuID0gY2xhc3NQcmVmaXggKyAiLW9wZW4iOwogICAgdGhpcy5jbGFzc0hlYWRlciA9IGNsYXNzUHJlZml4ICsgIi1oZWFkZXIiOwogICAgdGhpcy5jbGFzc0JvZHkgPSBjbGFzc1ByZWZpeCArICItYm9keSI7CiAgICB0aGlzLiRlbGVtZW50ID0gJChzZWxlY3RvcikuZmlyc3QoKTsKICAgIGV4dGVuZCh0aGlzLm9wdGlvbnMsIG9wdGlvbnMpOwogICAgdGhpcy5iaW5kRXZlbnQoKTsKICB9OwogIC8qKg0KICAgKiDnu5Hlrprkuovku7YNCiAgICovCgoKICBDb2xsYXBzZUFic3RyYWN0LnByb3RvdHlwZS5iaW5kRXZlbnQgPSBmdW5jdGlvbiBiaW5kRXZlbnQoKSB7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXRoaXMtYWxpYXMKICAgIHZhciB0aGF0ID0gdGhpczsgLy8g54K55Ye7IGhlYWRlciDml7bvvIzmiZPlvIAv5YWz6ZetIGl0ZW0KCiAgICB0aGlzLiRlbGVtZW50Lm9uKCdjbGljaycsICIuIiArIHRoaXMuY2xhc3NIZWFkZXIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyICRoZWFkZXIgPSAkKHRoaXMpOwogICAgICB2YXIgJGl0ZW0gPSAkaGVhZGVyLnBhcmVudCgpOwogICAgICB2YXIgJGl0ZW1zID0gdGhhdC5nZXRJdGVtcygpOwogICAgICAkaXRlbXMuZWFjaChmdW5jdGlvbiAoXywgaXRlbSkgewogICAgICAgIGlmICgkaXRlbS5pcyhpdGVtKSkgewogICAgICAgICAgdGhhdC50b2dnbGUoaXRlbSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOyAvLyDngrnlh7vlhbPpl63mjInpkq7ml7bvvIzlhbPpl60gaXRlbQoKICAgIHRoaXMuJGVsZW1lbnQub24oJ2NsaWNrJywgIlttZHVpLSIgKyB0aGlzLmdldE5hbWVzcGFjZSgpICsgIi1pdGVtLWNsb3NlXSIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyICR0YXJnZXQgPSAkKHRoaXMpOwogICAgICB2YXIgJGl0ZW0gPSAkdGFyZ2V0LnBhcmVudHMoIi4iICsgdGhhdC5jbGFzc0l0ZW0pLmZpcnN0KCk7CiAgICAgIHRoYXQuY2xvc2UoJGl0ZW0pOwogICAgfSk7CiAgfTsKICAvKioNCiAgICog5oyH5a6aIGl0ZW0g5piv5ZCm5aSE5LqO5omT5byA54q25oCBDQogICAqIEBwYXJhbSAkaXRlbQ0KICAgKi8KCgogIENvbGxhcHNlQWJzdHJhY3QucHJvdG90eXBlLmlzT3BlbiA9IGZ1bmN0aW9uIGlzT3BlbigkaXRlbSkgewogICAgcmV0dXJuICRpdGVtLmhhc0NsYXNzKHRoaXMuY2xhc3NJdGVtT3Blbik7CiAgfTsKICAvKioNCiAgICog6I635Y+W5omA5pyJIGl0ZW0NCiAgICovCgoKICBDb2xsYXBzZUFic3RyYWN0LnByb3RvdHlwZS5nZXRJdGVtcyA9IGZ1bmN0aW9uIGdldEl0ZW1zKCkgewogICAgcmV0dXJuIHRoaXMuJGVsZW1lbnQuY2hpbGRyZW4oIi4iICsgdGhpcy5jbGFzc0l0ZW0pOwogIH07CiAgLyoqDQogICAqIOiOt+WPluaMh+WumiBpdGVtDQogICAqIEBwYXJhbSBpdGVtDQogICAqLwoKCiAgQ29sbGFwc2VBYnN0cmFjdC5wcm90b3R5cGUuZ2V0SXRlbSA9IGZ1bmN0aW9uIGdldEl0ZW0oaXRlbSkgewogICAgaWYgKGlzTnVtYmVyKGl0ZW0pKSB7CiAgICAgIHJldHVybiB0aGlzLmdldEl0ZW1zKCkuZXEoaXRlbSk7CiAgICB9CgogICAgcmV0dXJuICQoaXRlbSkuZmlyc3QoKTsKICB9OwogIC8qKg0KICAgKiDop6blj5Hnu4Tku7bkuovku7YNCiAgICogQHBhcmFtIG5hbWUg5LqL5Lu25ZCNDQogICAqIEBwYXJhbSAkaXRlbSDkuovku7bop6blj5HnmoTnm67moIcgaXRlbQ0KICAgKi8KCgogIENvbGxhcHNlQWJzdHJhY3QucHJvdG90eXBlLnRyaWdnZXJFdmVudCA9IGZ1bmN0aW9uIHRyaWdnZXJFdmVudChuYW1lLCAkaXRlbSkgewogICAgY29tcG9uZW50RXZlbnQobmFtZSwgdGhpcy5nZXROYW1lc3BhY2UoKSwgJGl0ZW0sIHRoaXMpOwogIH07CiAgLyoqDQogICAqIOWKqOeUu+e7k+adn+Wbnuiwgw0KICAgKiBAcGFyYW0gJGNvbnRlbnQgYm9keSDlhYPntKANCiAgICogQHBhcmFtICRpdGVtIGl0ZW0g5YWD57SgDQogICAqLwoKCiAgQ29sbGFwc2VBYnN0cmFjdC5wcm90b3R5cGUudHJhbnNpdGlvbkVuZCA9IGZ1bmN0aW9uIHRyYW5zaXRpb25FbmQoJGNvbnRlbnQsICRpdGVtKSB7CiAgICBpZiAodGhpcy5pc09wZW4oJGl0ZW0pKSB7CiAgICAgICRjb250ZW50LnRyYW5zaXRpb24oMCkuaGVpZ2h0KCdhdXRvJykucmVmbG93KCkudHJhbnNpdGlvbignJyk7CiAgICAgIHRoaXMudHJpZ2dlckV2ZW50KCdvcGVuZWQnLCAkaXRlbSk7CiAgICB9IGVsc2UgewogICAgICAkY29udGVudC5oZWlnaHQoJycpOwogICAgICB0aGlzLnRyaWdnZXJFdmVudCgnY2xvc2VkJywgJGl0ZW0pOwogICAgfQogIH07CiAgLyoqDQogICAqIOaJk+W8gOaMh+Wumumdouadv+mhuQ0KICAgKiBAcGFyYW0gaXRlbSDpnaLmnb/pobnnmoTntKLlvJXlj7fjgIHmiJYgQ1NTIOmAieaLqeWZqOOAgeaIliBET00g5YWD57Sg44CB5oiWIEpRIOWvueixoQ0KICAgKi8KCgogIENvbGxhcHNlQWJzdHJhY3QucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbiBvcGVuKGl0ZW0pIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgdmFyICRpdGVtID0gdGhpcy5nZXRJdGVtKGl0ZW0pOwoKICAgIGlmICh0aGlzLmlzT3BlbigkaXRlbSkpIHsKICAgICAgcmV0dXJuOwogICAgfSAvLyDlhbPpl63lhbbku5bpobkKCgogICAgaWYgKHRoaXMub3B0aW9ucy5hY2NvcmRpb24pIHsKICAgICAgdGhpcy4kZWxlbWVudC5jaGlsZHJlbigiLiIgKyB0aGlzLmNsYXNzSXRlbU9wZW4pLmVhY2goZnVuY3Rpb24gKF8sIGVsZW1lbnQpIHsKICAgICAgICB2YXIgJGVsZW1lbnQgPSAkKGVsZW1lbnQpOwoKICAgICAgICBpZiAoISRlbGVtZW50LmlzKCRpdGVtKSkgewogICAgICAgICAgdGhpcyQxLmNsb3NlKCRlbGVtZW50KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIHZhciAkY29udGVudCA9ICRpdGVtLmNoaWxkcmVuKCIuIiArIHRoaXMuY2xhc3NCb2R5KTsKICAgICRjb250ZW50LmhlaWdodCgkY29udGVudFswXS5zY3JvbGxIZWlnaHQpLnRyYW5zaXRpb25FbmQoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcyQxLnRyYW5zaXRpb25FbmQoJGNvbnRlbnQsICRpdGVtKTsKICAgIH0pOwogICAgdGhpcy50cmlnZ2VyRXZlbnQoJ29wZW4nLCAkaXRlbSk7CiAgICAkaXRlbS5hZGRDbGFzcyh0aGlzLmNsYXNzSXRlbU9wZW4pOwogIH07CiAgLyoqDQogICAqIOWFs+mXreaMh+Wumumdouadv+mhuQ0KICAgKiBAcGFyYW0gaXRlbSDpnaLmnb/pobnnmoTntKLlvJXlj7fjgIHmiJYgQ1NTIOmAieaLqeWZqOOAgeaIliBET00g5YWD57Sg44CB5oiWIEpRIOWvueixoQ0KICAgKi8KCgogIENvbGxhcHNlQWJzdHJhY3QucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gY2xvc2UoaXRlbSkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CiAgICB2YXIgJGl0ZW0gPSB0aGlzLmdldEl0ZW0oaXRlbSk7CgogICAgaWYgKCF0aGlzLmlzT3BlbigkaXRlbSkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciAkY29udGVudCA9ICRpdGVtLmNoaWxkcmVuKCIuIiArIHRoaXMuY2xhc3NCb2R5KTsKICAgIHRoaXMudHJpZ2dlckV2ZW50KCdjbG9zZScsICRpdGVtKTsKICAgICRpdGVtLnJlbW92ZUNsYXNzKHRoaXMuY2xhc3NJdGVtT3Blbik7CiAgICAkY29udGVudC50cmFuc2l0aW9uKDApLmhlaWdodCgkY29udGVudFswXS5zY3JvbGxIZWlnaHQpLnJlZmxvdygpLnRyYW5zaXRpb24oJycpLmhlaWdodCgnJykudHJhbnNpdGlvbkVuZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzJDEudHJhbnNpdGlvbkVuZCgkY29udGVudCwgJGl0ZW0pOwogICAgfSk7CiAgfTsKICAvKioNCiAgICog5YiH5o2i5oyH5a6a6Z2i5p2/6aG555qE5omT5byA54q25oCBDQogICAqIEBwYXJhbSBpdGVtIOmdouadv+mhueeahOe0ouW8leWPt+OAgeaIliBDU1Mg6YCJ5oup5Zmo44CB5oiWIERPTSDlhYPntKDjgIHmiJYgSlEg5a+56LGhDQogICAqLwoKCiAgQ29sbGFwc2VBYnN0cmFjdC5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24gdG9nZ2xlKGl0ZW0pIHsKICAgIHZhciAkaXRlbSA9IHRoaXMuZ2V0SXRlbShpdGVtKTsKICAgIHRoaXMuaXNPcGVuKCRpdGVtKSA/IHRoaXMuY2xvc2UoJGl0ZW0pIDogdGhpcy5vcGVuKCRpdGVtKTsKICB9OwogIC8qKg0KICAgKiDmiZPlvIDmiYDmnInpnaLmnb/pobkNCiAgICovCgoKICBDb2xsYXBzZUFic3RyYWN0LnByb3RvdHlwZS5vcGVuQWxsID0gZnVuY3Rpb24gb3BlbkFsbCgpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgdGhpcy5nZXRJdGVtcygpLmVhY2goZnVuY3Rpb24gKF8sIGVsZW1lbnQpIHsKICAgICAgcmV0dXJuIHRoaXMkMS5vcGVuKGVsZW1lbnQpOwogICAgfSk7CiAgfTsKICAvKioNCiAgICog5YWz6Zet5omA5pyJ6Z2i5p2/6aG5DQogICAqLwoKCiAgQ29sbGFwc2VBYnN0cmFjdC5wcm90b3R5cGUuY2xvc2VBbGwgPSBmdW5jdGlvbiBjbG9zZUFsbCgpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgdGhpcy5nZXRJdGVtcygpLmVhY2goZnVuY3Rpb24gKF8sIGVsZW1lbnQpIHsKICAgICAgcmV0dXJuIHRoaXMkMS5jbG9zZShlbGVtZW50KTsKICAgIH0pOwogIH07CgogIHZhciBDb2xsYXBzZSA9IC8qQF9fUFVSRV9fKi9mdW5jdGlvbiAoQ29sbGFwc2VBYnN0cmFjdCkgewogICAgZnVuY3Rpb24gQ29sbGFwc2UoKSB7CiAgICAgIENvbGxhcHNlQWJzdHJhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBpZiAoQ29sbGFwc2VBYnN0cmFjdCkgQ29sbGFwc2UuX19wcm90b19fID0gQ29sbGFwc2VBYnN0cmFjdDsKICAgIENvbGxhcHNlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoQ29sbGFwc2VBYnN0cmFjdCAmJiBDb2xsYXBzZUFic3RyYWN0LnByb3RvdHlwZSk7CiAgICBDb2xsYXBzZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBDb2xsYXBzZTsKCiAgICBDb2xsYXBzZS5wcm90b3R5cGUuZ2V0TmFtZXNwYWNlID0gZnVuY3Rpb24gZ2V0TmFtZXNwYWNlKCkgewogICAgICByZXR1cm4gJ2NvbGxhcHNlJzsKICAgIH07CgogICAgcmV0dXJuIENvbGxhcHNlOwogIH0oQ29sbGFwc2VBYnN0cmFjdCk7CgogIG1kdWkuQ29sbGFwc2UgPSBDb2xsYXBzZTsKICB2YXIgY3VzdG9tQXR0ciQxID0gJ21kdWktY29sbGFwc2UnOwogICQoZnVuY3Rpb24gKCkgewogICAgbWR1aS5tdXRhdGlvbigiWyIgKyBjdXN0b21BdHRyJDEgKyAiXSIsIGZ1bmN0aW9uICgpIHsKICAgICAgbmV3IG1kdWkuQ29sbGFwc2UodGhpcywgcGFyc2VPcHRpb25zKHRoaXMsIGN1c3RvbUF0dHIkMSkpOwogICAgfSk7CiAgfSk7CgogIHZhciBQYW5lbCA9IC8qQF9fUFVSRV9fKi9mdW5jdGlvbiAoQ29sbGFwc2VBYnN0cmFjdCkgewogICAgZnVuY3Rpb24gUGFuZWwoKSB7CiAgICAgIENvbGxhcHNlQWJzdHJhY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KCiAgICBpZiAoQ29sbGFwc2VBYnN0cmFjdCkgUGFuZWwuX19wcm90b19fID0gQ29sbGFwc2VBYnN0cmFjdDsKICAgIFBhbmVsLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoQ29sbGFwc2VBYnN0cmFjdCAmJiBDb2xsYXBzZUFic3RyYWN0LnByb3RvdHlwZSk7CiAgICBQYW5lbC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBQYW5lbDsKCiAgICBQYW5lbC5wcm90b3R5cGUuZ2V0TmFtZXNwYWNlID0gZnVuY3Rpb24gZ2V0TmFtZXNwYWNlKCkgewogICAgICByZXR1cm4gJ3BhbmVsJzsKICAgIH07CgogICAgcmV0dXJuIFBhbmVsOwogIH0oQ29sbGFwc2VBYnN0cmFjdCk7CgogIG1kdWkuUGFuZWwgPSBQYW5lbDsKICB2YXIgY3VzdG9tQXR0ciQyID0gJ21kdWktcGFuZWwnOwogICQoZnVuY3Rpb24gKCkgewogICAgbWR1aS5tdXRhdGlvbigiWyIgKyBjdXN0b21BdHRyJDIgKyAiXSIsIGZ1bmN0aW9uICgpIHsKICAgICAgbmV3IG1kdWkuUGFuZWwodGhpcywgcGFyc2VPcHRpb25zKHRoaXMsIGN1c3RvbUF0dHIkMikpOwogICAgfSk7CiAgfSk7CgogIHZhciBUYWJsZSA9IGZ1bmN0aW9uIFRhYmxlKHNlbGVjdG9yKSB7CiAgICAvKioNCiAgICAgKiDooajlpLQgdHIg5YWD57SgDQogICAgICovCiAgICB0aGlzLiR0aFJvdyA9ICQoKTsKICAgIC8qKg0KICAgICAqIOihqOagvCBib2R5IOS4reeahCB0ciDlhYPntKANCiAgICAgKi8KCiAgICB0aGlzLiR0ZFJvd3MgPSAkKCk7CiAgICAvKioNCiAgICAgKiDooajlpLTnmoQgY2hlY2tib3gg5YWD57SgDQogICAgICovCgogICAgdGhpcy4kdGhDaGVja2JveCA9ICQoKTsKICAgIC8qKg0KICAgICAqIOihqOagvCBib2R5IOS4reeahCBjaGVja2JveCDlhYPntKANCiAgICAgKi8KCiAgICB0aGlzLiR0ZENoZWNrYm94cyA9ICQoKTsKICAgIC8qKg0KICAgICAqIOihqOagvOihjOaYr+WQpuWPr+mAieaLqQ0KICAgICAqLwoKICAgIHRoaXMuc2VsZWN0YWJsZSA9IGZhbHNlOwogICAgLyoqDQogICAgICog5bey6YCJ5Lit55qE6KGM5pWwDQogICAgICovCgogICAgdGhpcy5zZWxlY3RlZFJvdyA9IDA7CiAgICB0aGlzLiRlbGVtZW50ID0gJChzZWxlY3RvcikuZmlyc3QoKTsKICAgIHRoaXMuaW5pdCgpOwogIH07CiAgLyoqDQogICAqIOWIneWni+WMluihqOagvA0KICAgKi8KCgogIFRhYmxlLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gaW5pdCgpIHsKICAgIHRoaXMuJHRoUm93ID0gdGhpcy4kZWxlbWVudC5maW5kKCd0aGVhZCB0cicpOwogICAgdGhpcy4kdGRSb3dzID0gdGhpcy4kZWxlbWVudC5maW5kKCd0Ym9keSB0cicpOwogICAgdGhpcy5zZWxlY3RhYmxlID0gdGhpcy4kZWxlbWVudC5oYXNDbGFzcygnbWR1aS10YWJsZS1zZWxlY3RhYmxlJyk7CiAgICB0aGlzLnVwZGF0ZVRoQ2hlY2tib3goKTsKICAgIHRoaXMudXBkYXRlVGRDaGVja2JveCgpOwogICAgdGhpcy51cGRhdGVOdW1lcmljQ29sKCk7CiAgfTsKICAvKioNCiAgICog55Sf5oiQIGNoZWNrYm94IOeahCBIVE1MIOe7k+aehA0KICAgKiBAcGFyYW0gdGFnIOagh+etvuWQjQ0KICAgKi8KCgogIFRhYmxlLnByb3RvdHlwZS5jcmVhdGVDaGVja2JveEhUTUwgPSBmdW5jdGlvbiBjcmVhdGVDaGVja2JveEhUTUwodGFnKSB7CiAgICByZXR1cm4gIjwiICsgdGFnICsgIiBjbGFzcz1cIm1kdWktdGFibGUtY2VsbC1jaGVja2JveFwiPiIgKyAnPGxhYmVsIGNsYXNzPSJtZHVpLWNoZWNrYm94Ij4nICsgJzxpbnB1dCB0eXBlPSJjaGVja2JveCIvPicgKyAnPGkgY2xhc3M9Im1kdWktY2hlY2tib3gtaWNvbiI+PC9pPicgKyAnPC9sYWJlbD4nICsgIjwvIiArIHRhZyArICI+IjsKICB9OwogIC8qKg0KICAgKiDmm7TmlrDooajlpLQgY2hlY2tib3gg55qE54q25oCBDQogICAqLwoKCiAgVGFibGUucHJvdG90eXBlLnVwZGF0ZVRoQ2hlY2tib3hTdGF0dXMgPSBmdW5jdGlvbiB1cGRhdGVUaENoZWNrYm94U3RhdHVzKCkgewogICAgdmFyIGNoZWNrYm94ID0gdGhpcy4kdGhDaGVja2JveFswXTsKICAgIHZhciBzZWxlY3RlZFJvdyA9IHRoaXMuc2VsZWN0ZWRSb3c7CiAgICB2YXIgdGRSb3dzTGVuZ3RoID0gdGhpcy4kdGRSb3dzLmxlbmd0aDsKICAgIGNoZWNrYm94LmNoZWNrZWQgPSBzZWxlY3RlZFJvdyA9PT0gdGRSb3dzTGVuZ3RoOwogICAgY2hlY2tib3guaW5kZXRlcm1pbmF0ZSA9ICEhc2VsZWN0ZWRSb3cgJiYgc2VsZWN0ZWRSb3cgIT09IHRkUm93c0xlbmd0aDsKICB9OwogIC8qKg0KICAgKiDmm7TmlrDooajmoLzooYznmoQgY2hlY2tib3gNCiAgICovCgoKICBUYWJsZS5wcm90b3R5cGUudXBkYXRlVGRDaGVja2JveCA9IGZ1bmN0aW9uIHVwZGF0ZVRkQ2hlY2tib3goKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgIHZhciByb3dTZWxlY3RlZENsYXNzID0gJ21kdWktdGFibGUtcm93LXNlbGVjdGVkJzsKICAgIHRoaXMuJHRkUm93cy5lYWNoKGZ1bmN0aW9uIChfLCByb3cpIHsKICAgICAgdmFyICRyb3cgPSAkKHJvdyk7IC8vIOenu+mZpOaXp+eahCBjaGVja2JveAoKICAgICAgJHJvdy5maW5kKCcubWR1aS10YWJsZS1jZWxsLWNoZWNrYm94JykucmVtb3ZlKCk7CgogICAgICBpZiAoIXRoaXMkMS5zZWxlY3RhYmxlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIOWIm+W7uiBET00KCgogICAgICB2YXIgJGNoZWNrYm94ID0gJCh0aGlzJDEuY3JlYXRlQ2hlY2tib3hIVE1MKCd0ZCcpKS5wcmVwZW5kVG8oJHJvdykuZmluZCgnaW5wdXRbdHlwZT0iY2hlY2tib3giXScpOyAvLyDpu5jorqTpgInkuK3nmoTooYwKCiAgICAgIGlmICgkcm93Lmhhc0NsYXNzKHJvd1NlbGVjdGVkQ2xhc3MpKSB7CiAgICAgICAgJGNoZWNrYm94WzBdLmNoZWNrZWQgPSB0cnVlOwogICAgICAgIHRoaXMkMS5zZWxlY3RlZFJvdysrOwogICAgICB9CgogICAgICB0aGlzJDEudXBkYXRlVGhDaGVja2JveFN0YXR1cygpOyAvLyDnu5Hlrprkuovku7YKCiAgICAgICRjaGVja2JveC5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkgewogICAgICAgIGlmICgkY2hlY2tib3hbMF0uY2hlY2tlZCkgewogICAgICAgICAgJHJvdy5hZGRDbGFzcyhyb3dTZWxlY3RlZENsYXNzKTsKICAgICAgICAgIHRoaXMkMS5zZWxlY3RlZFJvdysrOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAkcm93LnJlbW92ZUNsYXNzKHJvd1NlbGVjdGVkQ2xhc3MpOwogICAgICAgICAgdGhpcyQxLnNlbGVjdGVkUm93LS07CiAgICAgICAgfQoKICAgICAgICB0aGlzJDEudXBkYXRlVGhDaGVja2JveFN0YXR1cygpOwogICAgICB9KTsKICAgICAgdGhpcyQxLiR0ZENoZWNrYm94cyA9IHRoaXMkMS4kdGRDaGVja2JveHMuYWRkKCRjaGVja2JveCk7CiAgICB9KTsKICB9OwogIC8qKg0KICAgKiDmm7TmlrDooajlpLTnmoQgY2hlY2tib3gNCiAgICovCgoKICBUYWJsZS5wcm90b3R5cGUudXBkYXRlVGhDaGVja2JveCA9IGZ1bmN0aW9uIHVwZGF0ZVRoQ2hlY2tib3goKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsgLy8g56e76Zmk5pen55qEIGNoZWNrYm94CgogICAgdGhpcy4kdGhSb3cuZmluZCgnLm1kdWktdGFibGUtY2VsbC1jaGVja2JveCcpLnJlbW92ZSgpOwoKICAgIGlmICghdGhpcy5zZWxlY3RhYmxlKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLiR0aENoZWNrYm94ID0gJCh0aGlzLmNyZWF0ZUNoZWNrYm94SFRNTCgndGgnKSkucHJlcGVuZFRvKHRoaXMuJHRoUm93KS5maW5kKCdpbnB1dFt0eXBlPSJjaGVja2JveCJdJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGlzQ2hlY2tlZEFsbCA9IHRoaXMkMS4kdGhDaGVja2JveFswXS5jaGVja2VkOwogICAgICB0aGlzJDEuc2VsZWN0ZWRSb3cgPSBpc0NoZWNrZWRBbGwgPyB0aGlzJDEuJHRkUm93cy5sZW5ndGggOiAwOwogICAgICB0aGlzJDEuJHRkQ2hlY2tib3hzLmVhY2goZnVuY3Rpb24gKF8sIGNoZWNrYm94KSB7CiAgICAgICAgY2hlY2tib3guY2hlY2tlZCA9IGlzQ2hlY2tlZEFsbDsKICAgICAgfSk7CiAgICAgIHRoaXMkMS4kdGRSb3dzLmVhY2goZnVuY3Rpb24gKF8sIHJvdykgewogICAgICAgIGlzQ2hlY2tlZEFsbCA/ICQocm93KS5hZGRDbGFzcygnbWR1aS10YWJsZS1yb3ctc2VsZWN0ZWQnKSA6ICQocm93KS5yZW1vdmVDbGFzcygnbWR1aS10YWJsZS1yb3ctc2VsZWN0ZWQnKTsKICAgICAgfSk7CiAgICB9KTsKICB9OwogIC8qKg0KICAgKiDmm7TmlrDmlbDlgLzliJcNCiAgICovCgoKICBUYWJsZS5wcm90b3R5cGUudXBkYXRlTnVtZXJpY0NvbCA9IGZ1bmN0aW9uIHVwZGF0ZU51bWVyaWNDb2woKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgIHZhciBudW1lcmljQ2xhc3MgPSAnbWR1aS10YWJsZS1jb2wtbnVtZXJpYyc7CiAgICB0aGlzLiR0aFJvdy5maW5kKCd0aCcpLmVhY2goZnVuY3Rpb24gKGksIHRoKSB7CiAgICAgIHZhciBpc051bWVyaWNDb2wgPSAkKHRoKS5oYXNDbGFzcyhudW1lcmljQ2xhc3MpOwogICAgICB0aGlzJDEuJHRkUm93cy5lYWNoKGZ1bmN0aW9uIChfLCByb3cpIHsKICAgICAgICB2YXIgJHRkID0gJChyb3cpLmZpbmQoJ3RkJykuZXEoaSk7CiAgICAgICAgaXNOdW1lcmljQ29sID8gJHRkLmFkZENsYXNzKG51bWVyaWNDbGFzcykgOiAkdGQucmVtb3ZlQ2xhc3MobnVtZXJpY0NsYXNzKTsKICAgICAgfSk7CiAgICB9KTsKICB9OwoKICB2YXIgZGF0YU5hbWUgPSAnX21kdWlfdGFibGUnOwogICQoZnVuY3Rpb24gKCkgewogICAgbWR1aS5tdXRhdGlvbignLm1kdWktdGFibGUnLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciAkZWxlbWVudCA9ICQodGhpcyk7CgogICAgICBpZiAoISRlbGVtZW50LmRhdGEoZGF0YU5hbWUpKSB7CiAgICAgICAgJGVsZW1lbnQuZGF0YShkYXRhTmFtZSwgbmV3IFRhYmxlKCRlbGVtZW50KSk7CiAgICAgIH0KICAgIH0pOwogIH0pOwoKICBtZHVpLnVwZGF0ZVRhYmxlcyA9IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgdmFyICRlbGVtZW50cyA9IGlzVW5kZWZpbmVkKHNlbGVjdG9yKSA/ICQoJy5tZHVpLXRhYmxlJykgOiAkKHNlbGVjdG9yKTsKICAgICRlbGVtZW50cy5lYWNoKGZ1bmN0aW9uIChfLCBlbGVtZW50KSB7CiAgICAgIHZhciAkZWxlbWVudCA9ICQoZWxlbWVudCk7CiAgICAgIHZhciBpbnN0YW5jZSA9ICRlbGVtZW50LmRhdGEoZGF0YU5hbWUpOwoKICAgICAgaWYgKGluc3RhbmNlKSB7CiAgICAgICAgaW5zdGFuY2UuaW5pdCgpOwogICAgICB9IGVsc2UgewogICAgICAgICRlbGVtZW50LmRhdGEoZGF0YU5hbWUsIG5ldyBUYWJsZSgkZWxlbWVudCkpOwogICAgICB9CiAgICB9KTsKICB9OwogIC8qKg0KICAgKiB0b3VjaCDkuovku7blkI7nmoQgNTAwbXMg5YaF56aB55SoIG1vdXNlZG93biDkuovku7YNCiAgICoNCiAgICog5LiN5pSv5oyB6Kem5o6n55qE5bGP5bmV5LiK5LqL5Lu26aG65bqP5Li6IG1vdXNlZG93biAtPiBtb3VzZXVwIC0+IGNsaWNrDQogICAqIOaUr+aMgeinpuaOp+eahOWxj+W5leS4iuS6i+S7tumhuuW6j+S4uiB0b3VjaHN0YXJ0IC0+IHRvdWNoZW5kIC0+IG1vdXNlZG93biAtPiBtb3VzZXVwIC0+IGNsaWNrDQogICAqDQogICAqIOWcqOavj+S4gOS4quS6i+S7tuS4remDveS9v+eUqCBUb3VjaEhhbmRsZXIuaXNBbGxvdyhldmVudCkg5Yik5pat5LqL5Lu25piv5ZCm5Y+v5omn6KGMDQogICAqIOWcqCB0b3VjaHN0YXJ0IOWSjCB0b3VjaG1vdmXjgIF0b3VjaGVuZOOAgXRvdWNoY2FuY2VsDQogICAqDQogICAqIChmdW5jdGlvbiAoKSB7DQogICAqICAgJGRvY3VtZW50DQogICAqICAgICAub24oc3RhcnQsIGZ1bmN0aW9uIChlKSB7DQogICAqICAgICAgIGlmICghaXNBbGxvdyhlKSkgew0KICAgKiAgICAgICAgIHJldHVybjsNCiAgICogICAgICAgfQ0KICAgKiAgICAgICByZWdpc3RlcihlKTsNCiAgICogICAgICAgY29uc29sZS5sb2coZS50eXBlKTsNCiAgICogICAgIH0pDQogICAqICAgICAub24obW92ZSwgZnVuY3Rpb24gKGUpIHsNCiAgICogICAgICAgaWYgKCFpc0FsbG93KGUpKSB7DQogICAqICAgICAgICAgcmV0dXJuOw0KICAgKiAgICAgICB9DQogICAqICAgICAgIGNvbnNvbGUubG9nKGUudHlwZSk7DQogICAqICAgICB9KQ0KICAgKiAgICAgLm9uKGVuZCwgZnVuY3Rpb24gKGUpIHsNCiAgICogICAgICAgaWYgKCFpc0FsbG93KGUpKSB7DQogICAqICAgICAgICAgcmV0dXJuOw0KICAgKiAgICAgICB9DQogICAqICAgICAgIGNvbnNvbGUubG9nKGUudHlwZSk7DQogICAqICAgICB9KQ0KICAgKiAgICAgLm9uKHVubG9jaywgcmVnaXN0ZXIpOw0KICAgKiB9KSgpOw0KICAgKi8KCgogIHZhciBzdGFydEV2ZW50ID0gJ3RvdWNoc3RhcnQgbW91c2Vkb3duJzsKICB2YXIgbW92ZUV2ZW50ID0gJ3RvdWNobW92ZSBtb3VzZW1vdmUnOwogIHZhciBlbmRFdmVudCA9ICd0b3VjaGVuZCBtb3VzZXVwJzsKICB2YXIgY2FuY2VsRXZlbnQgPSAndG91Y2hjYW5jZWwgbW91c2VsZWF2ZSc7CiAgdmFyIHVubG9ja0V2ZW50ID0gJ3RvdWNoZW5kIHRvdWNobW92ZSB0b3VjaGNhbmNlbCc7CiAgdmFyIHRvdWNoZXMgPSAwOwogIC8qKg0KICAgKiDor6Xkuovku7bmmK/lkKbooqvlhYHorrjvvIzlnKjmiafooYzkuovku7bliY3osIPnlKjor6Xmlrnms5XliKTmlq3kuovku7bmmK/lkKblj6/ku6XmiafooYwNCiAgICog6Iul5bey6Kem5Y+RIHRvdWNoIOS6i+S7tu+8jOWImemYu+atouS5i+WQjueahOm8oOagh+S6i+S7tg0KICAgKiBAcGFyYW0gZXZlbnQNCiAgICovCgogIGZ1bmN0aW9uIGlzQWxsb3coZXZlbnQpIHsKICAgIHJldHVybiAhKHRvdWNoZXMgJiYgWydtb3VzZWRvd24nLCAnbW91c2V1cCcsICdtb3VzZW1vdmUnLCAnY2xpY2snLCAnbW91c2VvdmVyJywgJ21vdXNlb3V0JywgJ21vdXNlZW50ZXInLCAnbW91c2VsZWF2ZSddLmluZGV4T2YoZXZlbnQudHlwZSkgPiAtMSk7CiAgfQogIC8qKg0KICAgKiDlnKggdG91Y2hzdGFydCDlkowgdG91Y2htb3Zl44CBdG91Y2hlbmTjgIF0b3VjaGNhbmNlbCDkuovku7bkuK3osIPnlKjor6Xmlrnms5Xms6jlhozkuovku7YNCiAgICogQHBhcmFtIGV2ZW50DQogICAqLwoKCiAgZnVuY3Rpb24gcmVnaXN0ZXIoZXZlbnQpIHsKICAgIGlmIChldmVudC50eXBlID09PSAndG91Y2hzdGFydCcpIHsKICAgICAgLy8g6Kem5Y+R5LqGIHRvdWNoIOS6i+S7tgogICAgICB0b3VjaGVzICs9IDE7CiAgICB9IGVsc2UgaWYgKFsndG91Y2htb3ZlJywgJ3RvdWNoZW5kJywgJ3RvdWNoY2FuY2VsJ10uaW5kZXhPZihldmVudC50eXBlKSA+IC0xKSB7CiAgICAgIC8vIHRvdWNoIOS6i+S7tue7k+adnyA1MDBtcyDlkI7op6PpmaTlr7npvKDmoIfkuovku7bnmoTpmLvmraIKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRvdWNoZXMpIHsKICAgICAgICAgIHRvdWNoZXMgLT0gMTsKICAgICAgICB9CiAgICAgIH0sIDUwMCk7CiAgICB9CiAgfQogIC8qKg0KICAgKiBJbnNwaXJlZCBieSBodHRwczovL2dpdGh1Yi5jb20vbm9saW1pdHM0d2ViL0ZyYW1ld29yazcvYmxvYi9tYXN0ZXIvc3JjL2pzL2Zhc3QtY2xpY2tzLmpzDQogICAqIGh0dHBzOi8vZ2l0aHViLmNvbS9ub2xpbWl0czR3ZWIvRnJhbWV3b3JrNy9ibG9iL21hc3Rlci9MSUNFTlNFDQogICAqDQogICAqIEluc3BpcmVkIGJ5IGh0dHBzOi8vZ2l0aHViLmNvbS9maWFucy9XYXZlcw0KICAgKi8KCiAgLyoqDQogICAqIOaYvuekuua2n+a8quWKqOeUuw0KICAgKiBAcGFyYW0gZXZlbnQNCiAgICogQHBhcmFtICRyaXBwbGUNCiAgICovCgoKICBmdW5jdGlvbiBzaG93KGV2ZW50LCAkcmlwcGxlKSB7CiAgICAvLyDpvKDmoIflj7PplK7kuI3kuqfnlJ/mtp/mvKoKICAgIGlmIChldmVudCBpbnN0YW5jZW9mIE1vdXNlRXZlbnQgJiYgZXZlbnQuYnV0dG9uID09PSAyKSB7CiAgICAgIHJldHVybjsKICAgIH0gLy8g54K55Ye75L2N572u5Z2Q5qCHCgoKICAgIHZhciB0b3VjaFBvc2l0aW9uID0gdHlwZW9mIFRvdWNoRXZlbnQgIT09ICd1bmRlZmluZWQnICYmIGV2ZW50IGluc3RhbmNlb2YgVG91Y2hFdmVudCAmJiBldmVudC50b3VjaGVzLmxlbmd0aCA/IGV2ZW50LnRvdWNoZXNbMF0gOiBldmVudDsKICAgIHZhciB0b3VjaFN0YXJ0WCA9IHRvdWNoUG9zaXRpb24ucGFnZVg7CiAgICB2YXIgdG91Y2hTdGFydFkgPSB0b3VjaFBvc2l0aW9uLnBhZ2VZOyAvLyDmtp/mvKrkvY3nva4KCiAgICB2YXIgb2Zmc2V0ID0gJHJpcHBsZS5vZmZzZXQoKTsKICAgIHZhciBoZWlnaHQgPSAkcmlwcGxlLmlubmVySGVpZ2h0KCk7CiAgICB2YXIgd2lkdGggPSAkcmlwcGxlLmlubmVyV2lkdGgoKTsKICAgIHZhciBjZW50ZXIgPSB7CiAgICAgIHg6IHRvdWNoU3RhcnRYIC0gb2Zmc2V0LmxlZnQsCiAgICAgIHk6IHRvdWNoU3RhcnRZIC0gb2Zmc2V0LnRvcAogICAgfTsKICAgIHZhciBkaWFtZXRlciA9IE1hdGgubWF4KE1hdGgucG93KE1hdGgucG93KGhlaWdodCwgMikgKyBNYXRoLnBvdyh3aWR0aCwgMiksIDAuNSksIDQ4KTsgLy8g5raf5ryq5omp5pWj5Yqo55S7CgogICAgdmFyIHRyYW5zbGF0ZSA9ICJ0cmFuc2xhdGUzZCgiICsgKC1jZW50ZXIueCArIHdpZHRoIC8gMikgKyAicHgsIiArICgtY2VudGVyLnkgKyBoZWlnaHQgLyAyKSArICJweCwgMCkgc2NhbGUoMSkiOyAvLyDmtp/mvKrnmoQgRE9NIOe7k+aehO+8jOW5tue8k+WtmOWKqOeUu+aViOaenAoKICAgICQoIjxkaXYgY2xhc3M9XCJtZHVpLXJpcHBsZS13YXZlXCIgIiArICJzdHlsZT1cIndpZHRoOiIgKyBkaWFtZXRlciArICJweDtoZWlnaHQ6IiArIGRpYW1ldGVyICsgInB4OyIgKyAibWFyZ2luLXRvcDotIiArIGRpYW1ldGVyIC8gMiArICJweDttYXJnaW4tbGVmdDotIiArIGRpYW1ldGVyIC8gMiArICJweDsiICsgImxlZnQ6IiArIGNlbnRlci54ICsgInB4O3RvcDoiICsgY2VudGVyLnkgKyAicHg7XCI+PC9kaXY+IikuZGF0YSgnX3JpcHBsZV93YXZlX3RyYW5zbGF0ZScsIHRyYW5zbGF0ZSkucHJlcGVuZFRvKCRyaXBwbGUpLnJlZmxvdygpLnRyYW5zZm9ybSh0cmFuc2xhdGUpOwogIH0KICAvKioNCiAgICog6ZqQ6JeP5bm256e76Zmk5raf5ryqDQogICAqIEBwYXJhbSAkd2F2ZQ0KICAgKi8KCgogIGZ1bmN0aW9uIHJlbW92ZVJpcHBsZSgkd2F2ZSkgewogICAgaWYgKCEkd2F2ZS5sZW5ndGggfHwgJHdhdmUuZGF0YSgnX3JpcHBsZV93YXZlX3JlbW92ZWQnKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgJHdhdmUuZGF0YSgnX3JpcHBsZV93YXZlX3JlbW92ZWQnLCB0cnVlKTsKICAgIHZhciByZW1vdmVUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gJHdhdmUucmVtb3ZlKCk7CiAgICB9LCA0MDApOwogICAgdmFyIHRyYW5zbGF0ZSA9ICR3YXZlLmRhdGEoJ19yaXBwbGVfd2F2ZV90cmFuc2xhdGUnKTsKICAgICR3YXZlLmFkZENsYXNzKCdtZHVpLXJpcHBsZS13YXZlLWZpbGwnKS50cmFuc2Zvcm0odHJhbnNsYXRlLnJlcGxhY2UoJ3NjYWxlKDEpJywgJ3NjYWxlKDEuMDEpJykpLnRyYW5zaXRpb25FbmQoZnVuY3Rpb24gKCkgewogICAgICBjbGVhclRpbWVvdXQocmVtb3ZlVGltZXIpOwogICAgICAkd2F2ZS5hZGRDbGFzcygnbWR1aS1yaXBwbGUtd2F2ZS1vdXQnKS50cmFuc2Zvcm0odHJhbnNsYXRlLnJlcGxhY2UoJ3NjYWxlKDEpJywgJ3NjYWxlKDEuMDEpJykpOwogICAgICByZW1vdmVUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiAkd2F2ZS5yZW1vdmUoKTsKICAgICAgfSwgNzAwKTsKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgJHdhdmUudHJhbnNpdGlvbkVuZChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQocmVtb3ZlVGltZXIpOwogICAgICAgICAgJHdhdmUucmVtb3ZlKCk7CiAgICAgICAgfSk7CiAgICAgIH0sIDApOwogICAgfSk7CiAgfQogIC8qKg0KICAgKiDpmpDol4/mtp/mvKrliqjnlLsNCiAgICogQHBhcmFtIHRoaXMNCiAgICovCgoKICBmdW5jdGlvbiBoaWRlKCkgewogICAgdmFyICRyaXBwbGUgPSAkKHRoaXMpOwogICAgJHJpcHBsZS5jaGlsZHJlbignLm1kdWktcmlwcGxlLXdhdmUnKS5lYWNoKGZ1bmN0aW9uIChfLCB3YXZlKSB7CiAgICAgIHJlbW92ZVJpcHBsZSgkKHdhdmUpKTsKICAgIH0pOwogICAgJHJpcHBsZS5vZmYobW92ZUV2ZW50ICsgIiAiICsgZW5kRXZlbnQgKyAiICIgKyBjYW5jZWxFdmVudCwgaGlkZSk7CiAgfQogIC8qKg0KICAgKiDmmL7npLrmtp/mvKrvvIzlubbnu5HlrpogdG91Y2hlbmQg562J5LqL5Lu2DQogICAqIEBwYXJhbSBldmVudA0KICAgKi8KCgogIGZ1bmN0aW9uIHNob3dSaXBwbGUoZXZlbnQpIHsKICAgIGlmICghaXNBbGxvdyhldmVudCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHJlZ2lzdGVyKGV2ZW50KTsgLy8gQ2hyb21lIDU5IOeCueWHu+a7muWKqOadoeaXtu+8jOS8muWcqCBkb2N1bWVudCDkuIrop6blj5Hkuovku7YKCiAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSBkb2N1bWVudCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyICR0YXJnZXQgPSAkKGV2ZW50LnRhcmdldCk7IC8vIOiOt+WPluWQqyAubWR1aS1yaXBwbGUg57G755qE5YWD57SgCgogICAgdmFyICRyaXBwbGUgPSAkdGFyZ2V0Lmhhc0NsYXNzKCdtZHVpLXJpcHBsZScpID8gJHRhcmdldCA6ICR0YXJnZXQucGFyZW50cygnLm1kdWktcmlwcGxlJykuZmlyc3QoKTsKCiAgICBpZiAoISRyaXBwbGUubGVuZ3RoKSB7CiAgICAgIHJldHVybjsKICAgIH0gLy8g56aB55So54q25oCB55qE5YWD57Sg5LiK5LiN5Lqn55Sf5raf5ryq5pWI5p6cCgoKICAgIGlmICgkcmlwcGxlLnByb3AoJ2Rpc2FibGVkJykgfHwgIWlzVW5kZWZpbmVkKCRyaXBwbGUuYXR0cignZGlzYWJsZWQnKSkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmIChldmVudC50eXBlID09PSAndG91Y2hzdGFydCcpIHsKICAgICAgdmFyIGhpZGRlbiA9IGZhbHNlOyAvLyB0b3VjaHN0YXJ0IOinpuWPkeaMh+WumuaXtumXtOWQjuW8gOWni+a2n+a8quWKqOeUu++8jOmBv+WFjeaJi+aMh+a7keWKqOaXtuS5n+inpuWPkea2n+a8qgoKICAgICAgdmFyIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgdGltZXIgPSAwOwogICAgICAgIHNob3coZXZlbnQsICRyaXBwbGUpOwogICAgICB9LCAyMDApOwoKICAgICAgdmFyIGhpZGVSaXBwbGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgLy8g5aaC5p6c5omL5oyH5rKh5pyJ56e75Yqo77yM5LiU5raf5ryq5Yqo55S76L+Y5rKh5pyJ5byA5aeL77yM5YiZ5byA5aeL5raf5ryq5Yqo55S7CiAgICAgICAgaWYgKHRpbWVyKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpOwogICAgICAgICAgdGltZXIgPSAwOwogICAgICAgICAgc2hvdyhldmVudCwgJHJpcHBsZSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIWhpZGRlbikgewogICAgICAgICAgaGlkZGVuID0gdHJ1ZTsKICAgICAgICAgIGhpZGUuY2FsbCgkcmlwcGxlKTsKICAgICAgICB9CiAgICAgIH07IC8vIOaJi+aMh+enu+WKqOWQju+8jOenu+mZpOa2n+a8quWKqOeUuwoKCiAgICAgIHZhciB0b3VjaE1vdmUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRpbWVyKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpOwogICAgICAgICAgdGltZXIgPSAwOwogICAgICAgIH0KCiAgICAgICAgaGlkZVJpcHBsZSgpOwogICAgICB9OwoKICAgICAgJHJpcHBsZS5vbigndG91Y2htb3ZlJywgdG91Y2hNb3ZlKS5vbigndG91Y2hlbmQgdG91Y2hjYW5jZWwnLCBoaWRlUmlwcGxlKTsKICAgIH0gZWxzZSB7CiAgICAgIHNob3coZXZlbnQsICRyaXBwbGUpOwogICAgICAkcmlwcGxlLm9uKG1vdmVFdmVudCArICIgIiArIGVuZEV2ZW50ICsgIiAiICsgY2FuY2VsRXZlbnQsIGhpZGUpOwogICAgfQogIH0KCiAgJChmdW5jdGlvbiAoKSB7CiAgICAkZG9jdW1lbnQub24oc3RhcnRFdmVudCwgc2hvd1JpcHBsZSkub24odW5sb2NrRXZlbnQsIHJlZ2lzdGVyKTsKICB9KTsKICB2YXIgZGVmYXVsdERhdGEgPSB7CiAgICByZUluaXQ6IGZhbHNlLAogICAgZG9tTG9hZGVkRXZlbnQ6IGZhbHNlCiAgfTsKICAvKioNCiAgICog6L6T5YWl5qGG5LqL5Lu2DQogICAqIEBwYXJhbSBldmVudA0KICAgKiBAcGFyYW0gZGF0YQ0KICAgKi8KCiAgZnVuY3Rpb24gaW5wdXRFdmVudChldmVudCwgZGF0YSkgewogICAgaWYgKGRhdGEgPT09IHZvaWQgMCkgZGF0YSA9IHt9OwogICAgZGF0YSA9IGV4dGVuZCh7fSwgZGVmYXVsdERhdGEsIGRhdGEpOwogICAgdmFyIGlucHV0ID0gZXZlbnQudGFyZ2V0OwogICAgdmFyICRpbnB1dCA9ICQoaW5wdXQpOwogICAgdmFyIGV2ZW50VHlwZSA9IGV2ZW50LnR5cGU7CiAgICB2YXIgdmFsdWUgPSAkaW5wdXQudmFsKCk7IC8vIOaWh+acrOahhuexu+WeiwoKICAgIHZhciBpbnB1dFR5cGUgPSAkaW5wdXQuYXR0cigndHlwZScpIHx8ICcnOwoKICAgIGlmIChbJ2NoZWNrYm94JywgJ2J1dHRvbicsICdzdWJtaXQnLCAncmFuZ2UnLCAncmFkaW8nLCAnaW1hZ2UnXS5pbmRleE9mKGlucHV0VHlwZSkgPiAtMSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyICR0ZXh0ZmllbGQgPSAkaW5wdXQucGFyZW50KCcubWR1aS10ZXh0ZmllbGQnKTsgLy8g6L6T5YWl5qGG5piv5ZCm6IGa54SmCgogICAgaWYgKGV2ZW50VHlwZSA9PT0gJ2ZvY3VzJykgewogICAgICAkdGV4dGZpZWxkLmFkZENsYXNzKCdtZHVpLXRleHRmaWVsZC1mb2N1cycpOwogICAgfQoKICAgIGlmIChldmVudFR5cGUgPT09ICdibHVyJykgewogICAgICAkdGV4dGZpZWxkLnJlbW92ZUNsYXNzKCdtZHVpLXRleHRmaWVsZC1mb2N1cycpOwogICAgfSAvLyDovpPlhaXmoYbmmK/lkKbkuLrnqboKCgogICAgaWYgKGV2ZW50VHlwZSA9PT0gJ2JsdXInIHx8IGV2ZW50VHlwZSA9PT0gJ2lucHV0JykgewogICAgICB2YWx1ZSA/ICR0ZXh0ZmllbGQuYWRkQ2xhc3MoJ21kdWktdGV4dGZpZWxkLW5vdC1lbXB0eScpIDogJHRleHRmaWVsZC5yZW1vdmVDbGFzcygnbWR1aS10ZXh0ZmllbGQtbm90LWVtcHR5Jyk7CiAgICB9IC8vIOi+k+WFpeahhuaYr+WQpuemgeeUqAoKCiAgICBpbnB1dC5kaXNhYmxlZCA/ICR0ZXh0ZmllbGQuYWRkQ2xhc3MoJ21kdWktdGV4dGZpZWxkLWRpc2FibGVkJykgOiAkdGV4dGZpZWxkLnJlbW92ZUNsYXNzKCdtZHVpLXRleHRmaWVsZC1kaXNhYmxlZCcpOyAvLyDooajljZXpqozor4EKCiAgICBpZiAoKGV2ZW50VHlwZSA9PT0gJ2lucHV0JyB8fCBldmVudFR5cGUgPT09ICdibHVyJykgJiYgIWRhdGEuZG9tTG9hZGVkRXZlbnQgJiYgaW5wdXQudmFsaWRpdHkpIHsKICAgICAgaW5wdXQudmFsaWRpdHkudmFsaWQgPyAkdGV4dGZpZWxkLnJlbW92ZUNsYXNzKCdtZHVpLXRleHRmaWVsZC1pbnZhbGlkLWh0bWw1JykgOiAkdGV4dGZpZWxkLmFkZENsYXNzKCdtZHVpLXRleHRmaWVsZC1pbnZhbGlkLWh0bWw1Jyk7CiAgICB9IC8vIHRleHRhcmVhIOmrmOW6puiHquWKqOiwg+aVtAoKCiAgICBpZiAoJGlucHV0LmlzKCd0ZXh0YXJlYScpKSB7CiAgICAgIC8vIElFIGJ1Z++8mnRleHRhcmVhIOeahOWAvOS7heS4uuWkmuS4quaNouihjO+8jOS4jeWQq+WFtuS7luWGheWuueaXtu+8jHRleHRhcmVhIOeahOmrmOW6puS4jeWHhuehrgogICAgICAvLyAgICAgICAgIOatpOaXtu+8jOWcqOiuoeeul+mrmOW6puWJje+8jOWcqOWAvOeahOW8gOWktOWKoOWFpeS4gOS4quepuuagvO+8jOiuoeeul+WujOWQju+8jOenu+mZpOepuuagvAogICAgICB2YXIgaW5wdXRWYWx1ZSA9IHZhbHVlOwogICAgICB2YXIgaGFzRXh0cmFTcGFjZSA9IGZhbHNlOwoKICAgICAgaWYgKGlucHV0VmFsdWUucmVwbGFjZSgvW1xyXG5dL2csICcnKSA9PT0gJycpIHsKICAgICAgICAkaW5wdXQudmFsKCcgJyArIGlucHV0VmFsdWUpOwogICAgICAgIGhhc0V4dHJhU3BhY2UgPSB0cnVlOwogICAgICB9IC8vIOiuvue9riB0ZXh0YXJlYSDpq5jluqYKCgogICAgICAkaW5wdXQub3V0ZXJIZWlnaHQoJycpOwogICAgICB2YXIgaGVpZ2h0ID0gJGlucHV0Lm91dGVySGVpZ2h0KCk7CiAgICAgIHZhciBzY3JvbGxIZWlnaHQgPSBpbnB1dC5zY3JvbGxIZWlnaHQ7CgogICAgICBpZiAoc2Nyb2xsSGVpZ2h0ID4gaGVpZ2h0KSB7CiAgICAgICAgJGlucHV0Lm91dGVySGVpZ2h0KHNjcm9sbEhlaWdodCk7CiAgICAgIH0gLy8g6K6h566X5a6M77yM6L+Y5Y6fIHRleHRhcmVhIOeahOWAvAoKCiAgICAgIGlmIChoYXNFeHRyYVNwYWNlKSB7CiAgICAgICAgJGlucHV0LnZhbChpbnB1dFZhbHVlKTsKICAgICAgfQogICAgfSAvLyDlrp7ml7blrZfmlbDnu5/orqEKCgogICAgaWYgKGRhdGEucmVJbml0KSB7CiAgICAgICR0ZXh0ZmllbGQuZmluZCgnLm1kdWktdGV4dGZpZWxkLWNvdW50ZXInKS5yZW1vdmUoKTsKICAgIH0KCiAgICB2YXIgbWF4TGVuZ3RoID0gJGlucHV0LmF0dHIoJ21heGxlbmd0aCcpOwoKICAgIGlmIChtYXhMZW5ndGgpIHsKICAgICAgaWYgKGRhdGEucmVJbml0IHx8IGRhdGEuZG9tTG9hZGVkRXZlbnQpIHsKICAgICAgICAkKCc8ZGl2IGNsYXNzPSJtZHVpLXRleHRmaWVsZC1jb3VudGVyIj4nICsgIjxzcGFuIGNsYXNzPVwibWR1aS10ZXh0ZmllbGQtY291bnRlci1pbnB1dGVkXCI+PC9zcGFuPiAvICIgKyBtYXhMZW5ndGggKyAnPC9kaXY+JykuYXBwZW5kVG8oJHRleHRmaWVsZCk7CiAgICAgIH0KCiAgICAgICR0ZXh0ZmllbGQuZmluZCgnLm1kdWktdGV4dGZpZWxkLWNvdW50ZXItaW5wdXRlZCcpLnRleHQodmFsdWUubGVuZ3RoLnRvU3RyaW5nKCkpOwogICAgfSAvLyDlkKsg5biu5Yqp5paH5pys44CB6ZSZ6K+v5o+Q56S644CB5a2X5pWw57uf6K6hIOaXtu+8jOWinuWKoOaWh+acrOahhuW6lemDqOWGhei+uei3nQoKCiAgICBpZiAoJHRleHRmaWVsZC5maW5kKCcubWR1aS10ZXh0ZmllbGQtaGVscGVyJykubGVuZ3RoIHx8ICR0ZXh0ZmllbGQuZmluZCgnLm1kdWktdGV4dGZpZWxkLWVycm9yJykubGVuZ3RoIHx8IG1heExlbmd0aCkgewogICAgICAkdGV4dGZpZWxkLmFkZENsYXNzKCdtZHVpLXRleHRmaWVsZC1oYXMtYm90dG9tJyk7CiAgICB9CiAgfQoKICAkKGZ1bmN0aW9uICgpIHsKICAgIC8vIOe7keWumuS6i+S7tgogICAgJGRvY3VtZW50Lm9uKCdpbnB1dCBmb2N1cyBibHVyJywgJy5tZHVpLXRleHRmaWVsZC1pbnB1dCcsIHsKICAgICAgdXNlQ2FwdHVyZTogdHJ1ZQogICAgfSwgaW5wdXRFdmVudCk7IC8vIOWPr+WxleW8gOaWh+acrOahhuWxleW8gAoKICAgICRkb2N1bWVudC5vbignY2xpY2snLCAnLm1kdWktdGV4dGZpZWxkLWV4cGFuZGFibGUgLm1kdWktdGV4dGZpZWxkLWljb24nLCBmdW5jdGlvbiAoKSB7CiAgICAgICQodGhpcykucGFyZW50cygnLm1kdWktdGV4dGZpZWxkJykuYWRkQ2xhc3MoJ21kdWktdGV4dGZpZWxkLWV4cGFuZGVkJykuZmluZCgnLm1kdWktdGV4dGZpZWxkLWlucHV0JylbMF0uZm9jdXMoKTsKICAgIH0pOyAvLyDlj6/lsZXlvIDmlofmnKzmoYblhbPpl60KCiAgICAkZG9jdW1lbnQub24oJ2NsaWNrJywgJy5tZHVpLXRleHRmaWVsZC1leHBhbmRlZCAubWR1aS10ZXh0ZmllbGQtY2xvc2UnLCBmdW5jdGlvbiAoKSB7CiAgICAgICQodGhpcykucGFyZW50cygnLm1kdWktdGV4dGZpZWxkJykucmVtb3ZlQ2xhc3MoJ21kdWktdGV4dGZpZWxkLWV4cGFuZGVkJykuZmluZCgnLm1kdWktdGV4dGZpZWxkLWlucHV0JykudmFsKCcnKTsKICAgIH0pOwogICAgLyoqDQogICAgICog5Yid5aeL5YyW5paH5pys5qGGDQogICAgICovCgogICAgbWR1aS5tdXRhdGlvbignLm1kdWktdGV4dGZpZWxkJywgZnVuY3Rpb24gKCkgewogICAgICAkKHRoaXMpLmZpbmQoJy5tZHVpLXRleHRmaWVsZC1pbnB1dCcpLnRyaWdnZXIoJ2lucHV0JywgewogICAgICAgIGRvbUxvYWRlZEV2ZW50OiB0cnVlCiAgICAgIH0pOwogICAgfSk7CiAgfSk7CgogIG1kdWkudXBkYXRlVGV4dEZpZWxkcyA9IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgdmFyICRlbGVtZW50cyA9IGlzVW5kZWZpbmVkKHNlbGVjdG9yKSA/ICQoJy5tZHVpLXRleHRmaWVsZCcpIDogJChzZWxlY3Rvcik7CiAgICAkZWxlbWVudHMuZWFjaChmdW5jdGlvbiAoXywgZWxlbWVudCkgewogICAgICAkKGVsZW1lbnQpLmZpbmQoJy5tZHVpLXRleHRmaWVsZC1pbnB1dCcpLnRyaWdnZXIoJ2lucHV0JywgewogICAgICAgIHJlSW5pdDogdHJ1ZQogICAgICB9KTsKICAgIH0pOwogIH07CiAgLyoqDQogICAqIOa7keWdl+eahOWAvOaUueWPmOWQjuS/ruaUuea7keWdl+agt+W8jw0KICAgKiBAcGFyYW0gJHNsaWRlcg0KICAgKi8KCgogIGZ1bmN0aW9uIHVwZGF0ZVZhbHVlU3R5bGUoJHNsaWRlcikgewogICAgdmFyIGRhdGEgPSAkc2xpZGVyLmRhdGEoKTsKICAgIHZhciAkdHJhY2sgPSBkYXRhLl9zbGlkZXJfJHRyYWNrOwogICAgdmFyICRmaWxsID0gZGF0YS5fc2xpZGVyXyRmaWxsOwogICAgdmFyICR0aHVtYiA9IGRhdGEuX3NsaWRlcl8kdGh1bWI7CiAgICB2YXIgJGlucHV0ID0gZGF0YS5fc2xpZGVyXyRpbnB1dDsKICAgIHZhciBtaW4gPSBkYXRhLl9zbGlkZXJfbWluOwogICAgdmFyIG1heCA9IGRhdGEuX3NsaWRlcl9tYXg7CiAgICB2YXIgaXNEaXNhYmxlZCA9IGRhdGEuX3NsaWRlcl9kaXNhYmxlZDsKICAgIHZhciBpc0Rpc2NyZXRlID0gZGF0YS5fc2xpZGVyX2Rpc2NyZXRlOwogICAgdmFyICR0aHVtYlRleHQgPSBkYXRhLl9zbGlkZXJfJHRodW1iVGV4dDsKICAgIHZhciB2YWx1ZSA9ICRpbnB1dC52YWwoKTsKICAgIHZhciBwZXJjZW50ID0gKHZhbHVlIC0gbWluKSAvIChtYXggLSBtaW4pICogMTAwOwogICAgJGZpbGwud2lkdGgocGVyY2VudCArICIlIik7CiAgICAkdHJhY2sud2lkdGgoMTAwIC0gcGVyY2VudCArICIlIik7CgogICAgaWYgKGlzRGlzYWJsZWQpIHsKICAgICAgJGZpbGwuY3NzKCdwYWRkaW5nLXJpZ2h0JywgJzZweCcpOwogICAgICAkdHJhY2suY3NzKCdwYWRkaW5nLWxlZnQnLCAnNnB4Jyk7CiAgICB9CgogICAgJHRodW1iLmNzcygnbGVmdCcsIHBlcmNlbnQgKyAiJSIpOwoKICAgIGlmIChpc0Rpc2NyZXRlKSB7CiAgICAgICR0aHVtYlRleHQudGV4dCh2YWx1ZSk7CiAgICB9CgogICAgcGVyY2VudCA9PT0gMCA/ICRzbGlkZXIuYWRkQ2xhc3MoJ21kdWktc2xpZGVyLXplcm8nKSA6ICRzbGlkZXIucmVtb3ZlQ2xhc3MoJ21kdWktc2xpZGVyLXplcm8nKTsKICB9CiAgLyoqDQogICAqIOmHjeaWsOWIneWni+WMlua7keWdlw0KICAgKiBAcGFyYW0gJHNsaWRlcg0KICAgKi8KCgogIGZ1bmN0aW9uIHJlSW5pdCgkc2xpZGVyKSB7CiAgICB2YXIgJHRyYWNrID0gJCgnPGRpdiBjbGFzcz0ibWR1aS1zbGlkZXItdHJhY2siPjwvZGl2PicpOwogICAgdmFyICRmaWxsID0gJCgnPGRpdiBjbGFzcz0ibWR1aS1zbGlkZXItZmlsbCI+PC9kaXY+Jyk7CiAgICB2YXIgJHRodW1iID0gJCgnPGRpdiBjbGFzcz0ibWR1aS1zbGlkZXItdGh1bWIiPjwvZGl2PicpOwogICAgdmFyICRpbnB1dCA9ICRzbGlkZXIuZmluZCgnaW5wdXRbdHlwZT0icmFuZ2UiXScpOwogICAgdmFyIGlzRGlzYWJsZWQgPSAkaW5wdXRbMF0uZGlzYWJsZWQ7CiAgICB2YXIgaXNEaXNjcmV0ZSA9ICRzbGlkZXIuaGFzQ2xhc3MoJ21kdWktc2xpZGVyLWRpc2NyZXRlJyk7IC8vIOemgeeUqOeKtuaAgQoKICAgIGlzRGlzYWJsZWQgPyAkc2xpZGVyLmFkZENsYXNzKCdtZHVpLXNsaWRlci1kaXNhYmxlZCcpIDogJHNsaWRlci5yZW1vdmVDbGFzcygnbWR1aS1zbGlkZXItZGlzYWJsZWQnKTsgLy8g6YeN5paw5aGr5YWFIEhUTUwKCiAgICAkc2xpZGVyLmZpbmQoJy5tZHVpLXNsaWRlci10cmFjaycpLnJlbW92ZSgpOwogICAgJHNsaWRlci5maW5kKCcubWR1aS1zbGlkZXItZmlsbCcpLnJlbW92ZSgpOwogICAgJHNsaWRlci5maW5kKCcubWR1aS1zbGlkZXItdGh1bWInKS5yZW1vdmUoKTsKICAgICRzbGlkZXIuYXBwZW5kKCR0cmFjaykuYXBwZW5kKCRmaWxsKS5hcHBlbmQoJHRodW1iKTsgLy8g6Ze057ut5Z6L5ruR5Z2XCgogICAgdmFyICR0aHVtYlRleHQgPSAkKCk7CgogICAgaWYgKGlzRGlzY3JldGUpIHsKICAgICAgJHRodW1iVGV4dCA9ICQoJzxzcGFuPjwvc3Bhbj4nKTsKICAgICAgJHRodW1iLmVtcHR5KCkuYXBwZW5kKCR0aHVtYlRleHQpOwogICAgfQoKICAgICRzbGlkZXIuZGF0YSgnX3NsaWRlcl8kdHJhY2snLCAkdHJhY2spOwogICAgJHNsaWRlci5kYXRhKCdfc2xpZGVyXyRmaWxsJywgJGZpbGwpOwogICAgJHNsaWRlci5kYXRhKCdfc2xpZGVyXyR0aHVtYicsICR0aHVtYik7CiAgICAkc2xpZGVyLmRhdGEoJ19zbGlkZXJfJGlucHV0JywgJGlucHV0KTsKICAgICRzbGlkZXIuZGF0YSgnX3NsaWRlcl9taW4nLCAkaW5wdXQuYXR0cignbWluJykpOwogICAgJHNsaWRlci5kYXRhKCdfc2xpZGVyX21heCcsICRpbnB1dC5hdHRyKCdtYXgnKSk7CiAgICAkc2xpZGVyLmRhdGEoJ19zbGlkZXJfZGlzYWJsZWQnLCBpc0Rpc2FibGVkKTsKICAgICRzbGlkZXIuZGF0YSgnX3NsaWRlcl9kaXNjcmV0ZScsIGlzRGlzY3JldGUpOwogICAgJHNsaWRlci5kYXRhKCdfc2xpZGVyXyR0aHVtYlRleHQnLCAkdGh1bWJUZXh0KTsgLy8g6K6+572u6buY6K6k5YC8CgogICAgdXBkYXRlVmFsdWVTdHlsZSgkc2xpZGVyKTsKICB9CgogIHZhciByYW5nZVNlbGVjdG9yID0gJy5tZHVpLXNsaWRlciBpbnB1dFt0eXBlPSJyYW5nZSJdJzsKICAkKGZ1bmN0aW9uICgpIHsKICAgIC8vIOa7keWdl+a7keWKqOS6i+S7tgogICAgJGRvY3VtZW50Lm9uKCdpbnB1dCBjaGFuZ2UnLCByYW5nZVNlbGVjdG9yLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciAkc2xpZGVyID0gJCh0aGlzKS5wYXJlbnQoKTsKICAgICAgdXBkYXRlVmFsdWVTdHlsZSgkc2xpZGVyKTsKICAgIH0pOyAvLyDlvIDlp4vop6bmkbjmu5HlnZfkuovku7YKCiAgICAkZG9jdW1lbnQub24oc3RhcnRFdmVudCwgcmFuZ2VTZWxlY3RvciwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIGlmICghaXNBbGxvdyhldmVudCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHJlZ2lzdGVyKGV2ZW50KTsKCiAgICAgIGlmICh0aGlzLmRpc2FibGVkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgJHNsaWRlciA9ICQodGhpcykucGFyZW50KCk7CiAgICAgICRzbGlkZXIuYWRkQ2xhc3MoJ21kdWktc2xpZGVyLWZvY3VzJyk7CiAgICB9KTsgLy8g57uT5p2f6Kem5pG45ruR5Z2X5LqL5Lu2CgogICAgJGRvY3VtZW50Lm9uKGVuZEV2ZW50LCByYW5nZVNlbGVjdG9yLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgaWYgKCFpc0FsbG93KGV2ZW50KSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciAkc2xpZGVyID0gJCh0aGlzKS5wYXJlbnQoKTsKICAgICAgJHNsaWRlci5yZW1vdmVDbGFzcygnbWR1aS1zbGlkZXItZm9jdXMnKTsKICAgIH0pOwogICAgJGRvY3VtZW50Lm9uKHVubG9ja0V2ZW50LCByYW5nZVNlbGVjdG9yLCByZWdpc3Rlcik7CiAgICAvKioNCiAgICAgKiDliJ3lp4vljJbmu5HlnZcNCiAgICAgKi8KCiAgICBtZHVpLm11dGF0aW9uKCcubWR1aS1zbGlkZXInLCBmdW5jdGlvbiAoKSB7CiAgICAgIHJlSW5pdCgkKHRoaXMpKTsKICAgIH0pOwogIH0pOwoKICBtZHVpLnVwZGF0ZVNsaWRlcnMgPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgIHZhciAkZWxlbWVudHMgPSBpc1VuZGVmaW5lZChzZWxlY3RvcikgPyAkKCcubWR1aS1zbGlkZXInKSA6ICQoc2VsZWN0b3IpOwogICAgJGVsZW1lbnRzLmVhY2goZnVuY3Rpb24gKF8sIGVsZW1lbnQpIHsKICAgICAgcmVJbml0KCQoZWxlbWVudCkpOwogICAgfSk7CiAgfTsKCiAgdmFyIERFRkFVTFRfT1BUSU9OUyQyID0gewogICAgdHJpZ2dlcjogJ2hvdmVyJwogIH07CgogIHZhciBGYWIgPSBmdW5jdGlvbiBGYWIoc2VsZWN0b3IsIG9wdGlvbnMpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgb3B0aW9ucyA9IHt9OwogICAgLyoqDQogICAgICog6YWN572u5Y+C5pWwDQogICAgICovCgogICAgdGhpcy5vcHRpb25zID0gZXh0ZW5kKHt9LCBERUZBVUxUX09QVElPTlMkMik7CiAgICAvKioNCiAgICAgKiDlvZPliY0gZmFiIOeahOeKtuaAgQ0KICAgICAqLwoKICAgIHRoaXMuc3RhdGUgPSAnY2xvc2VkJzsKICAgIHRoaXMuJGVsZW1lbnQgPSAkKHNlbGVjdG9yKS5maXJzdCgpOwogICAgZXh0ZW5kKHRoaXMub3B0aW9ucywgb3B0aW9ucyk7CiAgICB0aGlzLiRidG4gPSB0aGlzLiRlbGVtZW50LmZpbmQoJy5tZHVpLWZhYicpOwogICAgdGhpcy4kZGlhbCA9IHRoaXMuJGVsZW1lbnQuZmluZCgnLm1kdWktZmFiLWRpYWwnKTsKICAgIHRoaXMuJGRpYWxCdG5zID0gdGhpcy4kZGlhbC5maW5kKCcubWR1aS1mYWInKTsKCiAgICBpZiAodGhpcy5vcHRpb25zLnRyaWdnZXIgPT09ICdob3ZlcicpIHsKICAgICAgdGhpcy4kYnRuLm9uKCd0b3VjaHN0YXJ0IG1vdXNlZW50ZXInLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMkMS5vcGVuKCk7CiAgICAgIH0pOwogICAgICB0aGlzLiRlbGVtZW50Lm9uKCdtb3VzZWxlYXZlJywgZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0aGlzJDEuY2xvc2UoKTsKICAgICAgfSk7CiAgICB9CgogICAgaWYgKHRoaXMub3B0aW9ucy50cmlnZ2VyID09PSAnY2xpY2snKSB7CiAgICAgIHRoaXMuJGJ0bi5vbihzdGFydEV2ZW50LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMkMS5vcGVuKCk7CiAgICAgIH0pOwogICAgfSAvLyDop6bmkbjlsY/luZXlhbbku5blnLDmlrnlhbPpl63lv6vpgJ/mi6jlj7cKCgogICAgJGRvY3VtZW50Lm9uKHN0YXJ0RXZlbnQsIGZ1bmN0aW9uIChldmVudCkgewogICAgICBpZiAoJChldmVudC50YXJnZXQpLnBhcmVudHMoJy5tZHVpLWZhYi13cmFwcGVyJykubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzJDEuY2xvc2UoKTsKICAgIH0pOwogIH07CiAgLyoqDQogICAqIOinpuWPkee7hOS7tuS6i+S7tg0KICAgKiBAcGFyYW0gbmFtZQ0KICAgKi8KCgogIEZhYi5wcm90b3R5cGUudHJpZ2dlckV2ZW50ID0gZnVuY3Rpb24gdHJpZ2dlckV2ZW50KG5hbWUpIHsKICAgIGNvbXBvbmVudEV2ZW50KG5hbWUsICdmYWInLCB0aGlzLiRlbGVtZW50LCB0aGlzKTsKICB9OwogIC8qKg0KICAgKiDlvZPliY3mmK/lkKbkuLrmiZPlvIDnirbmgIENCiAgICovCgoKICBGYWIucHJvdG90eXBlLmlzT3BlbiA9IGZ1bmN0aW9uIGlzT3BlbigpIHsKICAgIHJldHVybiB0aGlzLnN0YXRlID09PSAnb3BlbmluZycgfHwgdGhpcy5zdGF0ZSA9PT0gJ29wZW5lZCc7CiAgfTsKICAvKioNCiAgICog5omT5byA5b+r6YCf5ouo5Y+36I+c5Y2VDQogICAqLwoKCiAgRmFiLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gb3BlbigpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwoKICAgIGlmICh0aGlzLmlzT3BlbigpKSB7CiAgICAgIHJldHVybjsKICAgIH0gLy8g5Li66I+c5Y2V5Lit55qE5oyJ6ZKu5re75Yqg5LiN5ZCM55qEIHRyYW5zaXRpb24tZGVsYXkKCgogICAgdGhpcy4kZGlhbEJ0bnMuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGJ0bikgewogICAgICB2YXIgZGVsYXkgPSAxNSAqICh0aGlzJDEuJGRpYWxCdG5zLmxlbmd0aCAtIGluZGV4KSArICJtcyI7CiAgICAgIGJ0bi5zdHlsZS50cmFuc2l0aW9uRGVsYXkgPSBkZWxheTsKICAgICAgYnRuLnN0eWxlLndlYmtpdFRyYW5zaXRpb25EZWxheSA9IGRlbGF5OwogICAgfSk7CiAgICB0aGlzLiRkaWFsLmNzcygnaGVpZ2h0JywgJ2F1dG8nKS5hZGRDbGFzcygnbWR1aS1mYWItZGlhbC1zaG93Jyk7IC8vIOWmguaenOaMiemSruS4reWtmOWcqCAubWR1aS1mYWItb3BlbmVkIOeahOWbvuagh++8jOWImei/m+ihjOWbvuagh+WIh+aNogoKICAgIGlmICh0aGlzLiRidG4uZmluZCgnLm1kdWktZmFiLW9wZW5lZCcpLmxlbmd0aCkgewogICAgICB0aGlzLiRidG4uYWRkQ2xhc3MoJ21kdWktZmFiLW9wZW5lZCcpOwogICAgfQoKICAgIHRoaXMuc3RhdGUgPSAnb3BlbmluZyc7CiAgICB0aGlzLnRyaWdnZXJFdmVudCgnb3BlbicpOyAvLyDmiZPlvIDpobrluo/kuLrku47kuIvliLDkuIrpgJDkuKrmiZPlvIDvvIzmnIDkuIrpnaLnmoTmiZPlvIDlkI7miY3ooajnpLrliqjnlLvlrozmiJAKCiAgICB0aGlzLiRkaWFsQnRucy5maXJzdCgpLnRyYW5zaXRpb25FbmQoZnVuY3Rpb24gKCkgewogICAgICBpZiAodGhpcyQxLiRidG4uaGFzQ2xhc3MoJ21kdWktZmFiLW9wZW5lZCcpKSB7CiAgICAgICAgdGhpcyQxLnN0YXRlID0gJ29wZW5lZCc7CiAgICAgICAgdGhpcyQxLnRyaWdnZXJFdmVudCgnb3BlbmVkJyk7CiAgICAgIH0KICAgIH0pOwogIH07CiAgLyoqDQogICAqIOWFs+mXreW/q+mAn+aLqOWPt+iPnOWNlQ0KICAgKi8KCgogIEZhYi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiBjbG9zZSgpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwoKICAgIGlmICghdGhpcy5pc09wZW4oKSkgewogICAgICByZXR1cm47CiAgICB9IC8vIOS4uuiPnOWNleS4reeahOaMiemSrua3u+WKoOS4jeWQjOeahCB0cmFuc2l0aW9uLWRlbGF5CgoKICAgIHRoaXMuJGRpYWxCdG5zLmVhY2goZnVuY3Rpb24gKGluZGV4LCBidG4pIHsKICAgICAgdmFyIGRlbGF5ID0gMTUgKiBpbmRleCArICJtcyI7CiAgICAgIGJ0bi5zdHlsZS50cmFuc2l0aW9uRGVsYXkgPSBkZWxheTsKICAgICAgYnRuLnN0eWxlLndlYmtpdFRyYW5zaXRpb25EZWxheSA9IGRlbGF5OwogICAgfSk7CiAgICB0aGlzLiRkaWFsLnJlbW92ZUNsYXNzKCdtZHVpLWZhYi1kaWFsLXNob3cnKTsKICAgIHRoaXMuJGJ0bi5yZW1vdmVDbGFzcygnbWR1aS1mYWItb3BlbmVkJyk7CiAgICB0aGlzLnN0YXRlID0gJ2Nsb3NpbmcnOwogICAgdGhpcy50cmlnZ2VyRXZlbnQoJ2Nsb3NlJyk7IC8vIOS7juS4iuW+gOS4i+S+neasoeWFs+mXre+8jOacgOWQjuS4gOS4quWFs+mXreWQjuaJjeihqOekuuWKqOeUu+WujOaIkAoKICAgIHRoaXMuJGRpYWxCdG5zLmxhc3QoKS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHRoaXMkMS4kYnRuLmhhc0NsYXNzKCdtZHVpLWZhYi1vcGVuZWQnKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcyQxLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICAgIHRoaXMkMS50cmlnZ2VyRXZlbnQoJ2Nsb3NlZCcpOwogICAgICB0aGlzJDEuJGRpYWwuY3NzKCdoZWlnaHQnLCAwKTsKICAgIH0pOwogIH07CiAgLyoqDQogICAqIOWIh+aNouW/q+mAn+aLqOWPt+iPnOWNleeahOaJk+W8gOeKtuaAgQ0KICAgKi8KCgogIEZhYi5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24gdG9nZ2xlKCkgewogICAgdGhpcy5pc09wZW4oKSA/IHRoaXMuY2xvc2UoKSA6IHRoaXMub3BlbigpOwogIH07CiAgLyoqDQogICAqIOS7peWKqOeUu+eahOW9ouW8j+aYvuekuuaVtOS4qua1ruWKqOaTjeS9nOaMiemSrg0KICAgKi8KCgogIEZhYi5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uIHNob3coKSB7CiAgICB0aGlzLiRlbGVtZW50LnJlbW92ZUNsYXNzKCdtZHVpLWZhYi1oaWRlJyk7CiAgfTsKICAvKioNCiAgICog5Lul5Yqo55S755qE5b2i5byP6ZqQ6JeP5pW05Liq5rWu5Yqo5pON5L2c5oyJ6ZKuDQogICAqLwoKCiAgRmFiLnByb3RvdHlwZS5oaWRlID0gZnVuY3Rpb24gaGlkZSgpIHsKICAgIHRoaXMuJGVsZW1lbnQuYWRkQ2xhc3MoJ21kdWktZmFiLWhpZGUnKTsKICB9OwogIC8qKg0KICAgKiDov5Tlm57lvZPliY3lv6vpgJ/mi6jlj7foj5zljZXnmoTmiZPlvIDnirbmgIHjgILlhbHljIXlkKvlm5vnp43nirbmgIHvvJpgb3BlbmluZ2DjgIFgb3BlbmVkYOOAgWBjbG9zaW5nYOOAgWBjbG9zZWRgDQogICAqLwoKCiAgRmFiLnByb3RvdHlwZS5nZXRTdGF0ZSA9IGZ1bmN0aW9uIGdldFN0YXRlKCkgewogICAgcmV0dXJuIHRoaXMuc3RhdGU7CiAgfTsKCiAgbWR1aS5GYWIgPSBGYWI7CiAgdmFyIGN1c3RvbUF0dHIkMyA9ICdtZHVpLWZhYic7CiAgJChmdW5jdGlvbiAoKSB7CiAgICAvLyBtb3VzZWVudGVyIOS4jeWGkuazoe+8jOaXoOazlei/m+ihjOS6i+S7tuWnlOaJmO+8jOi/memHjOeUqCBtb3VzZW92ZXIg5Luj5pu/44CCCiAgICAvLyDkuI3nrqHmmK8gY2xpY2sg44CBIG1vdXNlb3ZlciDov5jmmK8gdG91Y2hzdGFydCDvvIzpg73lhYjliJ3lp4vljJbjgIIKICAgICRkb2N1bWVudC5vbigndG91Y2hzdGFydCBtb3VzZWRvd24gbW91c2VvdmVyJywgIlsiICsgY3VzdG9tQXR0ciQzICsgIl0iLCBmdW5jdGlvbiAoKSB7CiAgICAgIG5ldyBtZHVpLkZhYih0aGlzLCBwYXJzZU9wdGlvbnModGhpcywgY3VzdG9tQXR0ciQzKSk7CiAgICB9KTsKICB9KTsKICAvKioNCiAgICog5pyA57uI55Sf5oiQ55qE5YWD57Sg57uT5p6E5Li677yaDQogICAqICA8c2VsZWN0IGNsYXNzPSJtZHVpLXNlbGVjdCIgbWR1aS1zZWxlY3Q9Intwb3NpdGlvbjogJ3RvcCd9IiBzdHlsZT0iZGlzcGxheTogbm9uZTsiPiAvLyAkbmF0aXZlDQogICAqICAgIDxvcHRpb24gdmFsdWU9IjEiPlN0YXRlIDE8L29wdGlvbj4NCiAgICogICAgPG9wdGlvbiB2YWx1ZT0iMiI+U3RhdGUgMjwvb3B0aW9uPg0KICAgKiAgICA8b3B0aW9uIHZhbHVlPSIzIiBkaXNhYmxlZD0iIj5TdGF0ZSAzPC9vcHRpb24+DQogICAqICA8L3NlbGVjdD4NCiAgICogIDxkaXYgY2xhc3M9Im1kdWktc2VsZWN0IG1kdWktc2VsZWN0LXBvc2l0aW9uLXRvcCIgc3R5bGU9IiIgaWQ9Ijg4ZGVjMGU0LWQ0YTItYzZkMC0wZTdmLTFiYTQ1MDFlMDU1MyI+IC8vICRlbGVtZW50DQogICAqICAgIDxzcGFuIGNsYXNzPSJtZHVpLXNlbGVjdC1zZWxlY3RlZCI+U3RhdGUgMTwvc3Bhbj4gLy8gJHNlbGVjdGVkDQogICAqICAgIDxkaXYgY2xhc3M9Im1kdWktc2VsZWN0LW1lbnUiIHN0eWxlPSJ0cmFuc2Zvcm0tb3JpZ2luOiBjZW50ZXIgMTAwJSAwcHg7Ij4gLy8gJG1lbnUNCiAgICogICAgICA8ZGl2IGNsYXNzPSJtZHVpLXNlbGVjdC1tZW51LWl0ZW0gbWR1aS1yaXBwbGUiIHNlbGVjdGVkPSIiPlN0YXRlIDE8L2Rpdj4gLy8gJGl0ZW1zDQogICAqICAgICAgPGRpdiBjbGFzcz0ibWR1aS1zZWxlY3QtbWVudS1pdGVtIG1kdWktcmlwcGxlIj5TdGF0ZSAyPC9kaXY+DQogICAqICAgICAgPGRpdiBjbGFzcz0ibWR1aS1zZWxlY3QtbWVudS1pdGVtIG1kdWktcmlwcGxlIiBkaXNhYmxlZD0iIj5TdGF0ZSAzPC9kaXY+DQogICAqICAgIDwvZGl2Pg0KICAgKiAgPC9kaXY+DQogICAqLwoKICB2YXIgREVGQVVMVF9PUFRJT05TJDMgPSB7CiAgICBwb3NpdGlvbjogJ2F1dG8nLAogICAgZ3V0dGVyOiAxNgogIH07CgogIHZhciBTZWxlY3QgPSBmdW5jdGlvbiBTZWxlY3Qoc2VsZWN0b3IsIG9wdGlvbnMpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgb3B0aW9ucyA9IHt9OwogICAgLyoqDQogICAgICog55Sf5oiQ55qEIGA8ZGl2IGNsYXNzPSJtZHVpLXNlbGVjdCI+YCDlhYPntKDnmoQgSlEg5a+56LGhDQogICAgICovCgogICAgdGhpcy4kZWxlbWVudCA9ICQoKTsKICAgIC8qKg0KICAgICAqIOmFjee9ruWPguaVsA0KICAgICAqLwoKICAgIHRoaXMub3B0aW9ucyA9IGV4dGVuZCh7fSwgREVGQVVMVF9PUFRJT05TJDMpOwogICAgLyoqDQogICAgICogc2VsZWN0IOeahCBzaXplIOWxnuaAp+eahOWAvO+8jOagueaNruivpeWAvOiuvue9riBzZWxlY3Qg55qE6auY5bqmDQogICAgICovCgogICAgdGhpcy5zaXplID0gMDsKICAgIC8qKg0KICAgICAqIOWNoOS9jeWFg+e0oO+8jOaYvuekuuW3sumAieS4reiPnOWNlemhueeahOaWh+acrA0KICAgICAqLwoKICAgIHRoaXMuJHNlbGVjdGVkID0gJCgpOwogICAgLyoqDQogICAgICog6I+c5Y2V6aG555qE5aSW5bGC5YWD57Sg55qEIEpRIOWvueixoQ0KICAgICAqLwoKICAgIHRoaXMuJG1lbnUgPSAkKCk7CiAgICAvKioNCiAgICAgKiDoj5zljZXpobnmlbDnu4TnmoQgSlEg5a+56LGhDQogICAgICovCgogICAgdGhpcy4kaXRlbXMgPSAkKCk7CiAgICAvKioNCiAgICAgKiDlvZPliY3pgInkuK3nmoToj5zljZXpobnnmoTntKLlvJXlj7cNCiAgICAgKi8KCiAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSAwOwogICAgLyoqDQogICAgICog5b2T5YmN6YCJ5Lit6I+c5Y2V6aG555qE5paH5pysDQogICAgICovCgogICAgdGhpcy5zZWxlY3RlZFRleHQgPSAnJzsKICAgIC8qKg0KICAgICAqIOW9k+WJjemAieS4reiPnOWNlemhueeahOWAvA0KICAgICAqLwoKICAgIHRoaXMuc2VsZWN0ZWRWYWx1ZSA9ICcnOwogICAgLyoqDQogICAgICog5b2T5YmNIHNlbGVjdCDnmoTnirbmgIENCiAgICAgKi8KCiAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICB0aGlzLiRuYXRpdmUgPSAkKHNlbGVjdG9yKS5maXJzdCgpOwogICAgdGhpcy4kbmF0aXZlLmhpZGUoKTsKICAgIGV4dGVuZCh0aGlzLm9wdGlvbnMsIG9wdGlvbnMpOyAvLyDkuLrlvZPliY0gc2VsZWN0IOeUn+aIkOWUr+S4gCBJRAoKICAgIHRoaXMudW5pcXVlSUQgPSAkLmd1aWQoKTsgLy8g55Sf5oiQIHNlbGVjdAoKICAgIHRoaXMuaGFuZGxlVXBkYXRlKCk7IC8vIOeCueWHuyBzZWxlY3Qg5aSW6Z2i5Yy65Z+f5YWz6ZetCgogICAgJGRvY3VtZW50Lm9uKCdjbGljayB0b3VjaHN0YXJ0JywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHZhciAkdGFyZ2V0ID0gJChldmVudC50YXJnZXQpOwoKICAgICAgaWYgKHRoaXMkMS5pc09wZW4oKSAmJiAhJHRhcmdldC5pcyh0aGlzJDEuJGVsZW1lbnQpICYmICFjb250YWlucyh0aGlzJDEuJGVsZW1lbnRbMF0sICR0YXJnZXRbMF0pKSB7CiAgICAgICAgdGhpcyQxLmNsb3NlKCk7CiAgICAgIH0KICAgIH0pOwogIH07CiAgLyoqDQogICAqIOiwg+aVtOiPnOWNleS9jee9rg0KICAgKi8KCgogIFNlbGVjdC5wcm90b3R5cGUucmVhZGp1c3RNZW51ID0gZnVuY3Rpb24gcmVhZGp1c3RNZW51KCkgewogICAgdmFyIHdpbmRvd0hlaWdodCA9ICR3aW5kb3cuaGVpZ2h0KCk7IC8vIG1kdWktc2VsZWN0IOmrmOW6pgoKICAgIHZhciBlbGVtZW50SGVpZ2h0ID0gdGhpcy4kZWxlbWVudC5oZWlnaHQoKTsgLy8g6I+c5Y2V6aG56auY5bqmCgogICAgdmFyICRpdGVtRmlyc3QgPSB0aGlzLiRpdGVtcy5maXJzdCgpOwogICAgdmFyIGl0ZW1IZWlnaHQgPSAkaXRlbUZpcnN0LmhlaWdodCgpOwogICAgdmFyIGl0ZW1NYXJnaW4gPSBwYXJzZUludCgkaXRlbUZpcnN0LmNzcygnbWFyZ2luLXRvcCcpKTsgLy8g6I+c5Y2V6auY5bqmCgogICAgdmFyIG1lbnVXaWR0aCA9IHRoaXMuJGVsZW1lbnQuaW5uZXJXaWR0aCgpICsgMC4wMTsgLy8g5b+F6aG75q+U55yf5a6e5a695bqm5aSa5LiA54K577yM5LiN54S25Lya5Ye6546w55yB55Wl5Y+3CgogICAgdmFyIG1lbnVIZWlnaHQgPSBpdGVtSGVpZ2h0ICogdGhpcy5zaXplICsgaXRlbU1hcmdpbiAqIDI7IC8vIG1kdWktc2VsZWN0IOWcqOeql+WPo+S4reeahOS9jee9rgoKICAgIHZhciBlbGVtZW50VG9wID0gdGhpcy4kZWxlbWVudFswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7CiAgICB2YXIgdHJhbnNmb3JtT3JpZ2luWTsKICAgIHZhciBtZW51TWFyZ2luVG9wOwoKICAgIGlmICh0aGlzLm9wdGlvbnMucG9zaXRpb24gPT09ICdib3R0b20nKSB7CiAgICAgIG1lbnVNYXJnaW5Ub3AgPSBlbGVtZW50SGVpZ2h0OwogICAgICB0cmFuc2Zvcm1PcmlnaW5ZID0gJzBweCc7CiAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9ucy5wb3NpdGlvbiA9PT0gJ3RvcCcpIHsKICAgICAgbWVudU1hcmdpblRvcCA9IC1tZW51SGVpZ2h0IC0gMTsKICAgICAgdHJhbnNmb3JtT3JpZ2luWSA9ICcxMDAlJzsKICAgIH0gZWxzZSB7CiAgICAgIC8vIOiPnOWNlemrmOW6puS4jeiDvei2hei/h+eql+WPo+mrmOW6pgogICAgICB2YXIgbWVudU1heEhlaWdodCA9IHdpbmRvd0hlaWdodCAtIHRoaXMub3B0aW9ucy5ndXR0ZXIgKiAyOwoKICAgICAgaWYgKG1lbnVIZWlnaHQgPiBtZW51TWF4SGVpZ2h0KSB7CiAgICAgICAgbWVudUhlaWdodCA9IG1lbnVNYXhIZWlnaHQ7CiAgICAgIH0gLy8g6I+c5Y2V55qEIG1hcmdpbi10b3AKCgogICAgICBtZW51TWFyZ2luVG9wID0gLShpdGVtTWFyZ2luICsgdGhpcy5zZWxlY3RlZEluZGV4ICogaXRlbUhlaWdodCArIChpdGVtSGVpZ2h0IC0gZWxlbWVudEhlaWdodCkgLyAyKTsKICAgICAgdmFyIG1lbnVNYXhNYXJnaW5Ub3AgPSAtKGl0ZW1NYXJnaW4gKyAodGhpcy5zaXplIC0gMSkgKiBpdGVtSGVpZ2h0ICsgKGl0ZW1IZWlnaHQgLSBlbGVtZW50SGVpZ2h0KSAvIDIpOwoKICAgICAgaWYgKG1lbnVNYXJnaW5Ub3AgPCBtZW51TWF4TWFyZ2luVG9wKSB7CiAgICAgICAgbWVudU1hcmdpblRvcCA9IG1lbnVNYXhNYXJnaW5Ub3A7CiAgICAgIH0gLy8g6I+c5Y2V5LiN6IO96LaF5Ye656qX5Y+jCgoKICAgICAgdmFyIG1lbnVUb3AgPSBlbGVtZW50VG9wICsgbWVudU1hcmdpblRvcDsKCiAgICAgIGlmIChtZW51VG9wIDwgdGhpcy5vcHRpb25zLmd1dHRlcikgewogICAgICAgIC8vIOS4jeiDvei2heWHuueql+WPo+S4iuaWuQogICAgICAgIG1lbnVNYXJnaW5Ub3AgPSAtKGVsZW1lbnRUb3AgLSB0aGlzLm9wdGlvbnMuZ3V0dGVyKTsKICAgICAgfSBlbHNlIGlmIChtZW51VG9wICsgbWVudUhlaWdodCArIHRoaXMub3B0aW9ucy5ndXR0ZXIgPiB3aW5kb3dIZWlnaHQpIHsKICAgICAgICAvLyDkuI3og73otoXlh7rnqpflj6PkuIvmlrkKICAgICAgICBtZW51TWFyZ2luVG9wID0gLShlbGVtZW50VG9wICsgbWVudUhlaWdodCArIHRoaXMub3B0aW9ucy5ndXR0ZXIgLSB3aW5kb3dIZWlnaHQpOwogICAgICB9IC8vIHRyYW5zZm9ybSDnmoQgWSDovbTlnZDmoIcKCgogICAgICB0cmFuc2Zvcm1PcmlnaW5ZID0gdGhpcy5zZWxlY3RlZEluZGV4ICogaXRlbUhlaWdodCArIGl0ZW1IZWlnaHQgLyAyICsgaXRlbU1hcmdpbiArICJweCI7CiAgICB9IC8vIOiuvue9ruagt+W8jwoKCiAgICB0aGlzLiRlbGVtZW50LmlubmVyV2lkdGgobWVudVdpZHRoKTsKICAgIHRoaXMuJG1lbnUuaW5uZXJXaWR0aChtZW51V2lkdGgpLmhlaWdodChtZW51SGVpZ2h0KS5jc3MoewogICAgICAnbWFyZ2luLXRvcCc6IG1lbnVNYXJnaW5Ub3AgKyAncHgnLAogICAgICAndHJhbnNmb3JtLW9yaWdpbic6ICdjZW50ZXIgJyArIHRyYW5zZm9ybU9yaWdpblkgKyAnIDAnCiAgICB9KTsKICB9OwogIC8qKg0KICAgKiBzZWxlY3Qg5piv5ZCm5Li65omT5byA54q25oCBDQogICAqLwoKCiAgU2VsZWN0LnByb3RvdHlwZS5pc09wZW4gPSBmdW5jdGlvbiBpc09wZW4oKSB7CiAgICByZXR1cm4gdGhpcy5zdGF0ZSA9PT0gJ29wZW5pbmcnIHx8IHRoaXMuc3RhdGUgPT09ICdvcGVuZWQnOwogIH07CiAgLyoqDQogICAqIOWvueWOn+eUnyBzZWxlY3Qg57uE5Lu26L+b6KGM5LqG5L+u5pS55ZCO77yM6ZyA6KaB6LCD55So6K+l5pa55rOVDQogICAqLwoKCiAgU2VsZWN0LnByb3RvdHlwZS5oYW5kbGVVcGRhdGUgPSBmdW5jdGlvbiBoYW5kbGVVcGRhdGUoKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKCiAgICBpZiAodGhpcy5pc09wZW4oKSkgewogICAgICB0aGlzLmNsb3NlKCk7CiAgICB9CgogICAgdGhpcy5zZWxlY3RlZFZhbHVlID0gdGhpcy4kbmF0aXZlLnZhbCgpOwogICAgdmFyIGl0ZW1zRGF0YSA9IFtdOwogICAgdGhpcy4kaXRlbXMgPSAkKCk7IC8vIOeUn+aIkCBIVE1MCgogICAgdGhpcy4kbmF0aXZlLmZpbmQoJ29wdGlvbicpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBvcHRpb24pIHsKICAgICAgdmFyIHRleHQgPSBvcHRpb24udGV4dENvbnRlbnQgfHwgJyc7CiAgICAgIHZhciB2YWx1ZSA9IG9wdGlvbi52YWx1ZTsKICAgICAgdmFyIGRpc2FibGVkID0gb3B0aW9uLmRpc2FibGVkOwogICAgICB2YXIgc2VsZWN0ZWQgPSB0aGlzJDEuc2VsZWN0ZWRWYWx1ZSA9PT0gdmFsdWU7CiAgICAgIGl0ZW1zRGF0YS5wdXNoKHsKICAgICAgICB2YWx1ZTogdmFsdWUsCiAgICAgICAgdGV4dDogdGV4dCwKICAgICAgICBkaXNhYmxlZDogZGlzYWJsZWQsCiAgICAgICAgc2VsZWN0ZWQ6IHNlbGVjdGVkLAogICAgICAgIGluZGV4OiBpbmRleAogICAgICB9KTsKCiAgICAgIGlmIChzZWxlY3RlZCkgewogICAgICAgIHRoaXMkMS5zZWxlY3RlZFRleHQgPSB0ZXh0OwogICAgICAgIHRoaXMkMS5zZWxlY3RlZEluZGV4ID0gaW5kZXg7CiAgICAgIH0KCiAgICAgIHRoaXMkMS4kaXRlbXMgPSB0aGlzJDEuJGl0ZW1zLmFkZCgnPGRpdiBjbGFzcz0ibWR1aS1zZWxlY3QtbWVudS1pdGVtIG1kdWktcmlwcGxlIicgKyAoZGlzYWJsZWQgPyAnIGRpc2FibGVkJyA6ICcnKSArIChzZWxlY3RlZCA/ICcgc2VsZWN0ZWQnIDogJycpICsgIj4iICsgdGV4dCArICI8L2Rpdj4iKTsKICAgIH0pOwogICAgdGhpcy4kc2VsZWN0ZWQgPSAkKCI8c3BhbiBjbGFzcz1cIm1kdWktc2VsZWN0LXNlbGVjdGVkXCI+IiArIHRoaXMuc2VsZWN0ZWRUZXh0ICsgIjwvc3Bhbj4iKTsKICAgIHRoaXMuJGVsZW1lbnQgPSAkKCI8ZGl2IGNsYXNzPVwibWR1aS1zZWxlY3QgbWR1aS1zZWxlY3QtcG9zaXRpb24tIiArIHRoaXMub3B0aW9ucy5wb3NpdGlvbiArICJcIiAiICsgInN0eWxlPVwiIiArIHRoaXMuJG5hdGl2ZS5hdHRyKCdzdHlsZScpICsgIlwiICIgKyAiaWQ9XCIiICsgdGhpcy51bmlxdWVJRCArICJcIj48L2Rpdj4iKS5zaG93KCkuYXBwZW5kKHRoaXMuJHNlbGVjdGVkKTsKICAgIHRoaXMuJG1lbnUgPSAkKCc8ZGl2IGNsYXNzPSJtZHVpLXNlbGVjdC1tZW51Ij48L2Rpdj4nKS5hcHBlbmRUbyh0aGlzLiRlbGVtZW50KS5hcHBlbmQodGhpcy4kaXRlbXMpOwogICAgJCgiIyIgKyB0aGlzLnVuaXF1ZUlEKS5yZW1vdmUoKTsKICAgIHRoaXMuJG5hdGl2ZS5hZnRlcih0aGlzLiRlbGVtZW50KTsgLy8g5qC55o2uIHNlbGVjdCDnmoQgc2l6ZSDlsZ7mgKforr7nva7pq5jluqYKCiAgICB0aGlzLnNpemUgPSBwYXJzZUludCh0aGlzLiRuYXRpdmUuYXR0cignc2l6ZScpIHx8ICcwJyk7CgogICAgaWYgKHRoaXMuc2l6ZSA8PSAwKSB7CiAgICAgIHRoaXMuc2l6ZSA9IHRoaXMuJGl0ZW1zLmxlbmd0aDsKCiAgICAgIGlmICh0aGlzLnNpemUgPiA4KSB7CiAgICAgICAgdGhpcy5zaXplID0gODsKICAgICAgfQogICAgfSAvLyDngrnlh7vpgInpobnml7blhbPpl63kuIvmi4noj5zljZUKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdGhpcy1hbGlhcwoKCiAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICB0aGlzLiRpdGVtcy5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGF0LnN0YXRlID09PSAnY2xvc2luZycpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciAkaXRlbSA9ICQodGhpcyk7CiAgICAgIHZhciBpbmRleCA9ICRpdGVtLmluZGV4KCk7CiAgICAgIHZhciBkYXRhID0gaXRlbXNEYXRhW2luZGV4XTsKCiAgICAgIGlmIChkYXRhLmRpc2FibGVkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGF0LiRzZWxlY3RlZC50ZXh0KGRhdGEudGV4dCk7CiAgICAgIHRoYXQuJG5hdGl2ZS52YWwoZGF0YS52YWx1ZSk7CiAgICAgIHRoYXQuJGl0ZW1zLnJlbW92ZUF0dHIoJ3NlbGVjdGVkJyk7CiAgICAgICRpdGVtLmF0dHIoJ3NlbGVjdGVkJywgJycpOwogICAgICB0aGF0LnNlbGVjdGVkSW5kZXggPSBkYXRhLmluZGV4OwogICAgICB0aGF0LnNlbGVjdGVkVmFsdWUgPSBkYXRhLnZhbHVlOwogICAgICB0aGF0LnNlbGVjdGVkVGV4dCA9IGRhdGEudGV4dDsKICAgICAgdGhhdC4kbmF0aXZlLnRyaWdnZXIoJ2NoYW5nZScpOwogICAgICB0aGF0LmNsb3NlKCk7CiAgICB9KTsgLy8g54K55Ye7ICRlbGVtZW50IOaXtuaJk+W8gOS4i+aLieiPnOWNlQoKICAgIHRoaXMuJGVsZW1lbnQub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHZhciAkdGFyZ2V0ID0gJChldmVudC50YXJnZXQpOyAvLyDlnKjoj5zljZXkuIrngrnlh7vml7bkuI3miZPlvIAKCiAgICAgIGlmICgkdGFyZ2V0LmlzKCcubWR1aS1zZWxlY3QtbWVudScpIHx8ICR0YXJnZXQuaXMoJy5tZHVpLXNlbGVjdC1tZW51LWl0ZW0nKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcyQxLnRvZ2dsZSgpOwogICAgfSk7CiAgfTsKICAvKioNCiAgICog5Yqo55S757uT5p2f55qE5Zue6LCDDQogICAqLwoKCiAgU2VsZWN0LnByb3RvdHlwZS50cmFuc2l0aW9uRW5kID0gZnVuY3Rpb24gdHJhbnNpdGlvbkVuZCgpIHsKICAgIHRoaXMuJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kdWktc2VsZWN0LWNsb3NpbmcnKTsKCiAgICBpZiAodGhpcy5zdGF0ZSA9PT0gJ29wZW5pbmcnKSB7CiAgICAgIHRoaXMuc3RhdGUgPSAnb3BlbmVkJzsKICAgICAgdGhpcy50cmlnZ2VyRXZlbnQoJ29wZW5lZCcpOwogICAgICB0aGlzLiRtZW51LmNzcygnb3ZlcmZsb3cteScsICdhdXRvJyk7CiAgICB9CgogICAgaWYgKHRoaXMuc3RhdGUgPT09ICdjbG9zaW5nJykgewogICAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICAgIHRoaXMudHJpZ2dlckV2ZW50KCdjbG9zZWQnKTsgLy8g5oGi5aSN5qC35byPCgogICAgICB0aGlzLiRlbGVtZW50LmlubmVyV2lkdGgoJycpOwogICAgICB0aGlzLiRtZW51LmNzcyh7CiAgICAgICAgJ21hcmdpbi10b3AnOiAnJywKICAgICAgICBoZWlnaHQ6ICcnLAogICAgICAgIHdpZHRoOiAnJwogICAgICB9KTsKICAgIH0KICB9OwogIC8qKg0KICAgKiDop6blj5Hnu4Tku7bkuovku7YNCiAgICogQHBhcmFtIG5hbWUNCiAgICovCgoKICBTZWxlY3QucHJvdG90eXBlLnRyaWdnZXJFdmVudCA9IGZ1bmN0aW9uIHRyaWdnZXJFdmVudChuYW1lKSB7CiAgICBjb21wb25lbnRFdmVudChuYW1lLCAnc2VsZWN0JywgdGhpcy4kbmF0aXZlLCB0aGlzKTsKICB9OwogIC8qKg0KICAgKiDliIfmjaLkuIvmi4noj5zljZXnmoTmiZPlvIDnirbmgIENCiAgICovCgoKICBTZWxlY3QucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uIHRvZ2dsZSgpIHsKICAgIHRoaXMuaXNPcGVuKCkgPyB0aGlzLmNsb3NlKCkgOiB0aGlzLm9wZW4oKTsKICB9OwogIC8qKg0KICAgKiDmiZPlvIDkuIvmi4noj5zljZUNCiAgICovCgoKICBTZWxlY3QucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbiBvcGVuKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CgogICAgaWYgKHRoaXMuaXNPcGVuKCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuc3RhdGUgPSAnb3BlbmluZyc7CiAgICB0aGlzLnRyaWdnZXJFdmVudCgnb3BlbicpOwogICAgdGhpcy5yZWFkanVzdE1lbnUoKTsKICAgIHRoaXMuJGVsZW1lbnQuYWRkQ2xhc3MoJ21kdWktc2VsZWN0LW9wZW4nKTsKICAgIHRoaXMuJG1lbnUudHJhbnNpdGlvbkVuZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzJDEudHJhbnNpdGlvbkVuZCgpOwogICAgfSk7CiAgfTsKICAvKioNCiAgICog5YWz6Zet5LiL5ouJ6I+c5Y2VDQogICAqLwoKCiAgU2VsZWN0LnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uIGNsb3NlKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CgogICAgaWYgKCF0aGlzLmlzT3BlbigpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLnN0YXRlID0gJ2Nsb3NpbmcnOwogICAgdGhpcy50cmlnZ2VyRXZlbnQoJ2Nsb3NlJyk7CiAgICB0aGlzLiRtZW51LmNzcygnb3ZlcmZsb3cteScsICcnKTsKICAgIHRoaXMuJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kdWktc2VsZWN0LW9wZW4nKS5hZGRDbGFzcygnbWR1aS1zZWxlY3QtY2xvc2luZycpOwogICAgdGhpcy4kbWVudS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMkMS50cmFuc2l0aW9uRW5kKCk7CiAgICB9KTsKICB9OwogIC8qKg0KICAgKiDojrflj5blvZPliY3oj5zljZXnmoTnirbmgIHjgILlhbHljIXlkKvlm5vnp43nirbmgIHvvJpgb3BlbmluZ2DjgIFgb3BlbmVkYOOAgWBjbG9zaW5nYOOAgWBjbG9zZWRgDQogICAqLwoKCiAgU2VsZWN0LnByb3RvdHlwZS5nZXRTdGF0ZSA9IGZ1bmN0aW9uIGdldFN0YXRlKCkgewogICAgcmV0dXJuIHRoaXMuc3RhdGU7CiAgfTsKCiAgbWR1aS5TZWxlY3QgPSBTZWxlY3Q7CiAgdmFyIGN1c3RvbUF0dHIkNCA9ICdtZHVpLXNlbGVjdCc7CiAgJChmdW5jdGlvbiAoKSB7CiAgICBtZHVpLm11dGF0aW9uKCJbIiArIGN1c3RvbUF0dHIkNCArICJdIiwgZnVuY3Rpb24gKCkgewogICAgICBuZXcgbWR1aS5TZWxlY3QodGhpcywgcGFyc2VPcHRpb25zKHRoaXMsIGN1c3RvbUF0dHIkNCkpOwogICAgfSk7CiAgfSk7CiAgJChmdW5jdGlvbiAoKSB7CiAgICAvLyDmu5rliqjml7bpmpDol4/lupTnlKjmoI8KICAgIG1kdWkubXV0YXRpb24oJy5tZHVpLWFwcGJhci1zY3JvbGwtaGlkZScsIGZ1bmN0aW9uICgpIHsKICAgICAgbmV3IG1kdWkuSGVhZHJvb20odGhpcyk7CiAgICB9KTsgLy8g5rua5Yqo5pe25Y+q6ZqQ6JeP5bqU55So5qCP5Lit55qE5bel5YW35qCPCgogICAgbWR1aS5tdXRhdGlvbignLm1kdWktYXBwYmFyLXNjcm9sbC10b29sYmFyLWhpZGUnLCBmdW5jdGlvbiAoKSB7CiAgICAgIG5ldyBtZHVpLkhlYWRyb29tKHRoaXMsIHsKICAgICAgICBwaW5uZWRDbGFzczogJ21kdWktaGVhZHJvb20tcGlubmVkLXRvb2xiYXInLAogICAgICAgIHVucGlubmVkQ2xhc3M6ICdtZHVpLWhlYWRyb29tLXVucGlubmVkLXRvb2xiYXInCiAgICAgIH0pOwogICAgfSk7CiAgfSk7CiAgdmFyIERFRkFVTFRfT1BUSU9OUyQ0ID0gewogICAgdHJpZ2dlcjogJ2NsaWNrJywKICAgIGxvb3A6IGZhbHNlCiAgfTsKCiAgdmFyIFRhYiA9IGZ1bmN0aW9uIFRhYihzZWxlY3Rvciwgb3B0aW9ucykgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CiAgICBpZiAob3B0aW9ucyA9PT0gdm9pZCAwKSBvcHRpb25zID0ge307CiAgICAvKioNCiAgICAgKiDphY3nva7lj4LmlbANCiAgICAgKi8KCiAgICB0aGlzLm9wdGlvbnMgPSBleHRlbmQoe30sIERFRkFVTFRfT1BUSU9OUyQ0KTsKICAgIC8qKg0KICAgICAqIOW9k+WJjea/gOa0u+eahCB0YWIg55qE57Si5byV5Y+344CC5Li6IC0xIOaXtuihqOekuuayoeaciea/gOa0u+eahOmAiemhueWNoe+8jOaIluS4jeWtmOWcqOmAiemhueWNoQ0KICAgICAqLwoKICAgIHRoaXMuYWN0aXZlSW5kZXggPSAtMTsKICAgIHRoaXMuJGVsZW1lbnQgPSAkKHNlbGVjdG9yKS5maXJzdCgpOwogICAgZXh0ZW5kKHRoaXMub3B0aW9ucywgb3B0aW9ucyk7CiAgICB0aGlzLiR0YWJzID0gdGhpcy4kZWxlbWVudC5jaGlsZHJlbignYScpOwogICAgdGhpcy4kaW5kaWNhdG9yID0gJCgnPGRpdiBjbGFzcz0ibWR1aS10YWItaW5kaWNhdG9yIj48L2Rpdj4nKS5hcHBlbmRUbyh0aGlzLiRlbGVtZW50KTsgLy8g5qC55o2uIHVybCBoYXNoIOiOt+WPlum7mOiupOa/gOa0u+eahOmAiemhueWNoQoKICAgIHZhciBoYXNoID0gd2luZG93LmxvY2F0aW9uLmhhc2g7CgogICAgaWYgKGhhc2gpIHsKICAgICAgdGhpcy4kdGFicy5lYWNoKGZ1bmN0aW9uIChpbmRleCwgdGFiKSB7CiAgICAgICAgaWYgKCQodGFiKS5hdHRyKCdocmVmJykgPT09IGhhc2gpIHsKICAgICAgICAgIHRoaXMkMS5hY3RpdmVJbmRleCA9IGluZGV4OwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0pOwogICAgfSAvLyDlkKsgLm1kdWktdGFiLWFjdGl2ZSDnmoTlhYPntKDpu5jorqTmv4DmtLsKCgogICAgaWYgKHRoaXMuYWN0aXZlSW5kZXggPT09IC0xKSB7CiAgICAgIHRoaXMuJHRhYnMuZWFjaChmdW5jdGlvbiAoaW5kZXgsIHRhYikgewogICAgICAgIGlmICgkKHRhYikuaGFzQ2xhc3MoJ21kdWktdGFiLWFjdGl2ZScpKSB7CiAgICAgICAgICB0aGlzJDEuYWN0aXZlSW5kZXggPSBpbmRleDsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9KTsKICAgIH0gLy8g5a2Y5Zyo6YCJ6aG55Y2h5pe277yM6buY6K6k5r+A5rS756ys5LiA5Liq6YCJ6aG55Y2hCgoKICAgIGlmICh0aGlzLiR0YWJzLmxlbmd0aCAmJiB0aGlzLmFjdGl2ZUluZGV4ID09PSAtMSkgewogICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gMDsKICAgIH0gLy8g6K6+572u5r+A5rS754q25oCB6YCJ6aG55Y2hCgoKICAgIHRoaXMuc2V0QWN0aXZlKCk7IC8vIOebkeWQrOeql+WPo+Wkp+Wwj+WPmOWMluS6i+S7tu+8jOiwg+aVtOaMh+ekuuWZqOS9jee9rgoKICAgICR3aW5kb3cub24oJ3Jlc2l6ZScsICQudGhyb3R0bGUoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcyQxLnNldEluZGljYXRvclBvc2l0aW9uKCk7CiAgICB9LCAxMDApKTsgLy8g55uR5ZCs54K55Ye76YCJ6aG55Y2h5LqL5Lu2CgogICAgdGhpcy4kdGFicy5lYWNoKGZ1bmN0aW9uIChfLCB0YWIpIHsKICAgICAgdGhpcyQxLmJpbmRUYWJFdmVudCh0YWIpOwogICAgfSk7CiAgfTsKICAvKioNCiAgICog5oyH5a6a6YCJ6aG55Y2h5piv5ZCm5bey56aB55SoDQogICAqIEBwYXJhbSAkdGFiDQogICAqLwoKCiAgVGFiLnByb3RvdHlwZS5pc0Rpc2FibGVkID0gZnVuY3Rpb24gaXNEaXNhYmxlZCgkdGFiKSB7CiAgICByZXR1cm4gJHRhYi5hdHRyKCdkaXNhYmxlZCcpICE9PSB1bmRlZmluZWQ7CiAgfTsKICAvKioNCiAgICog57uR5a6a5ZyoIFRhYiDkuIrngrnlh7vmiJbmgqzmta7nmoTkuovku7YNCiAgICogQHBhcmFtIHRhYg0KICAgKi8KCgogIFRhYi5wcm90b3R5cGUuYmluZFRhYkV2ZW50ID0gZnVuY3Rpb24gYmluZFRhYkV2ZW50KHRhYikgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CiAgICB2YXIgJHRhYiA9ICQodGFiKTsgLy8g54K55Ye75oiW6byg5qCH56e75YWl6Kem5Y+R55qE5LqL5Lu2CgogICAgdmFyIGNsaWNrRXZlbnQgPSBmdW5jdGlvbiAoKSB7CiAgICAgIC8vIOemgeeUqOeKtuaAgeeahOmAiemhueWNoeaXoOazlemAieS4rQogICAgICBpZiAodGhpcyQxLmlzRGlzYWJsZWQoJHRhYikpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHRoaXMkMS5hY3RpdmVJbmRleCA9IHRoaXMkMS4kdGFicy5pbmRleCh0YWIpOwogICAgICB0aGlzJDEuc2V0QWN0aXZlKCk7CiAgICB9OyAvLyDml6DorrogdHJpZ2dlciDmmK8gY2xpY2sg6L+Y5pivIGhvdmVy77yM6YO95Lya5ZON5bqUIGNsaWNrIOS6i+S7tgoKCiAgICAkdGFiLm9uKCdjbGljaycsIGNsaWNrRXZlbnQpOyAvLyB0cmlnZ2VyIOS4uiBob3ZlciDml7bvvIzpop3lpJblk43lupQgbW91c2VlbnRlciDkuovku7YKCiAgICBpZiAodGhpcy5vcHRpb25zLnRyaWdnZXIgPT09ICdob3ZlcicpIHsKICAgICAgJHRhYi5vbignbW91c2VlbnRlcicsIGNsaWNrRXZlbnQpOwogICAgfSAvLyDpmLvmraLpk77mjqXnmoTpu5jorqTngrnlh7vliqjkvZwKCgogICAgJHRhYi5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICgoJHRhYi5hdHRyKCdocmVmJykgfHwgJycpLmluZGV4T2YoJyMnKSA9PT0gMCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSk7CiAgfTsKICAvKioNCiAgICog6Kem5Y+R57uE5Lu25LqL5Lu2DQogICAqIEBwYXJhbSBuYW1lDQogICAqIEBwYXJhbSAkZWxlbWVudA0KICAgKiBAcGFyYW0gcGFyYW1ldGVycw0KICAgKi8KCgogIFRhYi5wcm90b3R5cGUudHJpZ2dlckV2ZW50ID0gZnVuY3Rpb24gdHJpZ2dlckV2ZW50KG5hbWUsICRlbGVtZW50LCBwYXJhbWV0ZXJzKSB7CiAgICBpZiAocGFyYW1ldGVycyA9PT0gdm9pZCAwKSBwYXJhbWV0ZXJzID0ge307CiAgICBjb21wb25lbnRFdmVudChuYW1lLCAndGFiJywgJGVsZW1lbnQsIHRoaXMsIHBhcmFtZXRlcnMpOwogIH07CiAgLyoqDQogICAqIOiuvue9rua/gOa0u+eKtuaAgeeahOmAiemhueWNoQ0KICAgKi8KCgogIFRhYi5wcm90b3R5cGUuc2V0QWN0aXZlID0gZnVuY3Rpb24gc2V0QWN0aXZlKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CiAgICB0aGlzLiR0YWJzLmVhY2goZnVuY3Rpb24gKGluZGV4LCB0YWIpIHsKICAgICAgdmFyICR0YWIgPSAkKHRhYik7CiAgICAgIHZhciB0YXJnZXRJZCA9ICR0YWIuYXR0cignaHJlZicpIHx8ICcnOyAvLyDorr7nva7pgInpobnljaHmv4DmtLvnirbmgIEKCiAgICAgIGlmIChpbmRleCA9PT0gdGhpcyQxLmFjdGl2ZUluZGV4ICYmICF0aGlzJDEuaXNEaXNhYmxlZCgkdGFiKSkgewogICAgICAgIGlmICghJHRhYi5oYXNDbGFzcygnbWR1aS10YWItYWN0aXZlJykpIHsKICAgICAgICAgIHRoaXMkMS50cmlnZ2VyRXZlbnQoJ2NoYW5nZScsIHRoaXMkMS4kZWxlbWVudCwgewogICAgICAgICAgICBpbmRleDogdGhpcyQxLmFjdGl2ZUluZGV4LAogICAgICAgICAgICBpZDogdGFyZ2V0SWQuc3Vic3RyKDEpCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMkMS50cmlnZ2VyRXZlbnQoJ3Nob3cnLCAkdGFiKTsKICAgICAgICAgICR0YWIuYWRkQ2xhc3MoJ21kdWktdGFiLWFjdGl2ZScpOwogICAgICAgIH0KCiAgICAgICAgJCh0YXJnZXRJZCkuc2hvdygpOwogICAgICAgIHRoaXMkMS5zZXRJbmRpY2F0b3JQb3NpdGlvbigpOwogICAgICB9IGVsc2UgewogICAgICAgICR0YWIucmVtb3ZlQ2xhc3MoJ21kdWktdGFiLWFjdGl2ZScpOwogICAgICAgICQodGFyZ2V0SWQpLmhpZGUoKTsKICAgICAgfQogICAgfSk7CiAgfTsKICAvKioNCiAgICog6K6+572u6YCJ6aG55Y2h5oyH56S65Zmo55qE5L2N572uDQogICAqLwoKCiAgVGFiLnByb3RvdHlwZS5zZXRJbmRpY2F0b3JQb3NpdGlvbiA9IGZ1bmN0aW9uIHNldEluZGljYXRvclBvc2l0aW9uKCkgewogICAgLy8g6YCJ6aG55Y2h5pWw6YeP5Li6IDAg5pe277yM5LiN5pi+56S65oyH56S65ZmoCiAgICBpZiAodGhpcy5hY3RpdmVJbmRleCA9PT0gLTEpIHsKICAgICAgdGhpcy4kaW5kaWNhdG9yLmNzcyh7CiAgICAgICAgbGVmdDogMCwKICAgICAgICB3aWR0aDogMAogICAgICB9KTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciAkYWN0aXZlVGFiID0gdGhpcy4kdGFicy5lcSh0aGlzLmFjdGl2ZUluZGV4KTsKCiAgICBpZiAodGhpcy5pc0Rpc2FibGVkKCRhY3RpdmVUYWIpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgYWN0aXZlVGFiT2Zmc2V0ID0gJGFjdGl2ZVRhYi5vZmZzZXQoKTsKICAgIHRoaXMuJGluZGljYXRvci5jc3MoewogICAgICBsZWZ0OiBhY3RpdmVUYWJPZmZzZXQubGVmdCArIHRoaXMuJGVsZW1lbnRbMF0uc2Nyb2xsTGVmdCAtIHRoaXMuJGVsZW1lbnRbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCArICJweCIsCiAgICAgIHdpZHRoOiAkYWN0aXZlVGFiLmlubmVyV2lkdGgoKSArICJweCIKICAgIH0pOwogIH07CiAgLyoqDQogICAqIOWIh+aNouWIsOS4i+S4gOS4qumAiemhueWNoQ0KICAgKi8KCgogIFRhYi5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uIG5leHQoKSB7CiAgICBpZiAodGhpcy5hY3RpdmVJbmRleCA9PT0gLTEpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICh0aGlzLiR0YWJzLmxlbmd0aCA+IHRoaXMuYWN0aXZlSW5kZXggKyAxKSB7CiAgICAgIHRoaXMuYWN0aXZlSW5kZXgrKzsKICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25zLmxvb3ApIHsKICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IDA7CiAgICB9CgogICAgdGhpcy5zZXRBY3RpdmUoKTsKICB9OwogIC8qKg0KICAgKiDliIfmjaLliLDkuIrkuIDkuKrpgInpobnljaENCiAgICovCgoKICBUYWIucHJvdG90eXBlLnByZXYgPSBmdW5jdGlvbiBwcmV2KCkgewogICAgaWYgKHRoaXMuYWN0aXZlSW5kZXggPT09IC0xKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAodGhpcy5hY3RpdmVJbmRleCA+IDApIHsKICAgICAgdGhpcy5hY3RpdmVJbmRleC0tOwogICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMubG9vcCkgewogICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gdGhpcy4kdGFicy5sZW5ndGggLSAxOwogICAgfQoKICAgIHRoaXMuc2V0QWN0aXZlKCk7CiAgfTsKICAvKioNCiAgICog5pi+56S65oyH5a6a57Si5byV5Y+344CB5oiW5oyH5a6aaWTnmoTpgInpobnljaENCiAgICogQHBhcmFtIGluZGV4IOe0ouW8leWPt+OAgeaIlmlkDQogICAqLwoKCiAgVGFiLnByb3RvdHlwZS5zaG93ID0gZnVuY3Rpb24gc2hvdyhpbmRleCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CgogICAgaWYgKHRoaXMuYWN0aXZlSW5kZXggPT09IC0xKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoaXNOdW1iZXIoaW5kZXgpKSB7CiAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSBpbmRleDsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuJHRhYnMuZWFjaChmdW5jdGlvbiAoaSwgdGFiKSB7CiAgICAgICAgaWYgKHRhYi5pZCA9PT0gaW5kZXgpIHsKICAgICAgICAgIHRoaXMkMS5hY3RpdmVJbmRleCA9PT0gaTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIHRoaXMuc2V0QWN0aXZlKCk7CiAgfTsKICAvKioNCiAgICog5Zyo54i25YWD57Sg55qE5a695bqm5Y+Y5YyW5pe277yM6ZyA6KaB6LCD55So6K+l5pa55rOV6YeN5paw6LCD5pW05oyH56S65Zmo5L2N572uDQogICAqIOWcqOa3u+WKoOaIluWIoOmZpOmAiemhueWNoeaXtu+8jOmcgOimgeiwg+eUqOivpeaWueazlQ0KICAgKi8KCgogIFRhYi5wcm90b3R5cGUuaGFuZGxlVXBkYXRlID0gZnVuY3Rpb24gaGFuZGxlVXBkYXRlKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CiAgICB2YXIgJG9sZFRhYnMgPSB0aGlzLiR0YWJzOyAvLyDml6fnmoQgdGFicyBKUeWvueixoQoKICAgIHZhciAkbmV3VGFicyA9IHRoaXMuJGVsZW1lbnQuY2hpbGRyZW4oJ2EnKTsgLy8g5paw55qEIHRhYnMgSlHlr7nosaEKCiAgICB2YXIgb2xkVGFic0VsZW1lbnQgPSAkb2xkVGFicy5nZXQoKTsgLy8g5pen55qEIHRhYnMg5YWD57Sg5pWw57uECgogICAgdmFyIG5ld1RhYnNFbGVtZW50ID0gJG5ld1RhYnMuZ2V0KCk7IC8vIOaWsOeahCB0YWJzIOWFg+e0oOaVsOe7hAoKICAgIGlmICghJG5ld1RhYnMubGVuZ3RoKSB7CiAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSAtMTsKICAgICAgdGhpcy4kdGFicyA9ICRuZXdUYWJzOwogICAgICB0aGlzLnNldEluZGljYXRvclBvc2l0aW9uKCk7CiAgICAgIHJldHVybjsKICAgIH0gLy8g6YeN5paw6YGN5Y6G6YCJ6aG55Y2h77yM5om+5Ye65paw5aKe55qE6YCJ6aG55Y2hCgoKICAgICRuZXdUYWJzLmVhY2goZnVuY3Rpb24gKGluZGV4LCB0YWIpIHsKICAgICAgLy8g5pyJ5paw5aKe55qE6YCJ6aG55Y2hCiAgICAgIGlmIChvbGRUYWJzRWxlbWVudC5pbmRleE9mKHRhYikgPCAwKSB7CiAgICAgICAgdGhpcyQxLmJpbmRUYWJFdmVudCh0YWIpOwoKICAgICAgICBpZiAodGhpcyQxLmFjdGl2ZUluZGV4ID09PSAtMSkgewogICAgICAgICAgdGhpcyQxLmFjdGl2ZUluZGV4ID0gMDsKICAgICAgICB9IGVsc2UgaWYgKGluZGV4IDw9IHRoaXMkMS5hY3RpdmVJbmRleCkgewogICAgICAgICAgdGhpcyQxLmFjdGl2ZUluZGV4Kys7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsgLy8g5om+5Ye66KKr56e76Zmk55qE6YCJ6aG55Y2hCgogICAgJG9sZFRhYnMuZWFjaChmdW5jdGlvbiAoaW5kZXgsIHRhYikgewogICAgICAvLyDmnInooqvnp7vpmaTnmoTpgInpobnljaEKICAgICAgaWYgKG5ld1RhYnNFbGVtZW50LmluZGV4T2YodGFiKSA8IDApIHsKICAgICAgICBpZiAoaW5kZXggPCB0aGlzJDEuYWN0aXZlSW5kZXgpIHsKICAgICAgICAgIHRoaXMkMS5hY3RpdmVJbmRleC0tOwogICAgICAgIH0gZWxzZSBpZiAoaW5kZXggPT09IHRoaXMkMS5hY3RpdmVJbmRleCkgewogICAgICAgICAgdGhpcyQxLmFjdGl2ZUluZGV4ID0gMDsKICAgICAgICB9CiAgICAgIH0KICAgIH0pOwogICAgdGhpcy4kdGFicyA9ICRuZXdUYWJzOwogICAgdGhpcy5zZXRBY3RpdmUoKTsKICB9OwoKICBtZHVpLlRhYiA9IFRhYjsKICB2YXIgY3VzdG9tQXR0ciQ1ID0gJ21kdWktdGFiJzsKICAkKGZ1bmN0aW9uICgpIHsKICAgIG1kdWkubXV0YXRpb24oIlsiICsgY3VzdG9tQXR0ciQ1ICsgIl0iLCBmdW5jdGlvbiAoKSB7CiAgICAgIG5ldyBtZHVpLlRhYih0aGlzLCBwYXJzZU9wdGlvbnModGhpcywgY3VzdG9tQXR0ciQ1KSk7CiAgICB9KTsKICB9KTsKICAvKioNCiAgICog5Zyo5qGM6Z2i6K6+5aSH5LiK6buY6K6k5pi+56S65oq95bGJ5qCP77yM5LiN5pi+56S66YGu572p5bGCDQogICAqIOWcqOaJi+acuuWSjOW5s+adv+iuvuWkh+S4ium7mOiupOS4jeaYvuekuuaKveWxieagj++8jOWni+e7iOaYvuekuumBrue9qeWxgu+8jOS4lOimhuebluWvvOiIquagjw0KICAgKi8KCiAgdmFyIERFRkFVTFRfT1BUSU9OUyQ1ID0gewogICAgb3ZlcmxheTogZmFsc2UsCiAgICBzd2lwZTogZmFsc2UKICB9OwoKICB2YXIgRHJhd2VyID0gZnVuY3Rpb24gRHJhd2VyKHNlbGVjdG9yLCBvcHRpb25zKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIG9wdGlvbnMgPSB7fTsKICAgIC8qKg0KICAgICAqIOmFjee9ruWPguaVsA0KICAgICAqLwoKICAgIHRoaXMub3B0aW9ucyA9IGV4dGVuZCh7fSwgREVGQVVMVF9PUFRJT05TJDUpOwogICAgLyoqDQogICAgICog5b2T5YmN5piv5ZCm5pi+56S6552A6YGu572p5bGCDQogICAgICovCgogICAgdGhpcy5vdmVybGF5ID0gZmFsc2U7CiAgICB0aGlzLiRlbGVtZW50ID0gJChzZWxlY3RvcikuZmlyc3QoKTsKICAgIGV4dGVuZCh0aGlzLm9wdGlvbnMsIG9wdGlvbnMpOwogICAgdGhpcy5wb3NpdGlvbiA9IHRoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ21kdWktZHJhd2VyLXJpZ2h0JykgPyAncmlnaHQnIDogJ2xlZnQnOwoKICAgIGlmICh0aGlzLiRlbGVtZW50Lmhhc0NsYXNzKCdtZHVpLWRyYXdlci1jbG9zZScpKSB7CiAgICAgIHRoaXMuc3RhdGUgPSAnY2xvc2VkJzsKICAgIH0gZWxzZSBpZiAodGhpcy4kZWxlbWVudC5oYXNDbGFzcygnbWR1aS1kcmF3ZXItb3BlbicpKSB7CiAgICAgIHRoaXMuc3RhdGUgPSAnb3BlbmVkJzsKICAgIH0gZWxzZSBpZiAodGhpcy5pc0Rlc2t0b3AoKSkgewogICAgICB0aGlzLnN0YXRlID0gJ29wZW5lZCc7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICB9IC8vIOa1j+iniOWZqOeql+WPo+Wkp+Wwj+iwg+aVtOaXtgoKCiAgICAkd2luZG93Lm9uKCdyZXNpemUnLCAkLnRocm90dGxlKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHRoaXMkMS5pc0Rlc2t0b3AoKSkgewogICAgICAgIC8vIOeUseaJi+acuuW5s+adv+WIh+aNouWIsOahjOmdouaXtgogICAgICAgIC8vIOWmguaenOaYvuekuuedgOmBrue9qe+8jOWImemakOiXj+mBrue9qQogICAgICAgIGlmICh0aGlzJDEub3ZlcmxheSAmJiAhdGhpcyQxLm9wdGlvbnMub3ZlcmxheSkgewogICAgICAgICAgJC5oaWRlT3ZlcmxheSgpOwogICAgICAgICAgdGhpcyQxLm92ZXJsYXkgPSBmYWxzZTsKICAgICAgICAgICQudW5sb2NrU2NyZWVuKCk7CiAgICAgICAgfSAvLyDmsqHmnInlvLrliLblhbPpl63vvIzliJnnirbmgIHkuLrmiZPlvIDnirbmgIEKCgogICAgICAgIGlmICghdGhpcyQxLiRlbGVtZW50Lmhhc0NsYXNzKCdtZHVpLWRyYXdlci1jbG9zZScpKSB7CiAgICAgICAgICB0aGlzJDEuc3RhdGUgPSAnb3BlbmVkJzsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMkMS5vdmVybGF5ICYmIHRoaXMkMS5zdGF0ZSA9PT0gJ29wZW5lZCcpIHsKICAgICAgICAvLyDnlLHmoYzpnaLliIfmjaLliLDmiYvmnLrlubPmnb/ml7bjgILlpoLmnpzmir3lsYnmoI/mmK/miZPlvIDnnYDnmoTkuJTmsqHmnInpga7nvanlsYLvvIzliJnlhbPpl63mir3lsYnmoI8KICAgICAgICBpZiAodGhpcyQxLiRlbGVtZW50Lmhhc0NsYXNzKCdtZHVpLWRyYXdlci1vcGVuJykpIHsKICAgICAgICAgICQuc2hvd092ZXJsYXkoKTsKICAgICAgICAgIHRoaXMkMS5vdmVybGF5ID0gdHJ1ZTsKICAgICAgICAgICQubG9ja1NjcmVlbigpOwogICAgICAgICAgJCgnLm1kdWktb3ZlcmxheScpLm9uZSgnY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzJDEuY2xvc2UoKTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzJDEuc3RhdGUgPSAnY2xvc2VkJzsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIDEwMCkpOyAvLyDnu5HlrprlhbPpl63mjInpkq7kuovku7YKCiAgICB0aGlzLiRlbGVtZW50LmZpbmQoJ1ttZHVpLWRyYXdlci1jbG9zZV0nKS5lYWNoKGZ1bmN0aW9uIChfLCBjbG9zZSkgewogICAgICAkKGNsb3NlKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMkMS5jbG9zZSgpOwogICAgICB9KTsKICAgIH0pOwogICAgdGhpcy5zd2lwZVN1cHBvcnQoKTsKICB9OwogIC8qKg0KICAgKiDmmK/lkKbmmK/moYzpnaLorr7lpIcNCiAgICovCgoKICBEcmF3ZXIucHJvdG90eXBlLmlzRGVza3RvcCA9IGZ1bmN0aW9uIGlzRGVza3RvcCgpIHsKICAgIHJldHVybiAkd2luZG93LndpZHRoKCkgPj0gMTAyNDsKICB9OwogIC8qKg0KICAgKiDmu5HliqjmiYvlir/mlK/mjIENCiAgICovCgoKICBEcmF3ZXIucHJvdG90eXBlLnN3aXBlU3VwcG9ydCA9IGZ1bmN0aW9uIHN3aXBlU3VwcG9ydCgpIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdGhpcy1hbGlhcwogICAgdmFyIHRoYXQgPSB0aGlzOyAvLyDmir3lsYnmoI/mu5HliqjmiYvlir/mjqfliLYKCiAgICB2YXIgb3Blbk5hdkV2ZW50SGFuZGxlcjsKICAgIHZhciB0b3VjaFN0YXJ0WDsKICAgIHZhciB0b3VjaFN0YXJ0WTsKICAgIHZhciBzd2lwZVN0YXJ0WDsKICAgIHZhciBzd2lwaW5nID0gbnVsbDsKICAgIHZhciBtYXliZVN3aXBpbmcgPSBmYWxzZTsKICAgIHZhciAkYm9keSA9ICQoJ2JvZHknKTsgLy8g5omL5Yq/6Kem5Y+R55qE6IyD5Zu0CgogICAgdmFyIHN3aXBlQXJlYVdpZHRoID0gMjQ7CgogICAgZnVuY3Rpb24gc2V0UG9zaXRpb24odHJhbnNsYXRlWCkgewogICAgICB2YXIgcnRsVHJhbnNsYXRlTXVsdGlwbGllciA9IHRoYXQucG9zaXRpb24gPT09ICdyaWdodCcgPyAtMSA6IDE7CiAgICAgIHZhciB0cmFuc2Zvcm1DU1MgPSAidHJhbnNsYXRlKCIgKyAtMSAqIHJ0bFRyYW5zbGF0ZU11bHRpcGxpZXIgKiB0cmFuc2xhdGVYICsgInB4LCAwKSAhaW1wb3J0YW50OyI7CiAgICAgIHZhciB0cmFuc2l0aW9uQ1NTID0gJ2luaXRpYWwgIWltcG9ydGFudDsnOwogICAgICB0aGF0LiRlbGVtZW50LmNzcygnY3NzVGV4dCcsICJ0cmFuc2Zvcm06ICIgKyB0cmFuc2Zvcm1DU1MgKyAiOyB0cmFuc2l0aW9uOiAiICsgdHJhbnNpdGlvbkNTUyArICI7Iik7CiAgICB9CgogICAgZnVuY3Rpb24gY2xlYW5Qb3NpdGlvbigpIHsKICAgICAgdGhhdC4kZWxlbWVudFswXS5zdHlsZS50cmFuc2Zvcm0gPSAnJzsKICAgICAgdGhhdC4kZWxlbWVudFswXS5zdHlsZS53ZWJraXRUcmFuc2Zvcm0gPSAnJzsKICAgICAgdGhhdC4kZWxlbWVudFswXS5zdHlsZS50cmFuc2l0aW9uID0gJyc7CiAgICAgIHRoYXQuJGVsZW1lbnRbMF0uc3R5bGUud2Via2l0VHJhbnNpdGlvbiA9ICcnOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldE1heFRyYW5zbGF0ZVgoKSB7CiAgICAgIHJldHVybiB0aGF0LiRlbGVtZW50LndpZHRoKCkgKyAxMDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRUcmFuc2xhdGVYKGN1cnJlbnRYKSB7CiAgICAgIHJldHVybiBNYXRoLm1pbihNYXRoLm1heChzd2lwaW5nID09PSAnY2xvc2luZycgPyBzd2lwZVN0YXJ0WCAtIGN1cnJlbnRYIDogZ2V0TWF4VHJhbnNsYXRlWCgpICsgc3dpcGVTdGFydFggLSBjdXJyZW50WCwgMCksIGdldE1heFRyYW5zbGF0ZVgoKSk7CiAgICB9CgogICAgZnVuY3Rpb24gb25Cb2R5VG91Y2hFbmQoZXZlbnQpIHsKICAgICAgaWYgKHN3aXBpbmcpIHsKICAgICAgICB2YXIgdG91Y2hYID0gZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVg7CgogICAgICAgIGlmICh0aGF0LnBvc2l0aW9uID09PSAncmlnaHQnKSB7CiAgICAgICAgICB0b3VjaFggPSAkYm9keS53aWR0aCgpIC0gdG91Y2hYOwogICAgICAgIH0KCiAgICAgICAgdmFyIHRyYW5zbGF0ZVJhdGlvID0gZ2V0VHJhbnNsYXRlWCh0b3VjaFgpIC8gZ2V0TWF4VHJhbnNsYXRlWCgpOwogICAgICAgIG1heWJlU3dpcGluZyA9IGZhbHNlOwogICAgICAgIHZhciBzd2lwaW5nU3RhdGUgPSBzd2lwaW5nOwogICAgICAgIHN3aXBpbmcgPSBudWxsOwoKICAgICAgICBpZiAoc3dpcGluZ1N0YXRlID09PSAnb3BlbmluZycpIHsKICAgICAgICAgIGlmICh0cmFuc2xhdGVSYXRpbyA8IDAuOTIpIHsKICAgICAgICAgICAgY2xlYW5Qb3NpdGlvbigpOwogICAgICAgICAgICB0aGF0Lm9wZW4oKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNsZWFuUG9zaXRpb24oKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHRyYW5zbGF0ZVJhdGlvID4gMC4wOCkgewogICAgICAgICAgICBjbGVhblBvc2l0aW9uKCk7CiAgICAgICAgICAgIHRoYXQuY2xvc2UoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNsZWFuUG9zaXRpb24oKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICQudW5sb2NrU2NyZWVuKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbWF5YmVTd2lwaW5nID0gZmFsc2U7CiAgICAgIH0KCiAgICAgICRib2R5Lm9mZih7CiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11c2UtYmVmb3JlLWRlZmluZQogICAgICAgIHRvdWNobW92ZTogb25Cb2R5VG91Y2hNb3ZlLAogICAgICAgIHRvdWNoZW5kOiBvbkJvZHlUb3VjaEVuZCwKICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVzZS1iZWZvcmUtZGVmaW5lCiAgICAgICAgdG91Y2hjYW5jZWw6IG9uQm9keVRvdWNoTW92ZQogICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBvbkJvZHlUb3VjaE1vdmUoZXZlbnQpIHsKICAgICAgdmFyIHRvdWNoWCA9IGV2ZW50LnRvdWNoZXNbMF0ucGFnZVg7CgogICAgICBpZiAodGhhdC5wb3NpdGlvbiA9PT0gJ3JpZ2h0JykgewogICAgICAgIHRvdWNoWCA9ICRib2R5LndpZHRoKCkgLSB0b3VjaFg7CiAgICAgIH0KCiAgICAgIHZhciB0b3VjaFkgPSBldmVudC50b3VjaGVzWzBdLnBhZ2VZOwoKICAgICAgaWYgKHN3aXBpbmcpIHsKICAgICAgICBzZXRQb3NpdGlvbihnZXRUcmFuc2xhdGVYKHRvdWNoWCkpOwogICAgICB9IGVsc2UgaWYgKG1heWJlU3dpcGluZykgewogICAgICAgIHZhciBkWEFicyA9IE1hdGguYWJzKHRvdWNoWCAtIHRvdWNoU3RhcnRYKTsKICAgICAgICB2YXIgZFlBYnMgPSBNYXRoLmFicyh0b3VjaFkgLSB0b3VjaFN0YXJ0WSk7CiAgICAgICAgdmFyIHRocmVzaG9sZCA9IDg7CgogICAgICAgIGlmIChkWEFicyA+IHRocmVzaG9sZCAmJiBkWUFicyA8PSB0aHJlc2hvbGQpIHsKICAgICAgICAgIHN3aXBlU3RhcnRYID0gdG91Y2hYOwogICAgICAgICAgc3dpcGluZyA9IHRoYXQuc3RhdGUgPT09ICdvcGVuZWQnID8gJ2Nsb3NpbmcnIDogJ29wZW5pbmcnOwogICAgICAgICAgJC5sb2NrU2NyZWVuKCk7CiAgICAgICAgICBzZXRQb3NpdGlvbihnZXRUcmFuc2xhdGVYKHRvdWNoWCkpOwogICAgICAgIH0gZWxzZSBpZiAoZFhBYnMgPD0gdGhyZXNob2xkICYmIGRZQWJzID4gdGhyZXNob2xkKSB7CiAgICAgICAgICBvbkJvZHlUb3VjaEVuZCgpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIG9uQm9keVRvdWNoU3RhcnQoZXZlbnQpIHsKICAgICAgdG91Y2hTdGFydFggPSBldmVudC50b3VjaGVzWzBdLnBhZ2VYOwoKICAgICAgaWYgKHRoYXQucG9zaXRpb24gPT09ICdyaWdodCcpIHsKICAgICAgICB0b3VjaFN0YXJ0WCA9ICRib2R5LndpZHRoKCkgLSB0b3VjaFN0YXJ0WDsKICAgICAgfQoKICAgICAgdG91Y2hTdGFydFkgPSBldmVudC50b3VjaGVzWzBdLnBhZ2VZOwoKICAgICAgaWYgKHRoYXQuc3RhdGUgIT09ICdvcGVuZWQnKSB7CiAgICAgICAgaWYgKHRvdWNoU3RhcnRYID4gc3dpcGVBcmVhV2lkdGggfHwgb3Blbk5hdkV2ZW50SGFuZGxlciAhPT0gb25Cb2R5VG91Y2hTdGFydCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQoKICAgICAgbWF5YmVTd2lwaW5nID0gdHJ1ZTsKICAgICAgJGJvZHkub24oewogICAgICAgIHRvdWNobW92ZTogb25Cb2R5VG91Y2hNb3ZlLAogICAgICAgIHRvdWNoZW5kOiBvbkJvZHlUb3VjaEVuZCwKICAgICAgICB0b3VjaGNhbmNlbDogb25Cb2R5VG91Y2hNb3ZlCiAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIGVuYWJsZVN3aXBlSGFuZGxpbmcoKSB7CiAgICAgIGlmICghb3Blbk5hdkV2ZW50SGFuZGxlcikgewogICAgICAgICRib2R5Lm9uKCd0b3VjaHN0YXJ0Jywgb25Cb2R5VG91Y2hTdGFydCk7CiAgICAgICAgb3Blbk5hdkV2ZW50SGFuZGxlciA9IG9uQm9keVRvdWNoU3RhcnQ7CiAgICAgIH0KICAgIH0KCiAgICBpZiAodGhpcy5vcHRpb25zLnN3aXBlKSB7CiAgICAgIGVuYWJsZVN3aXBlSGFuZGxpbmcoKTsKICAgIH0KICB9OwogIC8qKg0KICAgKiDop6blj5Hnu4Tku7bkuovku7YNCiAgICogQHBhcmFtIG5hbWUNCiAgICovCgoKICBEcmF3ZXIucHJvdG90eXBlLnRyaWdnZXJFdmVudCA9IGZ1bmN0aW9uIHRyaWdnZXJFdmVudChuYW1lKSB7CiAgICBjb21wb25lbnRFdmVudChuYW1lLCAnZHJhd2VyJywgdGhpcy4kZWxlbWVudCwgdGhpcyk7CiAgfTsKICAvKioNCiAgICog5Yqo55S757uT5p2f5Zue6LCDDQogICAqLwoKCiAgRHJhd2VyLnByb3RvdHlwZS50cmFuc2l0aW9uRW5kID0gZnVuY3Rpb24gdHJhbnNpdGlvbkVuZCgpIHsKICAgIGlmICh0aGlzLiRlbGVtZW50Lmhhc0NsYXNzKCdtZHVpLWRyYXdlci1vcGVuJykpIHsKICAgICAgdGhpcy5zdGF0ZSA9ICdvcGVuZWQnOwogICAgICB0aGlzLnRyaWdnZXJFdmVudCgnb3BlbmVkJyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICAgIHRoaXMudHJpZ2dlckV2ZW50KCdjbG9zZWQnKTsKICAgIH0KICB9OwogIC8qKg0KICAgKiDmmK/lkKblpITkuo7miZPlvIDnirbmgIENCiAgICovCgoKICBEcmF3ZXIucHJvdG90eXBlLmlzT3BlbiA9IGZ1bmN0aW9uIGlzT3BlbigpIHsKICAgIHJldHVybiB0aGlzLnN0YXRlID09PSAnb3BlbmluZycgfHwgdGhpcy5zdGF0ZSA9PT0gJ29wZW5lZCc7CiAgfTsKICAvKioNCiAgICog5omT5byA5oq95bGJ5qCPDQogICAqLwoKCiAgRHJhd2VyLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gb3BlbigpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwoKICAgIGlmICh0aGlzLmlzT3BlbigpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLnN0YXRlID0gJ29wZW5pbmcnOwogICAgdGhpcy50cmlnZ2VyRXZlbnQoJ29wZW4nKTsKCiAgICBpZiAoIXRoaXMub3B0aW9ucy5vdmVybGF5KSB7CiAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygibWR1aS1kcmF3ZXItYm9keS0iICsgdGhpcy5wb3NpdGlvbik7CiAgICB9CgogICAgdGhpcy4kZWxlbWVudC5yZW1vdmVDbGFzcygnbWR1aS1kcmF3ZXItY2xvc2UnKS5hZGRDbGFzcygnbWR1aS1kcmF3ZXItb3BlbicpLnRyYW5zaXRpb25FbmQoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcyQxLnRyYW5zaXRpb25FbmQoKTsKICAgIH0pOwoKICAgIGlmICghdGhpcy5pc0Rlc2t0b3AoKSB8fCB0aGlzLm9wdGlvbnMub3ZlcmxheSkgewogICAgICB0aGlzLm92ZXJsYXkgPSB0cnVlOwogICAgICAkLnNob3dPdmVybGF5KCkub25lKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpcyQxLmNsb3NlKCk7CiAgICAgIH0pOwogICAgICAkLmxvY2tTY3JlZW4oKTsKICAgIH0KICB9OwogIC8qKg0KICAgKiDlhbPpl63mir3lsYnmoI8NCiAgICovCgoKICBEcmF3ZXIucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gY2xvc2UoKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKCiAgICBpZiAoIXRoaXMuaXNPcGVuKCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuc3RhdGUgPSAnY2xvc2luZyc7CiAgICB0aGlzLnRyaWdnZXJFdmVudCgnY2xvc2UnKTsKCiAgICBpZiAoIXRoaXMub3B0aW9ucy5vdmVybGF5KSB7CiAgICAgICQoJ2JvZHknKS5yZW1vdmVDbGFzcygibWR1aS1kcmF3ZXItYm9keS0iICsgdGhpcy5wb3NpdGlvbik7CiAgICB9CgogICAgdGhpcy4kZWxlbWVudC5hZGRDbGFzcygnbWR1aS1kcmF3ZXItY2xvc2UnKS5yZW1vdmVDbGFzcygnbWR1aS1kcmF3ZXItb3BlbicpLnRyYW5zaXRpb25FbmQoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcyQxLnRyYW5zaXRpb25FbmQoKTsKICAgIH0pOwoKICAgIGlmICh0aGlzLm92ZXJsYXkpIHsKICAgICAgJC5oaWRlT3ZlcmxheSgpOwogICAgICB0aGlzLm92ZXJsYXkgPSBmYWxzZTsKICAgICAgJC51bmxvY2tTY3JlZW4oKTsKICAgIH0KICB9OwogIC8qKg0KICAgKiDliIfmjaLmir3lsYnmoI/miZPlvIAv5YWz6Zet54q25oCBDQogICAqLwoKCiAgRHJhd2VyLnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbiB0b2dnbGUoKSB7CiAgICB0aGlzLmlzT3BlbigpID8gdGhpcy5jbG9zZSgpIDogdGhpcy5vcGVuKCk7CiAgfTsKICAvKioNCiAgICog6L+U5Zue5b2T5YmN5oq95bGJ5qCP55qE54q25oCB44CC5YWx5YyF5ZCr5Zub56eN54q25oCB77yaYG9wZW5pbmdg44CBYG9wZW5lZGDjgIFgY2xvc2luZ2DjgIFgY2xvc2VkYA0KICAgKi8KCgogIERyYXdlci5wcm90b3R5cGUuZ2V0U3RhdGUgPSBmdW5jdGlvbiBnZXRTdGF0ZSgpIHsKICAgIHJldHVybiB0aGlzLnN0YXRlOwogIH07CgogIG1kdWkuRHJhd2VyID0gRHJhd2VyOwogIHZhciBjdXN0b21BdHRyJDYgPSAnbWR1aS1kcmF3ZXInOwogICQoZnVuY3Rpb24gKCkgewogICAgbWR1aS5tdXRhdGlvbigiWyIgKyBjdXN0b21BdHRyJDYgKyAiXSIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyICRlbGVtZW50ID0gJCh0aGlzKTsKICAgICAgdmFyIG9wdGlvbnMgPSBwYXJzZU9wdGlvbnModGhpcywgY3VzdG9tQXR0ciQ2KTsKICAgICAgdmFyIHNlbGVjdG9yID0gb3B0aW9ucy50YXJnZXQ7IC8vIEB0cy1pZ25vcmUKCiAgICAgIGRlbGV0ZSBvcHRpb25zLnRhcmdldDsKICAgICAgdmFyICRkcmF3ZXIgPSAkKHNlbGVjdG9yKS5maXJzdCgpOwogICAgICB2YXIgaW5zdGFuY2UgPSBuZXcgbWR1aS5EcmF3ZXIoJGRyYXdlciwgb3B0aW9ucyk7CiAgICAgICRlbGVtZW50Lm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gaW5zdGFuY2UudG9nZ2xlKCk7CiAgICAgIH0pOwogICAgfSk7CiAgfSk7CiAgdmFyIGNvbnRhaW5lciA9IHt9OwoKICBmdW5jdGlvbiBxdWV1ZShuYW1lLCBmdW5jKSB7CiAgICBpZiAoaXNVbmRlZmluZWQoY29udGFpbmVyW25hbWVdKSkgewogICAgICBjb250YWluZXJbbmFtZV0gPSBbXTsKICAgIH0KCiAgICBpZiAoaXNVbmRlZmluZWQoZnVuYykpIHsKICAgICAgcmV0dXJuIGNvbnRhaW5lcltuYW1lXTsKICAgIH0KCiAgICBjb250YWluZXJbbmFtZV0ucHVzaChmdW5jKTsKICB9CiAgLyoqDQogICAqIOS7jumYn+WIl+S4reenu+mZpOesrOS4gOS4quWHveaVsO+8jOW5tuaJp+ihjOivpeWHveaVsA0KICAgKiBAcGFyYW0gbmFtZSDpmJ/liJfmu6ENCiAgICovCgoKICBmdW5jdGlvbiBkZXF1ZXVlKG5hbWUpIHsKICAgIGlmIChpc1VuZGVmaW5lZChjb250YWluZXJbbmFtZV0pKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoIWNvbnRhaW5lcltuYW1lXS5sZW5ndGgpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBmdW5jID0gY29udGFpbmVyW25hbWVdLnNoaWZ0KCk7CiAgICBmdW5jKCk7CiAgfQoKICB2YXIgREVGQVVMVF9PUFRJT05TJDYgPSB7CiAgICBoaXN0b3J5OiB0cnVlLAogICAgb3ZlcmxheTogdHJ1ZSwKICAgIG1vZGFsOiBmYWxzZSwKICAgIGNsb3NlT25Fc2M6IHRydWUsCiAgICBjbG9zZU9uQ2FuY2VsOiB0cnVlLAogICAgY2xvc2VPbkNvbmZpcm06IHRydWUsCiAgICBkZXN0cm95T25DbG9zZWQ6IGZhbHNlCiAgfTsKICAvKioNCiAgICog5b2T5YmN5pi+56S655qE5a+56K+d5qGG5a6e5L6LDQogICAqLwoKICB2YXIgY3VycmVudEluc3QgPSBudWxsOwogIC8qKg0KICAgKiDpmJ/liJflkI0NCiAgICovCgogIHZhciBxdWV1ZU5hbWUgPSAnX21kdWlfZGlhbG9nJzsKICAvKioNCiAgICog56qX5Y+j5piv5ZCm5bey6ZSB5a6aDQogICAqLwoKICB2YXIgaXNMb2NrU2NyZWVuID0gZmFsc2U7CiAgLyoqDQogICAqIOmBrue9qeWxguWFg+e0oA0KICAgKi8KCiAgdmFyICRvdmVybGF5OwoKICB2YXIgRGlhbG9nID0gZnVuY3Rpb24gRGlhbG9nKHNlbGVjdG9yLCBvcHRpb25zKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIG9wdGlvbnMgPSB7fTsKICAgIC8qKg0KICAgICAqIOmFjee9ruWPguaVsA0KICAgICAqLwoKICAgIHRoaXMub3B0aW9ucyA9IGV4dGVuZCh7fSwgREVGQVVMVF9PUFRJT05TJDYpOwogICAgLyoqDQogICAgICog5b2T5YmNIGRpYWxvZyDnmoTnirbmgIENCiAgICAgKi8KCiAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICAvKioNCiAgICAgKiBkaWFsb2cg5YWD57Sg5piv5ZCm5piv5Yqo5oCB5re75Yqg55qEDQogICAgICovCgogICAgdGhpcy5hcHBlbmQgPSBmYWxzZTsKICAgIHRoaXMuJGVsZW1lbnQgPSAkKHNlbGVjdG9yKS5maXJzdCgpOyAvLyDlpoLmnpzlr7nor53moYblhYPntKDmsqHmnInlnKjlvZPliY3mlofmoaPkuK3vvIzliJnpnIDopoHmt7vliqAKCiAgICBpZiAoIWNvbnRhaW5zKGRvY3VtZW50LmJvZHksIHRoaXMuJGVsZW1lbnRbMF0pKSB7CiAgICAgIHRoaXMuYXBwZW5kID0gdHJ1ZTsKICAgICAgJCgnYm9keScpLmFwcGVuZCh0aGlzLiRlbGVtZW50KTsKICAgIH0KCiAgICBleHRlbmQodGhpcy5vcHRpb25zLCBvcHRpb25zKTsgLy8g57uR5a6a5Y+W5raI5oyJ6ZKu5LqL5Lu2CgogICAgdGhpcy4kZWxlbWVudC5maW5kKCdbbWR1aS1kaWFsb2ctY2FuY2VsXScpLmVhY2goZnVuY3Rpb24gKF8sIGNhbmNlbCkgewogICAgICAkKGNhbmNlbCkub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgIHRoaXMkMS50cmlnZ2VyRXZlbnQoJ2NhbmNlbCcpOwoKICAgICAgICBpZiAodGhpcyQxLm9wdGlvbnMuY2xvc2VPbkNhbmNlbCkgewogICAgICAgICAgdGhpcyQxLmNsb3NlKCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOyAvLyDnu5Hlrprnoa7orqTmjInpkq7kuovku7YKCiAgICB0aGlzLiRlbGVtZW50LmZpbmQoJ1ttZHVpLWRpYWxvZy1jb25maXJtXScpLmVhY2goZnVuY3Rpb24gKF8sIGNvbmZpcm0pIHsKICAgICAgJChjb25maXJtKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgdGhpcyQxLnRyaWdnZXJFdmVudCgnY29uZmlybScpOwoKICAgICAgICBpZiAodGhpcyQxLm9wdGlvbnMuY2xvc2VPbkNvbmZpcm0pIHsKICAgICAgICAgIHRoaXMkMS5jbG9zZSgpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9KTsgLy8g57uR5a6a5YWz6Zet5oyJ6ZKu5LqL5Lu2CgogICAgdGhpcy4kZWxlbWVudC5maW5kKCdbbWR1aS1kaWFsb2ctY2xvc2VdJykuZWFjaChmdW5jdGlvbiAoXywgY2xvc2UpIHsKICAgICAgJChjbG9zZSkub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0aGlzJDEuY2xvc2UoKTsKICAgICAgfSk7CiAgICB9KTsKICB9OwogIC8qKg0KICAgKiDop6blj5Hnu4Tku7bkuovku7YNCiAgICogQHBhcmFtIG5hbWUNCiAgICovCgoKICBEaWFsb2cucHJvdG90eXBlLnRyaWdnZXJFdmVudCA9IGZ1bmN0aW9uIHRyaWdnZXJFdmVudChuYW1lKSB7CiAgICBjb21wb25lbnRFdmVudChuYW1lLCAnZGlhbG9nJywgdGhpcy4kZWxlbWVudCwgdGhpcyk7CiAgfTsKICAvKioNCiAgICog56qX5Y+j5a695bqm5Y+Y5YyW77yM5oiW5a+56K+d5qGG5YaF5a655Y+Y5YyW5pe277yM6LCD5pW05a+56K+d5qGG5L2N572u5ZKM5a+56K+d5qGG5YaF55qE5rua5Yqo5p2hDQogICAqLwoKCiAgRGlhbG9nLnByb3RvdHlwZS5yZWFkanVzdCA9IGZ1bmN0aW9uIHJlYWRqdXN0KCkgewogICAgaWYgKCFjdXJyZW50SW5zdCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdmFyICRlbGVtZW50ID0gY3VycmVudEluc3QuJGVsZW1lbnQ7CiAgICB2YXIgJHRpdGxlID0gJGVsZW1lbnQuY2hpbGRyZW4oJy5tZHVpLWRpYWxvZy10aXRsZScpOwogICAgdmFyICRjb250ZW50ID0gJGVsZW1lbnQuY2hpbGRyZW4oJy5tZHVpLWRpYWxvZy1jb250ZW50Jyk7CiAgICB2YXIgJGFjdGlvbnMgPSAkZWxlbWVudC5jaGlsZHJlbignLm1kdWktZGlhbG9nLWFjdGlvbnMnKTsgLy8g6LCD5pW0IGRpYWxvZyDnmoQgdG9wIOWSjCBoZWlnaHQg5YC8CgogICAgJGVsZW1lbnQuaGVpZ2h0KCcnKTsKICAgICRjb250ZW50LmhlaWdodCgnJyk7CiAgICB2YXIgZWxlbWVudEhlaWdodCA9ICRlbGVtZW50LmhlaWdodCgpOwogICAgJGVsZW1lbnQuY3NzKHsKICAgICAgdG9wOiAoJHdpbmRvdy5oZWlnaHQoKSAtIGVsZW1lbnRIZWlnaHQpIC8gMiArICJweCIsCiAgICAgIGhlaWdodDogZWxlbWVudEhlaWdodCArICJweCIKICAgIH0pOyAvLyDosIPmlbQgbWR1aS1kaWFsb2ctY29udGVudCDnmoTpq5jluqYKCiAgICAkY29udGVudC5pbm5lckhlaWdodChlbGVtZW50SGVpZ2h0IC0gKCR0aXRsZS5pbm5lckhlaWdodCgpIHx8IDApIC0gKCRhY3Rpb25zLmlubmVySGVpZ2h0KCkgfHwgMCkpOwogIH07CiAgLyoqDQogICAqIGhhc2hjaGFuZ2Ug5LqL5Lu26Kem5Y+R5pe25YWz6Zet5a+56K+d5qGGDQogICAqLwoKCiAgRGlhbG9nLnByb3RvdHlwZS5oYXNoY2hhbmdlRXZlbnQgPSBmdW5jdGlvbiBoYXNoY2hhbmdlRXZlbnQoKSB7CiAgICBpZiAod2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpLmluZGV4T2YoJ21kdWktZGlhbG9nJykgPCAwKSB7CiAgICAgIGN1cnJlbnRJbnN0LmNsb3NlKHRydWUpOwogICAgfQogIH07CiAgLyoqDQogICAqIOeCueWHu+mBrue9qeWxguWFs+mXreWvueivneahhg0KICAgKiBAcGFyYW0gZXZlbnQNCiAgICovCgoKICBEaWFsb2cucHJvdG90eXBlLm92ZXJsYXlDbGljayA9IGZ1bmN0aW9uIG92ZXJsYXlDbGljayhldmVudCkgewogICAgaWYgKCQoZXZlbnQudGFyZ2V0KS5oYXNDbGFzcygnbWR1aS1vdmVybGF5JykgJiYgY3VycmVudEluc3QpIHsKICAgICAgY3VycmVudEluc3QuY2xvc2UoKTsKICAgIH0KICB9OwogIC8qKg0KICAgKiDliqjnlLvnu5PmnZ/lm57osIMNCiAgICovCgoKICBEaWFsb2cucHJvdG90eXBlLnRyYW5zaXRpb25FbmQgPSBmdW5jdGlvbiB0cmFuc2l0aW9uRW5kKCkgewogICAgaWYgKHRoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ21kdWktZGlhbG9nLW9wZW4nKSkgewogICAgICB0aGlzLnN0YXRlID0gJ29wZW5lZCc7CiAgICAgIHRoaXMudHJpZ2dlckV2ZW50KCdvcGVuZWQnKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuc3RhdGUgPSAnY2xvc2VkJzsKICAgICAgdGhpcy50cmlnZ2VyRXZlbnQoJ2Nsb3NlZCcpOwogICAgICB0aGlzLiRlbGVtZW50LmhpZGUoKTsgLy8g5omA5pyJ5a+56K+d5qGG6YO95YWz6Zet77yM5LiU5b2T5YmN5rKh5pyJ5omT5byA55qE5a+56K+d5qGG5pe277yM6Kej6ZSB5bGP5bmVCgogICAgICBpZiAoIXF1ZXVlKHF1ZXVlTmFtZSkubGVuZ3RoICYmICFjdXJyZW50SW5zdCAmJiBpc0xvY2tTY3JlZW4pIHsKICAgICAgICAkLnVubG9ja1NjcmVlbigpOwogICAgICAgIGlzTG9ja1NjcmVlbiA9IGZhbHNlOwogICAgICB9CgogICAgICAkd2luZG93Lm9mZigncmVzaXplJywgJC50aHJvdHRsZSh0aGlzLnJlYWRqdXN0LCAxMDApKTsKCiAgICAgIGlmICh0aGlzLm9wdGlvbnMuZGVzdHJveU9uQ2xvc2VkKSB7CiAgICAgICAgdGhpcy5kZXN0cm95KCk7CiAgICAgIH0KICAgIH0KICB9OwogIC8qKg0KICAgKiDmiZPlvIDmjIflrprlr7nor53moYYNCiAgICovCgoKICBEaWFsb2cucHJvdG90eXBlLmRvT3BlbiA9IGZ1bmN0aW9uIGRvT3BlbigpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgY3VycmVudEluc3QgPSB0aGlzOwoKICAgIGlmICghaXNMb2NrU2NyZWVuKSB7CiAgICAgICQubG9ja1NjcmVlbigpOwogICAgICBpc0xvY2tTY3JlZW4gPSB0cnVlOwogICAgfQoKICAgIHRoaXMuJGVsZW1lbnQuc2hvdygpOwogICAgdGhpcy5yZWFkanVzdCgpOwogICAgJHdpbmRvdy5vbigncmVzaXplJywgJC50aHJvdHRsZSh0aGlzLnJlYWRqdXN0LCAxMDApKTsgLy8g5omT5byA5raI5oGv5qGGCgogICAgdGhpcy5zdGF0ZSA9ICdvcGVuaW5nJzsKICAgIHRoaXMudHJpZ2dlckV2ZW50KCdvcGVuJyk7CiAgICB0aGlzLiRlbGVtZW50LmFkZENsYXNzKCdtZHVpLWRpYWxvZy1vcGVuJykudHJhbnNpdGlvbkVuZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzJDEudHJhbnNpdGlvbkVuZCgpOwogICAgfSk7IC8vIOS4jeWtmOWcqOmBrue9qeWxguWFg+e0oOaXtu+8jOa3u+WKoOmBrue9qeWxggoKICAgIGlmICghJG92ZXJsYXkpIHsKICAgICAgJG92ZXJsYXkgPSAkLnNob3dPdmVybGF5KDUxMDApOwogICAgfSAvLyDngrnlh7vpga7nvanlsYLml7bmmK/lkKblhbPpl63lr7nor53moYYKCgogICAgaWYgKHRoaXMub3B0aW9ucy5tb2RhbCkgewogICAgICAkb3ZlcmxheS5vZmYoJ2NsaWNrJywgdGhpcy5vdmVybGF5Q2xpY2spOwogICAgfSBlbHNlIHsKICAgICAgJG92ZXJsYXkub24oJ2NsaWNrJywgdGhpcy5vdmVybGF5Q2xpY2spOwogICAgfSAvLyDmmK/lkKbmmL7npLrpga7nvanlsYLvvIzkuI3mmL7npLrml7bvvIzmiorpga7nvanlsYLog4zmma/pgI/mmI4KCgogICAgJG92ZXJsYXkuY3NzKCdvcGFjaXR5JywgdGhpcy5vcHRpb25zLm92ZXJsYXkgPyAnJyA6IDApOwoKICAgIGlmICh0aGlzLm9wdGlvbnMuaGlzdG9yeSkgewogICAgICAvLyDlpoLmnpwgaGFzaCDkuK3ljp/mnaXlsLHmnIkgbWR1aS1kaWFsb2fvvIzlhYjliKDpmaTvvIzpgb/lhY3lkI7pgIDljoblj7LnuqrlvZXlkI7ku43nhLbmnIkgbWR1aS1kaWFsb2cg5a+86Ie05peg5rOV5YWz6ZetCiAgICAgIC8vIOWMheaLrCBtZHVpLWRpYWxvZyDlkowgJm1kdWktZGlhbG9nIOWSjCA/bWR1aS1kaWFsb2cKICAgICAgdmFyIGhhc2ggPSB3aW5kb3cubG9jYXRpb24uaGFzaC5zdWJzdHJpbmcoMSk7CgogICAgICBpZiAoaGFzaC5pbmRleE9mKCdtZHVpLWRpYWxvZycpID4gLTEpIHsKICAgICAgICBoYXNoID0gaGFzaC5yZXBsYWNlKC9bJj9dP21kdWktZGlhbG9nL2csICcnKTsKICAgICAgfSAvLyDlkI7pgIDmjInpkq7lhbPpl63lr7nor53moYYKCgogICAgICBpZiAoaGFzaCkgewogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gIiIgKyBoYXNoICsgKGhhc2guaW5kZXhPZignPycpID4gLTEgPyAnJicgOiAnPycpICsgIm1kdWktZGlhbG9nIjsKICAgICAgfSBlbHNlIHsKICAgICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9ICdtZHVpLWRpYWxvZyc7CiAgICAgIH0KCiAgICAgICR3aW5kb3cub24oJ2hhc2hjaGFuZ2UnLCB0aGlzLmhhc2hjaGFuZ2VFdmVudCk7CiAgICB9CiAgfTsKICAvKioNCiAgICog5b2T5YmN5a+56K+d5qGG5piv5ZCm5Li65omT5byA54q25oCBDQogICAqLwoKCiAgRGlhbG9nLnByb3RvdHlwZS5pc09wZW4gPSBmdW5jdGlvbiBpc09wZW4oKSB7CiAgICByZXR1cm4gdGhpcy5zdGF0ZSA9PT0gJ29wZW5pbmcnIHx8IHRoaXMuc3RhdGUgPT09ICdvcGVuZWQnOwogIH07CiAgLyoqDQogICAqIOaJk+W8gOWvueivneahhg0KICAgKi8KCgogIERpYWxvZy5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uIG9wZW4oKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKCiAgICBpZiAodGhpcy5pc09wZW4oKSkgewogICAgICByZXR1cm47CiAgICB9IC8vIOWmguaenOW9k+WJjeacieato+WcqOaJk+W8gOaIluW3sue7j+aJk+W8gOeahOWvueivneahhizmiJbpmJ/liJfkuI3kuLrnqbrvvIzliJnlhYjliqDlhaXpmJ/liJfvvIznrYnml6flr7nor53moYblvIDlp4vlhbPpl63ml7blho3miZPlvIAKCgogICAgaWYgKGN1cnJlbnRJbnN0ICYmIChjdXJyZW50SW5zdC5zdGF0ZSA9PT0gJ29wZW5pbmcnIHx8IGN1cnJlbnRJbnN0LnN0YXRlID09PSAnb3BlbmVkJykgfHwgcXVldWUocXVldWVOYW1lKS5sZW5ndGgpIHsKICAgICAgcXVldWUocXVldWVOYW1lLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMkMS5kb09wZW4oKTsKICAgICAgfSk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLmRvT3BlbigpOwogIH07CiAgLyoqDQogICAqIOWFs+mXreWvueivneahhg0KICAgKi8KCgogIERpYWxvZy5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiBjbG9zZShoaXN0b3J5QmFjaykgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CiAgICBpZiAoaGlzdG9yeUJhY2sgPT09IHZvaWQgMCkgaGlzdG9yeUJhY2sgPSBmYWxzZTsgLy8gaGlzdG9yeUJhY2sg5piv5ZCm6ZyA6KaB5ZCO6YCA5Y6G5Y+y57qq5b2V77yM6buY6K6k5Li6IGBmYWxzZWDjgILor6Xlj4LmlbDku4XlhoXpg6jkvb/nlKgKICAgIC8vIOS4uiBgZmFsc2VgIOaXtuaYr+mAmui/hyBqcyDlhbPpl63vvIzpnIDopoHlkI7pgIDkuIDkuKrljoblj7LorrDlvZUKICAgIC8vIOS4uiBgdHJ1ZWAg5pe25piv6YCa6L+H5ZCO6YCA5oyJ6ZKu5YWz6Zet77yM5LiN6ZyA6KaB5ZCO6YCA5Y6G5Y+y6K6w5b2VCiAgICAvLyBzZXRUaW1lb3V0IOeahOS9nOeUqOaYr++8mgogICAgLy8g5b2T5ZCM5pe25YWz6Zet5LiA5Liq5a+56K+d5qGG77yM5bm25omT5byA5Y+m5LiA5Liq5a+56K+d5qGG5pe277yM5L2/5omT5byA5a+56K+d5qGG55qE5pON5L2c5YWI5omn6KGM77yM5Lul5L2/6ZyA6KaB5omT5byA55qE5a+56K+d5qGG5YWI5Yqg5YWl6Zif5YiXCgogICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghdGhpcyQxLmlzT3BlbigpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjdXJyZW50SW5zdCA9IG51bGw7CiAgICAgIHRoaXMkMS5zdGF0ZSA9ICdjbG9zaW5nJzsKICAgICAgdGhpcyQxLnRyaWdnZXJFdmVudCgnY2xvc2UnKTsgLy8g5omA5pyJ5a+56K+d5qGG6YO95YWz6Zet77yM5LiU5b2T5YmN5rKh5pyJ5omT5byA55qE5a+56K+d5qGG5pe277yM6ZqQ6JeP6YGu572pCgogICAgICBpZiAoIXF1ZXVlKHF1ZXVlTmFtZSkubGVuZ3RoICYmICRvdmVybGF5KSB7CiAgICAgICAgJC5oaWRlT3ZlcmxheSgpOwogICAgICAgICRvdmVybGF5ID0gbnVsbDsgLy8g6Iul5LuN5a2Y5Zyo6YGu572p77yM5oGi5aSN6YGu572p55qEIHotaW5kZXgKCiAgICAgICAgJCgnLm1kdWktb3ZlcmxheScpLmNzcygnei1pbmRleCcsIDIwMDApOwogICAgICB9CgogICAgICB0aGlzJDEuJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kdWktZGlhbG9nLW9wZW4nKS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpcyQxLnRyYW5zaXRpb25FbmQoKTsKICAgICAgfSk7CgogICAgICBpZiAodGhpcyQxLm9wdGlvbnMuaGlzdG9yeSAmJiAhcXVldWUocXVldWVOYW1lKS5sZW5ndGgpIHsKICAgICAgICBpZiAoIWhpc3RvcnlCYWNrKSB7CiAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5iYWNrKCk7CiAgICAgICAgfQoKICAgICAgICAkd2luZG93Lm9mZignaGFzaGNoYW5nZScsIHRoaXMkMS5oYXNoY2hhbmdlRXZlbnQpOwogICAgICB9IC8vIOWFs+mXreaXp+Wvueivneahhu+8jOaJk+W8gOaWsOWvueivneahhuOAggogICAgICAvLyDliqDkuIDngrnlu7bov5/vvIzku4Xku4XkuLrkuobop4bop4nmlYjmnpzmm7Tlpb3jgILkuI3liqDlu7bml7bkuZ/kuI3lvbHlk43lip/og70KCgogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBkZXF1ZXVlKHF1ZXVlTmFtZSk7CiAgICAgIH0sIDEwMCk7CiAgICB9KTsKICB9OwogIC8qKg0KICAgKiDliIfmjaLlr7nor53moYbmiZPlvIAv5YWz6Zet54q25oCBDQogICAqLwoKCiAgRGlhbG9nLnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbiB0b2dnbGUoKSB7CiAgICB0aGlzLmlzT3BlbigpID8gdGhpcy5jbG9zZSgpIDogdGhpcy5vcGVuKCk7CiAgfTsKICAvKioNCiAgICog6I635Y+W5a+56K+d5qGG54q25oCB44CC5YWx5YyF5ZCr5Zub56eN54q25oCB77yaYG9wZW5pbmdg44CBYG9wZW5lZGDjgIFgY2xvc2luZ2DjgIFgY2xvc2VkYA0KICAgKi8KCgogIERpYWxvZy5wcm90b3R5cGUuZ2V0U3RhdGUgPSBmdW5jdGlvbiBnZXRTdGF0ZSgpIHsKICAgIHJldHVybiB0aGlzLnN0YXRlOwogIH07CiAgLyoqDQogICAqIOmUgOavgeWvueivneahhg0KICAgKi8KCgogIERpYWxvZy5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uIGRlc3Ryb3koKSB7CiAgICBpZiAodGhpcy5hcHBlbmQpIHsKICAgICAgdGhpcy4kZWxlbWVudC5yZW1vdmUoKTsKICAgIH0KCiAgICBpZiAoIXF1ZXVlKHF1ZXVlTmFtZSkubGVuZ3RoICYmICFjdXJyZW50SW5zdCkgewogICAgICBpZiAoJG92ZXJsYXkpIHsKICAgICAgICAkLmhpZGVPdmVybGF5KCk7CiAgICAgICAgJG92ZXJsYXkgPSBudWxsOwogICAgICB9CgogICAgICBpZiAoaXNMb2NrU2NyZWVuKSB7CiAgICAgICAgJC51bmxvY2tTY3JlZW4oKTsKICAgICAgICBpc0xvY2tTY3JlZW4gPSBmYWxzZTsKICAgICAgfQogICAgfQogIH07CiAgLyoqDQogICAqIOWvueivneahhuWGheWuueWPmOWMluaXtu+8jOmcgOimgeiwg+eUqOivpeaWueazleadpeiwg+aVtOWvueivneahhuS9jee9ruWSjOa7muWKqOadoemrmOW6pg0KICAgKi8KCgogIERpYWxvZy5wcm90b3R5cGUuaGFuZGxlVXBkYXRlID0gZnVuY3Rpb24gaGFuZGxlVXBkYXRlKCkgewogICAgdGhpcy5yZWFkanVzdCgpOwogIH07IC8vIGVzYyDmjInkuIvml7blhbPpl63lr7nor53moYYKCgogICRkb2N1bWVudC5vbigna2V5ZG93bicsIGZ1bmN0aW9uIChldmVudCkgewogICAgaWYgKGN1cnJlbnRJbnN0ICYmIGN1cnJlbnRJbnN0Lm9wdGlvbnMuY2xvc2VPbkVzYyAmJiBjdXJyZW50SW5zdC5zdGF0ZSA9PT0gJ29wZW5lZCcgJiYgZXZlbnQua2V5Q29kZSA9PT0gMjcpIHsKICAgICAgY3VycmVudEluc3QuY2xvc2UoKTsKICAgIH0KICB9KTsKICBtZHVpLkRpYWxvZyA9IERpYWxvZzsKICB2YXIgY3VzdG9tQXR0ciQ3ID0gJ21kdWktZGlhbG9nJzsKICB2YXIgZGF0YU5hbWUkMSA9ICdfbWR1aV9kaWFsb2cnOwogICQoZnVuY3Rpb24gKCkgewogICAgJGRvY3VtZW50Lm9uKCdjbGljaycsICJbIiArIGN1c3RvbUF0dHIkNyArICJdIiwgZnVuY3Rpb24gKCkgewogICAgICB2YXIgb3B0aW9ucyA9IHBhcnNlT3B0aW9ucyh0aGlzLCBjdXN0b21BdHRyJDcpOwogICAgICB2YXIgc2VsZWN0b3IgPSBvcHRpb25zLnRhcmdldDsgLy8gQHRzLWlnbm9yZQoKICAgICAgZGVsZXRlIG9wdGlvbnMudGFyZ2V0OwogICAgICB2YXIgJGRpYWxvZyA9ICQoc2VsZWN0b3IpLmZpcnN0KCk7CiAgICAgIHZhciBpbnN0YW5jZSA9ICRkaWFsb2cuZGF0YShkYXRhTmFtZSQxKTsKCiAgICAgIGlmICghaW5zdGFuY2UpIHsKICAgICAgICBpbnN0YW5jZSA9IG5ldyBtZHVpLkRpYWxvZygkZGlhbG9nLCBvcHRpb25zKTsKICAgICAgICAkZGlhbG9nLmRhdGEoZGF0YU5hbWUkMSwgaW5zdGFuY2UpOwogICAgICB9CgogICAgICBpbnN0YW5jZS5vcGVuKCk7CiAgICB9KTsKICB9KTsKICB2YXIgREVGQVVMVF9CVVRUT04gPSB7CiAgICB0ZXh0OiAnJywKICAgIGJvbGQ6IGZhbHNlLAogICAgY2xvc2U6IHRydWUsCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uCiAgICBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7fQogIH07CiAgdmFyIERFRkFVTFRfT1BUSU9OUyQ3ID0gewogICAgdGl0bGU6ICcnLAogICAgY29udGVudDogJycsCiAgICBidXR0b25zOiBbXSwKICAgIHN0YWNrZWRCdXR0b25zOiBmYWxzZSwKICAgIGNzc0NsYXNzOiAnJywKICAgIGhpc3Rvcnk6IHRydWUsCiAgICBvdmVybGF5OiB0cnVlLAogICAgbW9kYWw6IGZhbHNlLAogICAgY2xvc2VPbkVzYzogdHJ1ZSwKICAgIGRlc3Ryb3lPbkNsb3NlZDogdHJ1ZSwKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb24KICAgIG9uT3BlbjogZnVuY3Rpb24gKCkge30sCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uCiAgICBvbk9wZW5lZDogZnVuY3Rpb24gKCkge30sCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uCiAgICBvbkNsb3NlOiBmdW5jdGlvbiAoKSB7fSwKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb24KICAgIG9uQ2xvc2VkOiBmdW5jdGlvbiAoKSB7fQogIH07CgogIG1kdWkuZGlhbG9nID0gZnVuY3Rpb24gKG9wdGlvbnMpIHsKICAgIHZhciBfYSwgX2I7IC8vIOWQiOW5tumFjee9ruWPguaVsAoKCiAgICBvcHRpb25zID0gZXh0ZW5kKHt9LCBERUZBVUxUX09QVElPTlMkNywgb3B0aW9ucyk7CiAgICBlYWNoKG9wdGlvbnMuYnV0dG9ucywgZnVuY3Rpb24gKGksIGJ1dHRvbikgewogICAgICBvcHRpb25zLmJ1dHRvbnNbaV0gPSBleHRlbmQoe30sIERFRkFVTFRfQlVUVE9OLCBidXR0b24pOwogICAgfSk7IC8vIOaMiemSrueahCBIVE1MCgogICAgdmFyIGJ1dHRvbnNIVE1MID0gJyc7CgogICAgaWYgKChfYSA9IG9wdGlvbnMuYnV0dG9ucykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmxlbmd0aCkgewogICAgICBidXR0b25zSFRNTCA9ICI8ZGl2IGNsYXNzPVwibWR1aS1kaWFsb2ctYWN0aW9ucyIgKyAob3B0aW9ucy5zdGFja2VkQnV0dG9ucyA/ICcgbWR1aS1kaWFsb2ctYWN0aW9ucy1zdGFja2VkJyA6ICcnKSArICJcIj4iOwogICAgICBlYWNoKG9wdGlvbnMuYnV0dG9ucywgZnVuY3Rpb24gKF8sIGJ1dHRvbikgewogICAgICAgIGJ1dHRvbnNIVE1MICs9ICc8YSBocmVmPSJqYXZhc2NyaXB0OnZvaWQoMCkiICcgKyAiY2xhc3M9XCJtZHVpLWJ0biBtZHVpLXJpcHBsZSBtZHVpLXRleHQtY29sb3ItcHJpbWFyeSAiICsgKGJ1dHRvbi5ib2xkID8gJ21kdWktYnRuLWJvbGQnIDogJycpICsgIlwiPiIgKyBidXR0b24udGV4dCArICI8L2E+IjsKICAgICAgfSk7CiAgICAgIGJ1dHRvbnNIVE1MICs9ICc8L2Rpdj4nOwogICAgfSAvLyBEaWFsb2cg55qEIEhUTUwKCgogICAgdmFyIEhUTUwgPSAiPGRpdiBjbGFzcz1cIm1kdWktZGlhbG9nICIgKyBvcHRpb25zLmNzc0NsYXNzICsgIlwiPiIgKyAob3B0aW9ucy50aXRsZSA/ICI8ZGl2IGNsYXNzPVwibWR1aS1kaWFsb2ctdGl0bGVcIj4iICsgb3B0aW9ucy50aXRsZSArICI8L2Rpdj4iIDogJycpICsgKG9wdGlvbnMuY29udGVudCA/ICI8ZGl2IGNsYXNzPVwibWR1aS1kaWFsb2ctY29udGVudFwiPiIgKyBvcHRpb25zLmNvbnRlbnQgKyAiPC9kaXY+IiA6ICcnKSArIGJ1dHRvbnNIVE1MICsgJzwvZGl2Pic7IC8vIOWunuS+i+WMliBEaWFsb2cKCiAgICB2YXIgaW5zdGFuY2UgPSBuZXcgbWR1aS5EaWFsb2coSFRNTCwgewogICAgICBoaXN0b3J5OiBvcHRpb25zLmhpc3RvcnksCiAgICAgIG92ZXJsYXk6IG9wdGlvbnMub3ZlcmxheSwKICAgICAgbW9kYWw6IG9wdGlvbnMubW9kYWwsCiAgICAgIGNsb3NlT25Fc2M6IG9wdGlvbnMuY2xvc2VPbkVzYywKICAgICAgZGVzdHJveU9uQ2xvc2VkOiBvcHRpb25zLmRlc3Ryb3lPbkNsb3NlZAogICAgfSk7IC8vIOe7keWumuaMiemSruS6i+S7tgoKICAgIGlmICgoX2IgPSBvcHRpb25zLmJ1dHRvbnMpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5sZW5ndGgpIHsKICAgICAgaW5zdGFuY2UuJGVsZW1lbnQuZmluZCgnLm1kdWktZGlhbG9nLWFjdGlvbnMgLm1kdWktYnRuJykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGJ1dHRvbikgewogICAgICAgICQoYnV0dG9uKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBvcHRpb25zLmJ1dHRvbnNbaW5kZXhdLm9uQ2xpY2soaW5zdGFuY2UpOwoKICAgICAgICAgIGlmIChvcHRpb25zLmJ1dHRvbnNbaW5kZXhdLmNsb3NlKSB7CiAgICAgICAgICAgIGluc3RhbmNlLmNsb3NlKCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSAvLyDnu5HlrprmiZPlvIDlhbPpl63kuovku7YKCgogICAgaW5zdGFuY2UuJGVsZW1lbnQub24oJ29wZW4ubWR1aS5kaWFsb2cnLCBmdW5jdGlvbiAoKSB7CiAgICAgIG9wdGlvbnMub25PcGVuKGluc3RhbmNlKTsKICAgIH0pLm9uKCdvcGVuZWQubWR1aS5kaWFsb2cnLCBmdW5jdGlvbiAoKSB7CiAgICAgIG9wdGlvbnMub25PcGVuZWQoaW5zdGFuY2UpOwogICAgfSkub24oJ2Nsb3NlLm1kdWkuZGlhbG9nJywgZnVuY3Rpb24gKCkgewogICAgICBvcHRpb25zLm9uQ2xvc2UoaW5zdGFuY2UpOwogICAgfSkub24oJ2Nsb3NlZC5tZHVpLmRpYWxvZycsIGZ1bmN0aW9uICgpIHsKICAgICAgb3B0aW9ucy5vbkNsb3NlZChpbnN0YW5jZSk7CiAgICB9KTsKICAgIGluc3RhbmNlLm9wZW4oKTsKICAgIHJldHVybiBpbnN0YW5jZTsKICB9OwoKICB2YXIgREVGQVVMVF9PUFRJT05TJDggPSB7CiAgICBjb25maXJtVGV4dDogJ29rJywKICAgIGhpc3Rvcnk6IHRydWUsCiAgICBtb2RhbDogZmFsc2UsCiAgICBjbG9zZU9uRXNjOiB0cnVlLAogICAgY2xvc2VPbkNvbmZpcm06IHRydWUKICB9OwoKICBtZHVpLmFsZXJ0ID0gZnVuY3Rpb24gKHRleHQsIHRpdGxlLCBvbkNvbmZpcm0sIG9wdGlvbnMpIHsKICAgIGlmIChpc0Z1bmN0aW9uKHRpdGxlKSkgewogICAgICBvcHRpb25zID0gb25Db25maXJtOwogICAgICBvbkNvbmZpcm0gPSB0aXRsZTsKICAgICAgdGl0bGUgPSAnJzsKICAgIH0KCiAgICBpZiAoaXNVbmRlZmluZWQob25Db25maXJtKSkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uCiAgICAgIG9uQ29uZmlybSA9IGZ1bmN0aW9uICgpIHt9OwogICAgfQoKICAgIGlmIChpc1VuZGVmaW5lZChvcHRpb25zKSkgewogICAgICBvcHRpb25zID0ge307CiAgICB9CgogICAgb3B0aW9ucyA9IGV4dGVuZCh7fSwgREVGQVVMVF9PUFRJT05TJDgsIG9wdGlvbnMpOwogICAgcmV0dXJuIG1kdWkuZGlhbG9nKHsKICAgICAgdGl0bGU6IHRpdGxlLAogICAgICBjb250ZW50OiB0ZXh0LAogICAgICBidXR0b25zOiBbewogICAgICAgIHRleHQ6IG9wdGlvbnMuY29uZmlybVRleHQsCiAgICAgICAgYm9sZDogZmFsc2UsCiAgICAgICAgY2xvc2U6IG9wdGlvbnMuY2xvc2VPbkNvbmZpcm0sCiAgICAgICAgb25DbGljazogb25Db25maXJtCiAgICAgIH1dLAogICAgICBjc3NDbGFzczogJ21kdWktZGlhbG9nLWFsZXJ0JywKICAgICAgaGlzdG9yeTogb3B0aW9ucy5oaXN0b3J5LAogICAgICBtb2RhbDogb3B0aW9ucy5tb2RhbCwKICAgICAgY2xvc2VPbkVzYzogb3B0aW9ucy5jbG9zZU9uRXNjCiAgICB9KTsKICB9OwoKICB2YXIgREVGQVVMVF9PUFRJT05TJDkgPSB7CiAgICBjb25maXJtVGV4dDogJ29rJywKICAgIGNhbmNlbFRleHQ6ICdjYW5jZWwnLAogICAgaGlzdG9yeTogdHJ1ZSwKICAgIG1vZGFsOiBmYWxzZSwKICAgIGNsb3NlT25Fc2M6IHRydWUsCiAgICBjbG9zZU9uQ2FuY2VsOiB0cnVlLAogICAgY2xvc2VPbkNvbmZpcm06IHRydWUKICB9OwoKICBtZHVpLmNvbmZpcm0gPSBmdW5jdGlvbiAodGV4dCwgdGl0bGUsIG9uQ29uZmlybSwgb25DYW5jZWwsIG9wdGlvbnMpIHsKICAgIGlmIChpc0Z1bmN0aW9uKHRpdGxlKSkgewogICAgICBvcHRpb25zID0gb25DYW5jZWw7CiAgICAgIG9uQ2FuY2VsID0gb25Db25maXJtOwogICAgICBvbkNvbmZpcm0gPSB0aXRsZTsKICAgICAgdGl0bGUgPSAnJzsKICAgIH0KCiAgICBpZiAoaXNVbmRlZmluZWQob25Db25maXJtKSkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uCiAgICAgIG9uQ29uZmlybSA9IGZ1bmN0aW9uICgpIHt9OwogICAgfQoKICAgIGlmIChpc1VuZGVmaW5lZChvbkNhbmNlbCkpIHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvbgogICAgICBvbkNhbmNlbCA9IGZ1bmN0aW9uICgpIHt9OwogICAgfQoKICAgIGlmIChpc1VuZGVmaW5lZChvcHRpb25zKSkgewogICAgICBvcHRpb25zID0ge307CiAgICB9CgogICAgb3B0aW9ucyA9IGV4dGVuZCh7fSwgREVGQVVMVF9PUFRJT05TJDksIG9wdGlvbnMpOwogICAgcmV0dXJuIG1kdWkuZGlhbG9nKHsKICAgICAgdGl0bGU6IHRpdGxlLAogICAgICBjb250ZW50OiB0ZXh0LAogICAgICBidXR0b25zOiBbewogICAgICAgIHRleHQ6IG9wdGlvbnMuY2FuY2VsVGV4dCwKICAgICAgICBib2xkOiBmYWxzZSwKICAgICAgICBjbG9zZTogb3B0aW9ucy5jbG9zZU9uQ2FuY2VsLAogICAgICAgIG9uQ2xpY2s6IG9uQ2FuY2VsCiAgICAgIH0sIHsKICAgICAgICB0ZXh0OiBvcHRpb25zLmNvbmZpcm1UZXh0LAogICAgICAgIGJvbGQ6IGZhbHNlLAogICAgICAgIGNsb3NlOiBvcHRpb25zLmNsb3NlT25Db25maXJtLAogICAgICAgIG9uQ2xpY2s6IG9uQ29uZmlybQogICAgICB9XSwKICAgICAgY3NzQ2xhc3M6ICdtZHVpLWRpYWxvZy1jb25maXJtJywKICAgICAgaGlzdG9yeTogb3B0aW9ucy5oaXN0b3J5LAogICAgICBtb2RhbDogb3B0aW9ucy5tb2RhbCwKICAgICAgY2xvc2VPbkVzYzogb3B0aW9ucy5jbG9zZU9uRXNjCiAgICB9KTsKICB9OwoKICB2YXIgREVGQVVMVF9PUFRJT05TJGEgPSB7CiAgICBjb25maXJtVGV4dDogJ29rJywKICAgIGNhbmNlbFRleHQ6ICdjYW5jZWwnLAogICAgaGlzdG9yeTogdHJ1ZSwKICAgIG1vZGFsOiBmYWxzZSwKICAgIGNsb3NlT25Fc2M6IHRydWUsCiAgICBjbG9zZU9uQ2FuY2VsOiB0cnVlLAogICAgY2xvc2VPbkNvbmZpcm06IHRydWUsCiAgICB0eXBlOiAndGV4dCcsCiAgICBtYXhsZW5ndGg6IDAsCiAgICBkZWZhdWx0VmFsdWU6ICcnLAogICAgY29uZmlybU9uRW50ZXI6IGZhbHNlCiAgfTsKCiAgbWR1aS5wcm9tcHQgPSBmdW5jdGlvbiAobGFiZWwsIHRpdGxlLCBvbkNvbmZpcm0sIG9uQ2FuY2VsLCBvcHRpb25zKSB7CiAgICBpZiAoaXNGdW5jdGlvbih0aXRsZSkpIHsKICAgICAgb3B0aW9ucyA9IG9uQ2FuY2VsOwogICAgICBvbkNhbmNlbCA9IG9uQ29uZmlybTsKICAgICAgb25Db25maXJtID0gdGl0bGU7CiAgICAgIHRpdGxlID0gJyc7CiAgICB9CgogICAgaWYgKGlzVW5kZWZpbmVkKG9uQ29uZmlybSkpIHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvbgogICAgICBvbkNvbmZpcm0gPSBmdW5jdGlvbiAoKSB7fTsKICAgIH0KCiAgICBpZiAoaXNVbmRlZmluZWQob25DYW5jZWwpKSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb24KICAgICAgb25DYW5jZWwgPSBmdW5jdGlvbiAoKSB7fTsKICAgIH0KCiAgICBpZiAoaXNVbmRlZmluZWQob3B0aW9ucykpIHsKICAgICAgb3B0aW9ucyA9IHt9OwogICAgfQoKICAgIG9wdGlvbnMgPSBleHRlbmQoe30sIERFRkFVTFRfT1BUSU9OUyRhLCBvcHRpb25zKTsKICAgIHZhciBjb250ZW50ID0gJzxkaXYgY2xhc3M9Im1kdWktdGV4dGZpZWxkIj4nICsgKGxhYmVsID8gIjxsYWJlbCBjbGFzcz1cIm1kdWktdGV4dGZpZWxkLWxhYmVsXCI+IiArIGxhYmVsICsgIjwvbGFiZWw+IiA6ICcnKSArIChvcHRpb25zLnR5cGUgPT09ICd0ZXh0JyA/ICI8aW5wdXQgY2xhc3M9XCJtZHVpLXRleHRmaWVsZC1pbnB1dFwiIHR5cGU9XCJ0ZXh0XCIgdmFsdWU9XCIiICsgb3B0aW9ucy5kZWZhdWx0VmFsdWUgKyAiXCIgIiArIChvcHRpb25zLm1heGxlbmd0aCA/ICdtYXhsZW5ndGg9IicgKyBvcHRpb25zLm1heGxlbmd0aCArICciJyA6ICcnKSArICIvPiIgOiAnJykgKyAob3B0aW9ucy50eXBlID09PSAndGV4dGFyZWEnID8gIjx0ZXh0YXJlYSBjbGFzcz1cIm1kdWktdGV4dGZpZWxkLWlucHV0XCIgIiArIChvcHRpb25zLm1heGxlbmd0aCA/ICdtYXhsZW5ndGg9IicgKyBvcHRpb25zLm1heGxlbmd0aCArICciJyA6ICcnKSArICI+IiArIG9wdGlvbnMuZGVmYXVsdFZhbHVlICsgIjwvdGV4dGFyZWE+IiA6ICcnKSArICc8L2Rpdj4nOwoKICAgIHZhciBvbkNhbmNlbENsaWNrID0gZnVuY3Rpb24gKGRpYWxvZykgewogICAgICB2YXIgdmFsdWUgPSBkaWFsb2cuJGVsZW1lbnQuZmluZCgnLm1kdWktdGV4dGZpZWxkLWlucHV0JykudmFsKCk7CiAgICAgIG9uQ2FuY2VsKHZhbHVlLCBkaWFsb2cpOwogICAgfTsKCiAgICB2YXIgb25Db25maXJtQ2xpY2sgPSBmdW5jdGlvbiAoZGlhbG9nKSB7CiAgICAgIHZhciB2YWx1ZSA9IGRpYWxvZy4kZWxlbWVudC5maW5kKCcubWR1aS10ZXh0ZmllbGQtaW5wdXQnKS52YWwoKTsKICAgICAgb25Db25maXJtKHZhbHVlLCBkaWFsb2cpOwogICAgfTsKCiAgICByZXR1cm4gbWR1aS5kaWFsb2coewogICAgICB0aXRsZTogdGl0bGUsCiAgICAgIGNvbnRlbnQ6IGNvbnRlbnQsCiAgICAgIGJ1dHRvbnM6IFt7CiAgICAgICAgdGV4dDogb3B0aW9ucy5jYW5jZWxUZXh0LAogICAgICAgIGJvbGQ6IGZhbHNlLAogICAgICAgIGNsb3NlOiBvcHRpb25zLmNsb3NlT25DYW5jZWwsCiAgICAgICAgb25DbGljazogb25DYW5jZWxDbGljawogICAgICB9LCB7CiAgICAgICAgdGV4dDogb3B0aW9ucy5jb25maXJtVGV4dCwKICAgICAgICBib2xkOiBmYWxzZSwKICAgICAgICBjbG9zZTogb3B0aW9ucy5jbG9zZU9uQ29uZmlybSwKICAgICAgICBvbkNsaWNrOiBvbkNvbmZpcm1DbGljawogICAgICB9XSwKICAgICAgY3NzQ2xhc3M6ICdtZHVpLWRpYWxvZy1wcm9tcHQnLAogICAgICBoaXN0b3J5OiBvcHRpb25zLmhpc3RvcnksCiAgICAgIG1vZGFsOiBvcHRpb25zLm1vZGFsLAogICAgICBjbG9zZU9uRXNjOiBvcHRpb25zLmNsb3NlT25Fc2MsCiAgICAgIG9uT3BlbjogZnVuY3Rpb24gKGRpYWxvZykgewogICAgICAgIC8vIOWIneWni+WMlui+k+WFpeahhgogICAgICAgIHZhciAkaW5wdXQgPSBkaWFsb2cuJGVsZW1lbnQuZmluZCgnLm1kdWktdGV4dGZpZWxkLWlucHV0Jyk7CiAgICAgICAgbWR1aS51cGRhdGVUZXh0RmllbGRzKCRpbnB1dCk7IC8vIOiBmueEpuWIsOi+k+WFpeahhgoKICAgICAgICAkaW5wdXRbMF0uZm9jdXMoKTsgLy8g5o2V5o2J5paH5pys5qGG5Zue6L2m6ZSu77yM5Zyo5Y2V6KGM5paH5pys5qGG55qE5oOF5Ya15LiL6Kem5Y+R5Zue6LCDCgogICAgICAgIGlmIChvcHRpb25zLnR5cGUgIT09ICd0ZXh0YXJlYScgJiYgb3B0aW9ucy5jb25maXJtT25FbnRlciA9PT0gdHJ1ZSkgewogICAgICAgICAgJGlucHV0Lm9uKCdrZXlkb3duJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgIGlmIChldmVudC5rZXlDb2RlID09PSAxMykgewogICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGRpYWxvZy4kZWxlbWVudC5maW5kKCcubWR1aS10ZXh0ZmllbGQtaW5wdXQnKS52YWwoKTsKICAgICAgICAgICAgICBvbkNvbmZpcm0odmFsdWUsIGRpYWxvZyk7CgogICAgICAgICAgICAgIGlmIChvcHRpb25zLmNsb3NlT25Db25maXJtKSB7CiAgICAgICAgICAgICAgICBkaWFsb2cuY2xvc2UoKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfSk7CiAgICAgICAgfSAvLyDlpoLmnpzmmK/lpJrooYzovpPlhaXmoYbvvIznm5HlkKzovpPlhaXmoYbnmoQgaW5wdXQg5LqL5Lu277yM5pu05paw5a+56K+d5qGG6auY5bqmCgoKICAgICAgICBpZiAob3B0aW9ucy50eXBlID09PSAndGV4dGFyZWEnKSB7CiAgICAgICAgICAkaW5wdXQub24oJ2lucHV0JywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gZGlhbG9nLmhhbmRsZVVwZGF0ZSgpOwogICAgICAgICAgfSk7CiAgICAgICAgfSAvLyDmnInlrZfnrKbmlbDpmZDliLbml7bvvIzliqDovb3lrozmlofmnKzmoYblkI4gRE9NIOS8muWPmOWMlu+8jOmcgOimgeabtOaWsOWvueivneahhumrmOW6pgoKCiAgICAgICAgaWYgKG9wdGlvbnMubWF4bGVuZ3RoKSB7CiAgICAgICAgICBkaWFsb2cuaGFuZGxlVXBkYXRlKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9OwoKICB2YXIgREVGQVVMVF9PUFRJT05TJGIgPSB7CiAgICBwb3NpdGlvbjogJ2F1dG8nLAogICAgZGVsYXk6IDAsCiAgICBjb250ZW50OiAnJwogIH07CgogIHZhciBUb29sdGlwID0gZnVuY3Rpb24gVG9vbHRpcChzZWxlY3Rvciwgb3B0aW9ucykgewogICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgb3B0aW9ucyA9IHt9OwogICAgLyoqDQogICAgICog6YWN572u5Y+C5pWwDQogICAgICovCgogICAgdGhpcy5vcHRpb25zID0gZXh0ZW5kKHt9LCBERUZBVUxUX09QVElPTlMkYik7CiAgICAvKioNCiAgICAgKiDlvZPliY0gdG9vbHRpcCDnmoTnirbmgIENCiAgICAgKi8KCiAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICAvKioNCiAgICAgKiBzZXRUaW1lb3V0IOeahOi/lOWbnuWAvA0KICAgICAqLwoKICAgIHRoaXMudGltZW91dElkID0gbnVsbDsKICAgIHRoaXMuJHRhcmdldCA9ICQoc2VsZWN0b3IpLmZpcnN0KCk7CiAgICBleHRlbmQodGhpcy5vcHRpb25zLCBvcHRpb25zKTsgLy8g5Yib5bu6IFRvb2x0aXAgSFRNTAoKICAgIHRoaXMuJGVsZW1lbnQgPSAkKCI8ZGl2IGNsYXNzPVwibWR1aS10b29sdGlwXCIgaWQ9XCIiICsgJC5ndWlkKCkgKyAiXCI+IiArIHRoaXMub3B0aW9ucy5jb250ZW50ICsgIjwvZGl2PiIpLmFwcGVuZFRvKGRvY3VtZW50LmJvZHkpOyAvLyDnu5Hlrprkuovku7bjgILlhYPntKDlpITkuo4gZGlzYWJsZWQg54q25oCB5pe25peg5rOV6Kem5Y+R6byg5qCH5LqL5Lu277yM5Li65LqG57uf5LiA77yM5oqKIHRvdWNoIOS6i+S7tuS5n+emgeeUqAogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby10aGlzLWFsaWFzCgogICAgdmFyIHRoYXQgPSB0aGlzOwogICAgdGhpcy4kdGFyZ2V0Lm9uKCd0b3VjaHN0YXJ0IG1vdXNlZW50ZXInLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgaWYgKHRoYXQuaXNEaXNhYmxlZCh0aGlzKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCFpc0FsbG93KGV2ZW50KSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgcmVnaXN0ZXIoZXZlbnQpOwogICAgICB0aGF0Lm9wZW4oKTsKICAgIH0pLm9uKCd0b3VjaGVuZCBtb3VzZWxlYXZlJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIGlmICh0aGF0LmlzRGlzYWJsZWQodGhpcykpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghaXNBbGxvdyhldmVudCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoYXQuY2xvc2UoKTsKICAgIH0pLm9uKHVubG9ja0V2ZW50LCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgaWYgKHRoYXQuaXNEaXNhYmxlZCh0aGlzKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgcmVnaXN0ZXIoZXZlbnQpOwogICAgfSk7CiAgfTsKICAvKioNCiAgICog5YWD57Sg5piv5ZCm5bey56aB55SoDQogICAqIEBwYXJhbSBlbGVtZW50DQogICAqLwoKCiAgVG9vbHRpcC5wcm90b3R5cGUuaXNEaXNhYmxlZCA9IGZ1bmN0aW9uIGlzRGlzYWJsZWQoZWxlbWVudCkgewogICAgcmV0dXJuIGVsZW1lbnQuZGlzYWJsZWQgfHwgJChlbGVtZW50KS5hdHRyKCdkaXNhYmxlZCcpICE9PSB1bmRlZmluZWQ7CiAgfTsKICAvKioNCiAgICog5piv5ZCm5piv5qGM6Z2i6K6+5aSHDQogICAqLwoKCiAgVG9vbHRpcC5wcm90b3R5cGUuaXNEZXNrdG9wID0gZnVuY3Rpb24gaXNEZXNrdG9wKCkgewogICAgcmV0dXJuICR3aW5kb3cud2lkdGgoKSA+IDEwMjQ7CiAgfTsKICAvKioNCiAgICog6K6+572uIFRvb2x0aXAg55qE5L2N572uDQogICAqLwoKCiAgVG9vbHRpcC5wcm90b3R5cGUuc2V0UG9zaXRpb24gPSBmdW5jdGlvbiBzZXRQb3NpdGlvbigpIHsKICAgIHZhciBtYXJnaW5MZWZ0OwogICAgdmFyIG1hcmdpblRvcDsgLy8g6Kem5Y+R55qE5YWD57SgCgogICAgdmFyIHRhcmdldFByb3BzID0gdGhpcy4kdGFyZ2V0WzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOyAvLyDop6blj5HnmoTlhYPntKDlkowgVG9vbHRpcCDkuYvpl7TnmoTot53nprsKCiAgICB2YXIgdGFyZ2V0TWFyZ2luID0gdGhpcy5pc0Rlc2t0b3AoKSA/IDE0IDogMjQ7IC8vIFRvb2x0aXAg55qE5a695bqm5ZKM6auY5bqmCgogICAgdmFyIHRvb2x0aXBXaWR0aCA9IHRoaXMuJGVsZW1lbnRbMF0ub2Zmc2V0V2lkdGg7CiAgICB2YXIgdG9vbHRpcEhlaWdodCA9IHRoaXMuJGVsZW1lbnRbMF0ub2Zmc2V0SGVpZ2h0OyAvLyBUb29sdGlwIOeahOaWueWQkQoKICAgIHZhciBwb3NpdGlvbiA9IHRoaXMub3B0aW9ucy5wb3NpdGlvbjsgLy8g6Ieq5Yqo5Yik5pat5L2N572u77yM5YqgIDJweO+8jOS9vyBUb29sdGlwIOi3neemu+eql+WPo+i+ueahhuiHs+WwkeaciSAycHgg55qE6Ze06LedCgogICAgaWYgKHBvc2l0aW9uID09PSAnYXV0bycpIHsKICAgICAgaWYgKHRhcmdldFByb3BzLnRvcCArIHRhcmdldFByb3BzLmhlaWdodCArIHRhcmdldE1hcmdpbiArIHRvb2x0aXBIZWlnaHQgKyAyIDwgJHdpbmRvdy5oZWlnaHQoKSkgewogICAgICAgIHBvc2l0aW9uID0gJ2JvdHRvbSc7CiAgICAgIH0gZWxzZSBpZiAodGFyZ2V0TWFyZ2luICsgdG9vbHRpcEhlaWdodCArIDIgPCB0YXJnZXRQcm9wcy50b3ApIHsKICAgICAgICBwb3NpdGlvbiA9ICd0b3AnOwogICAgICB9IGVsc2UgaWYgKHRhcmdldE1hcmdpbiArIHRvb2x0aXBXaWR0aCArIDIgPCB0YXJnZXRQcm9wcy5sZWZ0KSB7CiAgICAgICAgcG9zaXRpb24gPSAnbGVmdCc7CiAgICAgIH0gZWxzZSBpZiAodGFyZ2V0UHJvcHMud2lkdGggKyB0YXJnZXRNYXJnaW4gKyB0b29sdGlwV2lkdGggKyAyIDwgJHdpbmRvdy53aWR0aCgpIC0gdGFyZ2V0UHJvcHMubGVmdCkgewogICAgICAgIHBvc2l0aW9uID0gJ3JpZ2h0JzsKICAgICAgfSBlbHNlIHsKICAgICAgICBwb3NpdGlvbiA9ICdib3R0b20nOwogICAgICB9CiAgICB9IC8vIOiuvue9ruS9jee9rgoKCiAgICBzd2l0Y2ggKHBvc2l0aW9uKSB7CiAgICAgIGNhc2UgJ2JvdHRvbSc6CiAgICAgICAgbWFyZ2luTGVmdCA9IC0xICogKHRvb2x0aXBXaWR0aCAvIDIpOwogICAgICAgIG1hcmdpblRvcCA9IHRhcmdldFByb3BzLmhlaWdodCAvIDIgKyB0YXJnZXRNYXJnaW47CiAgICAgICAgdGhpcy4kZWxlbWVudC50cmFuc2Zvcm1PcmlnaW4oJ3RvcCBjZW50ZXInKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3RvcCc6CiAgICAgICAgbWFyZ2luTGVmdCA9IC0xICogKHRvb2x0aXBXaWR0aCAvIDIpOwogICAgICAgIG1hcmdpblRvcCA9IC0xICogKHRvb2x0aXBIZWlnaHQgKyB0YXJnZXRQcm9wcy5oZWlnaHQgLyAyICsgdGFyZ2V0TWFyZ2luKTsKICAgICAgICB0aGlzLiRlbGVtZW50LnRyYW5zZm9ybU9yaWdpbignYm90dG9tIGNlbnRlcicpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnbGVmdCc6CiAgICAgICAgbWFyZ2luTGVmdCA9IC0xICogKHRvb2x0aXBXaWR0aCArIHRhcmdldFByb3BzLndpZHRoIC8gMiArIHRhcmdldE1hcmdpbik7CiAgICAgICAgbWFyZ2luVG9wID0gLTEgKiAodG9vbHRpcEhlaWdodCAvIDIpOwogICAgICAgIHRoaXMuJGVsZW1lbnQudHJhbnNmb3JtT3JpZ2luKCdjZW50ZXIgcmlnaHQnKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3JpZ2h0JzoKICAgICAgICBtYXJnaW5MZWZ0ID0gdGFyZ2V0UHJvcHMud2lkdGggLyAyICsgdGFyZ2V0TWFyZ2luOwogICAgICAgIG1hcmdpblRvcCA9IC0xICogKHRvb2x0aXBIZWlnaHQgLyAyKTsKICAgICAgICB0aGlzLiRlbGVtZW50LnRyYW5zZm9ybU9yaWdpbignY2VudGVyIGxlZnQnKTsKICAgICAgICBicmVhazsKICAgIH0KCiAgICB2YXIgdGFyZ2V0T2Zmc2V0ID0gdGhpcy4kdGFyZ2V0Lm9mZnNldCgpOwogICAgdGhpcy4kZWxlbWVudC5jc3MoewogICAgICB0b3A6IHRhcmdldE9mZnNldC50b3AgKyB0YXJnZXRQcm9wcy5oZWlnaHQgLyAyICsgInB4IiwKICAgICAgbGVmdDogdGFyZ2V0T2Zmc2V0LmxlZnQgKyB0YXJnZXRQcm9wcy53aWR0aCAvIDIgKyAicHgiLAogICAgICAnbWFyZ2luLWxlZnQnOiBtYXJnaW5MZWZ0ICsgInB4IiwKICAgICAgJ21hcmdpbi10b3AnOiBtYXJnaW5Ub3AgKyAicHgiCiAgICB9KTsKICB9OwogIC8qKg0KICAgKiDop6blj5Hnu4Tku7bkuovku7YNCiAgICogQHBhcmFtIG5hbWUNCiAgICovCgoKICBUb29sdGlwLnByb3RvdHlwZS50cmlnZ2VyRXZlbnQgPSBmdW5jdGlvbiB0cmlnZ2VyRXZlbnQobmFtZSkgewogICAgY29tcG9uZW50RXZlbnQobmFtZSwgJ3Rvb2x0aXAnLCB0aGlzLiR0YXJnZXQsIHRoaXMpOwogIH07CiAgLyoqDQogICAqIOWKqOeUu+e7k+adn+Wbnuiwgw0KICAgKi8KCgogIFRvb2x0aXAucHJvdG90eXBlLnRyYW5zaXRpb25FbmQgPSBmdW5jdGlvbiB0cmFuc2l0aW9uRW5kKCkgewogICAgaWYgKHRoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ21kdWktdG9vbHRpcC1vcGVuJykpIHsKICAgICAgdGhpcy5zdGF0ZSA9ICdvcGVuZWQnOwogICAgICB0aGlzLnRyaWdnZXJFdmVudCgnb3BlbmVkJyk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICAgIHRoaXMudHJpZ2dlckV2ZW50KCdjbG9zZWQnKTsKICAgIH0KICB9OwogIC8qKg0KICAgKiDlvZPliY0gdG9vbHRpcCDmmK/lkKbkuLrmiZPlvIDnirbmgIENCiAgICovCgoKICBUb29sdGlwLnByb3RvdHlwZS5pc09wZW4gPSBmdW5jdGlvbiBpc09wZW4oKSB7CiAgICByZXR1cm4gdGhpcy5zdGF0ZSA9PT0gJ29wZW5pbmcnIHx8IHRoaXMuc3RhdGUgPT09ICdvcGVuZWQnOwogIH07CiAgLyoqDQogICAqIOaJp+ihjOaJk+W8gCB0b29sdGlwDQogICAqLwoKCiAgVG9vbHRpcC5wcm90b3R5cGUuZG9PcGVuID0gZnVuY3Rpb24gZG9PcGVuKCkgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CiAgICB0aGlzLnN0YXRlID0gJ29wZW5pbmcnOwogICAgdGhpcy50cmlnZ2VyRXZlbnQoJ29wZW4nKTsKICAgIHRoaXMuJGVsZW1lbnQuYWRkQ2xhc3MoJ21kdWktdG9vbHRpcC1vcGVuJykudHJhbnNpdGlvbkVuZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzJDEudHJhbnNpdGlvbkVuZCgpOwogICAgfSk7CiAgfTsKICAvKioNCiAgICog5omT5byAIFRvb2x0aXANCiAgICogQHBhcmFtIG9wdGlvbnMg5YWB6K645q+P5qyh5omT5byA5pe26K6+572u5LiN5ZCM55qE5Y+C5pWwDQogICAqLwoKCiAgVG9vbHRpcC5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uIG9wZW4ob3B0aW9ucykgewogICAgdmFyIHRoaXMkMSA9IHRoaXM7CgogICAgaWYgKHRoaXMuaXNPcGVuKCkpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciBvbGRPcHRpb25zID0gZXh0ZW5kKHt9LCB0aGlzLm9wdGlvbnMpOwoKICAgIGlmIChvcHRpb25zKSB7CiAgICAgIGV4dGVuZCh0aGlzLm9wdGlvbnMsIG9wdGlvbnMpOwogICAgfSAvLyB0b29sdGlwIOeahOWGheWuueacieabtOaWsAoKCiAgICBpZiAob2xkT3B0aW9ucy5jb250ZW50ICE9PSB0aGlzLm9wdGlvbnMuY29udGVudCkgewogICAgICB0aGlzLiRlbGVtZW50Lmh0bWwodGhpcy5vcHRpb25zLmNvbnRlbnQpOwogICAgfQoKICAgIHRoaXMuc2V0UG9zaXRpb24oKTsKCiAgICBpZiAodGhpcy5vcHRpb25zLmRlbGF5KSB7CiAgICAgIHRoaXMudGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMkMS5kb09wZW4oKTsKICAgICAgfSwgdGhpcy5vcHRpb25zLmRlbGF5KTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMudGltZW91dElkID0gbnVsbDsKICAgICAgdGhpcy5kb09wZW4oKTsKICAgIH0KICB9OwogIC8qKg0KICAgKiDlhbPpl60gVG9vbHRpcA0KICAgKi8KCgogIFRvb2x0aXAucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gY2xvc2UoKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKCiAgICBpZiAodGhpcy50aW1lb3V0SWQpIHsKICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dElkKTsKICAgICAgdGhpcy50aW1lb3V0SWQgPSBudWxsOwogICAgfQoKICAgIGlmICghdGhpcy5pc09wZW4oKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5zdGF0ZSA9ICdjbG9zaW5nJzsKICAgIHRoaXMudHJpZ2dlckV2ZW50KCdjbG9zZScpOwogICAgdGhpcy4kZWxlbWVudC5yZW1vdmVDbGFzcygnbWR1aS10b29sdGlwLW9wZW4nKS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMkMS50cmFuc2l0aW9uRW5kKCk7CiAgICB9KTsKICB9OwogIC8qKg0KICAgKiDliIfmjaIgVG9vbHRpcCDnmoTmiZPlvIDnirbmgIENCiAgICovCgoKICBUb29sdGlwLnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbiB0b2dnbGUoKSB7CiAgICB0aGlzLmlzT3BlbigpID8gdGhpcy5jbG9zZSgpIDogdGhpcy5vcGVuKCk7CiAgfTsKICAvKioNCiAgICog6I635Y+WIFRvb2x0aXAg54q25oCB44CC5YWx5YyF5ZCr5Zub56eN54q25oCB77yaYG9wZW5pbmdg44CBYG9wZW5lZGDjgIFgY2xvc2luZ2DjgIFgY2xvc2VkYA0KICAgKi8KCgogIFRvb2x0aXAucHJvdG90eXBlLmdldFN0YXRlID0gZnVuY3Rpb24gZ2V0U3RhdGUoKSB7CiAgICByZXR1cm4gdGhpcy5zdGF0ZTsKICB9OwoKICBtZHVpLlRvb2x0aXAgPSBUb29sdGlwOwogIHZhciBjdXN0b21BdHRyJDggPSAnbWR1aS10b29sdGlwJzsKICB2YXIgZGF0YU5hbWUkMiA9ICdfbWR1aV90b29sdGlwJzsKICAkKGZ1bmN0aW9uICgpIHsKICAgIC8vIG1vdXNlZW50ZXIg5LiN6IO95YaS5rOh77yM5omA5Lul6L+Z6YeM55SoIG1vdXNlb3ZlciDku6Pmm78KICAgICRkb2N1bWVudC5vbigndG91Y2hzdGFydCBtb3VzZW92ZXInLCAiWyIgKyBjdXN0b21BdHRyJDggKyAiXSIsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyICR0YXJnZXQgPSAkKHRoaXMpOwogICAgICB2YXIgaW5zdGFuY2UgPSAkdGFyZ2V0LmRhdGEoZGF0YU5hbWUkMik7CgogICAgICBpZiAoIWluc3RhbmNlKSB7CiAgICAgICAgaW5zdGFuY2UgPSBuZXcgbWR1aS5Ub29sdGlwKHRoaXMsIHBhcnNlT3B0aW9ucyh0aGlzLCBjdXN0b21BdHRyJDgpKTsKICAgICAgICAkdGFyZ2V0LmRhdGEoZGF0YU5hbWUkMiwgaW5zdGFuY2UpOwogICAgICB9CiAgICB9KTsKICB9KTsKICB2YXIgREVGQVVMVF9PUFRJT05TJGMgPSB7CiAgICBtZXNzYWdlOiAnJywKICAgIHRpbWVvdXQ6IDQwMDAsCiAgICBwb3NpdGlvbjogJ2JvdHRvbScsCiAgICBidXR0b25UZXh0OiAnJywKICAgIGJ1dHRvbkNvbG9yOiAnJywKICAgIGNsb3NlT25CdXR0b25DbGljazogdHJ1ZSwKICAgIGNsb3NlT25PdXRzaWRlQ2xpY2s6IHRydWUsCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWVtcHR5LWZ1bmN0aW9uCiAgICBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7fSwKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb24KICAgIG9uQnV0dG9uQ2xpY2s6IGZ1bmN0aW9uICgpIHt9LAogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvbgogICAgb25PcGVuOiBmdW5jdGlvbiAoKSB7fSwKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb24KICAgIG9uT3BlbmVkOiBmdW5jdGlvbiAoKSB7fSwKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZW1wdHktZnVuY3Rpb24KICAgIG9uQ2xvc2U6IGZ1bmN0aW9uICgpIHt9LAogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvbgogICAgb25DbG9zZWQ6IGZ1bmN0aW9uICgpIHt9CiAgfTsKICAvKioNCiAgICog5b2T5YmN5omT5byA552A55qEIFNuYWNrYmFyDQogICAqLwoKICB2YXIgY3VycmVudEluc3QkMSA9IG51bGw7CiAgLyoqDQogICAqIOmYn+WIl+WQjQ0KICAgKi8KCiAgdmFyIHF1ZXVlTmFtZSQxID0gJ19tZHVpX3NuYWNrYmFyJzsKCiAgdmFyIFNuYWNrYmFyID0gZnVuY3Rpb24gU25hY2tiYXIob3B0aW9ucykgewogICAgLyoqDQogICAgICog6YWN572u5Y+C5pWwDQogICAgICovCiAgICB0aGlzLm9wdGlvbnMgPSBleHRlbmQoe30sIERFRkFVTFRfT1BUSU9OUyRjKTsKICAgIC8qKg0KICAgICAqIOW9k+WJjSBTbmFja2JhciDnmoTnirbmgIENCiAgICAgKi8KCiAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICAvKioNCiAgICAgKiBzZXRUaW1lb3V0IOeahCBJRA0KICAgICAqLwoKICAgIHRoaXMudGltZW91dElkID0gbnVsbDsKICAgIGV4dGVuZCh0aGlzLm9wdGlvbnMsIG9wdGlvbnMpOyAvLyDmjInpkq7popzoibIKCiAgICB2YXIgYnV0dG9uQ29sb3JTdHlsZSA9ICcnOwogICAgdmFyIGJ1dHRvbkNvbG9yQ2xhc3MgPSAnJzsKCiAgICBpZiAodGhpcy5vcHRpb25zLmJ1dHRvbkNvbG9yLmluZGV4T2YoJyMnKSA9PT0gMCB8fCB0aGlzLm9wdGlvbnMuYnV0dG9uQ29sb3IuaW5kZXhPZigncmdiJykgPT09IDApIHsKICAgICAgYnV0dG9uQ29sb3JTdHlsZSA9ICJzdHlsZT1cImNvbG9yOiIgKyB0aGlzLm9wdGlvbnMuYnV0dG9uQ29sb3IgKyAiXCIiOwogICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMuYnV0dG9uQ29sb3IgIT09ICcnKSB7CiAgICAgIGJ1dHRvbkNvbG9yQ2xhc3MgPSAibWR1aS10ZXh0LWNvbG9yLSIgKyB0aGlzLm9wdGlvbnMuYnV0dG9uQ29sb3I7CiAgICB9IC8vIOa3u+WKoCBIVE1MCgoKICAgIHRoaXMuJGVsZW1lbnQgPSAkKCc8ZGl2IGNsYXNzPSJtZHVpLXNuYWNrYmFyIj4nICsgIjxkaXYgY2xhc3M9XCJtZHVpLXNuYWNrYmFyLXRleHRcIj4iICsgdGhpcy5vcHRpb25zLm1lc3NhZ2UgKyAiPC9kaXY+IiArICh0aGlzLm9wdGlvbnMuYnV0dG9uVGV4dCA/ICI8YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApXCIgY2xhc3M9XCJtZHVpLXNuYWNrYmFyLWFjdGlvbiBtZHVpLWJ0biBtZHVpLXJpcHBsZSBtZHVpLXJpcHBsZS13aGl0ZSAiICsgYnV0dG9uQ29sb3JDbGFzcyArICJcIiAiICsgYnV0dG9uQ29sb3JTdHlsZSArICI+IiArIHRoaXMub3B0aW9ucy5idXR0b25UZXh0ICsgIjwvYT4iIDogJycpICsgJzwvZGl2PicpLmFwcGVuZFRvKGRvY3VtZW50LmJvZHkpOyAvLyDorr7nva7kvY3nva4KCiAgICB0aGlzLnNldFBvc2l0aW9uKCdjbG9zZScpOwogICAgdGhpcy4kZWxlbWVudC5yZWZsb3coKS5hZGRDbGFzcygibWR1aS1zbmFja2Jhci0iICsgdGhpcy5vcHRpb25zLnBvc2l0aW9uKTsKICB9OwogIC8qKg0KICAgKiDngrnlh7sgU25hY2tiYXIg5aSW6Z2i55qE5Yy65Z+f5YWz6ZetDQogICAqIEBwYXJhbSBldmVudA0KICAgKi8KCgogIFNuYWNrYmFyLnByb3RvdHlwZS5jbG9zZU9uT3V0c2lkZUNsaWNrID0gZnVuY3Rpb24gY2xvc2VPbk91dHNpZGVDbGljayhldmVudCkgewogICAgdmFyICR0YXJnZXQgPSAkKGV2ZW50LnRhcmdldCk7CgogICAgaWYgKCEkdGFyZ2V0Lmhhc0NsYXNzKCdtZHVpLXNuYWNrYmFyJykgJiYgISR0YXJnZXQucGFyZW50cygnLm1kdWktc25hY2tiYXInKS5sZW5ndGgpIHsKICAgICAgY3VycmVudEluc3QkMS5jbG9zZSgpOwogICAgfQogIH07CiAgLyoqDQogICAqIOiuvue9riBTbmFja2JhciDnmoTkvY3nva4NCiAgICogQHBhcmFtIHN0YXRlDQogICAqLwoKCiAgU25hY2tiYXIucHJvdG90eXBlLnNldFBvc2l0aW9uID0gZnVuY3Rpb24gc2V0UG9zaXRpb24oc3RhdGUpIHsKICAgIHZhciBzbmFja2JhckhlaWdodCA9IHRoaXMuJGVsZW1lbnRbMF0uY2xpZW50SGVpZ2h0OwogICAgdmFyIHBvc2l0aW9uID0gdGhpcy5vcHRpb25zLnBvc2l0aW9uOwogICAgdmFyIHRyYW5zbGF0ZVg7CiAgICB2YXIgdHJhbnNsYXRlWTsgLy8gdHJhbnNsYXRlWAoKICAgIGlmIChwb3NpdGlvbiA9PT0gJ2JvdHRvbScgfHwgcG9zaXRpb24gPT09ICd0b3AnKSB7CiAgICAgIHRyYW5zbGF0ZVggPSAnLTUwJSc7CiAgICB9IGVsc2UgewogICAgICB0cmFuc2xhdGVYID0gJzAnOwogICAgfSAvLyB0cmFuc2xhdGVZCgoKICAgIGlmIChzdGF0ZSA9PT0gJ29wZW4nKSB7CiAgICAgIHRyYW5zbGF0ZVkgPSAnMCc7CiAgICB9IGVsc2UgewogICAgICBpZiAocG9zaXRpb24gPT09ICdib3R0b20nKSB7CiAgICAgICAgdHJhbnNsYXRlWSA9IHNuYWNrYmFySGVpZ2h0OwogICAgICB9CgogICAgICBpZiAocG9zaXRpb24gPT09ICd0b3AnKSB7CiAgICAgICAgdHJhbnNsYXRlWSA9IC1zbmFja2JhckhlaWdodDsKICAgICAgfQoKICAgICAgaWYgKHBvc2l0aW9uID09PSAnbGVmdC10b3AnIHx8IHBvc2l0aW9uID09PSAncmlnaHQtdG9wJykgewogICAgICAgIHRyYW5zbGF0ZVkgPSAtc25hY2tiYXJIZWlnaHQgLSAyNDsKICAgICAgfQoKICAgICAgaWYgKHBvc2l0aW9uID09PSAnbGVmdC1ib3R0b20nIHx8IHBvc2l0aW9uID09PSAncmlnaHQtYm90dG9tJykgewogICAgICAgIHRyYW5zbGF0ZVkgPSBzbmFja2JhckhlaWdodCArIDI0OwogICAgICB9CiAgICB9CgogICAgdGhpcy4kZWxlbWVudC50cmFuc2Zvcm0oInRyYW5zbGF0ZSgiICsgdHJhbnNsYXRlWCArICIsIiArIHRyYW5zbGF0ZVkgKyAicHgiKTsKICB9OwogIC8qKg0KICAgKiDmiZPlvIAgU25hY2tiYXINCiAgICovCgoKICBTbmFja2Jhci5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uIG9wZW4oKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKCiAgICBpZiAodGhpcy5zdGF0ZSA9PT0gJ29wZW5pbmcnIHx8IHRoaXMuc3RhdGUgPT09ICdvcGVuZWQnKSB7CiAgICAgIHJldHVybjsKICAgIH0gLy8g5aaC5p6c5b2T5YmN5pyJ5q2j5Zyo5pi+56S655qEIFNuYWNrYmFy77yM5YiZ5YWI5Yqg5YWl6Zif5YiX77yM562J5penIFNuYWNrYmFyIOWFs+mXreWQjuWGjeaJk+W8gAoKCiAgICBpZiAoY3VycmVudEluc3QkMSkgewogICAgICBxdWV1ZShxdWV1ZU5hbWUkMSwgZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0aGlzJDEub3BlbigpOwogICAgICB9KTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGN1cnJlbnRJbnN0JDEgPSB0aGlzOyAvLyDlvIDlp4vmiZPlvIAKCiAgICB0aGlzLnN0YXRlID0gJ29wZW5pbmcnOwogICAgdGhpcy5vcHRpb25zLm9uT3Blbih0aGlzKTsKICAgIHRoaXMuc2V0UG9zaXRpb24oJ29wZW4nKTsKICAgIHRoaXMuJGVsZW1lbnQudHJhbnNpdGlvbkVuZChmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzJDEuc3RhdGUgIT09ICdvcGVuaW5nJykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcyQxLnN0YXRlID0gJ29wZW5lZCc7CiAgICAgIHRoaXMkMS5vcHRpb25zLm9uT3BlbmVkKHRoaXMkMSk7IC8vIOacieaMiemSruaXtue7keWumuS6i+S7tgoKICAgICAgaWYgKHRoaXMkMS5vcHRpb25zLmJ1dHRvblRleHQpIHsKICAgICAgICB0aGlzJDEuJGVsZW1lbnQuZmluZCgnLm1kdWktc25hY2tiYXItYWN0aW9uJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgdGhpcyQxLm9wdGlvbnMub25CdXR0b25DbGljayh0aGlzJDEpOwoKICAgICAgICAgIGlmICh0aGlzJDEub3B0aW9ucy5jbG9zZU9uQnV0dG9uQ2xpY2spIHsKICAgICAgICAgICAgdGhpcyQxLmNsb3NlKCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gLy8g54K55Ye7IHNuYWNrYmFyIOeahOS6i+S7tgoKCiAgICAgIHRoaXMkMS4kZWxlbWVudC5vbignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICBpZiAoISQoZXZlbnQudGFyZ2V0KS5oYXNDbGFzcygnbWR1aS1zbmFja2Jhci1hY3Rpb24nKSkgewogICAgICAgICAgdGhpcyQxLm9wdGlvbnMub25DbGljayh0aGlzJDEpOwogICAgICAgIH0KICAgICAgfSk7IC8vIOeCueWHuyBTbmFja2JhciDlpJbpnaLnmoTljLrln5/lhbPpl60KCiAgICAgIGlmICh0aGlzJDEub3B0aW9ucy5jbG9zZU9uT3V0c2lkZUNsaWNrKSB7CiAgICAgICAgJGRvY3VtZW50Lm9uKHN0YXJ0RXZlbnQsIHRoaXMkMS5jbG9zZU9uT3V0c2lkZUNsaWNrKTsKICAgICAgfSAvLyDotoXml7blkI7oh6rliqjlhbPpl60KCgogICAgICBpZiAodGhpcyQxLm9wdGlvbnMudGltZW91dCkgewogICAgICAgIHRoaXMkMS50aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiB0aGlzJDEuY2xvc2UoKTsKICAgICAgICB9LCB0aGlzJDEub3B0aW9ucy50aW1lb3V0KTsKICAgICAgfQogICAgfSk7CiAgfTsKICAvKioNCiAgICog5YWz6ZetIFNuYWNrYmFyDQogICAqLwoKCiAgU25hY2tiYXIucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gY2xvc2UoKSB7CiAgICB2YXIgdGhpcyQxID0gdGhpczsKCiAgICBpZiAodGhpcy5zdGF0ZSA9PT0gJ2Nsb3NpbmcnIHx8IHRoaXMuc3RhdGUgPT09ICdjbG9zZWQnKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAodGhpcy50aW1lb3V0SWQpIHsKICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dElkKTsKICAgIH0KCiAgICBpZiAodGhpcy5vcHRpb25zLmNsb3NlT25PdXRzaWRlQ2xpY2spIHsKICAgICAgJGRvY3VtZW50Lm9mZihzdGFydEV2ZW50LCB0aGlzLmNsb3NlT25PdXRzaWRlQ2xpY2spOwogICAgfQoKICAgIHRoaXMuc3RhdGUgPSAnY2xvc2luZyc7CiAgICB0aGlzLm9wdGlvbnMub25DbG9zZSh0aGlzKTsKICAgIHRoaXMuc2V0UG9zaXRpb24oJ2Nsb3NlJyk7CiAgICB0aGlzLiRlbGVtZW50LnRyYW5zaXRpb25FbmQoZnVuY3Rpb24gKCkgewogICAgICBpZiAodGhpcyQxLnN0YXRlICE9PSAnY2xvc2luZycpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGN1cnJlbnRJbnN0JDEgPSBudWxsOwogICAgICB0aGlzJDEuc3RhdGUgPSAnY2xvc2VkJzsKICAgICAgdGhpcyQxLm9wdGlvbnMub25DbG9zZWQodGhpcyQxKTsKICAgICAgdGhpcyQxLiRlbGVtZW50LnJlbW92ZSgpOwogICAgICBkZXF1ZXVlKHF1ZXVlTmFtZSQxKTsKICAgIH0pOwogIH07CgogIG1kdWkuc25hY2tiYXIgPSBmdW5jdGlvbiAobWVzc2FnZSwgb3B0aW9ucykgewogICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgb3B0aW9ucyA9IHt9OwoKICAgIGlmIChpc1N0cmluZyhtZXNzYWdlKSkgewogICAgICBvcHRpb25zLm1lc3NhZ2UgPSBtZXNzYWdlOwogICAgfSBlbHNlIHsKICAgICAgb3B0aW9ucyA9IG1lc3NhZ2U7CiAgICB9CgogICAgdmFyIGluc3RhbmNlID0gbmV3IFNuYWNrYmFyKG9wdGlvbnMpOwogICAgaW5zdGFuY2Uub3BlbigpOwogICAgcmV0dXJuIGluc3RhbmNlOwogIH07CgogICQoZnVuY3Rpb24gKCkgewogICAgLy8g5YiH5o2i5a+86Iiq6aG5CiAgICAkZG9jdW1lbnQub24oJ2NsaWNrJywgJy5tZHVpLWJvdHRvbS1uYXY+YScsIGZ1bmN0aW9uICgpIHsKICAgICAgdmFyICRpdGVtID0gJCh0aGlzKTsKICAgICAgdmFyICRib3R0b21OYXYgPSAkaXRlbS5wYXJlbnQoKTsKICAgICAgJGJvdHRvbU5hdi5jaGlsZHJlbignYScpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBpdGVtKSB7CiAgICAgICAgdmFyIGlzVGhpcyA9ICRpdGVtLmlzKGl0ZW0pOwoKICAgICAgICBpZiAoaXNUaGlzKSB7CiAgICAgICAgICBjb21wb25lbnRFdmVudCgnY2hhbmdlJywgJ2JvdHRvbU5hdicsICRib3R0b21OYXZbMF0sIHVuZGVmaW5lZCwgewogICAgICAgICAgICBpbmRleDogaW5kZXgKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaXNUaGlzID8gJChpdGVtKS5hZGRDbGFzcygnbWR1aS1ib3R0b20tbmF2LWFjdGl2ZScpIDogJChpdGVtKS5yZW1vdmVDbGFzcygnbWR1aS1ib3R0b20tbmF2LWFjdGl2ZScpOwogICAgICB9KTsKICAgIH0pOyAvLyDmu5rliqjml7bpmpDol48gbWR1aS1ib3R0b20tbmF2LXNjcm9sbC1oaWRlCgogICAgbWR1aS5tdXRhdGlvbignLm1kdWktYm90dG9tLW5hdi1zY3JvbGwtaGlkZScsIGZ1bmN0aW9uICgpIHsKICAgICAgbmV3IG1kdWkuSGVhZHJvb20odGhpcywgewogICAgICAgIHBpbm5lZENsYXNzOiAnbWR1aS1oZWFkcm9vbS1waW5uZWQtZG93bicsCiAgICAgICAgdW5waW5uZWRDbGFzczogJ21kdWktaGVhZHJvb20tdW5waW5uZWQtZG93bicKICAgICAgfSk7CiAgICB9KTsKICB9KTsKICAvKioNCiAgICogbGF5ZXIg55qEIEhUTUwg57uT5p6EDQogICAqIEBwYXJhbSBpbmRleA0KICAgKi8KCiAgZnVuY3Rpb24gbGF5ZXJIVE1MKGluZGV4KSB7CiAgICBpZiAoaW5kZXggPT09IHZvaWQgMCkgaW5kZXggPSBmYWxzZTsKICAgIHJldHVybiAiPGRpdiBjbGFzcz1cIm1kdWktc3Bpbm5lci1sYXllciAiICsgKGluZGV4ID8gIm1kdWktc3Bpbm5lci1sYXllci0iICsgaW5kZXggOiAnJykgKyAiXCI+IiArICc8ZGl2IGNsYXNzPSJtZHVpLXNwaW5uZXItY2lyY2xlLWNsaXBwZXIgbWR1aS1zcGlubmVyLWxlZnQiPicgKyAnPGRpdiBjbGFzcz0ibWR1aS1zcGlubmVyLWNpcmNsZSI+PC9kaXY+JyArICc8L2Rpdj4nICsgJzxkaXYgY2xhc3M9Im1kdWktc3Bpbm5lci1nYXAtcGF0Y2giPicgKyAnPGRpdiBjbGFzcz0ibWR1aS1zcGlubmVyLWNpcmNsZSI+PC9kaXY+JyArICc8L2Rpdj4nICsgJzxkaXYgY2xhc3M9Im1kdWktc3Bpbm5lci1jaXJjbGUtY2xpcHBlciBtZHVpLXNwaW5uZXItcmlnaHQiPicgKyAnPGRpdiBjbGFzcz0ibWR1aS1zcGlubmVyLWNpcmNsZSI+PC9kaXY+JyArICc8L2Rpdj4nICsgJzwvZGl2Pic7CiAgfQogIC8qKg0KICAgKiDloavlhYUgSFRNTA0KICAgKiBAcGFyYW0gc3Bpbm5lcg0KICAgKi8KCgogIGZ1bmN0aW9uIGZpbGxIVE1MKHNwaW5uZXIpIHsKICAgIHZhciAkc3Bpbm5lciA9ICQoc3Bpbm5lcik7CiAgICB2YXIgbGF5ZXIgPSAkc3Bpbm5lci5oYXNDbGFzcygnbWR1aS1zcGlubmVyLWNvbG9yZnVsJykgPyBsYXllckhUTUwoMSkgKyBsYXllckhUTUwoMikgKyBsYXllckhUTUwoMykgKyBsYXllckhUTUwoNCkgOiBsYXllckhUTUwoKTsKICAgICRzcGlubmVyLmh0bWwobGF5ZXIpOwogIH0KCiAgJChmdW5jdGlvbiAoKSB7CiAgICAvLyDpobXpnaLliqDovb3lrozlkI7oh6rliqjloavlhYUgSFRNTCDnu5PmnoQKICAgIG1kdWkubXV0YXRpb24oJy5tZHVpLXNwaW5uZXInLCBmdW5jdGlvbiAoKSB7CiAgICAgIGZpbGxIVE1MKHRoaXMpOwogICAgfSk7CiAgfSk7CgogIG1kdWkudXBkYXRlU3Bpbm5lcnMgPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgIHZhciAkZWxlbWVudHMgPSBpc1VuZGVmaW5lZChzZWxlY3RvcikgPyAkKCcubWR1aS1zcGlubmVyJykgOiAkKHNlbGVjdG9yKTsKICAgICRlbGVtZW50cy5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgZmlsbEhUTUwodGhpcyk7CiAgICB9KTsKICB9OwoKICB2YXIgREVGQVVMVF9PUFRJT05TJGQgPSB7CiAgICBwb3NpdGlvbjogJ2F1dG8nLAogICAgYWxpZ246ICdhdXRvJywKICAgIGd1dHRlcjogMTYsCiAgICBmaXhlZDogZmFsc2UsCiAgICBjb3ZlcmVkOiAnYXV0bycsCiAgICBzdWJNZW51VHJpZ2dlcjogJ2hvdmVyJywKICAgIHN1Yk1lbnVEZWxheTogMjAwCiAgfTsKCiAgdmFyIE1lbnUgPSBmdW5jdGlvbiBNZW51KGFuY2hvclNlbGVjdG9yLCBtZW51U2VsZWN0b3IsIG9wdGlvbnMpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwogICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgb3B0aW9ucyA9IHt9OwogICAgLyoqDQogICAgICog6YWN572u5Y+C5pWwDQogICAgICovCgogICAgdGhpcy5vcHRpb25zID0gZXh0ZW5kKHt9LCBERUZBVUxUX09QVElPTlMkZCk7CiAgICAvKioNCiAgICAgKiDlvZPliY3oj5zljZXnirbmgIENCiAgICAgKi8KCiAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICB0aGlzLiRhbmNob3IgPSAkKGFuY2hvclNlbGVjdG9yKS5maXJzdCgpOwogICAgdGhpcy4kZWxlbWVudCA9ICQobWVudVNlbGVjdG9yKS5maXJzdCgpOyAvLyDop6blj5Hoj5zljZXnmoTlhYPntKAg5ZKMIOiPnOWNleW/hemhu+aYr+WQjOe6p+eahOWFg+e0oO+8jOWQpuWImeiPnOWNleWPr+iDveS4jeiDveWumuS9jQoKICAgIGlmICghdGhpcy4kYW5jaG9yLnBhcmVudCgpLmlzKHRoaXMuJGVsZW1lbnQucGFyZW50KCkpKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignYW5jaG9yU2VsZWN0b3IgYW5kIG1lbnVTZWxlY3RvciBtdXN0IGJlIHNpYmxpbmdzJyk7CiAgICB9CgogICAgZXh0ZW5kKHRoaXMub3B0aW9ucywgb3B0aW9ucyk7IC8vIOaYr+WQpuaYr+e6p+iBlOiPnOWNlQoKICAgIHRoaXMuaXNDYXNjYWRlID0gdGhpcy4kZWxlbWVudC5oYXNDbGFzcygnbWR1aS1tZW51LWNhc2NhZGUnKTsgLy8gY292ZXJlZCDlj4LmlbDlpITnkIYKCiAgICB0aGlzLmlzQ292ZXJlZCA9IHRoaXMub3B0aW9ucy5jb3ZlcmVkID09PSAnYXV0bycgPyAhdGhpcy5pc0Nhc2NhZGUgOiB0aGlzLm9wdGlvbnMuY292ZXJlZDsgLy8g54K55Ye76Kem5Y+R6I+c5Y2V5YiH5o2iCgogICAgdGhpcy4kYW5jaG9yLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMkMS50b2dnbGUoKTsKICAgIH0pOyAvLyDngrnlh7voj5zljZXlpJbpnaLljLrln5/lhbPpl63oj5zljZUKCiAgICAkZG9jdW1lbnQub24oJ2NsaWNrIHRvdWNoc3RhcnQnLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdmFyICR0YXJnZXQgPSAkKGV2ZW50LnRhcmdldCk7CgogICAgICBpZiAodGhpcyQxLmlzT3BlbigpICYmICEkdGFyZ2V0LmlzKHRoaXMkMS4kZWxlbWVudCkgJiYgIWNvbnRhaW5zKHRoaXMkMS4kZWxlbWVudFswXSwgJHRhcmdldFswXSkgJiYgISR0YXJnZXQuaXModGhpcyQxLiRhbmNob3IpICYmICFjb250YWlucyh0aGlzJDEuJGFuY2hvclswXSwgJHRhcmdldFswXSkpIHsKICAgICAgICB0aGlzJDEuY2xvc2UoKTsKICAgICAgfQogICAgfSk7IC8vIOeCueWHu+S4jeWQq+WtkOiPnOWNleeahOiPnOWNleadoeebruWFs+mXreiPnOWNlQogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby10aGlzLWFsaWFzCgogICAgdmFyIHRoYXQgPSB0aGlzOwogICAgJGRvY3VtZW50Lm9uKCdjbGljaycsICcubWR1aS1tZW51LWl0ZW0nLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciAkaXRlbSA9ICQodGhpcyk7CgogICAgICBpZiAoISRpdGVtLmZpbmQoJy5tZHVpLW1lbnUnKS5sZW5ndGggJiYgJGl0ZW0uYXR0cignZGlzYWJsZWQnKSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGhhdC5jbG9zZSgpOwogICAgICB9CiAgICB9KTsgLy8g57uR5a6a54K55Ye75oiW6byg5qCH56e75YWl5ZCr5a2Q6I+c5Y2V55qE5p2h55uu55qE5LqL5Lu2CgogICAgdGhpcy5iaW5kU3ViTWVudUV2ZW50KCk7IC8vIOeql+WPo+Wkp+Wwj+WPmOWMluaXtu+8jOmHjeaWsOiwg+aVtOiPnOWNleS9jee9rgoKICAgICR3aW5kb3cub24oJ3Jlc2l6ZScsICQudGhyb3R0bGUoZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcyQxLnJlYWRqdXN0KCk7CiAgICB9LCAxMDApKTsKICB9OwogIC8qKg0KICAgKiDmmK/lkKbkuLrmiZPlvIDnirbmgIENCiAgICovCgoKICBNZW51LnByb3RvdHlwZS5pc09wZW4gPSBmdW5jdGlvbiBpc09wZW4oKSB7CiAgICByZXR1cm4gdGhpcy5zdGF0ZSA9PT0gJ29wZW5pbmcnIHx8IHRoaXMuc3RhdGUgPT09ICdvcGVuZWQnOwogIH07CiAgLyoqDQogICAqIOinpuWPkee7hOS7tuS6i+S7tg0KICAgKiBAcGFyYW0gbmFtZQ0KICAgKi8KCgogIE1lbnUucHJvdG90eXBlLnRyaWdnZXJFdmVudCA9IGZ1bmN0aW9uIHRyaWdnZXJFdmVudChuYW1lKSB7CiAgICBjb21wb25lbnRFdmVudChuYW1lLCAnbWVudScsIHRoaXMuJGVsZW1lbnQsIHRoaXMpOwogIH07CiAgLyoqDQogICAqIOiwg+aVtOS4u+iPnOWNleS9jee9rg0KICAgKi8KCgogIE1lbnUucHJvdG90eXBlLnJlYWRqdXN0ID0gZnVuY3Rpb24gcmVhZGp1c3QoKSB7CiAgICB2YXIgbWVudUxlZnQ7CiAgICB2YXIgbWVudVRvcDsgLy8g6I+c5Y2V5L2N572u5ZKM5pa55ZCRCgogICAgdmFyIHBvc2l0aW9uOwogICAgdmFyIGFsaWduOyAvLyB3aW5kb3cg56qX5Y+j55qE5a695bqm5ZKM6auY5bqmCgogICAgdmFyIHdpbmRvd0hlaWdodCA9ICR3aW5kb3cuaGVpZ2h0KCk7CiAgICB2YXIgd2luZG93V2lkdGggPSAkd2luZG93LndpZHRoKCk7IC8vIOmFjee9ruWPguaVsAoKICAgIHZhciBndXR0ZXIgPSB0aGlzLm9wdGlvbnMuZ3V0dGVyOwogICAgdmFyIGlzQ292ZXJlZCA9IHRoaXMuaXNDb3ZlcmVkOwogICAgdmFyIGlzRml4ZWQgPSB0aGlzLm9wdGlvbnMuZml4ZWQ7IC8vIOWKqOeUu+aWueWQkeWPguaVsAoKICAgIHZhciB0cmFuc2Zvcm1PcmlnaW5YOwogICAgdmFyIHRyYW5zZm9ybU9yaWdpblk7IC8vIOiPnOWNleeahOWOn+Wni+WuveW6puWSjOmrmOW6pgoKICAgIHZhciBtZW51V2lkdGggPSB0aGlzLiRlbGVtZW50LndpZHRoKCk7CiAgICB2YXIgbWVudUhlaWdodCA9IHRoaXMuJGVsZW1lbnQuaGVpZ2h0KCk7IC8vIOinpuWPkeiPnOWNleeahOWFg+e0oOWcqOeql+WPo+S4reeahOS9jee9rgoKICAgIHZhciBhbmNob3JSZWN0ID0gdGhpcy4kYW5jaG9yWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgdmFyIGFuY2hvclRvcCA9IGFuY2hvclJlY3QudG9wOwogICAgdmFyIGFuY2hvckxlZnQgPSBhbmNob3JSZWN0LmxlZnQ7CiAgICB2YXIgYW5jaG9ySGVpZ2h0ID0gYW5jaG9yUmVjdC5oZWlnaHQ7CiAgICB2YXIgYW5jaG9yV2lkdGggPSBhbmNob3JSZWN0LndpZHRoOwogICAgdmFyIGFuY2hvckJvdHRvbSA9IHdpbmRvd0hlaWdodCAtIGFuY2hvclRvcCAtIGFuY2hvckhlaWdodDsKICAgIHZhciBhbmNob3JSaWdodCA9IHdpbmRvd1dpZHRoIC0gYW5jaG9yTGVmdCAtIGFuY2hvcldpZHRoOyAvLyDop6blj5HlhYPntKDnm7jlr7nlhbbmi6XmnInlrprkvY3lsZ7mgKfnmoTniLblhYPntKDnmoTkvY3nva4KCiAgICB2YXIgYW5jaG9yT2Zmc2V0VG9wID0gdGhpcy4kYW5jaG9yWzBdLm9mZnNldFRvcDsKICAgIHZhciBhbmNob3JPZmZzZXRMZWZ0ID0gdGhpcy4kYW5jaG9yWzBdLm9mZnNldExlZnQ7IC8vIOiHquWKqOWIpOaWreiPnOWNleS9jee9rgoKICAgIGlmICh0aGlzLm9wdGlvbnMucG9zaXRpb24gPT09ICdhdXRvJykgewogICAgICBpZiAoYW5jaG9yQm90dG9tICsgKGlzQ292ZXJlZCA/IGFuY2hvckhlaWdodCA6IDApID4gbWVudUhlaWdodCArIGd1dHRlcikgewogICAgICAgIC8vIOWIpOaWreS4i+aWueaYr+WQpuaUvuW+l+S4i+iPnOWNlQogICAgICAgIHBvc2l0aW9uID0gJ2JvdHRvbSc7CiAgICAgIH0gZWxzZSBpZiAoYW5jaG9yVG9wICsgKGlzQ292ZXJlZCA/IGFuY2hvckhlaWdodCA6IDApID4gbWVudUhlaWdodCArIGd1dHRlcikgewogICAgICAgIC8vIOWIpOaWreS4iuaWueaYr+WQpuaUvuW+l+S4i+iPnOWNlQogICAgICAgIHBvc2l0aW9uID0gJ3RvcCc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8g5LiK5LiL6YO95pS+5LiN5LiL77yM5bGF5Lit5pi+56S6CiAgICAgICAgcG9zaXRpb24gPSAnY2VudGVyJzsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgcG9zaXRpb24gPSB0aGlzLm9wdGlvbnMucG9zaXRpb247CiAgICB9IC8vIOiHquWKqOWIpOaWreiPnOWNleWvuem9kOaWueW8jwoKCiAgICBpZiAodGhpcy5vcHRpb25zLmFsaWduID09PSAnYXV0bycpIHsKICAgICAgaWYgKGFuY2hvclJpZ2h0ICsgYW5jaG9yV2lkdGggPiBtZW51V2lkdGggKyBndXR0ZXIpIHsKICAgICAgICAvLyDliKTmlq3lj7PkvqfmmK/lkKbmlL7lvpfkuIvoj5zljZUKICAgICAgICBhbGlnbiA9ICdsZWZ0JzsKICAgICAgfSBlbHNlIGlmIChhbmNob3JMZWZ0ICsgYW5jaG9yV2lkdGggPiBtZW51V2lkdGggKyBndXR0ZXIpIHsKICAgICAgICAvLyDliKTmlq3lt6bkvqfmmK/lkKbmlL7lvpfkuIvoj5zljZUKICAgICAgICBhbGlnbiA9ICdyaWdodCc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8g5bem5Y+z6YO95pS+5LiN5LiL77yM5bGF5Lit5pi+56S6CiAgICAgICAgYWxpZ24gPSAnY2VudGVyJzsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgYWxpZ24gPSB0aGlzLm9wdGlvbnMuYWxpZ247CiAgICB9IC8vIOiuvue9ruiPnOWNleS9jee9rgoKCiAgICBpZiAocG9zaXRpb24gPT09ICdib3R0b20nKSB7CiAgICAgIHRyYW5zZm9ybU9yaWdpblkgPSAnMCc7CiAgICAgIG1lbnVUb3AgPSAoaXNDb3ZlcmVkID8gMCA6IGFuY2hvckhlaWdodCkgKyAoaXNGaXhlZCA/IGFuY2hvclRvcCA6IGFuY2hvck9mZnNldFRvcCk7CiAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSAndG9wJykgewogICAgICB0cmFuc2Zvcm1PcmlnaW5ZID0gJzEwMCUnOwogICAgICBtZW51VG9wID0gKGlzQ292ZXJlZCA/IGFuY2hvckhlaWdodCA6IDApICsgKGlzRml4ZWQgPyBhbmNob3JUb3AgLSBtZW51SGVpZ2h0IDogYW5jaG9yT2Zmc2V0VG9wIC0gbWVudUhlaWdodCk7CiAgICB9IGVsc2UgewogICAgICB0cmFuc2Zvcm1PcmlnaW5ZID0gJzUwJSc7IC8vID09PT09PT09PT09PT09PT09PT09PeWcqOeql+WPo+S4reWxheS4rQogICAgICAvLyDmmL7npLrnmoToj5zljZXnmoTpq5jluqbvvIznroDljZXoj5zljZXpq5jluqbkuI3otoXov4fnqpflj6Ppq5jluqbvvIzoi6XotoXov4fkuobliJnlnKjoj5zljZXlhoXpg6jmmL7npLrmu5rliqjmnaEKICAgICAgLy8g57qn6IGU6I+c5Y2V5YaF6YOo5LiN5YWB6K645Ye6546w5rua5Yqo5p2hCgogICAgICB2YXIgbWVudUhlaWdodFRlbXAgPSBtZW51SGVpZ2h0OyAvLyDnroDljZXoj5zljZXmr5Tnqpflj6Ppq5jml7bvvIzpmZDliLboj5zljZXpq5jluqYKCiAgICAgIGlmICghdGhpcy5pc0Nhc2NhZGUpIHsKICAgICAgICBpZiAobWVudUhlaWdodCArIGd1dHRlciAqIDIgPiB3aW5kb3dIZWlnaHQpIHsKICAgICAgICAgIG1lbnVIZWlnaHRUZW1wID0gd2luZG93SGVpZ2h0IC0gZ3V0dGVyICogMjsKICAgICAgICAgIHRoaXMuJGVsZW1lbnQuaGVpZ2h0KG1lbnVIZWlnaHRUZW1wKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG1lbnVUb3AgPSAod2luZG93SGVpZ2h0IC0gbWVudUhlaWdodFRlbXApIC8gMiArIChpc0ZpeGVkID8gMCA6IGFuY2hvck9mZnNldFRvcCAtIGFuY2hvclRvcCk7CiAgICB9CgogICAgdGhpcy4kZWxlbWVudC5jc3MoJ3RvcCcsIG1lbnVUb3AgKyAicHgiKTsgLy8g6K6+572u6I+c5Y2V5a+56b2Q5pa55byPCgogICAgaWYgKGFsaWduID09PSAnbGVmdCcpIHsKICAgICAgdHJhbnNmb3JtT3JpZ2luWCA9ICcwJzsKICAgICAgbWVudUxlZnQgPSBpc0ZpeGVkID8gYW5jaG9yTGVmdCA6IGFuY2hvck9mZnNldExlZnQ7CiAgICB9IGVsc2UgaWYgKGFsaWduID09PSAncmlnaHQnKSB7CiAgICAgIHRyYW5zZm9ybU9yaWdpblggPSAnMTAwJSc7CiAgICAgIG1lbnVMZWZ0ID0gaXNGaXhlZCA/IGFuY2hvckxlZnQgKyBhbmNob3JXaWR0aCAtIG1lbnVXaWR0aCA6IGFuY2hvck9mZnNldExlZnQgKyBhbmNob3JXaWR0aCAtIG1lbnVXaWR0aDsKICAgIH0gZWxzZSB7CiAgICAgIHRyYW5zZm9ybU9yaWdpblggPSAnNTAlJzsgLy89PT09PT09PT09PT09PT09PT09PT09PeWcqOeql+WPo+S4reWxheS4rQogICAgICAvLyDmmL7npLrnmoToj5zljZXnmoTlrr3luqbvvIzoj5zljZXlrr3luqbkuI3og73otoXov4fnqpflj6Plrr3luqYKCiAgICAgIHZhciBtZW51V2lkdGhUZW1wID0gbWVudVdpZHRoOyAvLyDoj5zljZXmr5Tnqpflj6Plrr3vvIzpmZDliLboj5zljZXlrr3luqYKCiAgICAgIGlmIChtZW51V2lkdGggKyBndXR0ZXIgKiAyID4gd2luZG93V2lkdGgpIHsKICAgICAgICBtZW51V2lkdGhUZW1wID0gd2luZG93V2lkdGggLSBndXR0ZXIgKiAyOwogICAgICAgIHRoaXMuJGVsZW1lbnQud2lkdGgobWVudVdpZHRoVGVtcCk7CiAgICAgIH0KCiAgICAgIG1lbnVMZWZ0ID0gKHdpbmRvd1dpZHRoIC0gbWVudVdpZHRoVGVtcCkgLyAyICsgKGlzRml4ZWQgPyAwIDogYW5jaG9yT2Zmc2V0TGVmdCAtIGFuY2hvckxlZnQpOwogICAgfQoKICAgIHRoaXMuJGVsZW1lbnQuY3NzKCdsZWZ0JywgbWVudUxlZnQgKyAicHgiKTsgLy8g6K6+572u6I+c5Y2V5Yqo55S75pa55ZCRCgogICAgdGhpcy4kZWxlbWVudC50cmFuc2Zvcm1PcmlnaW4odHJhbnNmb3JtT3JpZ2luWCArICIgIiArIHRyYW5zZm9ybU9yaWdpblkpOwogIH07CiAgLyoqDQogICAqIOiwg+aVtOWtkOiPnOWNleeahOS9jee9rg0KICAgKiBAcGFyYW0gJHN1Ym1lbnUNCiAgICovCgoKICBNZW51LnByb3RvdHlwZS5yZWFkanVzdFN1Ym1lbnUgPSBmdW5jdGlvbiByZWFkanVzdFN1Ym1lbnUoJHN1Ym1lbnUpIHsKICAgIHZhciAkaXRlbSA9ICRzdWJtZW51LnBhcmVudCgnLm1kdWktbWVudS1pdGVtJyk7CiAgICB2YXIgc3VibWVudVRvcDsKICAgIHZhciBzdWJtZW51TGVmdDsgLy8g5a2Q6I+c5Y2V5L2N572u5ZKM5pa55ZCRCgogICAgdmFyIHBvc2l0aW9uOwogICAgdmFyIGFsaWduOyAvLyB3aW5kb3cg56qX5Y+j55qE5a695bqm5ZKM6auY5bqmCgogICAgdmFyIHdpbmRvd0hlaWdodCA9ICR3aW5kb3cuaGVpZ2h0KCk7CiAgICB2YXIgd2luZG93V2lkdGggPSAkd2luZG93LndpZHRoKCk7IC8vIOWKqOeUu+aWueWQkeWPguaVsAoKICAgIHZhciB0cmFuc2Zvcm1PcmlnaW5YOwogICAgdmFyIHRyYW5zZm9ybU9yaWdpblk7IC8vIOWtkOiPnOWNleeahOWOn+Wni+WuveW6puWSjOmrmOW6pgoKICAgIHZhciBzdWJtZW51V2lkdGggPSAkc3VibWVudS53aWR0aCgpOwogICAgdmFyIHN1Ym1lbnVIZWlnaHQgPSAkc3VibWVudS5oZWlnaHQoKTsgLy8g6Kem5Y+R5a2Q6I+c5Y2V55qE6I+c5Y2V6aG555qE5a695bqm6auY5bqmCgogICAgdmFyIGl0ZW1SZWN0ID0gJGl0ZW1bMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICB2YXIgaXRlbVdpZHRoID0gaXRlbVJlY3Qud2lkdGg7CiAgICB2YXIgaXRlbUhlaWdodCA9IGl0ZW1SZWN0LmhlaWdodDsKICAgIHZhciBpdGVtTGVmdCA9IGl0ZW1SZWN0LmxlZnQ7CiAgICB2YXIgaXRlbVRvcCA9IGl0ZW1SZWN0LnRvcDsgLy8g5Yik5pat6I+c5Y2V5LiK5LiL5L2N572uCgogICAgaWYgKHdpbmRvd0hlaWdodCAtIGl0ZW1Ub3AgPiBzdWJtZW51SGVpZ2h0KSB7CiAgICAgIC8vIOWIpOaWreS4i+aWueaYr+WQpuaUvuW+l+S4i+iPnOWNlQogICAgICBwb3NpdGlvbiA9ICdib3R0b20nOwogICAgfSBlbHNlIGlmIChpdGVtVG9wICsgaXRlbUhlaWdodCA+IHN1Ym1lbnVIZWlnaHQpIHsKICAgICAgLy8g5Yik5pat5LiK5pa55piv5ZCm5pS+5b6X5LiL6I+c5Y2VCiAgICAgIHBvc2l0aW9uID0gJ3RvcCc7CiAgICB9IGVsc2UgewogICAgICAvLyDpu5jorqTmlL7lnKjkuIvmlrkKICAgICAgcG9zaXRpb24gPSAnYm90dG9tJzsKICAgIH0gLy8g5Yik5pat6I+c5Y2V5bem5Y+z5L2N572uCgoKICAgIGlmICh3aW5kb3dXaWR0aCAtIGl0ZW1MZWZ0IC0gaXRlbVdpZHRoID4gc3VibWVudVdpZHRoKSB7CiAgICAgIC8vIOWIpOaWreWPs+S+p+aYr+WQpuaUvuW+l+S4i+iPnOWNlQogICAgICBhbGlnbiA9ICdsZWZ0JzsKICAgIH0gZWxzZSBpZiAoaXRlbUxlZnQgPiBzdWJtZW51V2lkdGgpIHsKICAgICAgLy8g5Yik5pat5bem5L6n5piv5ZCm5pS+5b6X5LiL6I+c5Y2VCiAgICAgIGFsaWduID0gJ3JpZ2h0JzsKICAgIH0gZWxzZSB7CiAgICAgIC8vIOm7mOiupOaUvuWcqOWPs+S+pwogICAgICBhbGlnbiA9ICdsZWZ0JzsKICAgIH0gLy8g6K6+572u6I+c5Y2V5L2N572uCgoKICAgIGlmIChwb3NpdGlvbiA9PT0gJ2JvdHRvbScpIHsKICAgICAgdHJhbnNmb3JtT3JpZ2luWSA9ICcwJzsKICAgICAgc3VibWVudVRvcCA9ICcwJzsKICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09ICd0b3AnKSB7CiAgICAgIHRyYW5zZm9ybU9yaWdpblkgPSAnMTAwJSc7CiAgICAgIHN1Ym1lbnVUb3AgPSAtc3VibWVudUhlaWdodCArIGl0ZW1IZWlnaHQ7CiAgICB9CgogICAgJHN1Ym1lbnUuY3NzKCd0b3AnLCBzdWJtZW51VG9wICsgInB4Iik7IC8vIOiuvue9ruiPnOWNleWvuem9kOaWueW8jwoKICAgIGlmIChhbGlnbiA9PT0gJ2xlZnQnKSB7CiAgICAgIHRyYW5zZm9ybU9yaWdpblggPSAnMCc7CiAgICAgIHN1Ym1lbnVMZWZ0ID0gaXRlbVdpZHRoOwogICAgfSBlbHNlIGlmIChhbGlnbiA9PT0gJ3JpZ2h0JykgewogICAgICB0cmFuc2Zvcm1PcmlnaW5YID0gJzEwMCUnOwogICAgICBzdWJtZW51TGVmdCA9IC1zdWJtZW51V2lkdGg7CiAgICB9CgogICAgJHN1Ym1lbnUuY3NzKCdsZWZ0Jywgc3VibWVudUxlZnQgKyAicHgiKTsgLy8g6K6+572u6I+c5Y2V5Yqo55S75pa55ZCRCgogICAgJHN1Ym1lbnUudHJhbnNmb3JtT3JpZ2luKHRyYW5zZm9ybU9yaWdpblggKyAiICIgKyB0cmFuc2Zvcm1PcmlnaW5ZKTsKICB9OwogIC8qKg0KICAgKiDmiZPlvIDlrZDoj5zljZUNCiAgICogQHBhcmFtICRzdWJtZW51DQogICAqLwoKCiAgTWVudS5wcm90b3R5cGUub3BlblN1Yk1lbnUgPSBmdW5jdGlvbiBvcGVuU3ViTWVudSgkc3VibWVudSkgewogICAgdGhpcy5yZWFkanVzdFN1Ym1lbnUoJHN1Ym1lbnUpOwogICAgJHN1Ym1lbnUuYWRkQ2xhc3MoJ21kdWktbWVudS1vcGVuJykucGFyZW50KCcubWR1aS1tZW51LWl0ZW0nKS5hZGRDbGFzcygnbWR1aS1tZW51LWl0ZW0tYWN0aXZlJyk7CiAgfTsKICAvKioNCiAgICog5YWz6Zet5a2Q6I+c5Y2V77yM5Y+K5YW25bWM5aWX55qE5a2Q6I+c5Y2VDQogICAqIEBwYXJhbSAkc3VibWVudQ0KICAgKi8KCgogIE1lbnUucHJvdG90eXBlLmNsb3NlU3ViTWVudSA9IGZ1bmN0aW9uIGNsb3NlU3ViTWVudSgkc3VibWVudSkgewogICAgLy8g5YWz6Zet5a2Q6I+c5Y2VCiAgICAkc3VibWVudS5yZW1vdmVDbGFzcygnbWR1aS1tZW51LW9wZW4nKS5hZGRDbGFzcygnbWR1aS1tZW51LWNsb3NpbmcnKS50cmFuc2l0aW9uRW5kKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICRzdWJtZW51LnJlbW92ZUNsYXNzKCdtZHVpLW1lbnUtY2xvc2luZycpOwogICAgfSkgLy8g56e76Zmk5r+A5rS754q25oCB55qE5qC35byPCiAgICAucGFyZW50KCcubWR1aS1tZW51LWl0ZW0nKS5yZW1vdmVDbGFzcygnbWR1aS1tZW51LWl0ZW0tYWN0aXZlJyk7IC8vIOW+queOr+WFs+mXreW1jOWll+eahOWtkOiPnOWNlQoKICAgICRzdWJtZW51LmZpbmQoJy5tZHVpLW1lbnUnKS5lYWNoKGZ1bmN0aW9uIChfLCBtZW51KSB7CiAgICAgIHZhciAkc3ViU3VibWVudSA9ICQobWVudSk7CiAgICAgICRzdWJTdWJtZW51LnJlbW92ZUNsYXNzKCdtZHVpLW1lbnUtb3BlbicpLmFkZENsYXNzKCdtZHVpLW1lbnUtY2xvc2luZycpLnRyYW5zaXRpb25FbmQoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiAkc3ViU3VibWVudS5yZW1vdmVDbGFzcygnbWR1aS1tZW51LWNsb3NpbmcnKTsKICAgICAgfSkucGFyZW50KCcubWR1aS1tZW51LWl0ZW0nKS5yZW1vdmVDbGFzcygnbWR1aS1tZW51LWl0ZW0tYWN0aXZlJyk7CiAgICB9KTsKICB9OwogIC8qKg0KICAgKiDliIfmjaLlrZDoj5zljZXnirbmgIENCiAgICogQHBhcmFtICRzdWJtZW51DQogICAqLwoKCiAgTWVudS5wcm90b3R5cGUudG9nZ2xlU3ViTWVudSA9IGZ1bmN0aW9uIHRvZ2dsZVN1Yk1lbnUoJHN1Ym1lbnUpIHsKICAgICRzdWJtZW51Lmhhc0NsYXNzKCdtZHVpLW1lbnUtb3BlbicpID8gdGhpcy5jbG9zZVN1Yk1lbnUoJHN1Ym1lbnUpIDogdGhpcy5vcGVuU3ViTWVudSgkc3VibWVudSk7CiAgfTsKICAvKioNCiAgICog57uR5a6a5a2Q6I+c5Y2V5LqL5Lu2DQogICAqLwoKCiAgTWVudS5wcm90b3R5cGUuYmluZFN1Yk1lbnVFdmVudCA9IGZ1bmN0aW9uIGJpbmRTdWJNZW51RXZlbnQoKSB7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXRoaXMtYWxpYXMKICAgIHZhciB0aGF0ID0gdGhpczsgLy8g54K55Ye75omT5byA5a2Q6I+c5Y2VCgogICAgdGhpcy4kZWxlbWVudC5vbignY2xpY2snLCAnLm1kdWktbWVudS1pdGVtJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHZhciAkaXRlbSA9ICQodGhpcyk7CiAgICAgIHZhciAkdGFyZ2V0ID0gJChldmVudC50YXJnZXQpOyAvLyDnpoHnlKjnirbmgIHoj5zljZXkuI3mk43kvZwKCiAgICAgIGlmICgkaXRlbS5hdHRyKCdkaXNhYmxlZCcpICE9PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8g5rKh5pyJ54K55Ye75Zyo5a2Q6I+c5Y2V55qE6I+c5Y2V6aG55LiK5pe277yM5LiN5pON5L2c77yI54K55Zyo5LqG5a2Q6I+c5Y2V55qE56m655m95Yy65Z+f44CB5oiW5YiG6ZqU57q/5LiK77yJCgoKICAgICAgaWYgKCR0YXJnZXQuaXMoJy5tZHVpLW1lbnUnKSB8fCAkdGFyZ2V0LmlzKCcubWR1aS1kaXZpZGVyJykpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8g6Zi75q2i5YaS5rOh77yM54K55Ye76I+c5Y2V6aG55pe25Y+q5Zyo5pyA5ZCO5LiA57qn55qEIG1kdWktbWVudS1pdGVtIOS4iueUn+aViO+8jOS4jeWQkeS4iuWGkuazoQoKCiAgICAgIGlmICghJHRhcmdldC5wYXJlbnRzKCcubWR1aS1tZW51LWl0ZW0nKS5maXJzdCgpLmlzKCRpdGVtKSkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyDlvZPliY3oj5zljZXnmoTlrZDoj5zljZUKCgogICAgICB2YXIgJHN1Ym1lbnUgPSAkaXRlbS5jaGlsZHJlbignLm1kdWktbWVudScpOyAvLyDlhYjlhbPpl63pmaTlvZPliY3lrZDoj5zljZXlpJbnmoTmiYDmnInlkIznuqflrZDoj5zljZUKCiAgICAgICRpdGVtLnBhcmVudCgnLm1kdWktbWVudScpLmNoaWxkcmVuKCcubWR1aS1tZW51LWl0ZW0nKS5lYWNoKGZ1bmN0aW9uIChfLCBpdGVtKSB7CiAgICAgICAgdmFyICR0bXBTdWJtZW51ID0gJChpdGVtKS5jaGlsZHJlbignLm1kdWktbWVudScpOwoKICAgICAgICBpZiAoJHRtcFN1Ym1lbnUubGVuZ3RoICYmICghJHN1Ym1lbnUubGVuZ3RoIHx8ICEkdG1wU3VibWVudS5pcygkc3VibWVudSkpKSB7CiAgICAgICAgICB0aGF0LmNsb3NlU3ViTWVudSgkdG1wU3VibWVudSk7CiAgICAgICAgfQogICAgICB9KTsgLy8g5YiH5o2i5b2T5YmN5a2Q6I+c5Y2VCgogICAgICBpZiAoJHN1Ym1lbnUubGVuZ3RoKSB7CiAgICAgICAgdGhhdC50b2dnbGVTdWJNZW51KCRzdWJtZW51KTsKICAgICAgfQogICAgfSk7CgogICAgaWYgKHRoaXMub3B0aW9ucy5zdWJNZW51VHJpZ2dlciA9PT0gJ2hvdmVyJykgewogICAgICAvLyDkuLTml7blrZjlgqggc2V0VGltZW91dCDlr7nosaEKICAgICAgdmFyIHRpbWVvdXQgPSBudWxsOwogICAgICB2YXIgdGltZW91dE9wZW4gPSBudWxsOwogICAgICB0aGlzLiRlbGVtZW50Lm9uKCdtb3VzZW92ZXIgbW91c2VvdXQnLCAnLm1kdWktbWVudS1pdGVtJywgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgdmFyICRpdGVtID0gJCh0aGlzKTsKICAgICAgICB2YXIgZXZlbnRUeXBlID0gZXZlbnQudHlwZTsKICAgICAgICB2YXIgJHJlbGF0ZWRUYXJnZXQgPSAkKGV2ZW50LnJlbGF0ZWRUYXJnZXQpOyAvLyDnpoHnlKjnirbmgIHnmoToj5zljZXkuI3mk43kvZwKCiAgICAgICAgaWYgKCRpdGVtLmF0dHIoJ2Rpc2FibGVkJykgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0gLy8g55SoIG1vdXNlb3ZlciDmqKHmi58gbW91c2VlbnRlcgoKCiAgICAgICAgaWYgKGV2ZW50VHlwZSA9PT0gJ21vdXNlb3ZlcicpIHsKICAgICAgICAgIGlmICghJGl0ZW0uaXMoJHJlbGF0ZWRUYXJnZXQpICYmIGNvbnRhaW5zKCRpdGVtWzBdLCAkcmVsYXRlZFRhcmdldFswXSkpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgIH0gLy8g55SoIG1vdXNlb3V0IOaooeaLnyBtb3VzZWxlYXZlCiAgICAgICAgZWxzZSBpZiAoZXZlbnRUeXBlID09PSAnbW91c2VvdXQnKSB7CiAgICAgICAgICAgIGlmICgkaXRlbS5pcygkcmVsYXRlZFRhcmdldCkgfHwgY29udGFpbnMoJGl0ZW1bMF0sICRyZWxhdGVkVGFyZ2V0WzBdKSkgewogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgfSAvLyDlvZPliY3oj5zljZXpobnkuIvnmoTlrZDoj5zljZXvvIzmnKrlv4XlrZjlnKgKCgogICAgICAgIHZhciAkc3VibWVudSA9ICRpdGVtLmNoaWxkcmVuKCcubWR1aS1tZW51Jyk7IC8vIOm8oOagh+enu+WFpeiPnOWNlemhueaXtu+8jOaYvuekuuiPnOWNlemhueS4i+eahOWtkOiPnOWNlQoKICAgICAgICBpZiAoZXZlbnRUeXBlID09PSAnbW91c2VvdmVyJykgewogICAgICAgICAgaWYgKCRzdWJtZW51Lmxlbmd0aCkgewogICAgICAgICAgICAvLyDlvZPliY3lrZDoj5zljZXlh4blpIfmiZPlvIDml7bvvIzlpoLmnpzlvZPliY3lrZDoj5zljZXmraPlh4blpIfnnYDlhbPpl63vvIzkuI3nlKjlho3lhbPpl63kuoYKICAgICAgICAgICAgdmFyIHRtcENsb3NlID0gJHN1Ym1lbnUuZGF0YSgndGltZW91dENsb3NlLm1kdWkubWVudScpOwoKICAgICAgICAgICAgaWYgKHRtcENsb3NlKSB7CiAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRtcENsb3NlKTsKICAgICAgICAgICAgfSAvLyDlpoLmnpzlvZPliY3lrZDoj5zljZXlt7Lnu4/miZPlvIDvvIzkuI3mk43kvZwKCgogICAgICAgICAgICBpZiAoJHN1Ym1lbnUuaGFzQ2xhc3MoJ21kdWktbWVudS1vcGVuJykpIHsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0gLy8g5b2T5YmN5a2Q6I+c5Y2V5YeG5aSH5omT5byA5pe277yM5YW25LuW5YeG5aSH5omT5byA55qE5a2Q6I+c5Y2V5LiN55So5YaN5omT5byA5LqGCgoKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRPcGVuKTsgLy8g5YeG5aSH5omT5byA5b2T5YmN5a2Q6I+c5Y2VCgogICAgICAgICAgICB0aW1lb3V0ID0gdGltZW91dE9wZW4gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gdGhhdC5vcGVuU3ViTWVudSgkc3VibWVudSk7CiAgICAgICAgICAgIH0sIHRoYXQub3B0aW9ucy5zdWJNZW51RGVsYXkpOwogICAgICAgICAgICAkc3VibWVudS5kYXRhKCd0aW1lb3V0T3Blbi5tZHVpLm1lbnUnLCB0aW1lb3V0KTsKICAgICAgICAgIH0KICAgICAgICB9IC8vIOm8oOagh+enu+WHuuiPnOWNlemhueaXtu+8jOWFs+mXreiPnOWNlemhueS4i+eahOWtkOiPnOWNlQogICAgICAgIGVsc2UgaWYgKGV2ZW50VHlwZSA9PT0gJ21vdXNlb3V0JykgewogICAgICAgICAgICBpZiAoJHN1Ym1lbnUubGVuZ3RoKSB7CiAgICAgICAgICAgICAgLy8g6byg5qCH56e75Ye66I+c5Y2V6aG55pe277yM5aaC5p6c5b2T5YmN6I+c5Y2V6aG55LiL55qE5a2Q6I+c5Y2V5q2j5YeG5aSH5omT5byA77yM5LiN55So5YaN5omT5byA5LqGCiAgICAgICAgICAgICAgdmFyIHRtcE9wZW4gPSAkc3VibWVudS5kYXRhKCd0aW1lb3V0T3Blbi5tZHVpLm1lbnUnKTsKCiAgICAgICAgICAgICAgaWYgKHRtcE9wZW4pIHsKICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0bXBPcGVuKTsKICAgICAgICAgICAgICB9IC8vIOWHhuWkh+WFs+mXreW9k+WJjeWtkOiPnOWNlQoKCiAgICAgICAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoYXQuY2xvc2VTdWJNZW51KCRzdWJtZW51KTsKICAgICAgICAgICAgICB9LCB0aGF0Lm9wdGlvbnMuc3ViTWVudURlbGF5KTsKICAgICAgICAgICAgICAkc3VibWVudS5kYXRhKCd0aW1lb3V0Q2xvc2UubWR1aS5tZW51JywgdGltZW91dCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfTsKICAvKioNCiAgICog5Yqo55S757uT5p2f5Zue6LCDDQogICAqLwoKCiAgTWVudS5wcm90b3R5cGUudHJhbnNpdGlvbkVuZCA9IGZ1bmN0aW9uIHRyYW5zaXRpb25FbmQoKSB7CiAgICB0aGlzLiRlbGVtZW50LnJlbW92ZUNsYXNzKCdtZHVpLW1lbnUtY2xvc2luZycpOwoKICAgIGlmICh0aGlzLnN0YXRlID09PSAnb3BlbmluZycpIHsKICAgICAgdGhpcy5zdGF0ZSA9ICdvcGVuZWQnOwogICAgICB0aGlzLnRyaWdnZXJFdmVudCgnb3BlbmVkJyk7CiAgICB9CgogICAgaWYgKHRoaXMuc3RhdGUgPT09ICdjbG9zaW5nJykgewogICAgICB0aGlzLnN0YXRlID0gJ2Nsb3NlZCc7CiAgICAgIHRoaXMudHJpZ2dlckV2ZW50KCdjbG9zZWQnKTsgLy8g5YWz6Zet5ZCO77yM5oGi5aSN6I+c5Y2V5qC35byP5Yiw6buY6K6k54q25oCB77yM5bm25oGi5aSNIGZpeGVkIOWumuS9jQoKICAgICAgdGhpcy4kZWxlbWVudC5jc3MoewogICAgICAgIHRvcDogJycsCiAgICAgICAgbGVmdDogJycsCiAgICAgICAgd2lkdGg6ICcnLAogICAgICAgIHBvc2l0aW9uOiAnZml4ZWQnCiAgICAgIH0pOwogICAgfQogIH07CiAgLyoqDQogICAqIOWIh+aNouiPnOWNleeKtuaAgQ0KICAgKi8KCgogIE1lbnUucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uIHRvZ2dsZSgpIHsKICAgIHRoaXMuaXNPcGVuKCkgPyB0aGlzLmNsb3NlKCkgOiB0aGlzLm9wZW4oKTsKICB9OwogIC8qKg0KICAgKiDmiZPlvIDoj5zljZUNCiAgICovCgoKICBNZW51LnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gb3BlbigpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwoKICAgIGlmICh0aGlzLmlzT3BlbigpKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLnN0YXRlID0gJ29wZW5pbmcnOwogICAgdGhpcy50cmlnZ2VyRXZlbnQoJ29wZW4nKTsKICAgIHRoaXMucmVhZGp1c3QoKTsKICAgIHRoaXMuJGVsZW1lbnQgLy8g6I+c5Y2V6ZqQ6JeP54q25oCB5L2/55So5L2/55SoIGZpeGVkIOWumuS9jeOAggogICAgLmNzcygncG9zaXRpb24nLCB0aGlzLm9wdGlvbnMuZml4ZWQgPyAnZml4ZWQnIDogJ2Fic29sdXRlJykuYWRkQ2xhc3MoJ21kdWktbWVudS1vcGVuJykudHJhbnNpdGlvbkVuZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzJDEudHJhbnNpdGlvbkVuZCgpOwogICAgfSk7CiAgfTsKICAvKioNCiAgICog5YWz6Zet6I+c5Y2VDQogICAqLwoKCiAgTWVudS5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiBjbG9zZSgpIHsKICAgIHZhciB0aGlzJDEgPSB0aGlzOwoKICAgIGlmICghdGhpcy5pc09wZW4oKSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5zdGF0ZSA9ICdjbG9zaW5nJzsKICAgIHRoaXMudHJpZ2dlckV2ZW50KCdjbG9zZScpOyAvLyDoj5zljZXlvIDlp4vlhbPpl63ml7bvvIzlhbPpl63miYDmnInlrZDoj5zljZUKCiAgICB0aGlzLiRlbGVtZW50LmZpbmQoJy5tZHVpLW1lbnUnKS5lYWNoKGZ1bmN0aW9uIChfLCBzdWJtZW51KSB7CiAgICAgIHRoaXMkMS5jbG9zZVN1Yk1lbnUoJChzdWJtZW51KSk7CiAgICB9KTsKICAgIHRoaXMuJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ21kdWktbWVudS1vcGVuJykuYWRkQ2xhc3MoJ21kdWktbWVudS1jbG9zaW5nJykudHJhbnNpdGlvbkVuZChmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzJDEudHJhbnNpdGlvbkVuZCgpOwogICAgfSk7CiAgfTsKCiAgbWR1aS5NZW51ID0gTWVudTsKICB2YXIgY3VzdG9tQXR0ciQ5ID0gJ21kdWktbWVudSc7CiAgdmFyIGRhdGFOYW1lJDMgPSAnX21kdWlfbWVudSc7CiAgJChmdW5jdGlvbiAoKSB7CiAgICAkZG9jdW1lbnQub24oJ2NsaWNrJywgIlsiICsgY3VzdG9tQXR0ciQ5ICsgIl0iLCBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7CiAgICAgIHZhciBpbnN0YW5jZSA9ICR0aGlzLmRhdGEoZGF0YU5hbWUkMyk7CgogICAgICBpZiAoIWluc3RhbmNlKSB7CiAgICAgICAgdmFyIG9wdGlvbnMgPSBwYXJzZU9wdGlvbnModGhpcywgY3VzdG9tQXR0ciQ5KTsKICAgICAgICB2YXIgbWVudVNlbGVjdG9yID0gb3B0aW9ucy50YXJnZXQ7IC8vIEB0cy1pZ25vcmUKCiAgICAgICAgZGVsZXRlIG9wdGlvbnMudGFyZ2V0OwogICAgICAgIGluc3RhbmNlID0gbmV3IG1kdWkuTWVudSgkdGhpcywgbWVudVNlbGVjdG9yLCBvcHRpb25zKTsKICAgICAgICAkdGhpcy5kYXRhKGRhdGFOYW1lJDMsIGluc3RhbmNlKTsKICAgICAgICBpbnN0YW5jZS50b2dnbGUoKTsKICAgICAgfQogICAgfSk7CiAgfSk7CiAgcmV0dXJuIG1kdWk7Cn0pOw=="},{"version":3,"sources":["../../node_modules/mdn-polyfills/MouseEvent.js","../../node_modules/mdn-polyfills/CustomEvent.js","../../node_modules/promise-polyfill/src/finally.js","../../node_modules/promise-polyfill/src/allSettled.js","../../node_modules/promise-polyfill/src/index.js","../../node_modules/promise-polyfill/src/polyfill.js","../../node_modules/mdui.jq/es/utils.js","../../node_modules/mdui.jq/es/functions/each.js","../../node_modules/mdui.jq/es/JQ.js","../../node_modules/mdui.jq/es/$.js","../../src/mdui.ts","../../node_modules/mdui.jq/es/methods/each.js","../../node_modules/mdui.jq/es/functions/contains.js","../../node_modules/mdui.jq/es/functions/merge.js","../../node_modules/mdui.jq/es/methods/get.js","../../node_modules/mdui.jq/es/methods/find.js","../../node_modules/mdui.jq/es/methods/utils/event.js","../../node_modules/mdui.jq/es/methods/trigger.js","../../node_modules/mdui.jq/es/functions/extend.js","../../node_modules/mdui.jq/es/functions/param.js","../../node_modules/mdui.jq/es/functions/utils/ajax.js","../../node_modules/mdui.jq/es/functions/ajax.js","../../node_modules/mdui.jq/es/static/ajax.js","../../node_modules/mdui.jq/es/functions/ajaxSetup.js","../../node_modules/mdui.jq/es/static/ajaxSetup.js","../../node_modules/mdui.jq/es/static/contains.js","../../node_modules/mdui.jq/es/functions/utils/data.js","../../node_modules/mdui.jq/es/functions/data.js","../../node_modules/mdui.jq/es/static/data.js","../../node_modules/mdui.jq/es/static/each.js","../../node_modules/mdui.jq/es/static/extend.js","../../node_modules/mdui.jq/es/functions/map.js","../../node_modules/mdui.jq/es/static/map.js","../../node_modules/mdui.jq/es/static/merge.js","../../node_modules/mdui.jq/es/static/param.js","../../node_modules/mdui.jq/es/functions/removeData.js","../../node_modules/mdui.jq/es/static/removeData.js","../../node_modules/mdui.jq/es/functions/unique.js","../../node_modules/mdui.jq/es/static/unique.js","../../node_modules/mdui.jq/es/methods/add.js","../../node_modules/mdui.jq/es/methods/addClass.js","../../node_modules/mdui.jq/es/methods/insertBefore.js","../../node_modules/mdui.jq/es/methods/before.js","../../node_modules/mdui.jq/es/methods/off.js","../../node_modules/mdui.jq/es/methods/on.js","../../node_modules/mdui.jq/es/methods/ajaxStart.js","../../node_modules/mdui.jq/es/methods/map.js","../../node_modules/mdui.jq/es/methods/clone.js","../../node_modules/mdui.jq/es/methods/is.js","../../node_modules/mdui.jq/es/methods/remove.js","../../node_modules/mdui.jq/es/methods/append.js","../../node_modules/mdui.jq/es/methods/appendTo.js","../../node_modules/mdui.jq/es/methods/attr.js","../../node_modules/mdui.jq/es/methods/children.js","../../node_modules/mdui.jq/es/methods/slice.js","../../node_modules/mdui.jq/es/methods/eq.js","../../node_modules/mdui.jq/es/methods/utils/dir.js","../../node_modules/mdui.jq/es/methods/parent.js","../../node_modules/mdui.jq/es/methods/closest.js","../../node_modules/mdui.jq/es/methods/data.js","../../node_modules/mdui.jq/es/methods/empty.js","../../node_modules/mdui.jq/es/methods/extend.js","../../node_modules/mdui.jq/es/methods/filter.js","../../node_modules/mdui.jq/es/methods/first.js","../../node_modules/mdui.jq/es/methods/has.js","../../node_modules/mdui.jq/es/methods/hasClass.js","../../node_modules/mdui.jq/es/methods/width.js","../../node_modules/mdui.jq/es/methods/hide.js","../../node_modules/mdui.jq/es/methods/val.js","../../node_modules/mdui.jq/es/methods/index.js","../../node_modules/mdui.jq/es/methods/last.js","../../node_modules/mdui.jq/es/methods/next.js","../../node_modules/mdui.jq/es/methods/not.js","../../node_modules/mdui.jq/es/methods/offsetParent.js","../../node_modules/mdui.jq/es/methods/position.js","../../node_modules/mdui.jq/es/methods/offset.js","../../node_modules/mdui.jq/es/methods/one.js","../../node_modules/mdui.jq/es/methods/prev.js","../../node_modules/mdui.jq/es/methods/removeAttr.js","../../node_modules/mdui.jq/es/methods/removeData.js","../../node_modules/mdui.jq/es/methods/removeProp.js","../../node_modules/mdui.jq/es/methods/replaceWith.js","../../node_modules/mdui.jq/es/methods/replaceAll.js","../../node_modules/mdui.jq/es/methods/serializeArray.js","../../node_modules/mdui.jq/es/methods/serialize.js","../../node_modules/mdui.jq/es/methods/show.js","../../node_modules/mdui.jq/es/methods/siblings.js","../../node_modules/mdui.jq/es/methods/toggle.js","../../src/jq_extends/methods/reflow.ts","../../src/jq_extends/methods/transition.ts","../../src/jq_extends/methods/transitionEnd.ts","../../src/jq_extends/methods/transformOrigin.ts","../../src/jq_extends/methods/transform.ts","../../src/utils/mutation.ts","../../src/jq_extends/methods/mutation.ts","../../src/jq_extends/static/showOverlay.ts","../../src/jq_extends/static/hideOverlay.ts","../../src/jq_extends/static/lockScreen.ts","../../src/jq_extends/static/unlockScreen.ts","../../src/jq_extends/static/throttle.ts","../../src/jq_extends/static/guid.ts","../../src/global/mutation.ts","../../src/utils/componentEvent.ts","../../src/utils/dom.ts","../../src/components/headroom/index.ts","../../src/utils/parseOptions.ts","../../src/components/headroom/customAttr.ts","../../src/components/collapse/collapseAbstract.ts","../../src/components/collapse/index.ts","../../src/components/collapse/customAttr.ts","../../src/components/panel/index.ts","../../src/components/panel/customAttr.ts","../../src/components/table/index.ts","../../src/utils/touchHandler.ts","../../src/components/ripple/index.ts","../../src/components/textfield/index.ts","../../src/components/slider/index.ts","../../src/components/fab/index.ts","../../src/components/fab/customAttr.ts","../../src/components/select/index.ts","../../src/components/select/customAttr.ts","../../src/components/appbar/index.ts","../../src/components/tab/index.ts","../../src/components/tab/customAttr.ts","../../src/components/drawer/index.ts","../../src/components/drawer/customAttr.ts","../../src/utils/queue.ts","../../src/components/dialog/class.ts","../../src/components/dialog/index.ts","../../src/components/dialog/customAttr.ts","../../src/components/dialog/dialog.ts","../../src/components/dialog/alert.ts","../../src/components/dialog/confirm.ts","../../src/components/dialog/prompt.ts","../../src/components/tooltip/index.ts","../../src/components/tooltip/customAttr.ts","../../src/components/snackbar/index.ts","../../src/components/bottom_nav/index.ts","../../src/components/progress/spinner.ts","../../src/components/menu/index.ts","../../src/components/menu/customAttr.ts"],"names":["e","Promise","promiseFinally","const","let","i","this","get","set","DEFAULT_OPTIONS","customAttr","dataName","currentInst","queueName"],"mappings":"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","sourcesContent":["!function(){try{return new MouseEvent(\"test\")}catch(e){}var e=function(e,t){t=t||{bubbles:!1,cancelable:!1};var n=document.createEvent(\"MouseEvent\");return n.initMouseEvent(e,t.bubbles,t.cancelable,window,0,t.screenX||0,t.screenY||0,t.clientX||0,t.clientY||0,t.ctrlKey||!1,t.altKey||!1,t.shiftKey||!1,t.metaKey||!1,t.button||0,t.relatedTarget||null),n};e.prototype=Event.prototype,window.MouseEvent=e}();\n","!function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent(\"CustomEvent\");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}\"function\"!=typeof window.CustomEvent&&(t.prototype=window.Event.prototype,window.CustomEvent=t)}();\n","/**\n * @this {Promise}\n */\nfunction finallyConstructor(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      // @ts-ignore\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      // @ts-ignore\n      return constructor.resolve(callback()).then(function() {\n        // @ts-ignore\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\nexport default finallyConstructor;\n","function allSettled(arr) {\n  var P = this;\n  return new P(function(resolve, reject) {\n    if (!(arr && typeof arr.length !== 'undefined')) {\n      return reject(\n        new TypeError(\n          typeof arr +\n            ' ' +\n            arr +\n            ' is not iterable(cannot read property Symbol(Symbol.iterator))'\n        )\n      );\n    }\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      if (val && (typeof val === 'object' || typeof val === 'function')) {\n        var then = val.then;\n        if (typeof then === 'function') {\n          then.call(\n            val,\n            function(val) {\n              res(i, val);\n            },\n            function(e) {\n              args[i] = { status: 'rejected', reason: e };\n              if (--remaining === 0) {\n                resolve(args);\n              }\n            }\n          );\n          return;\n        }\n      }\n      args[i] = { status: 'fulfilled', value: val };\n      if (--remaining === 0) {\n        resolve(args);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n}\n\nexport default allSettled;\n","import promiseFinally from './finally';\nimport allSettled from './allSettled';\n\n// Store setTimeout reference so promise-polyfill will be unaffected by\n// other code modifying setTimeout (like sinon.useFakeTimers())\nvar setTimeoutFunc = setTimeout;\n\nfunction isArray(x) {\n  return Boolean(x && typeof x.length !== 'undefined');\n}\n\nfunction noop() {}\n\n// Polyfill for Function.prototype.bind\nfunction bind(fn, thisArg) {\n  return function() {\n    fn.apply(thisArg, arguments);\n  };\n}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError('Promises must be constructed via new');\n  if (typeof fn !== 'function') throw new TypeError('not a function');\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError('A promise cannot be resolved with itself.');\n    if (\n      newValue &&\n      (typeof newValue === 'object' || typeof newValue === 'function')\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === 'function') {\n        doResolve(bind(then, newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) return;\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) return;\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) return;\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype['catch'] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype['finally'] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!isArray(arr)) {\n      return reject(new TypeError('Promise.all accepts an array'));\n    }\n\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === 'object' || typeof val === 'function')) {\n          var then = val.then;\n          if (typeof then === 'function') {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.allSettled = allSettled;\n\nPromise.resolve = function(value) {\n  if (value && typeof value === 'object' && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!isArray(arr)) {\n      return reject(new TypeError('Promise.race accepts an array'));\n    }\n\n    for (var i = 0, len = arr.length; i < len; i++) {\n      Promise.resolve(arr[i]).then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn =\n  // @ts-ignore\n  (typeof setImmediate === 'function' &&\n    function(fn) {\n      // @ts-ignore\n      setImmediate(fn);\n    }) ||\n  function(fn) {\n    setTimeoutFunc(fn, 0);\n  };\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n  if (typeof console !== 'undefined' && console) {\n    console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n  }\n};\n\nexport default Promise;\n","import Promise from './index';\nimport promiseFinally from './finally';\nimport allSettled from './allSettled';\n\n/** @suppress {undefinedVars} */\nvar globalNS = (function() {\n  // the only reliable means to get the global object is\n  // `Function('return this')()`\n  // However, this causes CSP violations in Chrome apps.\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  throw new Error('unable to locate global object');\n})();\n\n// Expose the polyfill if Promise is undefined or set to a\n// non-function value. The latter can be due to a named HTMLElement\n// being exposed by browsers for legacy reasons.\n// https://github.com/taylorhakes/promise-polyfill/issues/114\nif (typeof globalNS['Promise'] !== 'function') {\n  globalNS['Promise'] = Promise;\n} else if (!globalNS.Promise.prototype['finally']) {\n  globalNS.Promise.prototype['finally'] = promiseFinally;\n} else if (!globalNS.Promise.allSettled) {\n  globalNS.Promise.allSettled = allSettled;\n}\n","function isNodeName(element, name) {\n    return element.nodeName.toLowerCase() === name.toLowerCase();\n}\nfunction isFunction(target) {\n    return typeof target === 'function';\n}\nfunction isString(target) {\n    return typeof target === 'string';\n}\nfunction isNumber(target) {\n    return typeof target === 'number';\n}\nfunction isBoolean(target) {\n    return typeof target === 'boolean';\n}\nfunction isUndefined(target) {\n    return typeof target === 'undefined';\n}\nfunction isNull(target) {\n    return target === null;\n}\nfunction isWindow(target) {\n    return target instanceof Window;\n}\nfunction isDocument(target) {\n    return target instanceof Document;\n}\nfunction isElement(target) {\n    return target instanceof Element;\n}\nfunction isNode(target) {\n    return target instanceof Node;\n}\n/**\n * 是否是 IE 浏览器\n */\nfunction isIE() {\n    // @ts-ignore\n    return !!window.document.documentMode;\n}\nfunction isArrayLike(target) {\n    if (isFunction(target) || isWindow(target)) {\n        return false;\n    }\n    return isNumber(target.length);\n}\nfunction isObjectLike(target) {\n    return typeof target === 'object' && target !== null;\n}\nfunction toElement(target) {\n    return isDocument(target) ? target.documentElement : target;\n}\n/**\n * 把用 - 分隔的字符串转为驼峰（如 box-sizing 转换为 boxSizing）\n * @param string\n */\nfunction toCamelCase(string) {\n    return string\n        .replace(/^-ms-/, 'ms-')\n        .replace(/-([a-z])/g, (_, letter) => letter.toUpperCase());\n}\n/**\n * 把驼峰法转为用 - 分隔的字符串（如 boxSizing 转换为 box-sizing）\n * @param string\n */\nfunction toKebabCase(string) {\n    return string.replace(/[A-Z]/g, (replacer) => '-' + replacer.toLowerCase());\n}\n/**\n * 获取元素的样式值\n * @param element\n * @param name\n */\nfunction getComputedStyleValue(element, name) {\n    return window.getComputedStyle(element).getPropertyValue(toKebabCase(name));\n}\n/**\n * 检查元素的 box-sizing 是否是 border-box\n * @param element\n */\nfunction isBorderBox(element) {\n    return getComputedStyleValue(element, 'box-sizing') === 'border-box';\n}\n/**\n * 获取元素的 padding, border, margin 宽度（两侧宽度的和，单位为px）\n * @param element\n * @param direction\n * @param extra\n */\nfunction getExtraWidth(element, direction, extra) {\n    const position = direction === 'width' ? ['Left', 'Right'] : ['Top', 'Bottom'];\n    return [0, 1].reduce((prev, _, index) => {\n        let prop = extra + position[index];\n        if (extra === 'border') {\n            prop += 'Width';\n        }\n        return prev + parseFloat(getComputedStyleValue(element, prop) || '0');\n    }, 0);\n}\n/**\n * 获取元素的样式值，对 width 和 height 进行过处理\n * @param element\n * @param name\n */\nfunction getStyle(element, name) {\n    // width、height 属性使用 getComputedStyle 得到的值不准确，需要使用 getBoundingClientRect 获取\n    if (name === 'width' || name === 'height') {\n        const valueNumber = element.getBoundingClientRect()[name];\n        if (isBorderBox(element)) {\n            return `${valueNumber}px`;\n        }\n        return `${valueNumber -\n            getExtraWidth(element, name, 'border') -\n            getExtraWidth(element, name, 'padding')}px`;\n    }\n    return getComputedStyleValue(element, name);\n}\n/**\n * 获取子节点组成的数组\n * @param target\n * @param parent\n */\nfunction getChildNodesArray(target, parent) {\n    const tempParent = document.createElement(parent);\n    tempParent.innerHTML = target;\n    return [].slice.call(tempParent.childNodes);\n}\n/**\n * 始终返回 false 的函数\n */\nfunction returnFalse() {\n    return false;\n}\n/**\n * 数值单位的 CSS 属性\n */\nconst cssNumber = [\n    'animationIterationCount',\n    'columnCount',\n    'fillOpacity',\n    'flexGrow',\n    'flexShrink',\n    'fontWeight',\n    'gridArea',\n    'gridColumn',\n    'gridColumnEnd',\n    'gridColumnStart',\n    'gridRow',\n    'gridRowEnd',\n    'gridRowStart',\n    'lineHeight',\n    'opacity',\n    'order',\n    'orphans',\n    'widows',\n    'zIndex',\n    'zoom',\n];\nexport { isNodeName, isArrayLike, isObjectLike, isFunction, isString, isNumber, isBoolean, isUndefined, isNull, isWindow, isDocument, isElement, isNode, isIE, toElement, toCamelCase, toKebabCase, getComputedStyleValue, isBorderBox, getExtraWidth, getStyle, getChildNodesArray, returnFalse, cssNumber, };\n","import { isArrayLike } from '../utils';\nfunction each(target, callback) {\n    if (isArrayLike(target)) {\n        for (let i = 0; i < target.length; i += 1) {\n            if (callback.call(target[i], i, target[i]) === false) {\n                return target;\n            }\n        }\n    }\n    else {\n        const keys = Object.keys(target);\n        for (let i = 0; i < keys.length; i += 1) {\n            if (callback.call(target[keys[i]], keys[i], target[keys[i]]) === false) {\n                return target;\n            }\n        }\n    }\n    return target;\n}\nexport default each;\n","import each from './functions/each';\n/**\n * 为了使用模块扩充，这里不能使用默认导出\n */\nexport class JQ {\n    constructor(arr) {\n        this.length = 0;\n        if (!arr) {\n            return this;\n        }\n        each(arr, (i, item) => {\n            // @ts-ignore\n            this[i] = item;\n        });\n        this.length = arr.length;\n        return this;\n    }\n}\n","import each from './functions/each';\nimport { JQ } from './JQ';\nimport { getChildNodesArray, isArrayLike, isFunction, isNode, isString, } from './utils';\nfunction get$() {\n    const $ = function (selector) {\n        if (!selector) {\n            return new JQ();\n        }\n        // JQ\n        if (selector instanceof JQ) {\n            return selector;\n        }\n        // function\n        if (isFunction(selector)) {\n            if (/complete|loaded|interactive/.test(document.readyState) &&\n                document.body) {\n                selector.call(document, $);\n            }\n            else {\n                document.addEventListener('DOMContentLoaded', () => selector.call(document, $), false);\n            }\n            return new JQ([document]);\n        }\n        // String\n        if (isString(selector)) {\n            const html = selector.trim();\n            // 根据 HTML 字符串创建 JQ 对象\n            if (html[0] === '<' && html[html.length - 1] === '>') {\n                let toCreate = 'div';\n                const tags = {\n                    li: 'ul',\n                    tr: 'tbody',\n                    td: 'tr',\n                    th: 'tr',\n                    tbody: 'table',\n                    option: 'select',\n                };\n                each(tags, (childTag, parentTag) => {\n                    if (html.indexOf(`<${childTag}`) === 0) {\n                        toCreate = parentTag;\n                        return false;\n                    }\n                    return;\n                });\n                return new JQ(getChildNodesArray(html, toCreate));\n            }\n            // 根据 CSS 选择器创建 JQ 对象\n            const isIdSelector = selector[0] === '#' && !selector.match(/[ .<>:~]/);\n            if (!isIdSelector) {\n                return new JQ(document.querySelectorAll(selector));\n            }\n            const element = document.getElementById(selector.slice(1));\n            if (element) {\n                return new JQ([element]);\n            }\n            return new JQ();\n        }\n        if (isArrayLike(selector) && !isNode(selector)) {\n            return new JQ(selector);\n        }\n        return new JQ([selector]);\n    };\n    $.fn = JQ.prototype;\n    return $;\n}\nconst $ = get$();\nexport default $;\n","import { MduiStatic } from './interfaces/MduiStatic';\nimport $ from 'mdui.jq/es/$';\n\n// 避免页面加载完后直接执行css动画\n// https://css-tricks.com/transitions-only-after-page-load/\nsetTimeout(() => $('body').addClass('mdui-loaded'));\n\nconst mdui = {\n  $: $,\n} as MduiStatic;\n\nexport default mdui;\n","import $ from '../$';\nimport each from '../functions/each';\n$.fn.each = function (callback) {\n    return each(this, callback);\n};\n","import { toElement } from '../utils';\n/**\n * 检查 container 元素内是否包含 contains 元素\n * @param container 父元素\n * @param contains 子元素\n * @example\n```js\ncontains( document, document.body ); // true\ncontains( document.getElementById('test'), document ); // false\ncontains( $('.container').get(0), $('.contains').get(0) ); // false\n```\n */\nfunction contains(container, contains) {\n    return container !== contains && toElement(container).contains(contains);\n}\nexport default contains;\n","import each from './each';\n/**\n * 把第二个数组的元素追加到第一个数组中，并返回合并后的数组\n * @param first 第一个数组\n * @param second 该数组的元素将被追加到第一个数组中\n * @example\n```js\nmerge( [ 0, 1, 2 ], [ 2, 3, 4 ] )\n// [ 0, 1, 2, 2, 3, 4 ]\n```\n */\nfunction merge(first, second) {\n    each(second, (_, value) => {\n        first.push(value);\n    });\n    return first;\n}\nexport default merge;\n","import $ from '../$';\n$.fn.get = function (index) {\n    return index === undefined\n        ? [].slice.call(this)\n        : this[index >= 0 ? index : index + this.length];\n};\n","import $ from '../$';\nimport merge from '../functions/merge';\nimport { JQ } from '../JQ';\nimport './each';\nimport './get';\n$.fn.find = function (selector) {\n    const foundElements = [];\n    this.each((_, element) => {\n        merge(foundElements, $(element.querySelectorAll(selector)).get());\n    });\n    return new JQ(foundElements);\n};\n","import $ from '../../$';\nimport contains from '../../functions/contains';\nimport { isObjectLike } from '../../utils';\nimport '../find';\n// 存储事件\nconst handlers = {};\n// 元素ID\nlet mduiElementId = 1;\n/**\n * 为元素赋予一个唯一的ID\n */\nfunction getElementId(element) {\n    const key = '_mduiEventId';\n    // @ts-ignore\n    if (!element[key]) {\n        // @ts-ignore\n        element[key] = ++mduiElementId;\n    }\n    // @ts-ignore\n    return element[key];\n}\n/**\n * 解析事件名中的命名空间\n */\nfunction parse(type) {\n    const parts = type.split('.');\n    return {\n        type: parts[0],\n        ns: parts.slice(1).sort().join(' '),\n    };\n}\n/**\n * 命名空间匹配规则\n */\nfunction matcherFor(ns) {\n    return new RegExp('(?:^| )' + ns.replace(' ', ' .* ?') + '(?: |$)');\n}\n/**\n * 获取匹配的事件\n * @param element\n * @param type\n * @param func\n * @param selector\n */\nfunction getHandlers(element, type, func, selector) {\n    const event = parse(type);\n    return (handlers[getElementId(element)] || []).filter((handler) => handler &&\n        (!event.type || handler.type === event.type) &&\n        (!event.ns || matcherFor(event.ns).test(handler.ns)) &&\n        (!func || getElementId(handler.func) === getElementId(func)) &&\n        (!selector || handler.selector === selector));\n}\n/**\n * 添加事件监听\n * @param element\n * @param types\n * @param func\n * @param data\n * @param selector\n */\nfunction add(element, types, func, data, selector) {\n    const elementId = getElementId(element);\n    if (!handlers[elementId]) {\n        handlers[elementId] = [];\n    }\n    // 传入 data.useCapture 来设置 useCapture: true\n    let useCapture = false;\n    if (isObjectLike(data) && data.useCapture) {\n        useCapture = true;\n    }\n    types.split(' ').forEach((type) => {\n        if (!type) {\n            return;\n        }\n        const event = parse(type);\n        function callFn(e, elem) {\n            // 因为鼠标事件模拟事件的 detail 属性是只读的，因此在 e._detail 中存储参数\n            const result = func.apply(elem, \n            // @ts-ignore\n            e._detail === undefined ? [e] : [e].concat(e._detail));\n            if (result === false) {\n                e.preventDefault();\n                e.stopPropagation();\n            }\n        }\n        function proxyFn(e) {\n            // @ts-ignore\n            if (e._ns && !matcherFor(e._ns).test(event.ns)) {\n                return;\n            }\n            // @ts-ignore\n            e._data = data;\n            if (selector) {\n                // 事件代理\n                $(element)\n                    .find(selector)\n                    .get()\n                    .reverse()\n                    .forEach((elem) => {\n                    if (elem === e.target ||\n                        contains(elem, e.target)) {\n                        callFn(e, elem);\n                    }\n                });\n            }\n            else {\n                // 不使用事件代理\n                callFn(e, element);\n            }\n        }\n        const handler = {\n            type: event.type,\n            ns: event.ns,\n            func,\n            selector,\n            id: handlers[elementId].length,\n            proxy: proxyFn,\n        };\n        handlers[elementId].push(handler);\n        element.addEventListener(handler.type, proxyFn, useCapture);\n    });\n}\n/**\n * 移除事件监听\n * @param element\n * @param types\n * @param func\n * @param selector\n */\nfunction remove(element, types, func, selector) {\n    const handlersInElement = handlers[getElementId(element)] || [];\n    const removeEvent = (handler) => {\n        delete handlersInElement[handler.id];\n        element.removeEventListener(handler.type, handler.proxy, false);\n    };\n    if (!types) {\n        handlersInElement.forEach((handler) => removeEvent(handler));\n    }\n    else {\n        types.split(' ').forEach((type) => {\n            if (type) {\n                getHandlers(element, type, func, selector).forEach((handler) => removeEvent(handler));\n            }\n        });\n    }\n}\nexport { parse, add, remove };\n","import $ from '../$';\nimport './each';\nimport { parse } from './utils/event';\n$.fn.trigger = function (type, extraParameters) {\n    const event = parse(type);\n    let eventObject;\n    const eventParams = {\n        bubbles: true,\n        cancelable: true,\n    };\n    const isMouseEvent = ['click', 'mousedown', 'mouseup', 'mousemove'].indexOf(event.type) > -1;\n    if (isMouseEvent) {\n        // Note: MouseEvent 无法传入 detail 参数\n        eventObject = new MouseEvent(event.type, eventParams);\n    }\n    else {\n        eventParams.detail = extraParameters;\n        eventObject = new CustomEvent(event.type, eventParams);\n    }\n    // @ts-ignore\n    eventObject._detail = extraParameters;\n    // @ts-ignore\n    eventObject._ns = event.ns;\n    return this.each(function () {\n        this.dispatchEvent(eventObject);\n    });\n};\n","import each from '../functions/each';\nimport { isUndefined } from '../utils';\nfunction extend(target, object1, ...objectN) {\n    objectN.unshift(object1);\n    each(objectN, (_, object) => {\n        each(object, (prop, value) => {\n            if (!isUndefined(value)) {\n                target[prop] = value;\n            }\n        });\n    });\n    return target;\n}\nexport default extend;\n","import { isObjectLike } from '../utils';\nimport each from './each';\n/**\n * 将数组或对象序列化，序列化后的字符串可作为 URL 查询字符串使用\n *\n * 若传入数组，则格式必须和 serializeArray 方法的返回值一样\n * @param obj 对象或数组\n * @example\n```js\nparam({ width: 1680, height: 1050 });\n// width=1680&height=1050\n```\n * @example\n```js\nparam({ foo: { one: 1, two: 2 }})\n// foo[one]=1&foo[two]=2\n```\n * @example\n```js\nparam({ids: [1, 2, 3]})\n// ids[]=1&ids[]=2&ids[]=3\n```\n * @example\n```js\nparam([\n  {\"name\":\"name\",\"value\":\"mdui\"},\n  {\"name\":\"password\",\"value\":\"123456\"}\n])\n// name=mdui&password=123456\n```\n */\nfunction param(obj) {\n    if (!isObjectLike(obj) && !Array.isArray(obj)) {\n        return '';\n    }\n    const args = [];\n    function destructure(key, value) {\n        let keyTmp;\n        if (isObjectLike(value)) {\n            each(value, (i, v) => {\n                if (Array.isArray(value) && !isObjectLike(v)) {\n                    keyTmp = '';\n                }\n                else {\n                    keyTmp = i;\n                }\n                destructure(`${key}[${keyTmp}]`, v);\n            });\n        }\n        else {\n            if (value == null || value === '') {\n                keyTmp = '=';\n            }\n            else {\n                keyTmp = `=${encodeURIComponent(value)}`;\n            }\n            args.push(encodeURIComponent(key) + keyTmp);\n        }\n    }\n    if (Array.isArray(obj)) {\n        each(obj, function () {\n            destructure(this.name, this.value);\n        });\n    }\n    else {\n        each(obj, destructure);\n    }\n    return args.join('&');\n}\nexport default param;\n","// 全局配置参数\nconst globalOptions = {};\n// 全局事件名\nconst ajaxEvents = {\n    ajaxStart: 'start.mdui.ajax',\n    ajaxSuccess: 'success.mdui.ajax',\n    ajaxError: 'error.mdui.ajax',\n    ajaxComplete: 'complete.mdui.ajax',\n};\nexport { globalOptions, ajaxEvents };\n","import $ from '../$';\nimport '../methods/trigger';\nimport { isString, isUndefined } from '../utils';\nimport each from './each';\nimport extend from './extend';\nimport param from './param';\nimport { ajaxEvents, globalOptions } from './utils/ajax';\n/**\n * 判断此请求方法是否通过查询字符串提交参数\n * @param method 请求方法，大写\n */\nfunction isQueryStringData(method) {\n    return ['GET', 'HEAD'].indexOf(method) >= 0;\n}\n/**\n * 添加参数到 URL 上，且 URL 中不存在 ? 时，自动把第一个 & 替换为 ?\n * @param url\n * @param query\n */\nfunction appendQuery(url, query) {\n    return `${url}&${query}`.replace(/[&?]{1,2}/, '?');\n}\n/**\n * 合并请求参数，参数优先级：options > globalOptions > defaults\n * @param options\n */\nfunction mergeOptions(options) {\n    // 默认参数\n    const defaults = {\n        url: '',\n        method: 'GET',\n        data: '',\n        processData: true,\n        async: true,\n        cache: true,\n        username: '',\n        password: '',\n        headers: {},\n        xhrFields: {},\n        statusCode: {},\n        dataType: 'text',\n        contentType: 'application/x-www-form-urlencoded',\n        timeout: 0,\n        global: true,\n    };\n    // globalOptions 中的回调函数不合并\n    each(globalOptions, (key, value) => {\n        const callbacks = [\n            'beforeSend',\n            'success',\n            'error',\n            'complete',\n            'statusCode',\n        ];\n        // @ts-ignore\n        if (callbacks.indexOf(key) < 0 && !isUndefined(value)) {\n            defaults[key] = value;\n        }\n    });\n    return extend({}, defaults, options);\n}\n/**\n * 发送 ajax 请求\n * @param options\n * @example\n```js\najax({\n  method: \"POST\",\n  url: \"some.php\",\n  data: { name: \"John\", location: \"Boston\" }\n}).then(function( msg ) {\n  alert( \"Data Saved: \" + msg );\n});\n```\n */\nfunction ajax(options) {\n    // 是否已取消请求\n    let isCanceled = false;\n    // 事件参数\n    const eventParams = {};\n    // 参数合并\n    const mergedOptions = mergeOptions(options);\n    let url = mergedOptions.url || window.location.toString();\n    const method = mergedOptions.method.toUpperCase();\n    let data = mergedOptions.data;\n    const processData = mergedOptions.processData;\n    const async = mergedOptions.async;\n    const cache = mergedOptions.cache;\n    const username = mergedOptions.username;\n    const password = mergedOptions.password;\n    const headers = mergedOptions.headers;\n    const xhrFields = mergedOptions.xhrFields;\n    const statusCode = mergedOptions.statusCode;\n    const dataType = mergedOptions.dataType;\n    const contentType = mergedOptions.contentType;\n    const timeout = mergedOptions.timeout;\n    const global = mergedOptions.global;\n    // 需要发送的数据\n    // GET/HEAD 请求和 processData 为 true 时，转换为查询字符串格式，特殊格式不转换\n    if (data &&\n        (isQueryStringData(method) || processData) &&\n        !isString(data) &&\n        !(data instanceof ArrayBuffer) &&\n        !(data instanceof Blob) &&\n        !(data instanceof Document) &&\n        !(data instanceof FormData)) {\n        data = param(data);\n    }\n    // 对于 GET、HEAD 类型的请求，把 data 数据添加到 URL 中\n    if (data && isQueryStringData(method)) {\n        // 查询字符串拼接到 URL 中\n        url = appendQuery(url, data);\n        data = null;\n    }\n    /**\n     * 触发事件和回调函数\n     * @param event\n     * @param params\n     * @param callback\n     * @param args\n     */\n    function trigger(event, params, callback, ...args) {\n        // 触发全局事件\n        if (global) {\n            $(document).trigger(event, params);\n        }\n        // 触发 ajax 回调和事件\n        let result1;\n        let result2;\n        if (callback) {\n            // 全局回调\n            if (callback in globalOptions) {\n                // @ts-ignore\n                result1 = globalOptions[callback](...args);\n            }\n            // 自定义回调\n            if (mergedOptions[callback]) {\n                // @ts-ignore\n                result2 = mergedOptions[callback](...args);\n            }\n            // beforeSend 回调返回 false 时取消 ajax 请求\n            if (callback === 'beforeSend' &&\n                (result1 === false || result2 === false)) {\n                isCanceled = true;\n            }\n        }\n    }\n    // XMLHttpRequest 请求\n    function XHR() {\n        let textStatus;\n        return new Promise((resolve, reject) => {\n            // GET/HEAD 请求的缓存处理\n            if (isQueryStringData(method) && !cache) {\n                url = appendQuery(url, `_=${Date.now()}`);\n            }\n            // 创建 XHR\n            const xhr = new XMLHttpRequest();\n            xhr.open(method, url, async, username, password);\n            if (contentType ||\n                (data && !isQueryStringData(method) && contentType !== false)) {\n                xhr.setRequestHeader('Content-Type', contentType);\n            }\n            // 设置 Accept\n            if (dataType === 'json') {\n                xhr.setRequestHeader('Accept', 'application/json, text/javascript');\n            }\n            // 添加 headers\n            if (headers) {\n                each(headers, (key, value) => {\n                    // undefined 值不发送，string 和 null 需要发送\n                    if (!isUndefined(value)) {\n                        xhr.setRequestHeader(key, value + ''); // 把 null 转换成字符串\n                    }\n                });\n            }\n            // 检查是否是跨域请求，跨域请求时不添加 X-Requested-With\n            const crossDomain = /^([\\w-]+:)?\\/\\/([^/]+)/.test(url) &&\n                RegExp.$2 !== window.location.host;\n            if (!crossDomain) {\n                xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n            }\n            if (xhrFields) {\n                each(xhrFields, (key, value) => {\n                    // @ts-ignore\n                    xhr[key] = value;\n                });\n            }\n            eventParams.xhr = xhr;\n            eventParams.options = mergedOptions;\n            let xhrTimeout;\n            xhr.onload = function () {\n                if (xhrTimeout) {\n                    clearTimeout(xhrTimeout);\n                }\n                // AJAX 返回的 HTTP 响应码是否表示成功\n                const isHttpStatusSuccess = (xhr.status >= 200 && xhr.status < 300) ||\n                    xhr.status === 304 ||\n                    xhr.status === 0;\n                let responseData;\n                if (isHttpStatusSuccess) {\n                    if (xhr.status === 204 || method === 'HEAD') {\n                        textStatus = 'nocontent';\n                    }\n                    else if (xhr.status === 304) {\n                        textStatus = 'notmodified';\n                    }\n                    else {\n                        textStatus = 'success';\n                    }\n                    if (dataType === 'json') {\n                        try {\n                            responseData =\n                                method === 'HEAD' ? undefined : JSON.parse(xhr.responseText);\n                            eventParams.data = responseData;\n                        }\n                        catch (err) {\n                            textStatus = 'parsererror';\n                            trigger(ajaxEvents.ajaxError, eventParams, 'error', xhr, textStatus);\n                            reject(new Error(textStatus));\n                        }\n                        if (textStatus !== 'parsererror') {\n                            trigger(ajaxEvents.ajaxSuccess, eventParams, 'success', responseData, textStatus, xhr);\n                            resolve(responseData);\n                        }\n                    }\n                    else {\n                        responseData =\n                            method === 'HEAD'\n                                ? undefined\n                                : xhr.responseType === 'text' || xhr.responseType === ''\n                                    ? xhr.responseText\n                                    : xhr.response;\n                        eventParams.data = responseData;\n                        trigger(ajaxEvents.ajaxSuccess, eventParams, 'success', responseData, textStatus, xhr);\n                        resolve(responseData);\n                    }\n                }\n                else {\n                    textStatus = 'error';\n                    trigger(ajaxEvents.ajaxError, eventParams, 'error', xhr, textStatus);\n                    reject(new Error(textStatus));\n                }\n                // statusCode\n                each([globalOptions.statusCode, statusCode], (_, func) => {\n                    if (func && func[xhr.status]) {\n                        if (isHttpStatusSuccess) {\n                            func[xhr.status](responseData, textStatus, xhr);\n                        }\n                        else {\n                            func[xhr.status](xhr, textStatus);\n                        }\n                    }\n                });\n                trigger(ajaxEvents.ajaxComplete, eventParams, 'complete', xhr, textStatus);\n            };\n            xhr.onerror = function () {\n                if (xhrTimeout) {\n                    clearTimeout(xhrTimeout);\n                }\n                trigger(ajaxEvents.ajaxError, eventParams, 'error', xhr, xhr.statusText);\n                trigger(ajaxEvents.ajaxComplete, eventParams, 'complete', xhr, 'error');\n                reject(new Error(xhr.statusText));\n            };\n            xhr.onabort = function () {\n                let statusText = 'abort';\n                if (xhrTimeout) {\n                    statusText = 'timeout';\n                    clearTimeout(xhrTimeout);\n                }\n                trigger(ajaxEvents.ajaxError, eventParams, 'error', xhr, statusText);\n                trigger(ajaxEvents.ajaxComplete, eventParams, 'complete', xhr, statusText);\n                reject(new Error(statusText));\n            };\n            // ajax start 回调\n            trigger(ajaxEvents.ajaxStart, eventParams, 'beforeSend', xhr);\n            if (isCanceled) {\n                reject(new Error('cancel'));\n                return;\n            }\n            // Timeout\n            if (timeout > 0) {\n                xhrTimeout = setTimeout(() => {\n                    xhr.abort();\n                }, timeout);\n            }\n            // 发送 XHR\n            xhr.send(data);\n        });\n    }\n    return XHR();\n}\nexport default ajax;\n","import $ from '../$';\nimport ajax from '../functions/ajax';\n$.ajax = ajax;\n","import extend from '../functions/extend';\nimport { globalOptions } from './utils/ajax';\n/**\n * 为 Ajax 请求设置全局配置参数\n * @param options 键值对参数\n * @example\n```js\najaxSetup({\n  dataType: 'json',\n  method: 'POST',\n});\n```\n */\nfunction ajaxSetup(options) {\n    return extend(globalOptions, options);\n}\nexport default ajaxSetup;\n","import $ from '../$';\nimport ajaxSetup from '../functions/ajaxSetup';\n$.ajaxSetup = ajaxSetup;\n","import $ from '../$';\nimport contains from '../functions/contains';\n$.contains = contains;\n","const dataNS = '_mduiElementDataStorage';\nexport default dataNS;\n","import { isObjectLike, isUndefined, toCamelCase } from '../utils';\nimport each from './each';\nimport dataNS from './utils/data';\n/**\n * 在元素上设置键值对数据\n * @param element\n * @param object\n */\nfunction setObjectToElement(element, object) {\n    // @ts-ignore\n    if (!element[dataNS]) {\n        // @ts-ignore\n        element[dataNS] = {};\n    }\n    each(object, (key, value) => {\n        // @ts-ignore\n        element[dataNS][toCamelCase(key)] = value;\n    });\n}\nfunction data(element, key, value) {\n    // 根据键值对设置值\n    // data(element, { 'key' : 'value' })\n    if (isObjectLike(key)) {\n        setObjectToElement(element, key);\n        return key;\n    }\n    // 根据 key、value 设置值\n    // data(element, 'key', 'value')\n    if (!isUndefined(value)) {\n        setObjectToElement(element, { [key]: value });\n        return value;\n    }\n    // 获取所有值\n    // data(element)\n    if (isUndefined(key)) {\n        // @ts-ignore\n        return element[dataNS] ? element[dataNS] : {};\n    }\n    // 从 dataNS 中获取指定值\n    // data(element, 'key')\n    key = toCamelCase(key);\n    // @ts-ignore\n    if (element[dataNS] && key in element[dataNS]) {\n        // @ts-ignore\n        return element[dataNS][key];\n    }\n    return undefined;\n}\nexport default data;\n","import $ from '../$';\nimport data from '../functions/data';\n$.data = data;\n","import $ from '../$';\nimport each from '../functions/each';\n$.each = each;\n","import $ from '../$';\nimport each from '../functions/each';\nimport extend from '../functions/extend';\n$.extend = function (...objectN) {\n    if (objectN.length === 1) {\n        each(objectN[0], (prop, value) => {\n            this[prop] = value;\n        });\n        return this;\n    }\n    return extend(objectN.shift(), objectN.shift(), ...objectN);\n};\n","import each from './each';\nfunction map(elements, callback) {\n    let value;\n    const ret = [];\n    each(elements, (i, element) => {\n        value = callback.call(window, element, i);\n        if (value != null) {\n            ret.push(value);\n        }\n    });\n    return [].concat(...ret);\n}\nexport default map;\n","import $ from '../$';\nimport map from '../functions/map';\n$.map = map;\n","import $ from '../$';\nimport merge from '../functions/merge';\n$.merge = merge;\n","import $ from '../$';\nimport param from '../functions/param';\n$.param = param;\n","import each from '../functions/each';\nimport { isUndefined, isString, toCamelCase } from '../utils';\nimport dataNS from './utils/data';\n/**\n * 移除指定元素上存放的数据\n * @param element 存放数据的元素\n * @param name\n * 数据键名\n *\n * 若未指定键名，将移除元素上所有数据\n *\n * 多个键名可以用空格分隔，或者用数组表示多个键名\n  @example\n```js\n// 移除元素上键名为 name 的数据\nremoveData(document.body, 'name');\n```\n * @example\n```js\n// 移除元素上键名为 name1 和 name2 的数据\nremoveData(document.body, 'name1 name2');\n```\n * @example\n```js\n// 移除元素上键名为 name1 和 name2 的数据\nremoveData(document.body, ['name1', 'name2']);\n```\n * @example\n```js\n// 移除元素上所有数据\nremoveData(document.body);\n```\n */\nfunction removeData(element, name) {\n    // @ts-ignore\n    if (!element[dataNS]) {\n        return;\n    }\n    const remove = (nameItem) => {\n        nameItem = toCamelCase(nameItem);\n        // @ts-ignore\n        if (element[dataNS][nameItem]) {\n            // @ts-ignore\n            element[dataNS][nameItem] = null;\n            // @ts-ignore\n            delete element[dataNS][nameItem];\n        }\n    };\n    if (isUndefined(name)) {\n        // @ts-ignore\n        element[dataNS] = null;\n        // @ts-ignore\n        delete element[dataNS];\n        // @ts-ignore\n    }\n    else if (isString(name)) {\n        name\n            .split(' ')\n            .filter((nameItem) => nameItem)\n            .forEach((nameItem) => remove(nameItem));\n    }\n    else {\n        each(name, (_, nameItem) => remove(nameItem));\n    }\n}\nexport default removeData;\n","import $ from '../$';\nimport removeData from '../functions/removeData';\n$.removeData = removeData;\n","import each from './each';\n/**\n * 过滤掉数组中的重复元素\n * @param arr 数组\n * @example\n```js\nunique([1, 2, 12, 3, 2, 1, 2, 1, 1]);\n// [1, 2, 12, 3]\n```\n */\nfunction unique(arr) {\n    const result = [];\n    each(arr, (_, val) => {\n        if (result.indexOf(val) === -1) {\n            result.push(val);\n        }\n    });\n    return result;\n}\nexport default unique;\n","import $ from '../$';\nimport unique from '../functions/unique';\n$.unique = unique;\n","import $ from '../$';\nimport merge from '../functions/merge';\nimport unique from '../functions/unique';\nimport { JQ } from '../JQ';\nimport './get';\n$.fn.add = function (selector) {\n    return new JQ(unique(merge(this.get(), $(selector).get())));\n};\n","import $ from '../$';\nimport each from '../functions/each';\nimport { isElement, isFunction } from '../utils';\nimport './each';\neach(['add', 'remove', 'toggle'], (_, name) => {\n    $.fn[`${name}Class`] = function (className) {\n        if (name === 'remove' && !arguments.length) {\n            return this.each((_, element) => {\n                element.setAttribute('class', '');\n            });\n        }\n        return this.each((i, element) => {\n            if (!isElement(element)) {\n                return;\n            }\n            const classes = (isFunction(className)\n                ? className.call(element, i, element.getAttribute('class') || '')\n                : className)\n                .split(' ')\n                .filter((name) => name);\n            each(classes, (_, cls) => {\n                element.classList[name](cls);\n            });\n        });\n    };\n});\n","import $ from '../$';\nimport each from '../functions/each';\nimport './each';\neach(['insertBefore', 'insertAfter'], (nameIndex, name) => {\n    $.fn[name] = function (target) {\n        const $element = nameIndex ? $(this.get().reverse()) : this; // 顺序和 jQuery 保持一致\n        const $target = $(target);\n        const result = [];\n        $target.each((index, target) => {\n            if (!target.parentNode) {\n                return;\n            }\n            $element.each((_, element) => {\n                const newItem = index\n                    ? element.cloneNode(true)\n                    : element;\n                const existingItem = nameIndex ? target.nextSibling : target;\n                result.push(newItem);\n                target.parentNode.insertBefore(newItem, existingItem);\n            });\n        });\n        return $(nameIndex ? result.reverse() : result);\n    };\n});\n","import $ from '../$';\nimport each from '../functions/each';\nimport { getChildNodesArray, isFunction, isString, isElement } from '../utils';\nimport './each';\nimport './insertAfter';\nimport './insertBefore';\n/**\n * 是否不是 HTML 字符串（包裹在 <> 中）\n * @param target\n */\nfunction isPlainText(target) {\n    return (isString(target) && (target[0] !== '<' || target[target.length - 1] !== '>'));\n}\neach(['before', 'after'], (nameIndex, name) => {\n    $.fn[name] = function (...args) {\n        // after 方法，多个参数需要按参数顺序添加到元素后面，所以需要将参数顺序反向处理\n        if (nameIndex === 1) {\n            args = args.reverse();\n        }\n        return this.each((index, element) => {\n            const targets = isFunction(args[0])\n                ? [args[0].call(element, index, element.innerHTML)]\n                : args;\n            each(targets, (_, target) => {\n                let $target;\n                if (isPlainText(target)) {\n                    $target = $(getChildNodesArray(target, 'div'));\n                }\n                else if (index && isElement(target)) {\n                    $target = $(target.cloneNode(true));\n                }\n                else {\n                    $target = $(target);\n                }\n                $target[nameIndex ? 'insertAfter' : 'insertBefore'](element);\n            });\n        });\n    };\n});\n","import $ from '../$';\nimport each from '../functions/each';\nimport { isFunction, isObjectLike, returnFalse } from '../utils';\nimport './each';\nimport { remove } from './utils/event';\n$.fn.off = function (types, selector, callback) {\n    // types 是对象\n    if (isObjectLike(types)) {\n        each(types, (type, fn) => {\n            // this.off('click', undefined, function () {})\n            // this.off('click', '.box', function () {})\n            this.off(type, selector, fn);\n        });\n        return this;\n    }\n    // selector 不存在\n    if (selector === false || isFunction(selector)) {\n        callback = selector;\n        selector = undefined;\n        // this.off('click', undefined, function () {})\n    }\n    // callback 传入 `false`，相当于 `return false`\n    if (callback === false) {\n        callback = returnFalse;\n    }\n    return this.each(function () {\n        remove(this, types, callback, selector);\n    });\n};\n","import $ from '../$';\nimport each from '../functions/each';\nimport { isObjectLike, isString, returnFalse } from '../utils';\nimport './each';\nimport './off';\nimport { add } from './utils/event';\n$.fn.on = function (types, selector, data, callback, one) {\n    // types 可以是 type/func 对象\n    if (isObjectLike(types)) {\n        // (types-Object, selector, data)\n        if (!isString(selector)) {\n            // (types-Object, data)\n            data = data || selector;\n            selector = undefined;\n        }\n        each(types, (type, fn) => {\n            // selector 和 data 都可能是 undefined\n            // @ts-ignore\n            this.on(type, selector, data, fn, one);\n        });\n        return this;\n    }\n    if (data == null && callback == null) {\n        // (types, fn)\n        callback = selector;\n        data = selector = undefined;\n    }\n    else if (callback == null) {\n        if (isString(selector)) {\n            // (types, selector, fn)\n            callback = data;\n            data = undefined;\n        }\n        else {\n            // (types, data, fn)\n            callback = data;\n            data = selector;\n            selector = undefined;\n        }\n    }\n    if (callback === false) {\n        callback = returnFalse;\n    }\n    else if (!callback) {\n        return this;\n    }\n    // $().one()\n    if (one) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        const _this = this;\n        const origCallback = callback;\n        callback = function (event) {\n            _this.off(event.type, selector, callback);\n            // eslint-disable-next-line prefer-rest-params\n            return origCallback.apply(this, arguments);\n        };\n    }\n    return this.each(function () {\n        add(this, types, callback, data, selector);\n    });\n};\n","import $ from '../$';\nimport each from '../functions/each';\nimport { ajaxEvents } from '../functions/utils/ajax';\nimport './on';\neach(ajaxEvents, (name, eventName) => {\n    $.fn[name] = function (fn) {\n        return this.on(eventName, (e, params) => {\n            fn(e, params.xhr, params.options, params.data);\n        });\n    };\n});\n","import $ from '../$';\nimport map from '../functions/map';\nimport { JQ } from '../JQ';\n$.fn.map = function (callback) {\n    return new JQ(map(this, (element, i) => callback.call(element, i, element)));\n};\n","import $ from '../$';\nimport './map';\n$.fn.clone = function () {\n    return this.map(function () {\n        return this.cloneNode(true);\n    });\n};\n","import $ from '../$';\nimport { isDocument, isFunction, isString, isWindow } from '../utils';\nimport './each';\n$.fn.is = function (selector) {\n    let isMatched = false;\n    if (isFunction(selector)) {\n        this.each((index, element) => {\n            if (selector.call(element, index, element)) {\n                isMatched = true;\n            }\n        });\n        return isMatched;\n    }\n    if (isString(selector)) {\n        this.each((_, element) => {\n            if (isDocument(element) || isWindow(element)) {\n                return;\n            }\n            // @ts-ignore\n            const matches = element.matches || element.msMatchesSelector;\n            if (matches.call(element, selector)) {\n                isMatched = true;\n            }\n        });\n        return isMatched;\n    }\n    const $compareWith = $(selector);\n    this.each((_, element) => {\n        $compareWith.each((_, compare) => {\n            if (element === compare) {\n                isMatched = true;\n            }\n        });\n    });\n    return isMatched;\n};\n","import $ from '../$';\nimport './each';\nimport './is';\n$.fn.remove = function (selector) {\n    return this.each((_, element) => {\n        if (element.parentNode && (!selector || $(element).is(selector))) {\n            element.parentNode.removeChild(element);\n        }\n    });\n};\n","import $ from '../$';\nimport each from '../functions/each';\nimport { isFunction, isString } from '../utils';\nimport './after';\nimport './before';\nimport './clone';\nimport './each';\nimport './map';\nimport './remove';\neach(['prepend', 'append'], (nameIndex, name) => {\n    $.fn[name] = function (...args) {\n        return this.each((index, element) => {\n            const childNodes = element.childNodes;\n            const childLength = childNodes.length;\n            const child = childLength\n                ? childNodes[nameIndex ? childLength - 1 : 0]\n                : document.createElement('div');\n            if (!childLength) {\n                element.appendChild(child);\n            }\n            let contents = isFunction(args[0])\n                ? [args[0].call(element, index, element.innerHTML)]\n                : args;\n            // 如果不是字符串，则仅第一个元素使用原始元素，其他的都克隆自第一个元素\n            if (index) {\n                contents = contents.map((content) => {\n                    return isString(content) ? content : $(content).clone();\n                });\n            }\n            $(child)[nameIndex ? 'after' : 'before'](...contents);\n            if (!childLength) {\n                element.removeChild(child);\n            }\n        });\n    };\n});\n","import $ from '../$';\nimport each from '../functions/each';\nimport './insertAfter';\nimport './insertBefore';\nimport './map';\nimport './remove';\neach(['appendTo', 'prependTo'], (nameIndex, name) => {\n    $.fn[name] = function (target) {\n        const extraChilds = [];\n        const $target = $(target).map((_, element) => {\n            const childNodes = element.childNodes;\n            const childLength = childNodes.length;\n            if (childLength) {\n                return childNodes[nameIndex ? 0 : childLength - 1];\n            }\n            const child = document.createElement('div');\n            element.appendChild(child);\n            extraChilds.push(child);\n            return child;\n        });\n        const $result = this[nameIndex ? 'insertBefore' : 'insertAfter']($target);\n        $(extraChilds).remove();\n        return $result;\n    };\n});\n","import $ from '../$';\nimport each from '../functions/each';\nimport { cssNumber, getStyle, isElement, isFunction, isNull, isNumber, isObjectLike, isUndefined, toCamelCase, } from '../utils';\nimport './each';\neach(['attr', 'prop', 'css'], (nameIndex, name) => {\n    function set(element, key, value) {\n        // 值为 undefined 时，不修改\n        if (isUndefined(value)) {\n            return;\n        }\n        switch (nameIndex) {\n            // attr\n            case 0:\n                if (isNull(value)) {\n                    element.removeAttribute(key);\n                }\n                else {\n                    element.setAttribute(key, value);\n                }\n                break;\n            // prop\n            case 1:\n                // @ts-ignore\n                element[key] = value;\n                break;\n            // css\n            default:\n                key = toCamelCase(key);\n                // @ts-ignore\n                element.style[key] = isNumber(value)\n                    ? `${value}${cssNumber.indexOf(key) > -1 ? '' : 'px'}`\n                    : value;\n                break;\n        }\n    }\n    function get(element, key) {\n        switch (nameIndex) {\n            // attr\n            case 0:\n                // 属性不存在时，原生 getAttribute 方法返回 null，而 jquery 返回 undefined。这里和 jquery 保持一致\n                const value = element.getAttribute(key);\n                return isNull(value) ? undefined : value;\n            // prop\n            case 1:\n                // @ts-ignore\n                return element[key];\n            // css\n            default:\n                return getStyle(element, key);\n        }\n    }\n    $.fn[name] = function (key, value) {\n        if (isObjectLike(key)) {\n            each(key, (k, v) => {\n                // @ts-ignore\n                this[name](k, v);\n            });\n            return this;\n        }\n        if (arguments.length === 1) {\n            const element = this[0];\n            return isElement(element) ? get(element, key) : undefined;\n        }\n        return this.each((i, element) => {\n            set(element, key, isFunction(value) ? value.call(element, i, get(element, key)) : value);\n        });\n    };\n});\n","import $ from '../$';\nimport each from '../functions/each';\nimport unique from '../functions/unique';\nimport { JQ } from '../JQ';\nimport { isElement } from '../utils';\nimport './each';\nimport './is';\n$.fn.children = function (selector) {\n    const children = [];\n    this.each((_, element) => {\n        each(element.childNodes, (__, childNode) => {\n            if (!isElement(childNode)) {\n                return;\n            }\n            if (!selector || $(childNode).is(selector)) {\n                children.push(childNode);\n            }\n        });\n    });\n    return new JQ(unique(children));\n};\n","import $ from '../$';\nimport { JQ } from '../JQ';\n$.fn.slice = function (...args) {\n    return new JQ([].slice.apply(this, args));\n};\n","import $ from '../$';\nimport { JQ } from '../JQ';\nimport './slice';\n$.fn.eq = function (index) {\n    const ret = index === -1 ? this.slice(index) : this.slice(index, +index + 1);\n    return new JQ(ret);\n};\n","import $ from '../../$';\nimport unique from '../../functions/unique';\nimport { JQ } from '../../JQ';\nimport { isElement } from '../../utils';\nimport '../each';\nimport '../is';\nexport default function dir($elements, nameIndex, node, selector, filter) {\n    const ret = [];\n    let target;\n    $elements.each((_, element) => {\n        target = element[node];\n        // 不能包含最顶层的 document 元素\n        while (target && isElement(target)) {\n            // prevUntil, nextUntil, parentsUntil\n            if (nameIndex === 2) {\n                if (selector && $(target).is(selector)) {\n                    break;\n                }\n                if (!filter || $(target).is(filter)) {\n                    ret.push(target);\n                }\n            }\n            // prev, next, parent\n            else if (nameIndex === 0) {\n                if (!selector || $(target).is(selector)) {\n                    ret.push(target);\n                }\n                break;\n            }\n            // prevAll, nextAll, parents\n            else {\n                if (!selector || $(target).is(selector)) {\n                    ret.push(target);\n                }\n            }\n            // @ts-ignore\n            target = target[node];\n        }\n    });\n    return new JQ(unique(ret));\n}\n","import $ from '../$';\nimport each from '../functions/each';\nimport './get';\nimport dir from './utils/dir';\neach(['', 's', 'sUntil'], (nameIndex, name) => {\n    $.fn[`parent${name}`] = function (selector, filter) {\n        // parents、parentsUntil 需要把元素的顺序反向处理，以便和 jQuery 的结果一致\n        const $nodes = !nameIndex ? this : $(this.get().reverse());\n        return dir($nodes, nameIndex, 'parentNode', selector, filter);\n    };\n});\n","import $ from '../$';\nimport { JQ } from '../JQ';\nimport './eq';\nimport './is';\nimport './parents';\n$.fn.closest = function (selector) {\n    if (this.is(selector)) {\n        return this;\n    }\n    const matched = [];\n    this.parents().each((_, element) => {\n        if ($(element).is(selector)) {\n            matched.push(element);\n            return false;\n        }\n    });\n    return new JQ(matched);\n};\n","import $ from '../$';\nimport data from '../functions/data';\nimport { isObjectLike, isString, isUndefined, toCamelCase, toKebabCase, } from '../utils';\nimport './each';\nconst rbrace = /^(?:{[\\w\\W]*\\}|\\[[\\w\\W]*\\])$/;\n// 从 `data-*` 中获取的值，需要经过该函数转换\nfunction getData(value) {\n    if (value === 'true') {\n        return true;\n    }\n    if (value === 'false') {\n        return false;\n    }\n    if (value === 'null') {\n        return null;\n    }\n    if (value === +value + '') {\n        return +value;\n    }\n    if (rbrace.test(value)) {\n        return JSON.parse(value);\n    }\n    return value;\n}\n// 若 value 不存在，则从 `data-*` 中获取值\nfunction dataAttr(element, key, value) {\n    if (isUndefined(value) && element.nodeType === 1) {\n        const name = 'data-' + toKebabCase(key);\n        value = element.getAttribute(name);\n        if (isString(value)) {\n            try {\n                value = getData(value);\n            }\n            catch (e) { }\n        }\n        else {\n            value = undefined;\n        }\n    }\n    return value;\n}\n$.fn.data = function (key, value) {\n    // 获取所有值\n    if (isUndefined(key)) {\n        if (!this.length) {\n            return undefined;\n        }\n        const element = this[0];\n        const resultData = data(element);\n        // window, document 上不存在 `data-*` 属性\n        if (element.nodeType !== 1) {\n            return resultData;\n        }\n        // 从 `data-*` 中获取值\n        const attrs = element.attributes;\n        let i = attrs.length;\n        while (i--) {\n            if (attrs[i]) {\n                let name = attrs[i].name;\n                if (name.indexOf('data-') === 0) {\n                    name = toCamelCase(name.slice(5));\n                    resultData[name] = dataAttr(element, name, resultData[name]);\n                }\n            }\n        }\n        return resultData;\n    }\n    // 同时设置多个值\n    if (isObjectLike(key)) {\n        return this.each(function () {\n            data(this, key);\n        });\n    }\n    // value 传入了 undefined\n    if (arguments.length === 2 && isUndefined(value)) {\n        return this;\n    }\n    // 设置值\n    if (!isUndefined(value)) {\n        return this.each(function () {\n            data(this, key, value);\n        });\n    }\n    // 获取值\n    if (!this.length) {\n        return undefined;\n    }\n    return dataAttr(this[0], key, data(this[0], key));\n};\n","import $ from '../$';\nimport './each';\n$.fn.empty = function () {\n    return this.each(function () {\n        this.innerHTML = '';\n    });\n};\n","import $ from '../$';\nimport each from '../functions/each';\n$.fn.extend = function (obj) {\n    each(obj, (prop, value) => {\n        // 在 JQ 对象上扩展方法时，需要自己添加 typescript 的类型定义\n        $.fn[prop] = value;\n    });\n    return this;\n};\n","import $ from '../$';\nimport { isFunction, isString } from '../utils';\nimport './is';\nimport './map';\n$.fn.filter = function (selector) {\n    if (isFunction(selector)) {\n        return this.map((index, element) => selector.call(element, index, element) ? element : undefined);\n    }\n    if (isString(selector)) {\n        return this.map((_, element) => $(element).is(selector) ? element : undefined);\n    }\n    const $selector = $(selector);\n    return this.map((_, element) => $selector.get().indexOf(element) > -1 ? element : undefined);\n};\n","import $ from '../$';\nimport './eq';\n$.fn.first = function () {\n    return this.eq(0);\n};\n","import $ from '../$';\nimport contains from '../functions/contains';\nimport { isString } from '../utils';\nimport './find';\n$.fn.has = function (selector) {\n    const $targets = isString(selector) ? this.find(selector) : $(selector);\n    const { length } = $targets;\n    return this.map(function () {\n        for (let i = 0; i < length; i += 1) {\n            if (contains(this, $targets[i])) {\n                return this;\n            }\n        }\n        return;\n    });\n};\n","import $ from '../$';\n$.fn.hasClass = function (className) {\n    return this[0].classList.contains(className);\n};\n","import $ from '../$';\nimport each from '../functions/each';\nimport { isBoolean, isDocument, isFunction, isWindow, toElement, isBorderBox, getExtraWidth, getComputedStyleValue, isIE, } from '../utils';\nimport './css';\nimport './each';\n/**\n * 值上面的 padding、border、margin 处理\n * @param element\n * @param name\n * @param value\n * @param funcIndex\n * @param includeMargin\n * @param multiply\n */\nfunction handleExtraWidth(element, name, value, funcIndex, includeMargin, multiply) {\n    // 获取元素的 padding, border, margin 宽度（两侧宽度的和）\n    const getExtraWidthValue = (extra) => {\n        return (getExtraWidth(element, name.toLowerCase(), extra) *\n            multiply);\n    };\n    if (funcIndex === 2 && includeMargin) {\n        value += getExtraWidthValue('margin');\n    }\n    if (isBorderBox(element)) {\n        // IE 为 box-sizing: border-box 时，得到的值不含 border 和 padding，这里先修复\n        // 仅获取时需要处理，multiply === 1 为 get\n        if (isIE() && multiply === 1) {\n            value += getExtraWidthValue('border');\n            value += getExtraWidthValue('padding');\n        }\n        if (funcIndex === 0) {\n            value -= getExtraWidthValue('border');\n        }\n        if (funcIndex === 1) {\n            value -= getExtraWidthValue('border');\n            value -= getExtraWidthValue('padding');\n        }\n    }\n    else {\n        if (funcIndex === 0) {\n            value += getExtraWidthValue('padding');\n        }\n        if (funcIndex === 2) {\n            value += getExtraWidthValue('border');\n            value += getExtraWidthValue('padding');\n        }\n    }\n    return value;\n}\n/**\n * 获取元素的样式值\n * @param element\n * @param name\n * @param funcIndex 0: innerWidth, innerHeight; 1: width, height; 2: outerWidth, outerHeight\n * @param includeMargin\n */\nfunction get(element, name, funcIndex, includeMargin) {\n    const clientProp = `client${name}`;\n    const scrollProp = `scroll${name}`;\n    const offsetProp = `offset${name}`;\n    const innerProp = `inner${name}`;\n    // $(window).width()\n    if (isWindow(element)) {\n        // outerWidth, outerHeight 需要包含滚动条的宽度\n        return funcIndex === 2\n            ? element[innerProp]\n            : toElement(document)[clientProp];\n    }\n    // $(document).width()\n    if (isDocument(element)) {\n        const doc = toElement(element);\n        return Math.max(\n        // @ts-ignore\n        element.body[scrollProp], doc[scrollProp], \n        // @ts-ignore\n        element.body[offsetProp], doc[offsetProp], doc[clientProp]);\n    }\n    const value = parseFloat(getComputedStyleValue(element, name.toLowerCase()) || '0');\n    return handleExtraWidth(element, name, value, funcIndex, includeMargin, 1);\n}\n/**\n * 设置元素的样式值\n * @param element\n * @param elementIndex\n * @param name\n * @param funcIndex 0: innerWidth, innerHeight; 1: width, height; 2: outerWidth, outerHeight\n * @param includeMargin\n * @param value\n */\nfunction set(element, elementIndex, name, funcIndex, includeMargin, value) {\n    let computedValue = isFunction(value)\n        ? value.call(element, elementIndex, get(element, name, funcIndex, includeMargin))\n        : value;\n    if (computedValue == null) {\n        return;\n    }\n    const $element = $(element);\n    const dimension = name.toLowerCase();\n    // 特殊的值，不需要计算 padding、border、margin\n    if (['auto', 'inherit', ''].indexOf(computedValue) > -1) {\n        $element.css(dimension, computedValue);\n        return;\n    }\n    // 其他值保留原始单位。注意：如果不使用 px 作为单位，则算出的值一般是不准确的\n    const suffix = computedValue.toString().replace(/\\b[0-9.]*/, '');\n    const numerical = parseFloat(computedValue);\n    computedValue =\n        handleExtraWidth(element, name, numerical, funcIndex, includeMargin, -1) +\n            (suffix || 'px');\n    $element.css(dimension, computedValue);\n}\neach(['Width', 'Height'], (_, name) => {\n    each([`inner${name}`, name.toLowerCase(), `outer${name}`], (funcIndex, funcName) => {\n        $.fn[funcName] = function (margin, value) {\n            // 是否是赋值操作\n            const isSet = arguments.length && (funcIndex < 2 || !isBoolean(margin));\n            const includeMargin = margin === true || value === true;\n            // 获取第一个元素的值\n            if (!isSet) {\n                return this.length\n                    ? get(this[0], name, funcIndex, includeMargin)\n                    : undefined;\n            }\n            // 设置每个元素的值\n            return this.each((index, element) => set(element, index, name, funcIndex, includeMargin, margin));\n        };\n    });\n});\n","import $ from '../$';\nimport './each';\n$.fn.hide = function () {\n    return this.each(function () {\n        this.style.display = 'none';\n    });\n};\n","import $ from '../$';\nimport each from '../functions/each';\nimport map from '../functions/map';\nimport { isElement, isFunction, isUndefined, toElement } from '../utils';\nimport './each';\nimport './is';\neach(['val', 'html', 'text'], (nameIndex, name) => {\n    const props = {\n        0: 'value',\n        1: 'innerHTML',\n        2: 'textContent',\n    };\n    const propName = props[nameIndex];\n    function get($elements) {\n        // text() 获取所有元素的文本\n        if (nameIndex === 2) {\n            // @ts-ignore\n            return map($elements, (element) => toElement(element)[propName]).join('');\n        }\n        // 空集合时，val() 和 html() 返回 undefined\n        if (!$elements.length) {\n            return undefined;\n        }\n        // val() 和 html() 仅获取第一个元素的内容\n        const firstElement = $elements[0];\n        // select multiple 返回数组\n        if (nameIndex === 0 && $(firstElement).is('select[multiple]')) {\n            return map($(firstElement).find('option:checked'), (element) => element.value);\n        }\n        // @ts-ignore\n        return firstElement[propName];\n    }\n    function set(element, value) {\n        // text() 和 html() 赋值为 undefined，则保持原内容不变\n        // val() 赋值为 undefined 则赋值为空\n        if (isUndefined(value)) {\n            if (nameIndex !== 0) {\n                return;\n            }\n            value = '';\n        }\n        if (nameIndex === 1 && isElement(value)) {\n            value = value.outerHTML;\n        }\n        // @ts-ignore\n        element[propName] = value;\n    }\n    $.fn[name] = function (value) {\n        // 获取值\n        if (!arguments.length) {\n            return get(this);\n        }\n        // 设置值\n        return this.each((i, element) => {\n            const computedValue = isFunction(value)\n                ? value.call(element, i, get($(element)))\n                : value;\n            // value 是数组，则选中数组中的元素，反选不在数组中的元素\n            if (nameIndex === 0 && Array.isArray(computedValue)) {\n                // select[multiple]\n                if ($(element).is('select[multiple]')) {\n                    map($(element).find('option'), (option) => (option.selected =\n                        computedValue.indexOf(option.value) >\n                            -1));\n                }\n                // 其他 checkbox, radio 等元素\n                else {\n                    element.checked =\n                        computedValue.indexOf(element.value) > -1;\n                }\n            }\n            else {\n                set(element, computedValue);\n            }\n        });\n    };\n});\n","import $ from '../$';\nimport { isString } from '../utils';\nimport './children';\nimport './eq';\nimport './get';\nimport './parent';\n$.fn.index = function (selector) {\n    if (!arguments.length) {\n        return this.eq(0).parent().children().get().indexOf(this[0]);\n    }\n    if (isString(selector)) {\n        return $(selector).get().indexOf(this[0]);\n    }\n    return this.get().indexOf($(selector)[0]);\n};\n","import $ from '../$';\nimport './eq';\n$.fn.last = function () {\n    return this.eq(-1);\n};\n","import $ from '../$';\nimport each from '../functions/each';\nimport dir from './utils/dir';\neach(['', 'All', 'Until'], (nameIndex, name) => {\n    $.fn[`next${name}`] = function (selector, filter) {\n        return dir(this, nameIndex, 'nextElementSibling', selector, filter);\n    };\n});\n","import $ from '../$';\nimport './filter';\nimport './map';\n$.fn.not = function (selector) {\n    const $excludes = this.filter(selector);\n    return this.map((_, element) => $excludes.index(element) > -1 ? undefined : element);\n};\n","import $ from '../$';\nimport './css';\nimport './map';\n/**\n * 返回最近的用于定位的父元素\n */\n$.fn.offsetParent = function () {\n    return this.map(function () {\n        let offsetParent = this.offsetParent;\n        while (offsetParent && $(offsetParent).css('position') === 'static') {\n            offsetParent = offsetParent.offsetParent;\n        }\n        return offsetParent || document.documentElement;\n    });\n};\n","import $ from '../$';\nimport './css';\nimport './eq';\nimport './offset';\nimport './offsetParent';\nfunction floatStyle($element, name) {\n    return parseFloat($element.css(name));\n}\n$.fn.position = function () {\n    if (!this.length) {\n        return undefined;\n    }\n    const $element = this.eq(0);\n    let currentOffset;\n    let parentOffset = {\n        left: 0,\n        top: 0,\n    };\n    if ($element.css('position') === 'fixed') {\n        currentOffset = $element[0].getBoundingClientRect();\n    }\n    else {\n        currentOffset = $element.offset();\n        const $offsetParent = $element.offsetParent();\n        parentOffset = $offsetParent.offset();\n        parentOffset.top += floatStyle($offsetParent, 'border-top-width');\n        parentOffset.left += floatStyle($offsetParent, 'border-left-width');\n    }\n    return {\n        top: currentOffset.top - parentOffset.top - floatStyle($element, 'margin-top'),\n        left: currentOffset.left -\n            parentOffset.left -\n            floatStyle($element, 'margin-left'),\n    };\n};\n","import $ from '../$';\nimport extend from '../functions/extend';\nimport { isFunction } from '../utils';\nimport './css';\nimport './each';\nimport './position';\nfunction get(element) {\n    if (!element.getClientRects().length) {\n        return { top: 0, left: 0 };\n    }\n    const rect = element.getBoundingClientRect();\n    const win = element.ownerDocument.defaultView;\n    return {\n        top: rect.top + win.pageYOffset,\n        left: rect.left + win.pageXOffset,\n    };\n}\nfunction set(element, value, index) {\n    const $element = $(element);\n    const position = $element.css('position');\n    if (position === 'static') {\n        $element.css('position', 'relative');\n    }\n    const currentOffset = get(element);\n    const currentTopString = $element.css('top');\n    const currentLeftString = $element.css('left');\n    let currentTop;\n    let currentLeft;\n    const calculatePosition = (position === 'absolute' || position === 'fixed') &&\n        (currentTopString + currentLeftString).indexOf('auto') > -1;\n    if (calculatePosition) {\n        const currentPosition = $element.position();\n        currentTop = currentPosition.top;\n        currentLeft = currentPosition.left;\n    }\n    else {\n        currentTop = parseFloat(currentTopString);\n        currentLeft = parseFloat(currentLeftString);\n    }\n    const computedValue = isFunction(value)\n        ? value.call(element, index, extend({}, currentOffset))\n        : value;\n    $element.css({\n        top: computedValue.top != null\n            ? computedValue.top - currentOffset.top + currentTop\n            : undefined,\n        left: computedValue.left != null\n            ? computedValue.left - currentOffset.left + currentLeft\n            : undefined,\n    });\n}\n$.fn.offset = function (value) {\n    // 获取坐标\n    if (!arguments.length) {\n        if (!this.length) {\n            return undefined;\n        }\n        return get(this[0]);\n    }\n    // 设置坐标\n    return this.each(function (index) {\n        set(this, value, index);\n    });\n};\n","import $ from '../$';\nimport './on';\n$.fn.one = function (types, selector, data, callback) {\n    // @ts-ignore\n    return this.on(types, selector, data, callback, true);\n};\n","import $ from '../$';\nimport each from '../functions/each';\nimport './get';\nimport dir from './utils/dir';\neach(['', 'All', 'Until'], (nameIndex, name) => {\n    $.fn[`prev${name}`] = function (selector, filter) {\n        // prevAll、prevUntil 需要把元素的顺序倒序处理，以便和 jQuery 的结果一致\n        const $nodes = !nameIndex ? this : $(this.get().reverse());\n        return dir($nodes, nameIndex, 'previousElementSibling', selector, filter);\n    };\n});\n","import $ from '../$';\nimport each from '../functions/each';\nimport './each';\n$.fn.removeAttr = function (attributeName) {\n    const names = attributeName.split(' ').filter((name) => name);\n    return this.each(function () {\n        each(names, (_, name) => {\n            this.removeAttribute(name);\n        });\n    });\n};\n","import $ from '../$';\nimport removeData from '../functions/removeData';\nimport './each';\n$.fn.removeData = function (name) {\n    return this.each(function () {\n        removeData(this, name);\n    });\n};\n","import $ from '../$';\nimport './each';\n$.fn.removeProp = function (name) {\n    return this.each(function () {\n        try {\n            // @ts-ignore\n            delete this[name];\n        }\n        catch (e) { }\n    });\n};\n","import $ from '../$';\nimport './before';\nimport './clone';\nimport './each';\nimport './remove';\nimport { isFunction, isString } from '../utils';\n$.fn.replaceWith = function (newContent) {\n    this.each((index, element) => {\n        let content = newContent;\n        if (isFunction(content)) {\n            content = content.call(element, index, element.innerHTML);\n        }\n        else if (index && !isString(content)) {\n            content = $(content).clone();\n        }\n        $(element).before(content);\n    });\n    return this.remove();\n};\n","import $ from '../$';\nimport './clone';\nimport './get';\nimport './map';\nimport './replaceWith';\n$.fn.replaceAll = function (target) {\n    return $(target).map((index, element) => {\n        $(element).replaceWith(index ? this.clone() : this);\n        return this.get();\n    });\n};\n","import $ from '../$';\nimport './each';\nimport './val';\n/**\n * 将表单元素的值组合成键值对数组\n * @returns {Array}\n */\n$.fn.serializeArray = function () {\n    const result = [];\n    this.each((_, element) => {\n        const elements = element instanceof HTMLFormElement ? element.elements : [element];\n        $(elements).each((_, element) => {\n            const $element = $(element);\n            const type = element.type;\n            const nodeName = element.nodeName.toLowerCase();\n            if (nodeName !== 'fieldset' &&\n                element.name &&\n                !element.disabled &&\n                ['input', 'select', 'textarea', 'keygen'].indexOf(nodeName) > -1 &&\n                ['submit', 'button', 'image', 'reset', 'file'].indexOf(type) === -1 &&\n                (['radio', 'checkbox'].indexOf(type) === -1 ||\n                    element.checked)) {\n                const value = $element.val();\n                const valueArr = Array.isArray(value) ? value : [value];\n                valueArr.forEach((value) => {\n                    result.push({\n                        name: element.name,\n                        value,\n                    });\n                });\n            }\n        });\n    });\n    return result;\n};\n","import $ from '../$';\nimport param from '../functions/param';\nimport './serializeArray';\n$.fn.serialize = function () {\n    return param(this.serializeArray());\n};\n","import $ from '../$';\nimport { getStyle } from '../utils';\nimport './each';\nconst elementDisplay = {};\n/**\n * 获取元素的初始 display 值，用于 .show() 方法\n * @param nodeName\n */\nfunction defaultDisplay(nodeName) {\n    let element;\n    let display;\n    if (!elementDisplay[nodeName]) {\n        element = document.createElement(nodeName);\n        document.body.appendChild(element);\n        display = getStyle(element, 'display');\n        element.parentNode.removeChild(element);\n        if (display === 'none') {\n            display = 'block';\n        }\n        elementDisplay[nodeName] = display;\n    }\n    return elementDisplay[nodeName];\n}\n/**\n * 显示指定元素\n * @returns {JQ}\n */\n$.fn.show = function () {\n    return this.each(function () {\n        if (this.style.display === 'none') {\n            this.style.display = '';\n        }\n        if (getStyle(this, 'display') === 'none') {\n            this.style.display = defaultDisplay(this.nodeName);\n        }\n    });\n};\n","import $ from '../$';\nimport './add';\nimport './nextAll';\nimport './prevAll';\n/**\n * 取得同辈元素的集合\n * @param selector {String=}\n * @returns {JQ}\n */\n$.fn.siblings = function (selector) {\n    return this.prevAll(selector).add(this.nextAll(selector));\n};\n","import $ from '../$';\nimport { getStyle } from '../utils';\nimport './each';\nimport './hide';\nimport './show';\n/**\n * 切换元素的显示状态\n */\n$.fn.toggle = function () {\n    return this.each(function () {\n        getStyle(this, 'display') === 'none' ? $(this).show() : $(this).hide();\n    });\n};\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/each';\n\ndeclare module 'mdui.jq/es/JQ' {\n  interface JQ<T = HTMLElement> {\n    /**\n     * 强制重绘当前元素\n     *\n     * @example\n```js\n$('.box').reflow();\n```\n     */\n    reflow(): this;\n  }\n}\n\n$.fn.reflow = function (this: JQ): JQ {\n  return this.each(function () {\n    return this.clientLeft;\n  });\n};\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport { isNumber } from 'mdui.jq/es/utils';\nimport 'mdui.jq/es/methods/each';\n\ndeclare module 'mdui.jq/es/JQ' {\n  interface JQ<T = HTMLElement> {\n    /**\n     * 设置当前元素的 transition-duration 属性\n     * @param duration 可以是带单位的值；若不带单位，则自动添加 `ms` 作为单位\n     * @example\n```js\n$('.box').transition('300ms');\n$('.box').transition(300);\n```\n     */\n    transition(duration: string | number): this;\n  }\n}\n\n$.fn.transition = function (this: JQ, duration: string | number): JQ {\n  if (isNumber(duration)) {\n    duration = `${duration}ms`;\n  }\n\n  return this.each(function () {\n    this.style.webkitTransitionDuration = duration as string;\n    this.style.transitionDuration = duration as string;\n  });\n};\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport each from 'mdui.jq/es/functions/each';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/off';\n\ndeclare module 'mdui.jq/es/JQ' {\n  interface JQ<T = HTMLElement> {\n    /**\n     * 在当前元素上添加 transitionend 事件回调\n     * @param callback 回调函数的参数为 `transitionend` 事件对象；`this` 指向当前元素\n     * @example\n```js\n$('.box').transitionEnd(function() {\n  alert('.box 元素的 transitionend 事件已触发');\n});\n```\n     */\n    transitionEnd(callback: (this: T, e: Event) => void): this;\n  }\n}\n\n$.fn.transitionEnd = function (\n  this: JQ,\n  callback: (this: HTMLElement, e: Event) => void,\n): JQ {\n  // eslint-disable-next-line @typescript-eslint/no-this-alias\n  const that = this;\n  const events = ['webkitTransitionEnd', 'transitionend'];\n\n  function fireCallback(this: Element | Document | Window, e: Event): void {\n    if (e.target !== this) {\n      return;\n    }\n\n    // @ts-ignore\n    callback.call(this, e);\n\n    each(events, (_, event) => {\n      that.off(event, fireCallback);\n    });\n  }\n\n  each(events, (_, event) => {\n    that.on(event, fireCallback);\n  });\n\n  return this;\n};\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/each';\n\ndeclare module 'mdui.jq/es/JQ' {\n  interface JQ<T = HTMLElement> {\n    /**\n     * 设置当前元素的 transform-origin 属性\n     * @param transformOrigin\n     * @example\n```js\n$('.box').transformOrigin('top center');\n```\n     */\n    transformOrigin(transformOrigin: string): this;\n  }\n}\n\n$.fn.transformOrigin = function (this: JQ, transformOrigin: string): JQ {\n  return this.each(function () {\n    this.style.webkitTransformOrigin = transformOrigin;\n    this.style.transformOrigin = transformOrigin;\n  });\n};\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/each';\n\ndeclare module 'mdui.jq/es/JQ' {\n  interface JQ<T = HTMLElement> {\n    /**\n     * 设置当前元素的 transform 属性\n     * @param transform\n     * @example\n```js\n$('.box').transform('rotate(90deg)');\n```\n     */\n    transform(transform: string): this;\n  }\n}\n\n$.fn.transform = function (this: JQ, transform: string): JQ {\n  return this.each(function () {\n    this.style.webkitTransform = transform;\n    this.style.transform = transform;\n  });\n};\n","import PlainObject from 'mdui.jq/es/interfaces/PlainObject';\nimport data from 'mdui.jq/es/functions/data';\n\ntype TYPE_API_INIT = (\n  this: HTMLElement,\n  i: number,\n  element: HTMLElement,\n) => void;\n\n/**\n * CSS 选择器和初始化函数组成的对象\n */\nconst entries: PlainObject<TYPE_API_INIT> = {};\n\n/**\n * 注册并执行初始化函数\n * @param selector CSS 选择器\n * @param apiInit 初始化函数\n * @param i 元素索引\n * @param element 元素\n */\nfunction mutation(\n  selector: string,\n  apiInit: TYPE_API_INIT,\n  i: number,\n  element: HTMLElement,\n): void {\n  let selectors = data(element, '_mdui_mutation');\n\n  if (!selectors) {\n    selectors = [];\n    data(element, '_mdui_mutation', selectors);\n  }\n\n  if (selectors.indexOf(selector) === -1) {\n    selectors.push(selector);\n    apiInit.call(element, i, element);\n  }\n}\n\nexport { TYPE_API_INIT, entries, mutation };\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport each from 'mdui.jq/es/functions/each';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/is';\nimport { entries, mutation } from '../../utils/mutation';\n\ndeclare module 'mdui.jq/es/JQ' {\n  interface JQ<T = HTMLElement> {\n    /**\n     * 执行在当前元素及其子元素内注册的初始化函数\n     */\n    mutation(): this;\n  }\n}\n\n$.fn.mutation = function (this: JQ): JQ {\n  return this.each((i, element) => {\n    const $this = $(element);\n\n    each(entries, (selector: string, apiInit) => {\n      if ($this.is(selector)) {\n        mutation(selector, apiInit, i, element);\n      }\n\n      $this.find(selector).each((i, element) => {\n        mutation(selector, apiInit, i, element);\n      });\n    });\n  });\n};\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport { isUndefined } from 'mdui.jq/es/utils';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/css';\nimport 'mdui.jq/es/methods/appendTo';\nimport 'mdui.jq/es/methods/addClass';\nimport '../methods/reflow';\n\ndeclare module 'mdui.jq/es/interfaces/JQStatic' {\n  interface JQStatic {\n    /**\n     * 创建并显示遮罩，返回遮罩层的 JQ 对象\n     * @param zIndex 遮罩层的 `z-index` 值，默认为 `2000`\n     * @example\n```js\n$.showOverlay();\n```\n     * @example\n```js\n$.showOverlay(3000);\n```\n     */\n    showOverlay(zIndex?: number): JQ;\n  }\n}\n\n$.showOverlay = function (zIndex?: number): JQ {\n  let $overlay = $('.mdui-overlay');\n\n  if ($overlay.length) {\n    $overlay.data('_overlay_is_deleted', false);\n\n    if (!isUndefined(zIndex)) {\n      $overlay.css('z-index', zIndex);\n    }\n  } else {\n    if (isUndefined(zIndex)) {\n      zIndex = 2000;\n    }\n\n    $overlay = $('<div class=\"mdui-overlay\">')\n      .appendTo(document.body)\n      .reflow()\n      .css('z-index', zIndex);\n  }\n\n  let level = $overlay.data('_overlay_level') || 0;\n\n  return $overlay.data('_overlay_level', ++level).addClass('mdui-overlay-show');\n};\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/remove';\nimport '../methods/transitionEnd';\n\ndeclare module 'mdui.jq/es/interfaces/JQStatic' {\n  interface JQStatic {\n    /**\n     * 隐藏遮罩层\n     *\n     * 如果调用了多次 $.showOverlay() 来显示遮罩层，则也需要调用相同次数的 $.hideOverlay() 才能隐藏遮罩层。可以通过传入参数 true 来强制隐藏遮罩层。\n     * @param force 是否强制隐藏遮罩\n     * @example\n```js\n$.hideOverlay();\n```\n     * @example\n```js\n$.hideOverlay(true);\n```\n     */\n    hideOverlay(force?: boolean): void;\n  }\n}\n\n$.hideOverlay = function (force = false): void {\n  const $overlay = $('.mdui-overlay');\n\n  if (!$overlay.length) {\n    return;\n  }\n\n  let level = force ? 1 : $overlay.data('_overlay_level');\n\n  if (level > 1) {\n    $overlay.data('_overlay_level', --level);\n    return;\n  }\n\n  $overlay\n    .data('_overlay_level', 0)\n    .removeClass('mdui-overlay-show')\n    .data('_overlay_is_deleted', true)\n    .transitionEnd(() => {\n      if ($overlay.data('_overlay_is_deleted')) {\n        $overlay.remove();\n      }\n    });\n};\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/width';\n\ndeclare module 'mdui.jq/es/interfaces/JQStatic' {\n  interface JQStatic {\n    /**\n     * 锁定屏页面，禁止页面滚动\n     * @example\n```js\n$.lockScreen();\n```\n     */\n    lockScreen(): void;\n  }\n}\n\n$.lockScreen = function (): void {\n  const $body = $('body');\n\n  // 不直接把 body 设为 box-sizing: border-box，避免污染全局样式\n  const newBodyWidth = $body.width();\n  let level = $body.data('_lockscreen_level') || 0;\n\n  $body\n    .addClass('mdui-locked')\n    .width(newBodyWidth)\n    .data('_lockscreen_level', ++level);\n};\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/width';\n\ndeclare module 'mdui.jq/es/interfaces/JQStatic' {\n  interface JQStatic {\n    /**\n     * 解除页面锁定\n     *\n     * 如果调用了多次 $.lockScreen() 来显示遮罩层，则也需要调用相同次数的 $.unlockScreen() 才能隐藏遮罩层。可以通过传入参数 true 来强制隐藏遮罩层。\n     * @param force 是否强制解除锁定\n     * @example\n```js\n$.unlockScreen();\n```\n     * @example\n```js\n$.unlockScreen(true);\n```\n     */\n    unlockScreen(force?: boolean): void;\n  }\n}\n\n$.unlockScreen = function (force = false): void {\n  const $body = $('body');\n  let level = force ? 1 : $body.data('_lockscreen_level');\n\n  if (level > 1) {\n    $body.data('_lockscreen_level', --level);\n    return;\n  }\n\n  $body.data('_lockscreen_level', 0).removeClass('mdui-locked').width('');\n};\n","import $ from 'mdui.jq/es/$';\nimport { isNull } from 'mdui.jq/es/utils';\n\ndeclare module 'mdui.jq/es/interfaces/JQStatic' {\n  interface JQStatic {\n    /**\n     * 函数节流\n     * @param fn 执行的函数\n     * @param delay 最多多少毫秒执行一次\n     * @example\n```js\n$.throttle(function () {\n  console.log('这个函数最多 100ms 执行一次');\n}, 100)\n```\n     */\n    throttle(fn: () => void, delay: number): () => void;\n  }\n}\n\n$.throttle = function (fn: () => void, delay = 16): () => void {\n  let timer: any = null;\n\n  return function (this: any, ...args: any): void {\n    if (isNull(timer)) {\n      timer = setTimeout(() => {\n        fn.apply(this, args);\n        timer = null;\n      }, delay);\n    }\n  };\n};\n","import $ from 'mdui.jq/es/$';\nimport { isUndefined } from 'mdui.jq/es/utils';\nimport PlainObject from 'mdui.jq/es/interfaces/PlainObject';\n\ndeclare module 'mdui.jq/es/interfaces/JQStatic' {\n  interface JQStatic {\n    /**\n     * 生成一个全局唯一的 ID\n     * @param name 当该参数值对应的 guid 不存在时，会生成一个新的 guid，并返回；当该参数对应的 guid 已存在，则直接返回已有 guid\n     * @example\n```js\n$.guid();\n```\n     * @example\n```js\n$.guid('test');\n```\n     */\n    guid(name?: string): string;\n  }\n}\n\nconst GUID: PlainObject<string> = {};\n\n$.guid = function (name?: string): string {\n  if (!isUndefined(name) && !isUndefined(GUID[name])) {\n    return GUID[name];\n  }\n\n  function s4(): string {\n    return Math.floor((1 + Math.random()) * 0x10000)\n      .toString(16)\n      .substring(1);\n  }\n\n  const guid =\n    '_' +\n    s4() +\n    s4() +\n    '-' +\n    s4() +\n    '-' +\n    s4() +\n    '-' +\n    s4() +\n    '-' +\n    s4() +\n    s4() +\n    s4();\n\n  if (!isUndefined(name)) {\n    GUID[name] = guid;\n  }\n\n  return guid;\n};\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/each';\nimport mdui from '../mdui';\nimport '../jq_extends/methods/mutation';\nimport { isUndefined } from 'mdui.jq/es/utils';\nimport { TYPE_API_INIT, entries, mutation } from '../utils/mutation';\n\ndeclare module '../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 传入了两个参数时，注册并执行初始化函数\n     *\n     * 没有传入参数时，执行初始化\n     * @param selector CSS 选择器\n     * @param apiInit 初始化函数\n     * @example\n```js\nmdui.mutation();\n```\n     * @example\n```js\nmdui.mutation();\n```\n     */\n    mutation(selector?: string, apiInit?: TYPE_API_INIT): void;\n  }\n}\n\nmdui.mutation = function (selector?: string, apiInit?: TYPE_API_INIT): void {\n  if (isUndefined(selector) || isUndefined(apiInit)) {\n    $(document).mutation();\n    return;\n  }\n\n  entries[selector] = apiInit!;\n  $(selector).each((i, element) => mutation(selector, apiInit, i, element));\n};\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport PlainObject from 'mdui.jq/es/interfaces/PlainObject';\nimport 'mdui.jq/es/methods/trigger';\n\n/**\n * 触发组件上的事件\n * @param eventName 事件名\n * @param componentName 组件名\n * @param target 在该元素上触发事件\n * @param instance 组件实例\n * @param parameters 事件参数\n */\nfunction componentEvent(\n  eventName: string,\n  componentName: string,\n  target: HTMLElement | HTMLElement[] | JQ,\n  instance?: any,\n  parameters?: PlainObject,\n): void {\n  if (!parameters) {\n    parameters = {};\n  }\n\n  // @ts-ignore\n  parameters.inst = instance;\n\n  const fullEventName = `${eventName}.mdui.${componentName}`;\n\n  // jQuery 事件\n  // @ts-ignore\n  if (typeof jQuery !== 'undefined') {\n    // @ts-ignore\n    jQuery(target).trigger(fullEventName, parameters);\n  }\n\n  const $target = $(target);\n\n  // mdui.jq 事件\n  $target.trigger(fullEventName, parameters);\n\n  // 原生事件，供使用 addEventListener 监听\n  type EventParams = {\n    detail?: any;\n    bubbles: boolean;\n    cancelable: boolean;\n  };\n\n  const eventParams: EventParams = {\n    bubbles: true,\n    cancelable: true,\n    detail: parameters,\n  };\n\n  const eventObject: CustomEvent = new CustomEvent(fullEventName, eventParams);\n\n  // @ts-ignore\n  eventObject._detail = parameters;\n\n  $target[0].dispatchEvent(eventObject);\n}\n\nexport { componentEvent };\n","import $ from 'mdui.jq/es/$';\n\nconst $document = $(document);\nconst $window = $(window);\nconst $body = $('body');\n\nexport { $document, $window, $body };\n","import $ from 'mdui.jq/es/$';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/removeClass';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport { isNumber } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport '../../jq_extends/methods/transitionEnd';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $window } from '../../utils/dom';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * Headroom 插件\n     *\n     * 请通过 `new mdui.Headroom()` 调用\n     */\n    Headroom: {\n      /**\n       * 实例化 Headroom 组件\n       * @param selector CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Headroom;\n    };\n  }\n}\n\ntype TOLERANCE = {\n  /**\n   * 滚动条向下滚动多少距离开始隐藏或显示元素\n   */\n  down: number;\n\n  /**\n   * 滚动条向上滚动多少距离开始隐藏或显示元素\n   */\n  up: number;\n};\n\ntype OPTIONS = {\n  /**\n   * 滚动条滚动多少距离开始隐藏或显示元素\n   */\n  tolerance?: TOLERANCE | number;\n\n  /**\n   * 在页面顶部多少距离内滚动不会隐藏元素\n   */\n  offset?: number;\n\n  /**\n   * 初始化时添加的类\n   */\n  initialClass?: string;\n\n  /**\n   * 元素固定时添加的类\n   */\n  pinnedClass?: string;\n\n  /**\n   * 元素隐藏时添加的类\n   */\n  unpinnedClass?: string;\n};\n\ntype STATE = 'pinning' | 'pinned' | 'unpinning' | 'unpinned';\ntype EVENT = 'pin' | 'pinned' | 'unpin' | 'unpinned';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  tolerance: 5,\n  offset: 0,\n  initialClass: 'mdui-headroom',\n  pinnedClass: 'mdui-headroom-pinned-top',\n  unpinnedClass: 'mdui-headroom-unpinned-top',\n};\n\nclass Headroom {\n  /**\n   * headroom 元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * 当前 headroom 的状态\n   */\n  private state: STATE = 'pinned';\n\n  /**\n   * 当前是否启用\n   */\n  private isEnable = false;\n\n  /**\n   * 上次滚动后，垂直方向的距离\n   */\n  private lastScrollY = 0;\n\n  /**\n   * AnimationFrame ID\n   */\n  private rafId = 0;\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    this.$element = $(selector).first();\n\n    extend(this.options, options);\n\n    // tolerance 参数若为数值，转换为对象\n    const tolerance = this.options.tolerance;\n    if (isNumber(tolerance)) {\n      this.options.tolerance = {\n        down: tolerance,\n        up: tolerance,\n      };\n    }\n\n    this.enable();\n  }\n\n  /**\n   * 滚动时的处理\n   */\n  private onScroll(): void {\n    this.rafId = window.requestAnimationFrame(() => {\n      const currentScrollY = window.pageYOffset;\n      const direction = currentScrollY > this.lastScrollY ? 'down' : 'up';\n      const tolerance = (this.options.tolerance as TOLERANCE)[direction];\n      const scrolled = Math.abs(currentScrollY - this.lastScrollY);\n      const toleranceExceeded = scrolled >= tolerance;\n\n      if (\n        currentScrollY > this.lastScrollY &&\n        currentScrollY >= this.options.offset! &&\n        toleranceExceeded\n      ) {\n        this.unpin();\n      } else if (\n        (currentScrollY < this.lastScrollY && toleranceExceeded) ||\n        currentScrollY <= this.options.offset!\n      ) {\n        this.pin();\n      }\n\n      this.lastScrollY = currentScrollY;\n    });\n  }\n\n  /**\n   * 触发组件事件\n   * @param name\n   */\n  private triggerEvent(name: EVENT): void {\n    componentEvent(name, 'headroom', this.$element, this);\n  }\n\n  /**\n   * 动画结束的回调\n   */\n  private transitionEnd(): void {\n    if (this.state === 'pinning') {\n      this.state = 'pinned';\n      this.triggerEvent('pinned');\n    }\n\n    if (this.state === 'unpinning') {\n      this.state = 'unpinned';\n      this.triggerEvent('unpinned');\n    }\n  }\n\n  /**\n   * 使元素固定住\n   */\n  public pin(): void {\n    if (\n      this.state === 'pinning' ||\n      this.state === 'pinned' ||\n      !this.$element.hasClass(this.options.initialClass!)\n    ) {\n      return;\n    }\n\n    this.triggerEvent('pin');\n    this.state = 'pinning';\n    this.$element\n      .removeClass(this.options.unpinnedClass)\n      .addClass(this.options.pinnedClass!)\n      .transitionEnd(() => this.transitionEnd());\n  }\n\n  /**\n   * 使元素隐藏\n   */\n  public unpin(): void {\n    if (\n      this.state === 'unpinning' ||\n      this.state === 'unpinned' ||\n      !this.$element.hasClass(this.options.initialClass!)\n    ) {\n      return;\n    }\n\n    this.triggerEvent('unpin');\n    this.state = 'unpinning';\n    this.$element\n      .removeClass(this.options.pinnedClass)\n      .addClass(this.options.unpinnedClass!)\n      .transitionEnd(() => this.transitionEnd());\n  }\n\n  /**\n   * 启用 headroom 插件\n   */\n  public enable(): void {\n    if (this.isEnable) {\n      return;\n    }\n\n    this.isEnable = true;\n    this.state = 'pinned';\n    this.$element\n      .addClass(this.options.initialClass!)\n      .removeClass(this.options.pinnedClass)\n      .removeClass(this.options.unpinnedClass);\n    this.lastScrollY = window.pageYOffset;\n\n    $window.on('scroll', () => this.onScroll());\n  }\n\n  /**\n   * 禁用 headroom 插件\n   */\n  public disable(): void {\n    if (!this.isEnable) {\n      return;\n    }\n\n    this.isEnable = false;\n    this.$element\n      .removeClass(this.options.initialClass)\n      .removeClass(this.options.pinnedClass)\n      .removeClass(this.options.unpinnedClass);\n\n    $window.off('scroll', () => this.onScroll());\n    window.cancelAnimationFrame(this.rafId);\n  }\n\n  /**\n   * 获取当前状态。共包含四种状态：`pinning`、`pinned`、`unpinning`、`unpinned`\n   */\n  public getState(): STATE {\n    return this.state;\n  }\n}\n\nmdui.Headroom = Headroom;\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/attr';\nimport PlainObject from 'mdui.jq/es/interfaces/PlainObject';\n\n/**\n * 解析 DATA API 参数\n * @param element 元素\n * @param name 属性名\n */\nfunction parseOptions(element: HTMLElement, name: string): PlainObject {\n  const attr = $(element).attr(name);\n\n  if (!attr) {\n    return {};\n  }\n\n  return new Function(\n    '',\n    `var json = ${attr}; return JSON.parse(JSON.stringify(json));`,\n  )();\n}\n\nexport { parseOptions };\n","import $ from 'mdui.jq/es/$';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-headroom';\n\n$(() => {\n  mdui.mutation(`[${customAttr}]`, function () {\n    new mdui.Headroom(this, parseOptions(this, customAttr));\n  });\n});\n","import $ from 'mdui.jq/es/$';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/children';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/eq';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/height';\nimport 'mdui.jq/es/methods/is';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/parent';\nimport 'mdui.jq/es/methods/parents';\nimport 'mdui.jq/es/methods/removeClass';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport { isNumber } from 'mdui.jq/es/utils';\nimport '../../jq_extends/methods/reflow';\nimport '../../jq_extends/methods/transition';\nimport '../../jq_extends/methods/transitionEnd';\nimport { componentEvent } from '../../utils/componentEvent';\n\ntype OPTIONS = {\n  /**\n   * 是否启用手风琴效果\n   * 为 `true` 时，最多只能有一个面板项处于打开状态，打开一个面板项时会关闭其他面板项\n   * 为 `false` 时，可同时打开多个面板项\n   */\n  accordion?: boolean;\n};\n\ntype EVENT = 'open' | 'opened' | 'close' | 'closed';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  accordion: false,\n};\n\nabstract class CollapseAbstract {\n  /**\n   * collapse 元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * item 的 class 名\n   */\n  private classItem: string;\n\n  /**\n   * 打开状态的 item 的 class 名\n   */\n  private classItemOpen: string;\n\n  /**\n   * item-header 的 class 名\n   */\n  private classHeader: string;\n\n  /**\n   * item-body 的 class 名\n   */\n  private classBody: string;\n\n  /**\n   * 获取继承的组件名称\n   */\n  protected abstract getNamespace(): string;\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    // CSS 类名\n    const classPrefix = `mdui-${this.getNamespace()}-item`;\n    this.classItem = classPrefix;\n    this.classItemOpen = `${classPrefix}-open`;\n    this.classHeader = `${classPrefix}-header`;\n    this.classBody = `${classPrefix}-body`;\n\n    this.$element = $(selector).first();\n\n    extend(this.options, options);\n\n    this.bindEvent();\n  }\n\n  /**\n   * 绑定事件\n   */\n  private bindEvent(): void {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const that = this;\n\n    // 点击 header 时，打开/关闭 item\n    this.$element.on('click', `.${this.classHeader}`, function () {\n      const $header = $(this as HTMLElement);\n      const $item = $header.parent();\n      const $items = that.getItems();\n\n      $items.each((_, item) => {\n        if ($item.is(item)) {\n          that.toggle(item);\n        }\n      });\n    });\n\n    // 点击关闭按钮时，关闭 item\n    this.$element.on(\n      'click',\n      `[mdui-${this.getNamespace()}-item-close]`,\n      function () {\n        const $target = $(this as HTMLElement);\n        const $item = $target.parents(`.${that.classItem}`).first();\n\n        that.close($item);\n      },\n    );\n  }\n\n  /**\n   * 指定 item 是否处于打开状态\n   * @param $item\n   */\n  private isOpen($item: JQ): boolean {\n    return $item.hasClass(this.classItemOpen);\n  }\n\n  /**\n   * 获取所有 item\n   */\n  private getItems(): JQ {\n    return this.$element.children(`.${this.classItem}`);\n  }\n\n  /**\n   * 获取指定 item\n   * @param item\n   */\n  private getItem(\n    item: number | Selector | HTMLElement | ArrayLike<HTMLElement>,\n  ): JQ {\n    if (isNumber(item)) {\n      return this.getItems().eq(item);\n    }\n\n    return $(item).first();\n  }\n\n  /**\n   * 触发组件事件\n   * @param name 事件名\n   * @param $item 事件触发的目标 item\n   */\n  private triggerEvent(name: EVENT, $item: JQ): void {\n    componentEvent(name, this.getNamespace(), $item, this);\n  }\n\n  /**\n   * 动画结束回调\n   * @param $content body 元素\n   * @param $item item 元素\n   */\n  private transitionEnd($content: JQ, $item: JQ): void {\n    if (this.isOpen($item)) {\n      $content.transition(0).height('auto').reflow().transition('');\n\n      this.triggerEvent('opened', $item);\n    } else {\n      $content.height('');\n\n      this.triggerEvent('closed', $item);\n    }\n  }\n\n  /**\n   * 打开指定面板项\n   * @param item 面板项的索引号、或 CSS 选择器、或 DOM 元素、或 JQ 对象\n   */\n  public open(\n    item: number | Selector | HTMLElement | ArrayLike<HTMLElement>,\n  ): void {\n    const $item = this.getItem(item);\n\n    if (this.isOpen($item)) {\n      return;\n    }\n\n    // 关闭其他项\n    if (this.options.accordion) {\n      this.$element.children(`.${this.classItemOpen}`).each((_, element) => {\n        const $element = $(element);\n\n        if (!$element.is($item)) {\n          this.close($element);\n        }\n      });\n    }\n\n    const $content = $item.children(`.${this.classBody}`);\n\n    $content\n      .height($content[0].scrollHeight)\n      .transitionEnd(() => this.transitionEnd($content, $item));\n\n    this.triggerEvent('open', $item);\n\n    $item.addClass(this.classItemOpen);\n  }\n\n  /**\n   * 关闭指定面板项\n   * @param item 面板项的索引号、或 CSS 选择器、或 DOM 元素、或 JQ 对象\n   */\n  public close(\n    item: number | Selector | HTMLElement | ArrayLike<HTMLElement>,\n  ): void {\n    const $item = this.getItem(item);\n\n    if (!this.isOpen($item)) {\n      return;\n    }\n\n    const $content = $item.children(`.${this.classBody}`);\n\n    this.triggerEvent('close', $item);\n\n    $item.removeClass(this.classItemOpen);\n\n    $content\n      .transition(0)\n      .height($content[0].scrollHeight)\n      .reflow()\n      .transition('')\n      .height('')\n      .transitionEnd(() => this.transitionEnd($content, $item));\n  }\n\n  /**\n   * 切换指定面板项的打开状态\n   * @param item 面板项的索引号、或 CSS 选择器、或 DOM 元素、或 JQ 对象\n   */\n  public toggle(\n    item: number | Selector | HTMLElement | ArrayLike<HTMLElement>,\n  ): void {\n    const $item = this.getItem(item);\n\n    this.isOpen($item) ? this.close($item) : this.open($item);\n  }\n\n  /**\n   * 打开所有面板项\n   */\n  public openAll(): void {\n    this.getItems().each((_, element) => this.open(element));\n  }\n\n  /**\n   * 关闭所有面板项\n   */\n  public closeAll(): void {\n    this.getItems().each((_, element) => this.close(element));\n  }\n}\n\nexport { OPTIONS, CollapseAbstract };\n","import Selector from 'mdui.jq/es/types/Selector';\nimport mdui from '../../mdui';\nimport { CollapseAbstract, OPTIONS } from './collapseAbstract';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 折叠内容块组件\n     *\n     * 请通过 `new mdui.Collapse()` 调用\n     */\n    Collapse: {\n      /**\n       * 实例化 Collapse 组件\n       * @param selector CSS 选择器或 DOM 元素\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Collapse;\n    };\n  }\n}\n\nclass Collapse extends CollapseAbstract {\n  protected getNamespace(): string {\n    return 'collapse';\n  }\n}\n\nmdui.Collapse = Collapse;\n","import $ from 'mdui.jq/es/$';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-collapse';\n\n$(() => {\n  mdui.mutation(`[${customAttr}]`, function () {\n    new mdui.Collapse(this, parseOptions(this, customAttr));\n  });\n});\n","import Selector from 'mdui.jq/es/types/Selector';\nimport mdui from '../../mdui';\nimport { CollapseAbstract, OPTIONS } from '../collapse/collapseAbstract';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 可扩展面板组件\n     *\n     * 请通过 `new mdui.Panel()` 调用\n     */\n    Panel: {\n      /**\n       * 实例化 Panel 组件\n       * @param selector CSS 选择器或 DOM 元素\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Panel;\n    };\n  }\n}\n\nclass Panel extends CollapseAbstract {\n  protected getNamespace(): string {\n    return 'panel';\n  }\n}\n\nmdui.Panel = Panel;\n","import $ from 'mdui.jq/es/$';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-panel';\n\n$(() => {\n  mdui.mutation(`[${customAttr}]`, function () {\n    new mdui.Panel(this, parseOptions(this, customAttr));\n  });\n});\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/add';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/eq';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/prependTo';\nimport 'mdui.jq/es/methods/remove';\nimport 'mdui.jq/es/methods/removeClass';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport { isUndefined } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 动态修改了表格后，需要调用该方法重新初始化表格。\n     *\n     * 若传入了参数，则只初始化该参数对应的表格。若没有传入参数，则重新初始化所有表格。\n     * @param selector CSS 选择器、或 DOM 元素、或 DOM 元素组成的数组、或 JQ 对象\n     */\n    updateTables(\n      selector?: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    ): void;\n  }\n}\n\nclass Table {\n  /**\n   * table 元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 表头 tr 元素\n   */\n  private $thRow: JQ = $();\n\n  /**\n   * 表格 body 中的 tr 元素\n   */\n  private $tdRows: JQ = $();\n\n  /**\n   * 表头的 checkbox 元素\n   */\n  private $thCheckbox: JQ<HTMLInputElement> = $();\n\n  /**\n   * 表格 body 中的 checkbox 元素\n   */\n  private $tdCheckboxs: JQ<HTMLInputElement> = $();\n\n  /**\n   * 表格行是否可选择\n   */\n  private selectable = false;\n\n  /**\n   * 已选中的行数\n   */\n  private selectedRow = 0;\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n  ) {\n    this.$element = $(selector).first();\n    this.init();\n  }\n\n  /**\n   * 初始化表格\n   */\n  public init(): void {\n    this.$thRow = this.$element.find('thead tr');\n    this.$tdRows = this.$element.find('tbody tr');\n    this.selectable = this.$element.hasClass('mdui-table-selectable');\n\n    this.updateThCheckbox();\n    this.updateTdCheckbox();\n    this.updateNumericCol();\n  }\n\n  /**\n   * 生成 checkbox 的 HTML 结构\n   * @param tag 标签名\n   */\n  private createCheckboxHTML(tag: string): string {\n    return (\n      `<${tag} class=\"mdui-table-cell-checkbox\">` +\n      '<label class=\"mdui-checkbox\">' +\n      '<input type=\"checkbox\"/>' +\n      '<i class=\"mdui-checkbox-icon\"></i>' +\n      '</label>' +\n      `</${tag}>`\n    );\n  }\n\n  /**\n   * 更新表头 checkbox 的状态\n   */\n  private updateThCheckboxStatus(): void {\n    const checkbox = this.$thCheckbox[0];\n    const selectedRow = this.selectedRow;\n    const tdRowsLength = this.$tdRows.length;\n\n    checkbox.checked = selectedRow === tdRowsLength;\n    checkbox.indeterminate = !!selectedRow && selectedRow !== tdRowsLength;\n  }\n\n  /**\n   * 更新表格行的 checkbox\n   */\n  private updateTdCheckbox(): void {\n    const rowSelectedClass = 'mdui-table-row-selected';\n\n    this.$tdRows.each((_, row) => {\n      const $row = $(row);\n\n      // 移除旧的 checkbox\n      $row.find('.mdui-table-cell-checkbox').remove();\n\n      if (!this.selectable) {\n        return;\n      }\n\n      // 创建 DOM\n      const $checkbox = $(this.createCheckboxHTML('td'))\n        .prependTo($row)\n        .find('input[type=\"checkbox\"]') as JQ<HTMLInputElement>;\n\n      // 默认选中的行\n      if ($row.hasClass(rowSelectedClass)) {\n        $checkbox[0].checked = true;\n        this.selectedRow++;\n      }\n\n      this.updateThCheckboxStatus();\n\n      // 绑定事件\n      $checkbox.on('change', () => {\n        if ($checkbox[0].checked) {\n          $row.addClass(rowSelectedClass);\n          this.selectedRow++;\n        } else {\n          $row.removeClass(rowSelectedClass);\n          this.selectedRow--;\n        }\n\n        this.updateThCheckboxStatus();\n      });\n\n      this.$tdCheckboxs = this.$tdCheckboxs.add($checkbox);\n    });\n  }\n\n  /**\n   * 更新表头的 checkbox\n   */\n  private updateThCheckbox(): void {\n    // 移除旧的 checkbox\n    this.$thRow.find('.mdui-table-cell-checkbox').remove();\n\n    if (!this.selectable) {\n      return;\n    }\n\n    this.$thCheckbox = $(this.createCheckboxHTML('th'))\n      .prependTo(this.$thRow)\n      .find('input[type=\"checkbox\"]')\n      .on('change', () => {\n        const isCheckedAll = this.$thCheckbox[0].checked;\n        this.selectedRow = isCheckedAll ? this.$tdRows.length : 0;\n\n        this.$tdCheckboxs.each((_, checkbox) => {\n          checkbox.checked = isCheckedAll;\n        });\n\n        this.$tdRows.each((_, row) => {\n          isCheckedAll\n            ? $(row).addClass('mdui-table-row-selected')\n            : $(row).removeClass('mdui-table-row-selected');\n        });\n      }) as JQ<HTMLInputElement>;\n  }\n\n  /**\n   * 更新数值列\n   */\n  private updateNumericCol(): void {\n    const numericClass = 'mdui-table-col-numeric';\n\n    this.$thRow.find('th').each((i, th) => {\n      const isNumericCol = $(th).hasClass(numericClass);\n\n      this.$tdRows.each((_, row) => {\n        const $td = $(row).find('td').eq(i);\n\n        isNumericCol\n          ? $td.addClass(numericClass)\n          : $td.removeClass(numericClass);\n      });\n    });\n  }\n}\n\nconst dataName = '_mdui_table';\n\n$(() => {\n  mdui.mutation('.mdui-table', function () {\n    const $element = $(this);\n\n    if (!$element.data(dataName)) {\n      $element.data(dataName, new Table($element));\n    }\n  });\n});\n\nmdui.updateTables = function (\n  selector?: Selector | HTMLElement | ArrayLike<HTMLElement>,\n): void {\n  const $elements = isUndefined(selector) ? $('.mdui-table') : $(selector);\n\n  $elements.each((_, element) => {\n    const $element = $(element);\n    const instance = $element.data(dataName);\n\n    if (instance) {\n      instance.init();\n    } else {\n      $element.data(dataName, new Table($element));\n    }\n  });\n};\n","/**\n * touch 事件后的 500ms 内禁用 mousedown 事件\n *\n * 不支持触控的屏幕上事件顺序为 mousedown -> mouseup -> click\n * 支持触控的屏幕上事件顺序为 touchstart -> touchend -> mousedown -> mouseup -> click\n *\n * 在每一个事件中都使用 TouchHandler.isAllow(event) 判断事件是否可执行\n * 在 touchstart 和 touchmove、touchend、touchcancel\n *\n * (function () {\n *   $document\n *     .on(start, function (e) {\n *       if (!isAllow(e)) {\n *         return;\n *       }\n *       register(e);\n *       console.log(e.type);\n *     })\n *     .on(move, function (e) {\n *       if (!isAllow(e)) {\n *         return;\n *       }\n *       console.log(e.type);\n *     })\n *     .on(end, function (e) {\n *       if (!isAllow(e)) {\n *         return;\n *       }\n *       console.log(e.type);\n *     })\n *     .on(unlock, register);\n * })();\n */\n\nconst startEvent = 'touchstart mousedown';\nconst moveEvent = 'touchmove mousemove';\nconst endEvent = 'touchend mouseup';\nconst cancelEvent = 'touchcancel mouseleave';\nconst unlockEvent = 'touchend touchmove touchcancel';\n\nlet touches = 0;\n\n/**\n * 该事件是否被允许，在执行事件前调用该方法判断事件是否可以执行\n * 若已触发 touch 事件，则阻止之后的鼠标事件\n * @param event\n */\nfunction isAllow(event: Event): boolean {\n  return !(\n    touches &&\n    [\n      'mousedown',\n      'mouseup',\n      'mousemove',\n      'click',\n      'mouseover',\n      'mouseout',\n      'mouseenter',\n      'mouseleave',\n    ].indexOf(event.type) > -1\n  );\n}\n\n/**\n * 在 touchstart 和 touchmove、touchend、touchcancel 事件中调用该方法注册事件\n * @param event\n */\nfunction register(event: Event): void {\n  if (event.type === 'touchstart') {\n    // 触发了 touch 事件\n    touches += 1;\n  } else if (\n    ['touchmove', 'touchend', 'touchcancel'].indexOf(event.type) > -1\n  ) {\n    // touch 事件结束 500ms 后解除对鼠标事件的阻止\n    setTimeout(function () {\n      if (touches) {\n        touches -= 1;\n      }\n    }, 500);\n  }\n}\n\nexport {\n  startEvent,\n  moveEvent,\n  endEvent,\n  cancelEvent,\n  unlockEvent,\n  isAllow,\n  register,\n};\n","/**\n * Inspired by https://github.com/nolimits4web/Framework7/blob/master/src/js/fast-clicks.js\n * https://github.com/nolimits4web/Framework7/blob/master/LICENSE\n *\n * Inspired by https://github.com/fians/Waves\n */\n\nimport $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/attr';\nimport 'mdui.jq/es/methods/children';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/innerHeight';\nimport 'mdui.jq/es/methods/innerWidth';\nimport 'mdui.jq/es/methods/off';\nimport 'mdui.jq/es/methods/offset';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/parents';\nimport 'mdui.jq/es/methods/prependTo';\nimport 'mdui.jq/es/methods/prop';\nimport 'mdui.jq/es/methods/remove';\nimport { isUndefined } from 'mdui.jq/es/utils';\nimport '../../jq_extends/methods/reflow';\nimport '../../jq_extends/methods/transform';\nimport '../../jq_extends/methods/transitionEnd';\nimport { $document } from '../../utils/dom';\nimport {\n  cancelEvent,\n  endEvent,\n  isAllow,\n  moveEvent,\n  register,\n  startEvent,\n  unlockEvent,\n} from '../../utils/touchHandler';\n\n/**\n * 显示涟漪动画\n * @param event\n * @param $ripple\n */\nfunction show(event: Event, $ripple: JQ): void {\n  // 鼠标右键不产生涟漪\n  if (event instanceof MouseEvent && event.button === 2) {\n    return;\n  }\n\n  // 点击位置坐标\n  const touchPosition =\n    typeof TouchEvent !== 'undefined' &&\n    event instanceof TouchEvent &&\n    event.touches.length\n      ? event.touches[0]\n      : (event as MouseEvent);\n\n  const touchStartX = touchPosition.pageX;\n  const touchStartY = touchPosition.pageY;\n\n  // 涟漪位置\n  const offset = $ripple.offset();\n  const height = $ripple.innerHeight();\n  const width = $ripple.innerWidth();\n  const center = {\n    x: touchStartX - offset.left,\n    y: touchStartY - offset.top,\n  };\n  const diameter = Math.max(\n    Math.pow(Math.pow(height, 2) + Math.pow(width, 2), 0.5),\n    48,\n  );\n\n  // 涟漪扩散动画\n  const translate =\n    `translate3d(${-center.x + width / 2}px,` +\n    `${-center.y + height / 2}px, 0) scale(1)`;\n\n  // 涟漪的 DOM 结构，并缓存动画效果\n  $(\n    `<div class=\"mdui-ripple-wave\" ` +\n      `style=\"width:${diameter}px;height:${diameter}px;` +\n      `margin-top:-${diameter / 2}px;margin-left:-${diameter / 2}px;` +\n      `left:${center.x}px;top:${center.y}px;\"></div>`,\n  )\n    .data('_ripple_wave_translate', translate)\n    .prependTo($ripple)\n    .reflow()\n    .transform(translate);\n}\n\n/**\n * 隐藏并移除涟漪\n * @param $wave\n */\nfunction removeRipple($wave: JQ): void {\n  if (!$wave.length || $wave.data('_ripple_wave_removed')) {\n    return;\n  }\n\n  $wave.data('_ripple_wave_removed', true);\n\n  let removeTimer = setTimeout(() => $wave.remove(), 400);\n  const translate = $wave.data('_ripple_wave_translate');\n\n  $wave\n    .addClass('mdui-ripple-wave-fill')\n    .transform(translate.replace('scale(1)', 'scale(1.01)'))\n    .transitionEnd(() => {\n      clearTimeout(removeTimer);\n\n      $wave\n        .addClass('mdui-ripple-wave-out')\n        .transform(translate.replace('scale(1)', 'scale(1.01)'));\n\n      removeTimer = setTimeout(() => $wave.remove(), 700);\n\n      setTimeout(() => {\n        $wave.transitionEnd(() => {\n          clearTimeout(removeTimer);\n          $wave.remove();\n        });\n      }, 0);\n    });\n}\n\n/**\n * 隐藏涟漪动画\n * @param this\n */\nfunction hide(this: any): void {\n  const $ripple = $(this as HTMLElement);\n\n  $ripple.children('.mdui-ripple-wave').each((_, wave) => {\n    removeRipple($(wave));\n  });\n\n  $ripple.off(`${moveEvent} ${endEvent} ${cancelEvent}`, hide);\n}\n\n/**\n * 显示涟漪，并绑定 touchend 等事件\n * @param event\n */\nfunction showRipple(event: Event): void {\n  if (!isAllow(event)) {\n    return;\n  }\n\n  register(event);\n\n  // Chrome 59 点击滚动条时，会在 document 上触发事件\n  if (event.target === document) {\n    return;\n  }\n\n  const $target = $(event.target as HTMLElement);\n\n  // 获取含 .mdui-ripple 类的元素\n  const $ripple = $target.hasClass('mdui-ripple')\n    ? $target\n    : $target.parents('.mdui-ripple').first();\n\n  if (!$ripple.length) {\n    return;\n  }\n\n  // 禁用状态的元素上不产生涟漪效果\n  if ($ripple.prop('disabled') || !isUndefined($ripple.attr('disabled'))) {\n    return;\n  }\n\n  if (event.type === 'touchstart') {\n    let hidden = false;\n\n    // touchstart 触发指定时间后开始涟漪动画，避免手指滑动时也触发涟漪\n    let timer = setTimeout(() => {\n      timer = 0;\n      show(event, $ripple);\n    }, 200);\n\n    const hideRipple = (): void => {\n      // 如果手指没有移动，且涟漪动画还没有开始，则开始涟漪动画\n      if (timer) {\n        clearTimeout(timer);\n        timer = 0;\n        show(event, $ripple);\n      }\n\n      if (!hidden) {\n        hidden = true;\n        hide.call($ripple);\n      }\n    };\n\n    // 手指移动后，移除涟漪动画\n    const touchMove = (): void => {\n      if (timer) {\n        clearTimeout(timer);\n        timer = 0;\n      }\n\n      hideRipple();\n    };\n\n    $ripple.on('touchmove', touchMove).on('touchend touchcancel', hideRipple);\n  } else {\n    show(event, $ripple);\n    $ripple.on(`${moveEvent} ${endEvent} ${cancelEvent}`, hide);\n  }\n}\n\n$(() => {\n  $document.on(startEvent, showRipple).on(unlockEvent, register);\n});\n","import $ from 'mdui.jq/es/$';\nimport extend from 'mdui.jq/es/functions/extend';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/appendTo';\nimport 'mdui.jq/es/methods/attr';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/is';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/outerHeight';\nimport 'mdui.jq/es/methods/parent';\nimport 'mdui.jq/es/methods/parents';\nimport 'mdui.jq/es/methods/remove';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/text';\nimport 'mdui.jq/es/methods/trigger';\nimport 'mdui.jq/es/methods/val';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport { isUndefined } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport { $document } from '../../utils/dom';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 动态修改了文本框后，需要调用该方法重新初始化文本框。\n     *\n     * 若传入了参数，则只初始化该参数对应的文本框。若没有传入参数，则重新初始化所有文本框。\n     * @param selector CSS 选择器、或 DOM 元素、或 DOM 元素组成的数组、或 JQ 对象\n     */\n    updateTextFields(\n      selector?: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    ): void;\n  }\n}\n\ntype INPUT_EVENT_DATA = {\n  reInit?: boolean;\n  domLoadedEvent?: boolean;\n};\n\nconst defaultData: INPUT_EVENT_DATA = {\n  reInit: false,\n  domLoadedEvent: false,\n};\n\n/**\n * 输入框事件\n * @param event\n * @param data\n */\nfunction inputEvent(event: Event, data: INPUT_EVENT_DATA = {}): void {\n  data = extend({}, defaultData, data);\n\n  const input = event.target as HTMLInputElement;\n  const $input = $(input);\n  const eventType = event.type;\n  const value = $input.val() as string;\n\n  // 文本框类型\n  const inputType = $input.attr('type') || '';\n  if (\n    ['checkbox', 'button', 'submit', 'range', 'radio', 'image'].indexOf(\n      inputType,\n    ) > -1\n  ) {\n    return;\n  }\n\n  const $textfield = $input.parent('.mdui-textfield');\n\n  // 输入框是否聚焦\n  if (eventType === 'focus') {\n    $textfield.addClass('mdui-textfield-focus');\n  }\n\n  if (eventType === 'blur') {\n    $textfield.removeClass('mdui-textfield-focus');\n  }\n\n  // 输入框是否为空\n  if (eventType === 'blur' || eventType === 'input') {\n    value\n      ? $textfield.addClass('mdui-textfield-not-empty')\n      : $textfield.removeClass('mdui-textfield-not-empty');\n  }\n\n  // 输入框是否禁用\n  input.disabled\n    ? $textfield.addClass('mdui-textfield-disabled')\n    : $textfield.removeClass('mdui-textfield-disabled');\n\n  // 表单验证\n  if (\n    (eventType === 'input' || eventType === 'blur') &&\n    !data.domLoadedEvent &&\n    input.validity\n  ) {\n    input.validity.valid\n      ? $textfield.removeClass('mdui-textfield-invalid-html5')\n      : $textfield.addClass('mdui-textfield-invalid-html5');\n  }\n\n  // textarea 高度自动调整\n  if ($input.is('textarea')) {\n    // IE bug：textarea 的值仅为多个换行，不含其他内容时，textarea 的高度不准确\n    //         此时，在计算高度前，在值的开头加入一个空格，计算完后，移除空格\n    const inputValue = value;\n    let hasExtraSpace = false;\n\n    if (inputValue.replace(/[\\r\\n]/g, '') === '') {\n      $input.val(' ' + inputValue);\n      hasExtraSpace = true;\n    }\n\n    // 设置 textarea 高度\n    $input.outerHeight('');\n    const height = $input.outerHeight();\n    const scrollHeight = input.scrollHeight;\n\n    if (scrollHeight > height) {\n      $input.outerHeight(scrollHeight);\n    }\n\n    // 计算完，还原 textarea 的值\n    if (hasExtraSpace) {\n      $input.val(inputValue);\n    }\n  }\n\n  // 实时字数统计\n  if (data.reInit) {\n    $textfield.find('.mdui-textfield-counter').remove();\n  }\n\n  const maxLength = $input.attr('maxlength');\n  if (maxLength) {\n    if (data.reInit || data.domLoadedEvent) {\n      $(\n        '<div class=\"mdui-textfield-counter\">' +\n          `<span class=\"mdui-textfield-counter-inputed\"></span> / ${maxLength}` +\n          '</div>',\n      ).appendTo($textfield);\n    }\n\n    $textfield\n      .find('.mdui-textfield-counter-inputed')\n      .text(value.length.toString());\n  }\n\n  // 含 帮助文本、错误提示、字数统计 时，增加文本框底部内边距\n  if (\n    $textfield.find('.mdui-textfield-helper').length ||\n    $textfield.find('.mdui-textfield-error').length ||\n    maxLength\n  ) {\n    $textfield.addClass('mdui-textfield-has-bottom');\n  }\n}\n\n$(() => {\n  // 绑定事件\n  $document.on(\n    'input focus blur',\n    '.mdui-textfield-input',\n    { useCapture: true },\n    inputEvent,\n  );\n\n  // 可展开文本框展开\n  $document.on(\n    'click',\n    '.mdui-textfield-expandable .mdui-textfield-icon',\n    function () {\n      $(this as HTMLElement)\n        .parents('.mdui-textfield')\n        .addClass('mdui-textfield-expanded')\n        .find('.mdui-textfield-input')[0]\n        .focus();\n    },\n  );\n\n  // 可展开文本框关闭\n  $document.on(\n    'click',\n    '.mdui-textfield-expanded .mdui-textfield-close',\n    function () {\n      $(this)\n        .parents('.mdui-textfield')\n        .removeClass('mdui-textfield-expanded')\n        .find('.mdui-textfield-input')\n        .val('');\n    },\n  );\n\n  /**\n   * 初始化文本框\n   */\n  mdui.mutation('.mdui-textfield', function () {\n    $(this).find('.mdui-textfield-input').trigger('input', {\n      domLoadedEvent: true,\n    });\n  });\n});\n\nmdui.updateTextFields = function (\n  selector?: Selector | HTMLElement | ArrayLike<HTMLElement>,\n): void {\n  const $elements = isUndefined(selector) ? $('.mdui-textfield') : $(selector);\n\n  $elements.each((_, element) => {\n    $(element).find('.mdui-textfield-input').trigger('input', {\n      reInit: true,\n    });\n  });\n};\n","import $ from 'mdui.jq/es/$';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/append';\nimport 'mdui.jq/es/methods/attr';\nimport 'mdui.jq/es/methods/css';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/empty';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/parent';\nimport 'mdui.jq/es/methods/remove';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/text';\nimport 'mdui.jq/es/methods/val';\nimport 'mdui.jq/es/methods/width';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport { isUndefined } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport { $document } from '../../utils/dom';\nimport {\n  endEvent,\n  isAllow,\n  register,\n  startEvent,\n  unlockEvent,\n} from '../../utils/touchHandler';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 动态修改了滑块后，需要调用该方法重新初始化滑块\n     *\n     * 若传入了参数，则只初始化该参数对应的滑块。若没有传入参数，则重新初始化所有滑块。\n     * @param selector CSS 选择器、或 DOM 元素、或 DOM 元素组成的数组、或 JQ 对象\n     */\n    updateSliders(\n      selector?: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    ): void;\n  }\n}\n\n/**\n * 滑块的值改变后修改滑块样式\n * @param $slider\n */\nfunction updateValueStyle($slider: JQ): void {\n  const data = $slider.data();\n\n  const $track = data._slider_$track;\n  const $fill = data._slider_$fill;\n  const $thumb = data._slider_$thumb;\n  const $input = data._slider_$input;\n  const min = data._slider_min;\n  const max = data._slider_max;\n  const isDisabled = data._slider_disabled;\n  const isDiscrete = data._slider_discrete;\n  const $thumbText = data._slider_$thumbText;\n  const value = $input.val();\n  const percent = ((value - min) / (max - min)) * 100;\n\n  $fill.width(`${percent}%`);\n  $track.width(`${100 - percent}%`);\n\n  if (isDisabled) {\n    $fill.css('padding-right', '6px');\n    $track.css('padding-left', '6px');\n  }\n\n  $thumb.css('left', `${percent}%`);\n\n  if (isDiscrete) {\n    $thumbText.text(value);\n  }\n\n  percent === 0\n    ? $slider.addClass('mdui-slider-zero')\n    : $slider.removeClass('mdui-slider-zero');\n}\n\n/**\n * 重新初始化滑块\n * @param $slider\n */\nfunction reInit($slider: JQ): void {\n  const $track = $('<div class=\"mdui-slider-track\"></div>');\n  const $fill = $('<div class=\"mdui-slider-fill\"></div>');\n  const $thumb = $('<div class=\"mdui-slider-thumb\"></div>');\n  const $input = $slider.find('input[type=\"range\"]') as JQ<HTMLInputElement>;\n  const isDisabled = $input[0].disabled;\n  const isDiscrete = $slider.hasClass('mdui-slider-discrete');\n\n  // 禁用状态\n  isDisabled\n    ? $slider.addClass('mdui-slider-disabled')\n    : $slider.removeClass('mdui-slider-disabled');\n\n  // 重新填充 HTML\n  $slider.find('.mdui-slider-track').remove();\n  $slider.find('.mdui-slider-fill').remove();\n  $slider.find('.mdui-slider-thumb').remove();\n  $slider.append($track).append($fill).append($thumb);\n\n  // 间续型滑块\n  let $thumbText = $();\n  if (isDiscrete) {\n    $thumbText = $('<span></span>');\n    $thumb.empty().append($thumbText);\n  }\n\n  $slider.data('_slider_$track', $track);\n  $slider.data('_slider_$fill', $fill);\n  $slider.data('_slider_$thumb', $thumb);\n  $slider.data('_slider_$input', $input);\n  $slider.data('_slider_min', $input.attr('min'));\n  $slider.data('_slider_max', $input.attr('max'));\n  $slider.data('_slider_disabled', isDisabled);\n  $slider.data('_slider_discrete', isDiscrete);\n  $slider.data('_slider_$thumbText', $thumbText);\n\n  // 设置默认值\n  updateValueStyle($slider);\n}\n\nconst rangeSelector = '.mdui-slider input[type=\"range\"]';\n\n$(() => {\n  // 滑块滑动事件\n  $document.on('input change', rangeSelector, function () {\n    const $slider = $(this).parent() as JQ<HTMLElement>;\n\n    updateValueStyle($slider);\n  });\n\n  // 开始触摸滑块事件\n  $document.on(startEvent, rangeSelector, function (event: Event) {\n    if (!isAllow(event)) {\n      return;\n    }\n\n    register(event);\n\n    if ((this as HTMLInputElement).disabled) {\n      return;\n    }\n\n    const $slider = $(this).parent() as JQ<HTMLElement>;\n\n    $slider.addClass('mdui-slider-focus');\n  });\n\n  // 结束触摸滑块事件\n  $document.on(endEvent, rangeSelector, function (event: Event) {\n    if (!isAllow(event)) {\n      return;\n    }\n\n    if ((this as HTMLInputElement).disabled) {\n      return;\n    }\n\n    const $slider = $(this).parent() as JQ<HTMLElement>;\n\n    $slider.removeClass('mdui-slider-focus');\n  });\n\n  $document.on(unlockEvent, rangeSelector, register);\n\n  /**\n   * 初始化滑块\n   */\n  mdui.mutation('.mdui-slider', function () {\n    reInit($(this));\n  });\n});\n\nmdui.updateSliders = function (\n  selector?: Selector | HTMLElement | ArrayLike<HTMLElement>,\n): void {\n  const $elements = isUndefined(selector) ? $('.mdui-slider') : $(selector);\n\n  $elements.each((_, element) => {\n    reInit($(element));\n  });\n};\n","import $ from 'mdui.jq/es/$';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/css';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/last';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/parents';\nimport 'mdui.jq/es/methods/removeClass';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport mdui from '../../mdui';\nimport '../../jq_extends/methods/transitionEnd';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $document } from '../../utils/dom';\nimport { startEvent } from '../../utils/touchHandler';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 浮动操作按钮组件\n     *\n     * 请通过 `new mdui.Fab()` 调用\n     */\n    Fab: {\n      /**\n       * 实例化 Fab 组件\n       * @param selector CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Fab;\n    };\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * 触发方式。`hover`: 鼠标悬浮触发；`click`: 点击触发\n   *\n   * 默认为 `hover`\n   */\n  trigger?: 'click' | 'hover';\n};\n\ntype STATE = 'opening' | 'opened' | 'closing' | 'closed';\ntype EVENT = 'open' | 'opened' | 'close' | 'closed';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  trigger: 'hover',\n};\n\nclass Fab {\n  /**\n   * Fab 元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * 当前 fab 的状态\n   */\n  private state: STATE = 'closed';\n\n  /**\n   * 按钮元素\n   */\n  private $btn: JQ;\n\n  /**\n   * 拨号菜单元素\n   */\n  private $dial: JQ;\n\n  /**\n   * 拨号菜单内的按钮\n   */\n  private $dialBtns: JQ;\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    this.$element = $(selector).first();\n\n    extend(this.options, options);\n\n    this.$btn = this.$element.find('.mdui-fab');\n    this.$dial = this.$element.find('.mdui-fab-dial');\n    this.$dialBtns = this.$dial.find('.mdui-fab');\n\n    if (this.options.trigger === 'hover') {\n      this.$btn.on('touchstart mouseenter', () => this.open());\n      this.$element.on('mouseleave', () => this.close());\n    }\n\n    if (this.options.trigger === 'click') {\n      this.$btn.on(startEvent, () => this.open());\n    }\n\n    // 触摸屏幕其他地方关闭快速拨号\n    $document.on(startEvent, (event) => {\n      if ($(event.target as HTMLElement).parents('.mdui-fab-wrapper').length) {\n        return;\n      }\n\n      this.close();\n    });\n  }\n\n  /**\n   * 触发组件事件\n   * @param name\n   */\n  private triggerEvent(name: EVENT): void {\n    componentEvent(name, 'fab', this.$element, this);\n  }\n\n  /**\n   * 当前是否为打开状态\n   */\n  private isOpen(): boolean {\n    return this.state === 'opening' || this.state === 'opened';\n  }\n\n  /**\n   * 打开快速拨号菜单\n   */\n  public open(): void {\n    if (this.isOpen()) {\n      return;\n    }\n\n    // 为菜单中的按钮添加不同的 transition-delay\n    this.$dialBtns.each((index, btn) => {\n      const delay = `${15 * (this.$dialBtns.length - index)}ms`;\n\n      btn.style.transitionDelay = delay;\n      btn.style.webkitTransitionDelay = delay;\n    });\n\n    this.$dial.css('height', 'auto').addClass('mdui-fab-dial-show');\n\n    // 如果按钮中存在 .mdui-fab-opened 的图标，则进行图标切换\n    if (this.$btn.find('.mdui-fab-opened').length) {\n      this.$btn.addClass('mdui-fab-opened');\n    }\n\n    this.state = 'opening';\n    this.triggerEvent('open');\n\n    // 打开顺序为从下到上逐个打开，最上面的打开后才表示动画完成\n    this.$dialBtns.first().transitionEnd(() => {\n      if (this.$btn.hasClass('mdui-fab-opened')) {\n        this.state = 'opened';\n        this.triggerEvent('opened');\n      }\n    });\n  }\n\n  /**\n   * 关闭快速拨号菜单\n   */\n  public close(): void {\n    if (!this.isOpen()) {\n      return;\n    }\n\n    // 为菜单中的按钮添加不同的 transition-delay\n    this.$dialBtns.each((index, btn) => {\n      const delay = `${15 * index}ms`;\n\n      btn.style.transitionDelay = delay;\n      btn.style.webkitTransitionDelay = delay;\n    });\n\n    this.$dial.removeClass('mdui-fab-dial-show');\n    this.$btn.removeClass('mdui-fab-opened');\n    this.state = 'closing';\n    this.triggerEvent('close');\n\n    // 从上往下依次关闭，最后一个关闭后才表示动画完成\n    this.$dialBtns.last().transitionEnd(() => {\n      if (this.$btn.hasClass('mdui-fab-opened')) {\n        return;\n      }\n\n      this.state = 'closed';\n      this.triggerEvent('closed');\n      this.$dial.css('height', 0);\n    });\n  }\n\n  /**\n   * 切换快速拨号菜单的打开状态\n   */\n  public toggle(): void {\n    this.isOpen() ? this.close() : this.open();\n  }\n\n  /**\n   * 以动画的形式显示整个浮动操作按钮\n   */\n  public show(): void {\n    this.$element.removeClass('mdui-fab-hide');\n  }\n\n  /**\n   * 以动画的形式隐藏整个浮动操作按钮\n   */\n  public hide(): void {\n    this.$element.addClass('mdui-fab-hide');\n  }\n\n  /**\n   * 返回当前快速拨号菜单的打开状态。共包含四种状态：`opening`、`opened`、`closing`、`closed`\n   */\n  public getState(): STATE {\n    return this.state;\n  }\n}\n\nmdui.Fab = Fab;\n","import $ from 'mdui.jq/es/$';\nimport mdui from '../../mdui';\nimport { $document } from '../../utils/dom';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-fab';\n\n$(() => {\n  // mouseenter 不冒泡，无法进行事件委托，这里用 mouseover 代替。\n  // 不管是 click 、 mouseover 还是 touchstart ，都先初始化。\n\n  $document.on(\n    'touchstart mousedown mouseover',\n    `[${customAttr}]`,\n    function () {\n      new mdui.Fab(\n        this as HTMLElement,\n        parseOptions(this as HTMLElement, customAttr),\n      );\n    },\n  );\n});\n","/**\n * 最终生成的元素结构为：\n *  <select class=\"mdui-select\" mdui-select=\"{position: 'top'}\" style=\"display: none;\"> // $native\n *    <option value=\"1\">State 1</option>\n *    <option value=\"2\">State 2</option>\n *    <option value=\"3\" disabled=\"\">State 3</option>\n *  </select>\n *  <div class=\"mdui-select mdui-select-position-top\" style=\"\" id=\"88dec0e4-d4a2-c6d0-0e7f-1ba4501e0553\"> // $element\n *    <span class=\"mdui-select-selected\">State 1</span> // $selected\n *    <div class=\"mdui-select-menu\" style=\"transform-origin: center 100% 0px;\"> // $menu\n *      <div class=\"mdui-select-menu-item mdui-ripple\" selected=\"\">State 1</div> // $items\n *      <div class=\"mdui-select-menu-item mdui-ripple\">State 2</div>\n *      <div class=\"mdui-select-menu-item mdui-ripple\" disabled=\"\">State 3</div>\n *    </div>\n *  </div>\n */\n\nimport $ from 'mdui.jq/es/$';\nimport contains from 'mdui.jq/es/functions/contains';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/add';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/after';\nimport 'mdui.jq/es/methods/append';\nimport 'mdui.jq/es/methods/appendTo';\nimport 'mdui.jq/es/methods/attr';\nimport 'mdui.jq/es/methods/css';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/height';\nimport 'mdui.jq/es/methods/hide';\nimport 'mdui.jq/es/methods/index';\nimport 'mdui.jq/es/methods/innerWidth';\nimport 'mdui.jq/es/methods/is';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/remove';\nimport 'mdui.jq/es/methods/removeAttr';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/show';\nimport 'mdui.jq/es/methods/text';\nimport 'mdui.jq/es/methods/trigger';\nimport 'mdui.jq/es/methods/val';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport mdui from '../../mdui';\nimport '../../jq_extends/methods/transitionEnd';\nimport '../../jq_extends/static/guid';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $document, $window } from '../../utils/dom';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 下拉选择组件\n     *\n     * 请通过 `new mdui.Select()` 调用\n     */\n    Select: {\n      /**\n       * 实例化 Select 组件\n       * @param selector CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Select;\n    };\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * 下拉框位置：`auto`、`top`、`bottom`\n   */\n  position?: 'auto' | 'top' | 'bottom';\n\n  /**\n   * 菜单与窗口上下边框至少保持多少间距\n   */\n  gutter?: number;\n};\n\ntype STATE = 'closing' | 'closed' | 'opening' | 'opened';\ntype EVENT = 'open' | 'opened' | 'close' | 'closed';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  position: 'auto',\n  gutter: 16,\n};\n\nclass Select {\n  /**\n   * 原生 `<select>` 元素的 JQ 对象\n   */\n  public $native: JQ<HTMLSelectElement>;\n\n  /**\n   * 生成的 `<div class=\"mdui-select\">` 元素的 JQ 对象\n   */\n  public $element: JQ = $();\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * select 的 size 属性的值，根据该值设置 select 的高度\n   */\n  private size = 0;\n\n  /**\n   * 占位元素，显示已选中菜单项的文本\n   */\n  private $selected: JQ = $();\n\n  /**\n   * 菜单项的外层元素的 JQ 对象\n   */\n  private $menu: JQ = $();\n\n  /**\n   * 菜单项数组的 JQ 对象\n   */\n  private $items: JQ = $();\n\n  /**\n   * 当前选中的菜单项的索引号\n   */\n  private selectedIndex = 0;\n\n  /**\n   * 当前选中菜单项的文本\n   */\n  private selectedText = '';\n\n  /**\n   * 当前选中菜单项的值\n   */\n  private selectedValue = '';\n\n  /**\n   * 唯一 ID\n   */\n  private uniqueID: string;\n\n  /**\n   * 当前 select 的状态\n   */\n  private state: STATE = 'closed';\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    this.$native = $(selector).first() as JQ<HTMLSelectElement>;\n    this.$native.hide();\n\n    extend(this.options, options);\n\n    // 为当前 select 生成唯一 ID\n    this.uniqueID = $.guid();\n\n    // 生成 select\n    this.handleUpdate();\n\n    // 点击 select 外面区域关闭\n    $document.on('click touchstart', (event: Event) => {\n      const $target = $(event.target as HTMLElement);\n\n      if (\n        this.isOpen() &&\n        !$target.is(this.$element) &&\n        !contains(this.$element[0], $target[0])\n      ) {\n        this.close();\n      }\n    });\n  }\n\n  /**\n   * 调整菜单位置\n   */\n  private readjustMenu(): void {\n    const windowHeight = $window.height();\n\n    // mdui-select 高度\n    const elementHeight = this.$element.height();\n\n    // 菜单项高度\n    const $itemFirst = this.$items.first();\n    const itemHeight = $itemFirst.height();\n    const itemMargin = parseInt($itemFirst.css('margin-top'));\n\n    // 菜单高度\n    const menuWidth = this.$element.innerWidth() + 0.01; // 必须比真实宽度多一点，不然会出现省略号\n    let menuHeight = itemHeight * this.size + itemMargin * 2;\n\n    // mdui-select 在窗口中的位置\n    const elementTop = this.$element[0].getBoundingClientRect().top;\n\n    let transformOriginY: string;\n    let menuMarginTop: number;\n\n    if (this.options.position === 'bottom') {\n      menuMarginTop = elementHeight;\n      transformOriginY = '0px';\n    } else if (this.options.position === 'top') {\n      menuMarginTop = -menuHeight - 1;\n      transformOriginY = '100%';\n    } else {\n      // 菜单高度不能超过窗口高度\n      const menuMaxHeight = windowHeight - this.options.gutter! * 2;\n      if (menuHeight > menuMaxHeight) {\n        menuHeight = menuMaxHeight;\n      }\n\n      // 菜单的 margin-top\n      menuMarginTop = -(\n        itemMargin +\n        this.selectedIndex * itemHeight +\n        (itemHeight - elementHeight) / 2\n      );\n\n      const menuMaxMarginTop = -(\n        itemMargin +\n        (this.size - 1) * itemHeight +\n        (itemHeight - elementHeight) / 2\n      );\n      if (menuMarginTop < menuMaxMarginTop) {\n        menuMarginTop = menuMaxMarginTop;\n      }\n\n      // 菜单不能超出窗口\n      const menuTop = elementTop + menuMarginTop;\n      if (menuTop < this.options.gutter!) {\n        // 不能超出窗口上方\n        menuMarginTop = -(elementTop - this.options.gutter!);\n      } else if (menuTop + menuHeight + this.options.gutter! > windowHeight) {\n        // 不能超出窗口下方\n        menuMarginTop = -(\n          elementTop +\n          menuHeight +\n          this.options.gutter! -\n          windowHeight\n        );\n      }\n\n      // transform 的 Y 轴坐标\n      transformOriginY = `${\n        this.selectedIndex * itemHeight + itemHeight / 2 + itemMargin\n      }px`;\n    }\n\n    // 设置样式\n    this.$element.innerWidth(menuWidth);\n    this.$menu\n      .innerWidth(menuWidth)\n      .height(menuHeight)\n      .css({\n        'margin-top': menuMarginTop + 'px',\n        'transform-origin': 'center ' + transformOriginY + ' 0',\n      });\n  }\n\n  /**\n   * select 是否为打开状态\n   */\n  private isOpen(): boolean {\n    return this.state === 'opening' || this.state === 'opened';\n  }\n\n  /**\n   * 对原生 select 组件进行了修改后，需要调用该方法\n   */\n  public handleUpdate(): void {\n    if (this.isOpen()) {\n      this.close();\n    }\n\n    this.selectedValue = this.$native.val() as string;\n\n    // 保存菜单项数据的数组\n    type typeItemsData = {\n      value: string;\n      text: string;\n      disabled: boolean;\n      selected: boolean;\n      index: number;\n    };\n    const itemsData: typeItemsData[] = [];\n    this.$items = $();\n\n    // 生成 HTML\n    this.$native.find('option').each((index, option) => {\n      const text = option.textContent || '';\n      const value = option.value;\n      const disabled = option.disabled;\n      const selected = this.selectedValue === value;\n\n      itemsData.push({\n        value,\n        text,\n        disabled,\n        selected,\n        index,\n      });\n\n      if (selected) {\n        this.selectedText = text;\n        this.selectedIndex = index;\n      }\n\n      this.$items = this.$items.add(\n        '<div class=\"mdui-select-menu-item mdui-ripple\"' +\n          (disabled ? ' disabled' : '') +\n          (selected ? ' selected' : '') +\n          `>${text}</div>`,\n      );\n    });\n\n    this.$selected = $(\n      `<span class=\"mdui-select-selected\">${this.selectedText}</span>`,\n    );\n\n    this.$element = $(\n      `<div class=\"mdui-select mdui-select-position-${this.options.position}\" ` +\n        `style=\"${this.$native.attr('style')}\" ` +\n        `id=\"${this.uniqueID}\"></div>`,\n    )\n      .show()\n      .append(this.$selected);\n\n    this.$menu = $('<div class=\"mdui-select-menu\"></div>')\n      .appendTo(this.$element)\n      .append(this.$items);\n\n    $(`#${this.uniqueID}`).remove();\n    this.$native.after(this.$element);\n\n    // 根据 select 的 size 属性设置高度\n    this.size = parseInt(this.$native.attr('size') || '0');\n\n    if (this.size <= 0) {\n      this.size = this.$items.length;\n\n      if (this.size > 8) {\n        this.size = 8;\n      }\n    }\n\n    // 点击选项时关闭下拉菜单\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const that = this;\n    this.$items.on('click', function () {\n      if (that.state === 'closing') {\n        return;\n      }\n\n      const $item = $(this);\n      const index = $item.index();\n      const data = itemsData[index];\n\n      if (data.disabled) {\n        return;\n      }\n\n      that.$selected.text(data.text);\n      that.$native.val(data.value);\n      that.$items.removeAttr('selected');\n      $item.attr('selected', '');\n      that.selectedIndex = data.index;\n      that.selectedValue = data.value;\n      that.selectedText = data.text;\n      that.$native.trigger('change');\n      that.close();\n    });\n\n    // 点击 $element 时打开下拉菜单\n    this.$element.on('click', (event: Event) => {\n      const $target = $(event.target as HTMLElement);\n\n      // 在菜单上点击时不打开\n      if (\n        $target.is('.mdui-select-menu') ||\n        $target.is('.mdui-select-menu-item')\n      ) {\n        return;\n      }\n\n      this.toggle();\n    });\n  }\n\n  /**\n   * 动画结束的回调\n   */\n  private transitionEnd(): void {\n    this.$element.removeClass('mdui-select-closing');\n\n    if (this.state === 'opening') {\n      this.state = 'opened';\n      this.triggerEvent('opened');\n      this.$menu.css('overflow-y', 'auto');\n    }\n\n    if (this.state === 'closing') {\n      this.state = 'closed';\n      this.triggerEvent('closed');\n\n      // 恢复样式\n      this.$element.innerWidth('');\n      this.$menu.css({\n        'margin-top': '',\n        height: '',\n        width: '',\n      });\n    }\n  }\n\n  /**\n   * 触发组件事件\n   * @param name\n   */\n  private triggerEvent(name: EVENT): void {\n    componentEvent(name, 'select', this.$native, this);\n  }\n\n  /**\n   * 切换下拉菜单的打开状态\n   */\n  public toggle(): void {\n    this.isOpen() ? this.close() : this.open();\n  }\n\n  /**\n   * 打开下拉菜单\n   */\n  public open(): void {\n    if (this.isOpen()) {\n      return;\n    }\n\n    this.state = 'opening';\n    this.triggerEvent('open');\n    this.readjustMenu();\n    this.$element.addClass('mdui-select-open');\n    this.$menu.transitionEnd(() => this.transitionEnd());\n  }\n\n  /**\n   * 关闭下拉菜单\n   */\n  public close(): void {\n    if (!this.isOpen()) {\n      return;\n    }\n\n    this.state = 'closing';\n    this.triggerEvent('close');\n    this.$menu.css('overflow-y', '');\n    this.$element\n      .removeClass('mdui-select-open')\n      .addClass('mdui-select-closing');\n    this.$menu.transitionEnd(() => this.transitionEnd());\n  }\n\n  /**\n   * 获取当前菜单的状态。共包含四种状态：`opening`、`opened`、`closing`、`closed`\n   */\n  public getState(): STATE {\n    return this.state;\n  }\n}\n\nmdui.Select = Select;\n","import $ from 'mdui.jq/es/$';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-select';\n\n$(() => {\n  mdui.mutation(`[${customAttr}]`, function () {\n    new mdui.Select(this, parseOptions(this, customAttr));\n  });\n});\n","import $ from 'mdui.jq/es/$';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport '../headroom';\n\n$(() => {\n  // 滚动时隐藏应用栏\n  mdui.mutation('.mdui-appbar-scroll-hide', function () {\n    new mdui.Headroom(this);\n  });\n\n  // 滚动时只隐藏应用栏中的工具栏\n  mdui.mutation('.mdui-appbar-scroll-toolbar-hide', function () {\n    new mdui.Headroom(this, {\n      pinnedClass: 'mdui-headroom-pinned-toolbar',\n      unpinnedClass: 'mdui-headroom-unpinned-toolbar',\n    });\n  });\n});\n","import $ from 'mdui.jq/es/$';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/appendTo';\nimport 'mdui.jq/es/methods/attr';\nimport 'mdui.jq/es/methods/children';\nimport 'mdui.jq/es/methods/css';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/eq';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/get';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/hide';\nimport 'mdui.jq/es/methods/index';\nimport 'mdui.jq/es/methods/innerWidth';\nimport 'mdui.jq/es/methods/offset';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/show';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport { isNumber } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport '../../jq_extends/static/throttle';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $window } from '../../utils/dom';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * Tab 选项卡组件\n     *\n     * 请通过 `new mdui.Tab()` 调用\n     */\n    Tab: {\n      /**\n       * 实例化 Tab 组件\n       * @param selector CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Tab;\n    };\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * 切换选项卡的触发方式。`click`: 点击切换；`hover`: 鼠标悬浮切换\n   */\n  trigger?: 'click' | 'hover';\n\n  /**\n   * 是否启用循环切换，若为 `true`，则最后一个选项激活时调用 `next` 方法将回到第一个选项，第一个选项激活时调用 `prev` 方法将回到最后一个选项。\n   */\n  loop?: boolean;\n};\n\ntype EVENT = 'change' | 'show';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  trigger: 'click',\n  loop: false,\n};\n\nclass Tab {\n  /**\n   * tab 元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * 当前激活的 tab 的索引号。为 -1 时表示没有激活的选项卡，或不存在选项卡\n   */\n  public activeIndex = -1;\n\n  /**\n   * 选项数组 JQ 对象\n   */\n  private $tabs: JQ;\n\n  /**\n   * 激活状态的 tab 底部的指示符\n   */\n  private $indicator: JQ;\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    this.$element = $(selector).first();\n\n    extend(this.options, options);\n\n    this.$tabs = this.$element.children('a');\n    this.$indicator = $('<div class=\"mdui-tab-indicator\"></div>').appendTo(\n      this.$element,\n    );\n\n    // 根据 url hash 获取默认激活的选项卡\n    const hash = window.location.hash;\n    if (hash) {\n      this.$tabs.each((index, tab) => {\n        if ($(tab).attr('href') === hash) {\n          this.activeIndex = index;\n          return false;\n        }\n\n        return true;\n      });\n    }\n\n    // 含 .mdui-tab-active 的元素默认激活\n    if (this.activeIndex === -1) {\n      this.$tabs.each((index, tab) => {\n        if ($(tab).hasClass('mdui-tab-active')) {\n          this.activeIndex = index;\n          return false;\n        }\n\n        return true;\n      });\n    }\n\n    // 存在选项卡时，默认激活第一个选项卡\n    if (this.$tabs.length && this.activeIndex === -1) {\n      this.activeIndex = 0;\n    }\n\n    // 设置激活状态选项卡\n    this.setActive();\n\n    // 监听窗口大小变化事件，调整指示器位置\n    $window.on(\n      'resize',\n      $.throttle(() => this.setIndicatorPosition(), 100),\n    );\n\n    // 监听点击选项卡事件\n    this.$tabs.each((_, tab) => {\n      this.bindTabEvent(tab);\n    });\n  }\n\n  /**\n   * 指定选项卡是否已禁用\n   * @param $tab\n   */\n  private isDisabled($tab: JQ): boolean {\n    return $tab.attr('disabled') !== undefined;\n  }\n\n  /**\n   * 绑定在 Tab 上点击或悬浮的事件\n   * @param tab\n   */\n  private bindTabEvent(tab: HTMLElement): void {\n    const $tab = $(tab);\n\n    // 点击或鼠标移入触发的事件\n    const clickEvent = (): void | false => {\n      // 禁用状态的选项卡无法选中\n      if (this.isDisabled($tab)) {\n        return false;\n      }\n\n      this.activeIndex = this.$tabs.index(tab);\n      this.setActive();\n    };\n\n    // 无论 trigger 是 click 还是 hover，都会响应 click 事件\n    $tab.on('click', clickEvent);\n\n    // trigger 为 hover 时，额外响应 mouseenter 事件\n    if (this.options.trigger === 'hover') {\n      $tab.on('mouseenter', clickEvent);\n    }\n\n    // 阻止链接的默认点击动作\n    $tab.on('click', (): void | false => {\n      if (($tab.attr('href') || '').indexOf('#') === 0) {\n        return false;\n      }\n    });\n  }\n\n  /**\n   * 触发组件事件\n   * @param name\n   * @param $element\n   * @param parameters\n   */\n  private triggerEvent(name: EVENT, $element: JQ, parameters = {}): void {\n    componentEvent(name, 'tab', $element, this, parameters);\n  }\n\n  /**\n   * 设置激活状态的选项卡\n   */\n  private setActive(): void {\n    this.$tabs.each((index, tab) => {\n      const $tab = $(tab);\n      const targetId = $tab.attr('href') || '';\n\n      // 设置选项卡激活状态\n      if (index === this.activeIndex && !this.isDisabled($tab)) {\n        if (!$tab.hasClass('mdui-tab-active')) {\n          this.triggerEvent('change', this.$element, {\n            index: this.activeIndex,\n            id: targetId.substr(1),\n          });\n          this.triggerEvent('show', $tab);\n\n          $tab.addClass('mdui-tab-active');\n        }\n\n        $(targetId).show();\n        this.setIndicatorPosition();\n      } else {\n        $tab.removeClass('mdui-tab-active');\n        $(targetId).hide();\n      }\n    });\n  }\n\n  /**\n   * 设置选项卡指示器的位置\n   */\n  private setIndicatorPosition(): void {\n    // 选项卡数量为 0 时，不显示指示器\n    if (this.activeIndex === -1) {\n      this.$indicator.css({\n        left: 0,\n        width: 0,\n      });\n\n      return;\n    }\n\n    const $activeTab = this.$tabs.eq(this.activeIndex);\n\n    if (this.isDisabled($activeTab)) {\n      return;\n    }\n\n    const activeTabOffset = $activeTab.offset();\n\n    this.$indicator.css({\n      left: `${\n        activeTabOffset.left +\n        this.$element[0].scrollLeft -\n        this.$element[0].getBoundingClientRect().left\n      }px`,\n      width: `${$activeTab.innerWidth()}px`,\n    });\n  }\n\n  /**\n   * 切换到下一个选项卡\n   */\n  public next(): void {\n    if (this.activeIndex === -1) {\n      return;\n    }\n\n    if (this.$tabs.length > this.activeIndex + 1) {\n      this.activeIndex++;\n    } else if (this.options.loop) {\n      this.activeIndex = 0;\n    }\n\n    this.setActive();\n  }\n\n  /**\n   * 切换到上一个选项卡\n   */\n  public prev(): void {\n    if (this.activeIndex === -1) {\n      return;\n    }\n\n    if (this.activeIndex > 0) {\n      this.activeIndex--;\n    } else if (this.options.loop) {\n      this.activeIndex = this.$tabs.length - 1;\n    }\n\n    this.setActive();\n  }\n\n  /**\n   * 显示指定索引号、或指定id的选项卡\n   * @param index 索引号、或id\n   */\n  public show(index: number | string): void {\n    if (this.activeIndex === -1) {\n      return;\n    }\n\n    if (isNumber(index)) {\n      this.activeIndex = index;\n    } else {\n      this.$tabs.each((i, tab): void | false => {\n        if (tab.id === index) {\n          this.activeIndex === i;\n          return false;\n        }\n      });\n    }\n\n    this.setActive();\n  }\n\n  /**\n   * 在父元素的宽度变化时，需要调用该方法重新调整指示器位置\n   * 在添加或删除选项卡时，需要调用该方法\n   */\n  public handleUpdate(): void {\n    const $oldTabs = this.$tabs; // 旧的 tabs JQ对象\n    const $newTabs = this.$element.children('a'); // 新的 tabs JQ对象\n    const oldTabsElement = $oldTabs.get(); // 旧的 tabs 元素数组\n    const newTabsElement = $newTabs.get(); // 新的 tabs 元素数组\n\n    if (!$newTabs.length) {\n      this.activeIndex = -1;\n      this.$tabs = $newTabs;\n      this.setIndicatorPosition();\n\n      return;\n    }\n\n    // 重新遍历选项卡，找出新增的选项卡\n    $newTabs.each((index, tab) => {\n      // 有新增的选项卡\n      if (oldTabsElement.indexOf(tab) < 0) {\n        this.bindTabEvent(tab);\n\n        if (this.activeIndex === -1) {\n          this.activeIndex = 0;\n        } else if (index <= this.activeIndex) {\n          this.activeIndex++;\n        }\n      }\n    });\n\n    // 找出被移除的选项卡\n    $oldTabs.each((index, tab) => {\n      // 有被移除的选项卡\n      if (newTabsElement.indexOf(tab) < 0) {\n        if (index < this.activeIndex) {\n          this.activeIndex--;\n        } else if (index === this.activeIndex) {\n          this.activeIndex = 0;\n        }\n      }\n    });\n\n    this.$tabs = $newTabs;\n\n    this.setActive();\n  }\n}\n\nmdui.Tab = Tab;\n","import $ from 'mdui.jq/es/$';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-tab';\n\n$(() => {\n  mdui.mutation(`[${customAttr}]`, function () {\n    new mdui.Tab(this, parseOptions(this, customAttr));\n  });\n});\n","/**\n * 在桌面设备上默认显示抽屉栏，不显示遮罩层\n * 在手机和平板设备上默认不显示抽屉栏，始终显示遮罩层，且覆盖导航栏\n */\n\nimport $ from 'mdui.jq/es/$';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/off';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/one';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/width';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport mdui from '../../mdui';\nimport '../../jq_extends/methods/transitionEnd';\nimport '../../jq_extends/static/hideOverlay';\nimport '../../jq_extends/static/lockScreen';\nimport '../../jq_extends/static/showOverlay';\nimport '../../jq_extends/static/throttle';\nimport '../../jq_extends/static/unlockScreen';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $window } from '../../utils/dom';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * Drawer 组件\n     *\n     * 请通过 `new mdui.Drawer()` 调用\n     */\n    Drawer: {\n      /**\n       * 实例化 Drawer 组件\n       * @param selector CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Drawer;\n    };\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * 打开抽屉栏时是否显示遮罩层。该参数只对中等屏幕及以上的设备有效，在超小屏和小屏设备上始终会显示遮罩层。\n   */\n  overlay?: boolean;\n\n  /**\n   * 是否启用滑动手势。\n   */\n  swipe?: boolean;\n};\n\ntype STATE = 'opening' | 'opened' | 'closing' | 'closed';\ntype EVENT = 'open' | 'opened' | 'close' | 'closed';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  overlay: false,\n  swipe: false,\n};\n\nclass Drawer {\n  /**\n   * drawer 元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * 当前是否显示着遮罩层\n   */\n  private overlay = false;\n\n  /**\n   * 抽屉栏的位置\n   */\n  private position: 'left' | 'right';\n\n  /**\n   * 当前抽屉栏状态\n   */\n  private state: STATE;\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    this.$element = $(selector).first();\n\n    extend(this.options, options);\n\n    this.position = this.$element.hasClass('mdui-drawer-right')\n      ? 'right'\n      : 'left';\n\n    if (this.$element.hasClass('mdui-drawer-close')) {\n      this.state = 'closed';\n    } else if (this.$element.hasClass('mdui-drawer-open')) {\n      this.state = 'opened';\n    } else if (this.isDesktop()) {\n      this.state = 'opened';\n    } else {\n      this.state = 'closed';\n    }\n\n    // 浏览器窗口大小调整时\n    $window.on(\n      'resize',\n      $.throttle(() => {\n        if (this.isDesktop()) {\n          // 由手机平板切换到桌面时\n          // 如果显示着遮罩，则隐藏遮罩\n          if (this.overlay && !this.options.overlay) {\n            $.hideOverlay();\n            this.overlay = false;\n            $.unlockScreen();\n          }\n\n          // 没有强制关闭，则状态为打开状态\n          if (!this.$element.hasClass('mdui-drawer-close')) {\n            this.state = 'opened';\n          }\n        } else if (!this.overlay && this.state === 'opened') {\n          // 由桌面切换到手机平板时。如果抽屉栏是打开着的且没有遮罩层，则关闭抽屉栏\n          if (this.$element.hasClass('mdui-drawer-open')) {\n            $.showOverlay();\n            this.overlay = true;\n            $.lockScreen();\n\n            $('.mdui-overlay').one('click', () => this.close());\n          } else {\n            this.state = 'closed';\n          }\n        }\n      }, 100),\n    );\n\n    // 绑定关闭按钮事件\n    this.$element.find('[mdui-drawer-close]').each((_, close) => {\n      $(close).on('click', () => this.close());\n    });\n\n    this.swipeSupport();\n  }\n\n  /**\n   * 是否是桌面设备\n   */\n  private isDesktop(): boolean {\n    return $window.width() >= 1024;\n  }\n\n  /**\n   * 滑动手势支持\n   */\n  private swipeSupport(): void {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const that = this;\n\n    // 抽屉栏滑动手势控制\n    let openNavEventHandler: (event: Event) => void;\n    let touchStartX: number;\n    let touchStartY: number;\n    let swipeStartX: number;\n    let swiping: null | 'opening' | 'closing' = null;\n    let maybeSwiping = false;\n    const $body = $('body');\n\n    // 手势触发的范围\n    const swipeAreaWidth = 24;\n\n    function setPosition(translateX: number): void {\n      const rtlTranslateMultiplier = that.position === 'right' ? -1 : 1;\n      const transformCSS = `translate(${\n        -1 * rtlTranslateMultiplier * translateX\n      }px, 0) !important;`;\n      const transitionCSS = 'initial !important;';\n\n      that.$element.css(\n        'cssText',\n        `transform: ${transformCSS}; transition: ${transitionCSS};`,\n      );\n    }\n\n    function cleanPosition(): void {\n      that.$element[0].style.transform = '';\n      that.$element[0].style.webkitTransform = '';\n      that.$element[0].style.transition = '';\n      that.$element[0].style.webkitTransition = '';\n    }\n\n    function getMaxTranslateX(): number {\n      return that.$element.width() + 10;\n    }\n\n    function getTranslateX(currentX: number): number {\n      return Math.min(\n        Math.max(\n          swiping === 'closing'\n            ? swipeStartX - currentX\n            : getMaxTranslateX() + swipeStartX - currentX,\n          0,\n        ),\n        getMaxTranslateX(),\n      );\n    }\n\n    function onBodyTouchEnd(event?: Event): void {\n      if (swiping) {\n        let touchX = (event as TouchEvent).changedTouches[0].pageX;\n        if (that.position === 'right') {\n          touchX = $body.width() - touchX;\n        }\n\n        const translateRatio = getTranslateX(touchX) / getMaxTranslateX();\n\n        maybeSwiping = false;\n        const swipingState = swiping;\n        swiping = null;\n\n        if (swipingState === 'opening') {\n          if (translateRatio < 0.92) {\n            cleanPosition();\n            that.open();\n          } else {\n            cleanPosition();\n          }\n        } else {\n          if (translateRatio > 0.08) {\n            cleanPosition();\n            that.close();\n          } else {\n            cleanPosition();\n          }\n        }\n\n        $.unlockScreen();\n      } else {\n        maybeSwiping = false;\n      }\n\n      $body.off({\n        // eslint-disable-next-line @typescript-eslint/no-use-before-define\n        touchmove: onBodyTouchMove,\n        touchend: onBodyTouchEnd,\n        // eslint-disable-next-line @typescript-eslint/no-use-before-define\n        touchcancel: onBodyTouchMove,\n      });\n    }\n\n    function onBodyTouchMove(event: Event): void {\n      let touchX = (event as TouchEvent).touches[0].pageX;\n      if (that.position === 'right') {\n        touchX = $body.width() - touchX;\n      }\n\n      const touchY = (event as TouchEvent).touches[0].pageY;\n\n      if (swiping) {\n        setPosition(getTranslateX(touchX));\n      } else if (maybeSwiping) {\n        const dXAbs = Math.abs(touchX - touchStartX);\n        const dYAbs = Math.abs(touchY - touchStartY);\n        const threshold = 8;\n\n        if (dXAbs > threshold && dYAbs <= threshold) {\n          swipeStartX = touchX;\n          swiping = that.state === 'opened' ? 'closing' : 'opening';\n          $.lockScreen();\n          setPosition(getTranslateX(touchX));\n        } else if (dXAbs <= threshold && dYAbs > threshold) {\n          onBodyTouchEnd();\n        }\n      }\n    }\n\n    function onBodyTouchStart(event: Event): void {\n      touchStartX = (event as TouchEvent).touches[0].pageX;\n      if (that.position === 'right') {\n        touchStartX = $body.width() - touchStartX;\n      }\n\n      touchStartY = (event as TouchEvent).touches[0].pageY;\n\n      if (that.state !== 'opened') {\n        if (\n          touchStartX > swipeAreaWidth ||\n          openNavEventHandler !== onBodyTouchStart\n        ) {\n          return;\n        }\n      }\n\n      maybeSwiping = true;\n\n      $body.on({\n        touchmove: onBodyTouchMove,\n        touchend: onBodyTouchEnd,\n        touchcancel: onBodyTouchMove,\n      });\n    }\n\n    function enableSwipeHandling(): void {\n      if (!openNavEventHandler) {\n        $body.on('touchstart', onBodyTouchStart);\n        openNavEventHandler = onBodyTouchStart;\n      }\n    }\n\n    if (this.options.swipe) {\n      enableSwipeHandling();\n    }\n  }\n\n  /**\n   * 触发组件事件\n   * @param name\n   */\n  private triggerEvent(name: EVENT): void {\n    componentEvent(name, 'drawer', this.$element, this);\n  }\n\n  /**\n   * 动画结束回调\n   */\n  private transitionEnd(): void {\n    if (this.$element.hasClass('mdui-drawer-open')) {\n      this.state = 'opened';\n      this.triggerEvent('opened');\n    } else {\n      this.state = 'closed';\n      this.triggerEvent('closed');\n    }\n  }\n\n  /**\n   * 是否处于打开状态\n   */\n  private isOpen(): boolean {\n    return this.state === 'opening' || this.state === 'opened';\n  }\n\n  /**\n   * 打开抽屉栏\n   */\n  public open(): void {\n    if (this.isOpen()) {\n      return;\n    }\n\n    this.state = 'opening';\n    this.triggerEvent('open');\n\n    if (!this.options.overlay) {\n      $('body').addClass(`mdui-drawer-body-${this.position}`);\n    }\n\n    this.$element\n      .removeClass('mdui-drawer-close')\n      .addClass('mdui-drawer-open')\n      .transitionEnd(() => this.transitionEnd());\n\n    if (!this.isDesktop() || this.options.overlay) {\n      this.overlay = true;\n      $.showOverlay().one('click', () => this.close());\n      $.lockScreen();\n    }\n  }\n\n  /**\n   * 关闭抽屉栏\n   */\n  public close(): void {\n    if (!this.isOpen()) {\n      return;\n    }\n\n    this.state = 'closing';\n    this.triggerEvent('close');\n\n    if (!this.options.overlay) {\n      $('body').removeClass(`mdui-drawer-body-${this.position}`);\n    }\n\n    this.$element\n      .addClass('mdui-drawer-close')\n      .removeClass('mdui-drawer-open')\n      .transitionEnd(() => this.transitionEnd());\n\n    if (this.overlay) {\n      $.hideOverlay();\n      this.overlay = false;\n      $.unlockScreen();\n    }\n  }\n\n  /**\n   * 切换抽屉栏打开/关闭状态\n   */\n  public toggle(): void {\n    this.isOpen() ? this.close() : this.open();\n  }\n\n  /**\n   * 返回当前抽屉栏的状态。共包含四种状态：`opening`、`opened`、`closing`、`closed`\n   */\n  public getState(): STATE {\n    return this.state;\n  }\n}\n\nmdui.Drawer = Drawer;\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/on';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-drawer';\n\ntype OPTIONS = {\n  target: string;\n  overlay?: boolean;\n  swipe?: boolean;\n};\n\n$(() => {\n  mdui.mutation(`[${customAttr}]`, function () {\n    const $element = $(this);\n    const options = parseOptions(this, customAttr) as OPTIONS;\n    const selector = options.target;\n    // @ts-ignore\n    delete options.target;\n\n    const $drawer = $(selector).first();\n    const instance = new mdui.Drawer($drawer, options);\n\n    $element.on('click', () => instance.toggle());\n  });\n});\n","import { isUndefined } from 'mdui.jq/es/utils';\nimport PlainObject from 'mdui.jq/es/interfaces/PlainObject';\n\ntype Func = () => any;\n\nconst container: PlainObject<Func[]> = {};\n\n/**\n * 根据队列名，获取队列中所有函数\n * @param name 队列名\n */\nfunction queue(name: string): Func[];\n\n/**\n * 写入队列\n * @param name 队列名\n * @param func 函数\n */\nfunction queue(name: string, func: Func): void;\n\nfunction queue(name: string, func?: Func): void | Func[] {\n  if (isUndefined(container[name])) {\n    container[name] = [];\n  }\n\n  if (isUndefined(func)) {\n    return container[name];\n  }\n\n  container[name].push(func);\n}\n\n/**\n * 从队列中移除第一个函数，并执行该函数\n * @param name 队列满\n */\nfunction dequeue(name: string): void {\n  if (isUndefined(container[name])) {\n    return;\n  }\n\n  if (!container[name].length) {\n    return;\n  }\n\n  const func = container[name].shift()!;\n\n  func();\n}\n\nexport { queue, dequeue };\n","import $ from 'mdui.jq/es/$';\nimport contains from 'mdui.jq/es/functions/contains';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/append';\nimport 'mdui.jq/es/methods/children';\nimport 'mdui.jq/es/methods/css';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/height';\nimport 'mdui.jq/es/methods/hide';\nimport 'mdui.jq/es/methods/innerHeight';\nimport 'mdui.jq/es/methods/off';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/remove';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/show';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport '../../jq_extends/methods/transitionEnd';\nimport '../../jq_extends/static/hideOverlay';\nimport '../../jq_extends/static/lockScreen';\nimport '../../jq_extends/static/showOverlay';\nimport '../../jq_extends/static/throttle';\nimport '../../jq_extends/static/unlockScreen';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $window } from '../../utils/dom';\nimport { dequeue, queue } from '../../utils/queue';\n\ntype OPTIONS = {\n  /**\n   * 打开对话框时是否添加 url hash，若为 `true`，则打开对话框后可用过浏览器的后退按钮或 Android 的返回键关闭对话框。\n   */\n  history?: boolean;\n\n  /**\n   * 打开对话框时是否显示遮罩。\n   */\n  overlay?: boolean;\n\n  /**\n   * 是否模态化对话框。为 `false` 时点击对话框外面的区域时关闭对话框，否则不关闭。\n   */\n  modal?: boolean;\n\n  /**\n   * 按下 Esc 键时是否关闭对话框。\n   */\n  closeOnEsc?: boolean;\n\n  /**\n   * 按下取消按钮时是否关闭对话框。\n   */\n  closeOnCancel?: boolean;\n\n  /**\n   * 按下确认按钮时是否关闭对话框。\n   */\n  closeOnConfirm?: boolean;\n\n  /**\n   * 关闭对话框后是否自动销毁对话框。\n   */\n  destroyOnClosed?: boolean;\n};\n\ntype STATE = 'opening' | 'opened' | 'closing' | 'closed';\ntype EVENT = 'open' | 'opened' | 'close' | 'closed' | 'cancel' | 'confirm';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  history: true,\n  overlay: true,\n  modal: false,\n  closeOnEsc: true,\n  closeOnCancel: true,\n  closeOnConfirm: true,\n  destroyOnClosed: false,\n};\n\n/**\n * 当前显示的对话框实例\n */\nlet currentInst: null | Dialog = null;\n\n/**\n * 队列名\n */\nconst queueName = '_mdui_dialog';\n\n/**\n * 窗口是否已锁定\n */\nlet isLockScreen = false;\n\n/**\n * 遮罩层元素\n */\nlet $overlay: null | JQ;\n\nclass Dialog {\n  /**\n   * dialog 元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * 当前 dialog 的状态\n   */\n  public state: STATE = 'closed';\n\n  /**\n   * dialog 元素是否是动态添加的\n   */\n  private append = false;\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    this.$element = $(selector).first();\n\n    // 如果对话框元素没有在当前文档中，则需要添加\n    if (!contains(document.body, this.$element[0])) {\n      this.append = true;\n      $('body').append(this.$element);\n    }\n\n    extend(this.options, options);\n\n    // 绑定取消按钮事件\n    this.$element.find('[mdui-dialog-cancel]').each((_, cancel) => {\n      $(cancel).on('click', () => {\n        this.triggerEvent('cancel');\n\n        if (this.options.closeOnCancel) {\n          this.close();\n        }\n      });\n    });\n\n    // 绑定确认按钮事件\n    this.$element.find('[mdui-dialog-confirm]').each((_, confirm) => {\n      $(confirm).on('click', () => {\n        this.triggerEvent('confirm');\n\n        if (this.options.closeOnConfirm) {\n          this.close();\n        }\n      });\n    });\n\n    // 绑定关闭按钮事件\n    this.$element.find('[mdui-dialog-close]').each((_, close) => {\n      $(close).on('click', () => this.close());\n    });\n  }\n\n  /**\n   * 触发组件事件\n   * @param name\n   */\n  private triggerEvent(name: EVENT): void {\n    componentEvent(name, 'dialog', this.$element, this);\n  }\n\n  /**\n   * 窗口宽度变化，或对话框内容变化时，调整对话框位置和对话框内的滚动条\n   */\n  private readjust(): void {\n    if (!currentInst) {\n      return;\n    }\n\n    const $element = currentInst.$element;\n    const $title = $element.children('.mdui-dialog-title');\n    const $content = $element.children('.mdui-dialog-content');\n    const $actions = $element.children('.mdui-dialog-actions');\n\n    // 调整 dialog 的 top 和 height 值\n    $element.height('');\n    $content.height('');\n\n    const elementHeight = $element.height();\n    $element.css({\n      top: `${($window.height() - elementHeight) / 2}px`,\n      height: `${elementHeight}px`,\n    });\n\n    // 调整 mdui-dialog-content 的高度\n    $content.innerHeight(\n      elementHeight -\n        ($title.innerHeight() || 0) -\n        ($actions.innerHeight() || 0),\n    );\n  }\n\n  /**\n   * hashchange 事件触发时关闭对话框\n   */\n  private hashchangeEvent(): void {\n    if (window.location.hash.substring(1).indexOf('mdui-dialog') < 0) {\n      currentInst!.close(true);\n    }\n  }\n\n  /**\n   * 点击遮罩层关闭对话框\n   * @param event\n   */\n  private overlayClick(event: Event): void {\n    if (\n      $(event.target as HTMLElement).hasClass('mdui-overlay') &&\n      currentInst\n    ) {\n      currentInst.close();\n    }\n  }\n\n  /**\n   * 动画结束回调\n   */\n  private transitionEnd(): void {\n    if (this.$element.hasClass('mdui-dialog-open')) {\n      this.state = 'opened';\n      this.triggerEvent('opened');\n    } else {\n      this.state = 'closed';\n      this.triggerEvent('closed');\n      this.$element.hide();\n\n      // 所有对话框都关闭，且当前没有打开的对话框时，解锁屏幕\n      if (!queue(queueName).length && !currentInst && isLockScreen) {\n        $.unlockScreen();\n        isLockScreen = false;\n      }\n\n      $window.off('resize', $.throttle(this.readjust, 100));\n\n      if (this.options.destroyOnClosed) {\n        this.destroy();\n      }\n    }\n  }\n\n  /**\n   * 打开指定对话框\n   */\n  private doOpen(): void {\n    currentInst = this;\n\n    if (!isLockScreen) {\n      $.lockScreen();\n      isLockScreen = true;\n    }\n\n    this.$element.show();\n    this.readjust();\n\n    $window.on('resize', $.throttle(this.readjust, 100));\n\n    // 打开消息框\n    this.state = 'opening';\n    this.triggerEvent('open');\n    this.$element\n      .addClass('mdui-dialog-open')\n      .transitionEnd(() => this.transitionEnd());\n\n    // 不存在遮罩层元素时，添加遮罩层\n    if (!$overlay) {\n      $overlay = $.showOverlay(5100);\n    }\n\n    // 点击遮罩层时是否关闭对话框\n    if (this.options.modal) {\n      $overlay.off('click', this.overlayClick);\n    } else {\n      $overlay.on('click', this.overlayClick);\n    }\n\n    // 是否显示遮罩层，不显示时，把遮罩层背景透明\n    $overlay.css('opacity', this.options.overlay ? '' : 0);\n\n    if (this.options.history) {\n      // 如果 hash 中原来就有 mdui-dialog，先删除，避免后退历史纪录后仍然有 mdui-dialog 导致无法关闭\n      // 包括 mdui-dialog 和 &mdui-dialog 和 ?mdui-dialog\n      let hash = window.location.hash.substring(1);\n      if (hash.indexOf('mdui-dialog') > -1) {\n        hash = hash.replace(/[&?]?mdui-dialog/g, '');\n      }\n\n      // 后退按钮关闭对话框\n      if (hash) {\n        window.location.hash = `${hash}${\n          hash.indexOf('?') > -1 ? '&' : '?'\n        }mdui-dialog`;\n      } else {\n        window.location.hash = 'mdui-dialog';\n      }\n\n      $window.on('hashchange', this.hashchangeEvent);\n    }\n  }\n\n  /**\n   * 当前对话框是否为打开状态\n   */\n  private isOpen(): boolean {\n    return this.state === 'opening' || this.state === 'opened';\n  }\n\n  /**\n   * 打开对话框\n   */\n  public open(): void {\n    if (this.isOpen()) {\n      return;\n    }\n\n    // 如果当前有正在打开或已经打开的对话框,或队列不为空，则先加入队列，等旧对话框开始关闭时再打开\n    if (\n      (currentInst &&\n        (currentInst.state === 'opening' || currentInst.state === 'opened')) ||\n      queue(queueName).length\n    ) {\n      queue(queueName, () => this.doOpen());\n\n      return;\n    }\n\n    this.doOpen();\n  }\n\n  /**\n   * 关闭对话框\n   */\n  public close(historyBack = false): void {\n    // historyBack 是否需要后退历史纪录，默认为 `false`。该参数仅内部使用\n    // 为 `false` 时是通过 js 关闭，需要后退一个历史记录\n    // 为 `true` 时是通过后退按钮关闭，不需要后退历史记录\n\n    // setTimeout 的作用是：\n    // 当同时关闭一个对话框，并打开另一个对话框时，使打开对话框的操作先执行，以使需要打开的对话框先加入队列\n    setTimeout(() => {\n      if (!this.isOpen()) {\n        return;\n      }\n\n      currentInst = null;\n\n      this.state = 'closing';\n      this.triggerEvent('close');\n\n      // 所有对话框都关闭，且当前没有打开的对话框时，隐藏遮罩\n      if (!queue(queueName).length && $overlay) {\n        $.hideOverlay();\n        $overlay = null;\n\n        // 若仍存在遮罩，恢复遮罩的 z-index\n        $('.mdui-overlay').css('z-index', 2000);\n      }\n\n      this.$element\n        .removeClass('mdui-dialog-open')\n        .transitionEnd(() => this.transitionEnd());\n\n      if (this.options.history && !queue(queueName).length) {\n        if (!historyBack) {\n          window.history.back();\n        }\n\n        $window.off('hashchange', this.hashchangeEvent);\n      }\n\n      // 关闭旧对话框，打开新对话框。\n      // 加一点延迟，仅仅为了视觉效果更好。不加延时也不影响功能\n      setTimeout(() => {\n        dequeue(queueName);\n      }, 100);\n    });\n  }\n\n  /**\n   * 切换对话框打开/关闭状态\n   */\n  public toggle(): void {\n    this.isOpen() ? this.close() : this.open();\n  }\n\n  /**\n   * 获取对话框状态。共包含四种状态：`opening`、`opened`、`closing`、`closed`\n   */\n  public getState(): STATE {\n    return this.state;\n  }\n\n  /**\n   * 销毁对话框\n   */\n  public destroy(): void {\n    if (this.append) {\n      this.$element.remove();\n    }\n\n    if (!queue(queueName).length && !currentInst) {\n      if ($overlay) {\n        $.hideOverlay();\n        $overlay = null;\n      }\n\n      if (isLockScreen) {\n        $.unlockScreen();\n        isLockScreen = false;\n      }\n    }\n  }\n\n  /**\n   * 对话框内容变化时，需要调用该方法来调整对话框位置和滚动条高度\n   */\n  public handleUpdate(): void {\n    this.readjust();\n  }\n}\n\nexport { currentInst, OPTIONS, Dialog };\n","import Selector from 'mdui.jq/es/types/Selector';\nimport mdui from '../../mdui';\nimport 'mdui.jq/es/methods/on';\nimport { $document } from '../../utils/dom';\nimport { currentInst, OPTIONS, Dialog } from './class';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * Dialog 组件\n     *\n     * 请通过 `new mdui.Dialog()` 调用\n     */\n    Dialog: {\n      /**\n       * 实例化 Dialog 组件\n       * @param selector CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Dialog;\n    };\n  }\n}\n\n// esc 按下时关闭对话框\n$document.on('keydown', (event: Event) => {\n  if (\n    currentInst &&\n    currentInst.options.closeOnEsc &&\n    currentInst.state === 'opened' &&\n    (event as KeyboardEvent).keyCode === 27\n  ) {\n    currentInst.close();\n  }\n});\n\nmdui.Dialog = Dialog;\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/on';\nimport mdui from '../../mdui';\nimport { $document } from '../../utils/dom';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-dialog';\nconst dataName = '_mdui_dialog';\n\ntype OPTIONS = {\n  target: string;\n  history?: boolean;\n  overlay?: boolean;\n  modal?: boolean;\n  closeOnEsc?: boolean;\n  closeOnCancel?: boolean;\n  closeOnConfirm?: boolean;\n  destroyOnClosed?: boolean;\n};\n\n$(() => {\n  $document.on('click', `[${customAttr}]`, function () {\n    const options = parseOptions(this as HTMLElement, customAttr) as OPTIONS;\n    const selector = options.target;\n    // @ts-ignore\n    delete options.target;\n\n    const $dialog = $(selector).first();\n    let instance = $dialog.data(dataName);\n\n    if (!instance) {\n      instance = new mdui.Dialog($dialog, options);\n      $dialog.data(dataName, instance);\n    }\n\n    instance.open();\n  });\n});\n","import $ from 'mdui.jq/es/$';\nimport each from 'mdui.jq/es/functions/each';\nimport extend from 'mdui.jq/es/functions/extend';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/on';\nimport mdui from '../../mdui';\nimport { Dialog } from './class';\nimport './index';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 打开一个对话框，标题、内容、按钮等都可以自定义\n     * @param options 配置参数\n     */\n    dialog(options: OPTIONS): Dialog;\n  }\n}\n\ntype BUTTON = {\n  /**\n   * 按钮文本\n   */\n  text?: string;\n\n  /**\n   * 按钮文本是否加粗，默认为 `false`\n   */\n  bold?: boolean;\n\n  /**\n   * 点击按钮后是否关闭对话框，默认为 `true`\n   */\n  close?: boolean;\n\n  /**\n   * 点击按钮的回调函数，参数为对话框的实例\n   */\n  onClick?: (dialog: Dialog) => void;\n};\n\ntype OPTIONS = {\n  /**\n   * 对话框的标题\n   */\n  title?: string;\n\n  /**\n   * 对话框的内容\n   */\n  content?: string;\n\n  /**\n   * 按钮数组，每个按钮都是一个带按钮参数的对象\n   */\n  buttons?: BUTTON[];\n\n  /**\n   * 按钮是否垂直排列，默认为 `false`\n   */\n  stackedButtons?: boolean;\n\n  /**\n   * 添加到 `.mdui-dialog` 上的 CSS 类\n   */\n  cssClass?: string;\n\n  /**\n   * 是否监听 `hashchange` 事件，为 `true` 时可以通过 Android 的返回键或浏览器后退按钮关闭对话框，默认为 `true`\n   */\n  history?: boolean;\n\n  /**\n   * 打开对话框后是否显示遮罩层，默认为 `true`\n   */\n  overlay?: boolean;\n\n  /**\n   * 是否模态化对话框。为 `false` 时点击对话框外面的区域时关闭对话框，否则不关闭\n   */\n  modal?: boolean;\n\n  /**\n   * 按下 Esc 键时是否关闭对话框，默认为 `true`\n   */\n  closeOnEsc?: boolean;\n\n  /**\n   * 关闭对话框后是否自动销毁对话框，默认为 `true`\n   */\n  destroyOnClosed?: boolean;\n\n  /**\n   * 打开动画开始时的回调，参数为对话框实例\n   */\n  onOpen?: (dialog: Dialog) => void;\n\n  /**\n   * 打开动画结束时的回调，参数为对话框实例\n   */\n  onOpened?: (dialog: Dialog) => void;\n\n  /**\n   * 关闭动画开始时的回调，参数为对话框实例\n   */\n  onClose?: (dialog: Dialog) => void;\n\n  /**\n   * 关闭动画结束时的回调，参数为对话框实例\n   */\n  onClosed?: (dialog: Dialog) => void;\n};\n\nconst DEFAULT_BUTTON: BUTTON = {\n  text: '',\n  bold: false,\n  close: true,\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onClick: () => {},\n};\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  title: '',\n  content: '',\n  buttons: [],\n  stackedButtons: false,\n  cssClass: '',\n  history: true,\n  overlay: true,\n  modal: false,\n  closeOnEsc: true,\n  destroyOnClosed: true,\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onOpen: () => {},\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onOpened: () => {},\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onClose: () => {},\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onClosed: () => {},\n};\n\nmdui.dialog = function (options: OPTIONS): Dialog {\n  // 合并配置参数\n  options = extend({}, DEFAULT_OPTIONS, options);\n\n  each(options.buttons!, (i, button) => {\n    options.buttons![i] = extend({}, DEFAULT_BUTTON, button);\n  });\n\n  // 按钮的 HTML\n  let buttonsHTML = '';\n  if (options.buttons?.length) {\n    buttonsHTML = `<div class=\"mdui-dialog-actions${\n      options.stackedButtons ? ' mdui-dialog-actions-stacked' : ''\n    }\">`;\n\n    each(options.buttons, (_, button) => {\n      buttonsHTML +=\n        '<a href=\"javascript:void(0)\" ' +\n        `class=\"mdui-btn mdui-ripple mdui-text-color-primary ${\n          button.bold ? 'mdui-btn-bold' : ''\n        }\">${button.text}</a>`;\n    });\n\n    buttonsHTML += '</div>';\n  }\n\n  // Dialog 的 HTML\n  const HTML =\n    `<div class=\"mdui-dialog ${options.cssClass}\">` +\n    (options.title\n      ? `<div class=\"mdui-dialog-title\">${options.title}</div>`\n      : '') +\n    (options.content\n      ? `<div class=\"mdui-dialog-content\">${options.content}</div>`\n      : '') +\n    buttonsHTML +\n    '</div>';\n\n  // 实例化 Dialog\n  const instance = new mdui.Dialog(HTML, {\n    history: options.history,\n    overlay: options.overlay,\n    modal: options.modal,\n    closeOnEsc: options.closeOnEsc,\n    destroyOnClosed: options.destroyOnClosed,\n  });\n\n  // 绑定按钮事件\n  if (options.buttons?.length) {\n    instance.$element\n      .find('.mdui-dialog-actions .mdui-btn')\n      .each((index, button) => {\n        $(button).on('click', () => {\n          options.buttons![index].onClick!(instance);\n\n          if (options.buttons![index].close) {\n            instance.close();\n          }\n        });\n      });\n  }\n\n  // 绑定打开关闭事件\n  instance.$element\n    .on('open.mdui.dialog', () => {\n      options.onOpen!(instance);\n    })\n    .on('opened.mdui.dialog', () => {\n      options.onOpened!(instance);\n    })\n    .on('close.mdui.dialog', () => {\n      options.onClose!(instance);\n    })\n    .on('closed.mdui.dialog', () => {\n      options.onClosed!(instance);\n    });\n\n  instance.open();\n\n  return instance;\n};\n","import extend from 'mdui.jq/es/functions/extend';\nimport { isFunction, isUndefined } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport { Dialog } from './class';\nimport './dialog';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 打开一个警告框，可以包含标题、内容和一个确认按钮\n     * @param text 警告框内容\n     * @param title 警告框标题\n     * @param onConfirm 点击确认按钮的回调函数，参数为对话框实例\n     * @param options 配置参数\n     */\n    alert(\n      text: string,\n      title: string,\n      onConfirm?: (dialog: Dialog) => void,\n      options?: OPTIONS,\n    ): Dialog;\n\n    /**\n     * 打开一个警告框，可以包含内容，和一个确认按钮\n     * @param text 警告框内容\n     * @param onConfirm 点击确认按钮的回调函数，参数为对话框实例\n     * @param options 配置参数\n     */\n    alert(\n      text: string,\n      onConfirm?: (dialog: Dialog) => void,\n      options?: OPTIONS,\n    ): Dialog;\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * 确认按钮的文本\n   */\n  confirmText?: string;\n\n  /**\n   * 是否监听 hashchange 事件，为 `true` 时可以通过 Android 的返回键或浏览器后退按钮关闭对话框，默认为 `true`\n   */\n  history?: boolean;\n\n  /**\n   * 是否模态化对话框。为 `false` 时点击对话框外面的区域时关闭对话框，否则不关闭，默认为 `false`\n   */\n  modal?: boolean;\n\n  /**\n   * 按下 Esc 键时是否关闭对话框，默认为 `true`\n   */\n  closeOnEsc?: boolean;\n\n  /**\n   * 是否在按下确认按钮时是否关闭对话框\n   */\n  closeOnConfirm?: boolean;\n};\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  confirmText: 'ok',\n  history: true,\n  modal: false,\n  closeOnEsc: true,\n  closeOnConfirm: true,\n};\n\nmdui.alert = function (\n  text: string,\n  title?: any,\n  onConfirm?: any,\n  options?: any,\n): Dialog {\n  if (isFunction(title)) {\n    options = onConfirm;\n    onConfirm = title;\n    title = '';\n  }\n\n  if (isUndefined(onConfirm)) {\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    onConfirm = (): void => {};\n  }\n\n  if (isUndefined(options)) {\n    options = {};\n  }\n\n  options = extend({}, DEFAULT_OPTIONS, options);\n\n  return mdui.dialog({\n    title: title,\n    content: text,\n    buttons: [\n      {\n        text: options.confirmText,\n        bold: false,\n        close: options.closeOnConfirm,\n        onClick: onConfirm,\n      },\n    ],\n    cssClass: 'mdui-dialog-alert',\n    history: options.history,\n    modal: options.modal,\n    closeOnEsc: options.closeOnEsc,\n  });\n};\n","import extend from 'mdui.jq/es/functions/extend';\nimport { isFunction, isUndefined } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport { Dialog } from './class';\nimport './dialog';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 打开一个确认框，可以包含标题、内容、一个确认按钮和一个取消按钮\n     * @param text 确认框内容\n     * @param title 确认框标题\n     * @param onConfirm 点击确认按钮的回调函数，参数为对话框实例\n     * @param onCancel 点击取消按钮的回调函数，参数为对话框实例\n     * @param options 配置参数\n     */\n    confirm(\n      text: string,\n      title: string,\n      onConfirm?: (dialog: Dialog) => void,\n      onCancel?: (dialog: Dialog) => void,\n      options?: OPTIONS,\n    ): Dialog;\n\n    /**\n     * 打开一个确认框，可以包含内容、一个确认按钮和一个取消按钮\n     * @param text 确认框内容\n     * @param onConfirm 点击确认按钮的回调函数，参数为对话框实例\n     * @param onCancel 点击取消按钮的回调函数，参数为对话框实例\n     * @param options 配置参数\n     */\n    confirm(\n      text: string,\n      onConfirm?: (dialog: Dialog) => void,\n      onCancel?: (dialog: Dialog) => void,\n      options?: OPTIONS,\n    ): Dialog;\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * 确认按钮的文本\n   */\n  confirmText?: string;\n\n  /**\n   * 取消按钮的文本\n   */\n  cancelText?: string;\n\n  /**\n   * 是否监听 hashchange 事件，为 `true` 时可以通过 Android 的返回键或浏览器后退按钮关闭对话框，默认为 `true`\n   */\n  history?: boolean;\n\n  /**\n   * 是否模态化对话框。为 `false` 时点击对话框外面的区域时关闭对话框，否则不关闭，默认为 `false`\n   */\n  modal?: boolean;\n\n  /**\n   * 按下 Esc 键时是否关闭对话框，默认为 `true`\n   */\n  closeOnEsc?: boolean;\n\n  /**\n   * 是否在按下取消按钮时是否关闭对话框\n   */\n  closeOnCancel?: boolean;\n\n  /**\n   * 是否在按下确认按钮时是否关闭对话框\n   */\n  closeOnConfirm?: boolean;\n};\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  confirmText: 'ok',\n  cancelText: 'cancel',\n  history: true,\n  modal: false,\n  closeOnEsc: true,\n  closeOnCancel: true,\n  closeOnConfirm: true,\n};\n\nmdui.confirm = function (\n  text: string,\n  title?: any,\n  onConfirm?: any,\n  onCancel?: any,\n  options?: any,\n): Dialog {\n  if (isFunction(title)) {\n    options = onCancel;\n    onCancel = onConfirm;\n    onConfirm = title;\n    title = '';\n  }\n\n  if (isUndefined(onConfirm)) {\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    onConfirm = (): void => {};\n  }\n\n  if (isUndefined(onCancel)) {\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    onCancel = (): void => {};\n  }\n\n  if (isUndefined(options)) {\n    options = {};\n  }\n\n  options = extend({}, DEFAULT_OPTIONS, options);\n\n  return mdui.dialog({\n    title: title,\n    content: text,\n    buttons: [\n      {\n        text: options.cancelText,\n        bold: false,\n        close: options.closeOnCancel,\n        onClick: onCancel,\n      },\n      {\n        text: options.confirmText,\n        bold: false,\n        close: options.closeOnConfirm,\n        onClick: onConfirm,\n      },\n    ],\n    cssClass: 'mdui-dialog-confirm',\n    history: options.history,\n    modal: options.modal,\n    closeOnEsc: options.closeOnEsc,\n  });\n};\n","import extend from 'mdui.jq/es/functions/extend';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/val';\nimport { isFunction, isUndefined } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport '../textfield';\nimport { Dialog } from './class';\nimport './dialog';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 打开一个提示用户输入的对话框，可以包含标题、文本框标签、文本框、一个确认按钮和一个取消按钮\n     * @param label 文本框浮动标签的文本\n     * @param title 标题\n     * @param onConfirm 点击确认按钮的回调。含两个参数，分别为文本框的值和对话框实例\n     * @param onCancel 点击取消按钮的回调。含两个参数，分别为文本框的值和对话框实例\n     * @param options 配置参数\n     */\n    prompt(\n      label: string,\n      title: string,\n      onConfirm?: (value: string, dialog: Dialog) => void,\n      onCancel?: (value: string, dialog: Dialog) => void,\n      options?: OPTIONS,\n    ): Dialog;\n\n    /**\n     * 打开一个提示用户输入的对话框，可以包含文本框标签、文本框、一个确认按钮和一个取消按钮\n     * @param label 文本框浮动标签的文本\n     * @param onConfirm 点击确认按钮的回调。含两个参数，分别为文本框的值和对话框实例\n     * @param onCancel 点击取消按钮的回调，含两个参数，分别为文本框的值和对话框实例\n     * @param options 配置参数\n     */\n    prompt(\n      label: string,\n      onConfirm?: (value: string, dialog: Dialog) => void,\n      onCancel?: (value: string, dialog: Dialog) => void,\n      options?: OPTIONS,\n    ): Dialog;\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * 确认按钮的文本\n   */\n  confirmText?: string;\n\n  /**\n   * 取消按钮的文本\n   */\n  cancelText?: string;\n\n  /**\n   * 是否监听 hashchange 事件，为 `true` 时可以通过 Android 的返回键或浏览器后退按钮关闭对话框，默认为 `true`\n   */\n  history?: boolean;\n\n  /**\n   * 是否模态化对话框。为 `false` 时点击对话框外面的区域时关闭对话框，否则不关闭，默认为 `false`\n   */\n  modal?: boolean;\n\n  /**\n   * 是否在按下 Esc 键时是否关闭对话框，默认为 `true`\n   */\n  closeOnEsc?: boolean;\n\n  /**\n   * 是否在按下取消按钮时是否关闭对话框\n   */\n  closeOnCancel?: boolean;\n\n  /**\n   * 是否在按下确认按钮时是否关闭对话框\n   */\n  closeOnConfirm?: boolean;\n\n  /**\n   * 是否在按下 Enter 键时触发 `onConfirm` 回调函数，默认为 `false`\n   */\n  confirmOnEnter?: boolean;\n\n  /**\n   * 文本框的类型。`text`: 单行文本框； `textarea`: 多行文本框\n   */\n  type?: 'text' | 'textarea';\n\n  /**\n   * 最大输入字符数量，为 0 时表示不限制\n   */\n  maxlength?: number;\n\n  /**\n   * 文本框的默认值\n   */\n  defaultValue?: string;\n};\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  confirmText: 'ok',\n  cancelText: 'cancel',\n  history: true,\n  modal: false,\n  closeOnEsc: true,\n  closeOnCancel: true,\n  closeOnConfirm: true,\n  type: 'text',\n  maxlength: 0,\n  defaultValue: '',\n  confirmOnEnter: false,\n};\n\nmdui.prompt = function (\n  label: string,\n  title?: any,\n  onConfirm?: any,\n  onCancel?: any,\n  options?: any,\n): Dialog {\n  if (isFunction(title)) {\n    options = onCancel;\n    onCancel = onConfirm;\n    onConfirm = title;\n    title = '';\n  }\n\n  if (isUndefined(onConfirm)) {\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    onConfirm = (): void => {};\n  }\n\n  if (isUndefined(onCancel)) {\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    onCancel = (): void => {};\n  }\n\n  if (isUndefined(options)) {\n    options = {};\n  }\n\n  options = extend({}, DEFAULT_OPTIONS, options);\n\n  const content =\n    '<div class=\"mdui-textfield\">' +\n    (label ? `<label class=\"mdui-textfield-label\">${label}</label>` : '') +\n    (options.type === 'text'\n      ? `<input class=\"mdui-textfield-input\" type=\"text\" value=\"${\n          options.defaultValue\n        }\" ${\n          options.maxlength ? 'maxlength=\"' + options.maxlength + '\"' : ''\n        }/>`\n      : '') +\n    (options.type === 'textarea'\n      ? `<textarea class=\"mdui-textfield-input\" ${\n          options.maxlength ? 'maxlength=\"' + options.maxlength + '\"' : ''\n        }>${options.defaultValue}</textarea>`\n      : '') +\n    '</div>';\n\n  const onCancelClick = (dialog: Dialog): void => {\n    const value = dialog.$element.find('.mdui-textfield-input').val();\n    onCancel(value, dialog);\n  };\n\n  const onConfirmClick = (dialog: Dialog): void => {\n    const value = dialog.$element.find('.mdui-textfield-input').val();\n    onConfirm(value, dialog);\n  };\n\n  return mdui.dialog({\n    title,\n    content,\n    buttons: [\n      {\n        text: options.cancelText,\n        bold: false,\n        close: options.closeOnCancel,\n        onClick: onCancelClick,\n      },\n      {\n        text: options.confirmText,\n        bold: false,\n        close: options.closeOnConfirm,\n        onClick: onConfirmClick,\n      },\n    ],\n    cssClass: 'mdui-dialog-prompt',\n    history: options.history,\n    modal: options.modal,\n    closeOnEsc: options.closeOnEsc,\n    onOpen: (dialog) => {\n      // 初始化输入框\n      const $input = dialog.$element.find('.mdui-textfield-input');\n      mdui.updateTextFields($input);\n\n      // 聚焦到输入框\n      $input[0].focus();\n\n      // 捕捉文本框回车键，在单行文本框的情况下触发回调\n      if (options.type !== 'textarea' && options.confirmOnEnter === true) {\n        $input.on('keydown', (event) => {\n          if ((event as KeyboardEvent).keyCode === 13) {\n            const value = dialog.$element.find('.mdui-textfield-input').val();\n            onConfirm(value, dialog);\n\n            if (options.closeOnConfirm) {\n              dialog.close();\n            }\n\n            return false;\n          }\n\n          return;\n        });\n      }\n\n      // 如果是多行输入框，监听输入框的 input 事件，更新对话框高度\n      if (options.type === 'textarea') {\n        $input.on('input', () => dialog.handleUpdate());\n      }\n\n      // 有字符数限制时，加载完文本框后 DOM 会变化，需要更新对话框高度\n      if (options.maxlength) {\n        dialog.handleUpdate();\n      }\n    },\n  });\n};\n","import $ from 'mdui.jq/es/$';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/appendTo';\nimport 'mdui.jq/es/methods/attr';\nimport 'mdui.jq/es/methods/css';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/height';\nimport 'mdui.jq/es/methods/html';\nimport 'mdui.jq/es/methods/offset';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/width';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport mdui from '../../mdui';\nimport '../../jq_extends/methods/transformOrigin';\nimport '../../jq_extends/methods/transitionEnd';\nimport '../../jq_extends/static/guid';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $window } from '../../utils/dom';\nimport { isAllow, register, unlockEvent } from '../../utils/touchHandler';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * Tooltip 组件\n     *\n     * 请通过 `new mdui.Tooltip()` 调用\n     */\n    Tooltip: {\n      /**\n       * 实例化 Tooltip 组件\n       * @param selector CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param options 配置参数\n       */\n      new (\n        selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Tooltip;\n    };\n  }\n}\n\ntype POSITION = 'auto' | 'bottom' | 'top' | 'left' | 'right';\n\ntype OPTIONS = {\n  /**\n   * Tooltip 的位置。取值范围包括 `auto`、`bottom`、`top`、`left`、`right`。\n   * 为 `auto` 时，会自动判断位置。默认在下方。优先级为 `bottom` > `top` > `left` > `right`。\n   * 默认为 `auto`\n   */\n  position?: POSITION;\n\n  /**\n   * 延时触发，单位毫秒。默认为 `0`，即没有延时。\n   */\n  delay?: number;\n\n  /**\n   * Tooltip 的内容\n   */\n  content?: string;\n};\n\ntype STATE = 'opening' | 'opened' | 'closing' | 'closed';\ntype EVENT = 'open' | 'opened' | 'close' | 'closed';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  position: 'auto',\n  delay: 0,\n  content: '',\n};\n\nclass Tooltip {\n  /**\n   * 触发 tooltip 元素的 JQ 对象\n   */\n  public $target: JQ;\n\n  /**\n   * tooltip 元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * 当前 tooltip 的状态\n   */\n  private state: STATE = 'closed';\n\n  /**\n   * setTimeout 的返回值\n   */\n  private timeoutId: any = null;\n\n  public constructor(\n    selector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    this.$target = $(selector).first();\n\n    extend(this.options, options);\n\n    // 创建 Tooltip HTML\n    this.$element = $(\n      `<div class=\"mdui-tooltip\" id=\"${$.guid()}\">${\n        this.options.content\n      }</div>`,\n    ).appendTo(document.body);\n\n    // 绑定事件。元素处于 disabled 状态时无法触发鼠标事件，为了统一，把 touch 事件也禁用\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const that = this;\n    this.$target\n      .on('touchstart mouseenter', function (event) {\n        if (that.isDisabled(this as HTMLElement)) {\n          return;\n        }\n\n        if (!isAllow(event)) {\n          return;\n        }\n\n        register(event);\n\n        that.open();\n      })\n      .on('touchend mouseleave', function (event) {\n        if (that.isDisabled(this as HTMLElement)) {\n          return;\n        }\n\n        if (!isAllow(event)) {\n          return;\n        }\n\n        that.close();\n      })\n      .on(unlockEvent, function (event) {\n        if (that.isDisabled(this as HTMLElement)) {\n          return;\n        }\n\n        register(event);\n      });\n  }\n\n  /**\n   * 元素是否已禁用\n   * @param element\n   */\n  private isDisabled(element: HTMLElement): boolean {\n    return (\n      (element as HTMLInputElement).disabled ||\n      $(element).attr('disabled') !== undefined\n    );\n  }\n\n  /**\n   * 是否是桌面设备\n   */\n  private isDesktop(): boolean {\n    return $window.width() > 1024;\n  }\n\n  /**\n   * 设置 Tooltip 的位置\n   */\n  private setPosition(): void {\n    let marginLeft: number;\n    let marginTop: number;\n\n    // 触发的元素\n    const targetProps = this.$target[0].getBoundingClientRect();\n\n    // 触发的元素和 Tooltip 之间的距离\n    const targetMargin = this.isDesktop() ? 14 : 24;\n\n    // Tooltip 的宽度和高度\n    const tooltipWidth = this.$element[0].offsetWidth;\n    const tooltipHeight = this.$element[0].offsetHeight;\n\n    // Tooltip 的方向\n    let position: POSITION = this.options.position!;\n\n    // 自动判断位置，加 2px，使 Tooltip 距离窗口边框至少有 2px 的间距\n    if (position === 'auto') {\n      if (\n        targetProps.top +\n          targetProps.height +\n          targetMargin +\n          tooltipHeight +\n          2 <\n        $window.height()\n      ) {\n        position = 'bottom';\n      } else if (targetMargin + tooltipHeight + 2 < targetProps.top) {\n        position = 'top';\n      } else if (targetMargin + tooltipWidth + 2 < targetProps.left) {\n        position = 'left';\n      } else if (\n        targetProps.width + targetMargin + tooltipWidth + 2 <\n        $window.width() - targetProps.left\n      ) {\n        position = 'right';\n      } else {\n        position = 'bottom';\n      }\n    }\n\n    // 设置位置\n    switch (position) {\n      case 'bottom':\n        marginLeft = -1 * (tooltipWidth / 2);\n        marginTop = targetProps.height / 2 + targetMargin;\n        this.$element.transformOrigin('top center');\n        break;\n\n      case 'top':\n        marginLeft = -1 * (tooltipWidth / 2);\n        marginTop =\n          -1 * (tooltipHeight + targetProps.height / 2 + targetMargin);\n        this.$element.transformOrigin('bottom center');\n        break;\n\n      case 'left':\n        marginLeft = -1 * (tooltipWidth + targetProps.width / 2 + targetMargin);\n        marginTop = -1 * (tooltipHeight / 2);\n        this.$element.transformOrigin('center right');\n        break;\n\n      case 'right':\n        marginLeft = targetProps.width / 2 + targetMargin;\n        marginTop = -1 * (tooltipHeight / 2);\n        this.$element.transformOrigin('center left');\n        break;\n    }\n\n    const targetOffset = this.$target.offset();\n\n    this.$element.css({\n      top: `${targetOffset.top + targetProps.height / 2}px`,\n      left: `${targetOffset.left + targetProps.width / 2}px`,\n      'margin-left': `${marginLeft}px`,\n      'margin-top': `${marginTop}px`,\n    });\n  }\n\n  /**\n   * 触发组件事件\n   * @param name\n   */\n  private triggerEvent(name: EVENT): void {\n    componentEvent(name, 'tooltip', this.$target, this);\n  }\n\n  /**\n   * 动画结束回调\n   */\n  private transitionEnd(): void {\n    if (this.$element.hasClass('mdui-tooltip-open')) {\n      this.state = 'opened';\n      this.triggerEvent('opened');\n    } else {\n      this.state = 'closed';\n      this.triggerEvent('closed');\n    }\n  }\n\n  /**\n   * 当前 tooltip 是否为打开状态\n   */\n  private isOpen(): boolean {\n    return this.state === 'opening' || this.state === 'opened';\n  }\n\n  /**\n   * 执行打开 tooltip\n   */\n  private doOpen(): void {\n    this.state = 'opening';\n    this.triggerEvent('open');\n\n    this.$element\n      .addClass('mdui-tooltip-open')\n      .transitionEnd(() => this.transitionEnd());\n  }\n\n  /**\n   * 打开 Tooltip\n   * @param options 允许每次打开时设置不同的参数\n   */\n  public open(options?: OPTIONS): void {\n    if (this.isOpen()) {\n      return;\n    }\n\n    const oldOptions = extend({}, this.options);\n\n    if (options) {\n      extend(this.options, options);\n    }\n\n    // tooltip 的内容有更新\n    if (oldOptions.content !== this.options.content) {\n      this.$element.html(this.options.content);\n    }\n\n    this.setPosition();\n\n    if (this.options.delay) {\n      this.timeoutId = setTimeout(() => this.doOpen(), this.options.delay);\n    } else {\n      this.timeoutId = null;\n      this.doOpen();\n    }\n  }\n\n  /**\n   * 关闭 Tooltip\n   */\n  public close(): void {\n    if (this.timeoutId) {\n      clearTimeout(this.timeoutId);\n      this.timeoutId = null;\n    }\n\n    if (!this.isOpen()) {\n      return;\n    }\n\n    this.state = 'closing';\n    this.triggerEvent('close');\n\n    this.$element\n      .removeClass('mdui-tooltip-open')\n      .transitionEnd(() => this.transitionEnd());\n  }\n\n  /**\n   * 切换 Tooltip 的打开状态\n   */\n  public toggle(): void {\n    this.isOpen() ? this.close() : this.open();\n  }\n\n  /**\n   * 获取 Tooltip 状态。共包含四种状态：`opening`、`opened`、`closing`、`closed`\n   */\n  public getState(): STATE {\n    return this.state;\n  }\n}\n\nmdui.Tooltip = Tooltip;\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/on';\nimport mdui from '../../mdui';\nimport { $document } from '../../utils/dom';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-tooltip';\nconst dataName = '_mdui_tooltip';\n\n$(() => {\n  // mouseenter 不能冒泡，所以这里用 mouseover 代替\n  $document.on('touchstart mouseover', `[${customAttr}]`, function () {\n    const $target = $(this);\n    let instance = $target.data(dataName);\n\n    if (!instance) {\n      instance = new mdui.Tooltip(\n        this as HTMLElement,\n        parseOptions(this as HTMLElement, customAttr),\n      );\n      $target.data(dataName, instance);\n    }\n  });\n});\n","import $ from 'mdui.jq/es/$';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/appendTo';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/off';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/parents';\nimport 'mdui.jq/es/methods/remove';\nimport { isString } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport '../../jq_extends/methods/reflow';\nimport '../../jq_extends/methods/transform';\nimport '../../jq_extends/methods/transitionEnd';\nimport { $document } from '../../utils/dom';\nimport { dequeue, queue } from '../../utils/queue';\nimport { startEvent } from '../../utils/touchHandler';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 打开一个 Snackbar\n     * @param message Snackbar 的文本\n     * @param options 配置参数\n     */\n    snackbar(message: string, options?: OPTIONS): Snackbar;\n\n    /**\n     * 打开一个 Snackbar\n     * @param options 配置参数\n     */\n    snackbar(options: OPTIONS): Snackbar;\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * Snackbar 的文本。通过 `mdui.snackbar(options)` 调用时，该参数不能为空\n   */\n  message?: string;\n\n  /**\n   * 在用户没有操作时多长时间自动隐藏，单位（毫秒）。为 `0` 时表示不自动关闭，默认为 `4000`\n   */\n  timeout?: number;\n\n  /**\n   * Snackbar 的位置，默认为 `bottom`。\n   * 取值范围包括：\n   *   `bottom`: 下方\n   *   `top`: 上方\n   *   `left-top`: 左上角\n   *   `left-bottom`: 左下角\n   *   `right-top`: 右上角\n   *   `right-bottom`: 右下角\n   */\n  position?:\n    | 'bottom'\n    | 'top'\n    | 'left-top'\n    | 'left-bottom'\n    | 'right-top'\n    | 'right-bottom';\n\n  /**\n   * 按钮的文本\n   */\n  buttonText?: string;\n\n  /**\n   * 按钮的文本颜色，可以是颜色名或颜色值，如 `red`、`#ffffff`、`rgba(255, 255, 255, 0.3)` 等。默认为 `#90CAF9`\n   */\n  buttonColor?: string;\n\n  /**\n   * 点击按钮时是否关闭 Snackbar，默认为 `true`\n   */\n  closeOnButtonClick?: boolean;\n\n  /**\n   * 点击或触摸 Snackbar 以外的区域时是否关闭 Snackbar，默认为 `true`\n   */\n  closeOnOutsideClick?: boolean;\n\n  /**\n   * 在 Snackbar 上点击的回调函数，参数为 Snackbar 的实例\n   */\n  onClick?: (snackbar: Snackbar) => void;\n\n  /**\n   * 点击 Snackbar 上的按钮时的回调函数，参数为 Snackbar 的实例\n   */\n  onButtonClick?: (snackbar: Snackbar) => void;\n\n  /**\n   * Snackbar 开始打开时的回调函数，参数为 Snackbar 的实例\n   */\n  onOpen?: (snackbar: Snackbar) => void;\n\n  /**\n   * Snackbar 打开后的回调函数，参数为 Snackbar 的实例\n   */\n  onOpened?: (snackbar: Snackbar) => void;\n\n  /**\n   * Snackbar 开始关闭时的回调函数，参数为 Snackbar 的实例\n   */\n  onClose?: (snackbar: Snackbar) => void;\n\n  /**\n   * Snackbar 关闭后的回调函数，参数为 Snackbar 的实例\n   */\n  onClosed?: (snackbar: Snackbar) => void;\n};\n\ntype STATE = 'opening' | 'opened' | 'closing' | 'closed';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  message: '',\n  timeout: 4000,\n  position: 'bottom',\n  buttonText: '',\n  buttonColor: '',\n  closeOnButtonClick: true,\n  closeOnOutsideClick: true,\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onClick: () => {},\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onButtonClick: () => {},\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onOpen: () => {},\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onOpened: () => {},\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onClose: () => {},\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onClosed: () => {},\n};\n\n/**\n * 当前打开着的 Snackbar\n */\nlet currentInst: null | Snackbar = null;\n\n/**\n * 队列名\n */\nconst queueName = '_mdui_snackbar';\n\nclass Snackbar {\n  /**\n   * Snackbar 元素\n   */\n  public $element: JQ;\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * 当前 Snackbar 的状态\n   */\n  private state: STATE = 'closed';\n\n  /**\n   * setTimeout 的 ID\n   */\n  private timeoutId: any = null;\n\n  public constructor(options: OPTIONS) {\n    extend(this.options, options);\n\n    // 按钮颜色\n    let buttonColorStyle = '';\n    let buttonColorClass = '';\n\n    if (\n      this.options.buttonColor!.indexOf('#') === 0 ||\n      this.options.buttonColor!.indexOf('rgb') === 0\n    ) {\n      buttonColorStyle = `style=\"color:${this.options.buttonColor}\"`;\n    } else if (this.options.buttonColor !== '') {\n      buttonColorClass = `mdui-text-color-${this.options.buttonColor}`;\n    }\n\n    // 添加 HTML\n    this.$element = $(\n      '<div class=\"mdui-snackbar\">' +\n        `<div class=\"mdui-snackbar-text\">${this.options.message}</div>` +\n        (this.options.buttonText\n          ? `<a href=\"javascript:void(0)\" class=\"mdui-snackbar-action mdui-btn mdui-ripple mdui-ripple-white ${buttonColorClass}\" ${buttonColorStyle}>${this.options.buttonText}</a>`\n          : '') +\n        '</div>',\n    ).appendTo(document.body);\n\n    // 设置位置\n    this.setPosition('close');\n\n    this.$element.reflow().addClass(`mdui-snackbar-${this.options.position}`);\n  }\n\n  /**\n   * 点击 Snackbar 外面的区域关闭\n   * @param event\n   */\n  private closeOnOutsideClick(event: Event): void {\n    const $target = $(event.target as HTMLElement);\n\n    if (\n      !$target.hasClass('mdui-snackbar') &&\n      !$target.parents('.mdui-snackbar').length\n    ) {\n      currentInst!.close();\n    }\n  }\n\n  /**\n   * 设置 Snackbar 的位置\n   * @param state\n   */\n  private setPosition(state: 'open' | 'close'): void {\n    const snackbarHeight = this.$element[0].clientHeight;\n    const position = this.options.position;\n\n    let translateX;\n    let translateY;\n\n    // translateX\n    if (position === 'bottom' || position === 'top') {\n      translateX = '-50%';\n    } else {\n      translateX = '0';\n    }\n\n    // translateY\n    if (state === 'open') {\n      translateY = '0';\n    } else {\n      if (position === 'bottom') {\n        translateY = snackbarHeight;\n      }\n\n      if (position === 'top') {\n        translateY = -snackbarHeight;\n      }\n\n      if (position === 'left-top' || position === 'right-top') {\n        translateY = -snackbarHeight - 24;\n      }\n\n      if (position === 'left-bottom' || position === 'right-bottom') {\n        translateY = snackbarHeight + 24;\n      }\n    }\n\n    this.$element.transform(`translate(${translateX},${translateY}px`);\n  }\n\n  /**\n   * 打开 Snackbar\n   */\n  public open(): void {\n    if (this.state === 'opening' || this.state === 'opened') {\n      return;\n    }\n\n    // 如果当前有正在显示的 Snackbar，则先加入队列，等旧 Snackbar 关闭后再打开\n    if (currentInst) {\n      queue(queueName, () => this.open());\n      return;\n    }\n\n    currentInst = this;\n\n    // 开始打开\n    this.state = 'opening';\n    this.options.onOpen!(this);\n\n    this.setPosition('open');\n\n    this.$element.transitionEnd(() => {\n      if (this.state !== 'opening') {\n        return;\n      }\n\n      this.state = 'opened';\n      this.options.onOpened!(this);\n\n      // 有按钮时绑定事件\n      if (this.options.buttonText) {\n        this.$element.find('.mdui-snackbar-action').on('click', () => {\n          this.options.onButtonClick!(this);\n          if (this.options.closeOnButtonClick) {\n            this.close();\n          }\n        });\n      }\n\n      // 点击 snackbar 的事件\n      this.$element.on('click', (event) => {\n        if (!$(event.target as HTMLElement).hasClass('mdui-snackbar-action')) {\n          this.options.onClick!(this);\n        }\n      });\n\n      // 点击 Snackbar 外面的区域关闭\n      if (this.options.closeOnOutsideClick) {\n        $document.on(startEvent, this.closeOnOutsideClick);\n      }\n\n      // 超时后自动关闭\n      if (this.options.timeout) {\n        this.timeoutId = setTimeout(() => this.close(), this.options.timeout);\n      }\n    });\n  }\n\n  /**\n   * 关闭 Snackbar\n   */\n  public close(): void {\n    if (this.state === 'closing' || this.state === 'closed') {\n      return;\n    }\n\n    if (this.timeoutId) {\n      clearTimeout(this.timeoutId);\n    }\n\n    if (this.options.closeOnOutsideClick) {\n      $document.off(startEvent, this.closeOnOutsideClick);\n    }\n\n    this.state = 'closing';\n    this.options.onClose!(this);\n\n    this.setPosition('close');\n\n    this.$element.transitionEnd(() => {\n      if (this.state !== 'closing') {\n        return;\n      }\n\n      currentInst = null;\n      this.state = 'closed';\n      this.options.onClosed!(this);\n      this.$element.remove();\n      dequeue(queueName);\n    });\n  }\n}\n\nmdui.snackbar = function (message: any, options: any = {}): Snackbar {\n  if (isString(message)) {\n    options.message = message;\n  } else {\n    options = message;\n  }\n\n  const instance = new Snackbar(options);\n\n  instance.open();\n\n  return instance;\n};\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/children';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/is';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/parent';\nimport 'mdui.jq/es/methods/removeClass';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $document } from '../../utils/dom';\nimport '../headroom';\n\n$(() => {\n  // 切换导航项\n  $document.on('click', '.mdui-bottom-nav>a', function () {\n    const $item = $(this as HTMLElement);\n    const $bottomNav = $item.parent();\n\n    $bottomNav.children('a').each((index, item) => {\n      const isThis = $item.is(item);\n\n      if (isThis) {\n        componentEvent('change', 'bottomNav', $bottomNav[0], undefined, {\n          index,\n        });\n      }\n\n      isThis\n        ? $(item).addClass('mdui-bottom-nav-active')\n        : $(item).removeClass('mdui-bottom-nav-active');\n    });\n  });\n\n  // 滚动时隐藏 mdui-bottom-nav-scroll-hide\n  mdui.mutation('.mdui-bottom-nav-scroll-hide', function () {\n    new mdui.Headroom(this, {\n      pinnedClass: 'mdui-headroom-pinned-down',\n      unpinnedClass: 'mdui-headroom-unpinned-down',\n    });\n  });\n});\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/html';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport { isUndefined } from 'mdui.jq/es/utils';\nimport mdui from '../../mdui';\nimport '../../global/mutation';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * 如果需要修改已有的圆形进度条组件，需要调用该方法来重新初始化组件。\n     *\n     * 若传入了参数，则只重新初始化该参数对应的圆形进度条。若没有传入参数，则重新初始化所有圆形进度条。\n     * @param selector CSS 选择器、或 DOM 元素、或 DOM 元素组成的数组、或 JQ 对象\n     */\n    updateSpinners(\n      selector?: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    ): void;\n  }\n}\n\n/**\n * layer 的 HTML 结构\n * @param index\n */\nfunction layerHTML(index: number | false = false): string {\n  return (\n    `<div class=\"mdui-spinner-layer ${\n      index ? `mdui-spinner-layer-${index}` : ''\n    }\">` +\n    '<div class=\"mdui-spinner-circle-clipper mdui-spinner-left\">' +\n    '<div class=\"mdui-spinner-circle\"></div>' +\n    '</div>' +\n    '<div class=\"mdui-spinner-gap-patch\">' +\n    '<div class=\"mdui-spinner-circle\"></div>' +\n    '</div>' +\n    '<div class=\"mdui-spinner-circle-clipper mdui-spinner-right\">' +\n    '<div class=\"mdui-spinner-circle\"></div>' +\n    '</div>' +\n    '</div>'\n  );\n}\n\n/**\n * 填充 HTML\n * @param spinner\n */\nfunction fillHTML(spinner: HTMLElement): void {\n  const $spinner = $(spinner);\n\n  const layer = $spinner.hasClass('mdui-spinner-colorful')\n    ? layerHTML(1) + layerHTML(2) + layerHTML(3) + layerHTML(4)\n    : layerHTML();\n\n  $spinner.html(layer);\n}\n\n$(() => {\n  // 页面加载完后自动填充 HTML 结构\n  mdui.mutation('.mdui-spinner', function () {\n    fillHTML(this);\n  });\n});\n\nmdui.updateSpinners = function (\n  selector?: Selector | HTMLElement | ArrayLike<HTMLElement>,\n): void {\n  const $elements = isUndefined(selector) ? $('.mdui-spinner') : $(selector);\n\n  $elements.each(function () {\n    fillHTML(this);\n  });\n};\n","import $ from 'mdui.jq/es/$';\nimport contains from 'mdui.jq/es/functions/contains';\nimport extend from 'mdui.jq/es/functions/extend';\nimport { JQ } from 'mdui.jq/es/JQ';\nimport 'mdui.jq/es/methods/addClass';\nimport 'mdui.jq/es/methods/attr';\nimport 'mdui.jq/es/methods/children';\nimport 'mdui.jq/es/methods/css';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/each';\nimport 'mdui.jq/es/methods/find';\nimport 'mdui.jq/es/methods/first';\nimport 'mdui.jq/es/methods/hasClass';\nimport 'mdui.jq/es/methods/height';\nimport 'mdui.jq/es/methods/is';\nimport 'mdui.jq/es/methods/on';\nimport 'mdui.jq/es/methods/parent';\nimport 'mdui.jq/es/methods/parents';\nimport 'mdui.jq/es/methods/removeClass';\nimport 'mdui.jq/es/methods/width';\nimport Selector from 'mdui.jq/es/types/Selector';\nimport mdui from '../../mdui';\nimport '../../jq_extends/methods/transformOrigin';\nimport '../../jq_extends/methods/transitionEnd';\nimport '../../jq_extends/static/throttle';\nimport { componentEvent } from '../../utils/componentEvent';\nimport { $document, $window } from '../../utils/dom';\n\ndeclare module '../../interfaces/MduiStatic' {\n  interface MduiStatic {\n    /**\n     * Menu 组件\n     *\n     * 请通过 `new mdui.Menu()` 调用\n     */\n    Menu: {\n      /**\n       * 实例化 Menu 组件\n       * @param anchorSelector 触发菜单的元素的 CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param menuSelector 菜单的 CSS 选择器、或 DOM 元素、或 JQ 对象\n       * @param options 配置参数\n       */\n      new (\n        anchorSelector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        menuSelector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n        options?: OPTIONS,\n      ): Menu;\n    };\n  }\n}\n\ntype OPTIONS = {\n  /**\n   * 菜单相对于触发它的元素的位置，默认为 `auto`。\n   * 取值范围包括：\n   *   `top`: 菜单在触发它的元素的上方\n   *   `bottom`: 菜单在触发它的元素的下方\n   *   `center`: 菜单在窗口中垂直居中\n   *   `auto`: 自动判断位置。优先级为：`bottom` > `top` > `center`\n   */\n  position?: 'auto' | 'top' | 'bottom' | 'center';\n\n  /**\n   * 菜单与触发它的元素的对其方式，默认为 `auto`。\n   * 取值范围包括：\n   *   `left`: 菜单与触发它的元素左对齐\n   *   `right`: 菜单与触发它的元素右对齐\n   *   `center`: 菜单在窗口中水平居中\n   *   `auto`: 自动判断位置：优先级为：`left` > `right` > `center`\n   */\n  align?: 'auto' | 'left' | 'right' | 'center';\n\n  /**\n   * 菜单与窗口边框至少保持多少间距，单位为 px，默认为 `16`\n   */\n  gutter?: number;\n\n  /**\n   * 菜单的定位方式，默认为 `false`。\n   * 为 `true` 时，菜单使用 fixed 定位。在页面滚动时，菜单将保持在窗口固定位置，不随滚动条滚动。\n   * 为 `false` 时，菜单使用 absolute 定位。在页面滚动时，菜单将随着页面一起滚动。\n   */\n  fixed?: boolean;\n\n  /**\n   * 菜单是否覆盖在触发它的元素的上面，默认为 `auto`\n   * 为 `true` 时，使菜单覆盖在触发它的元素的上面\n   * 为 `false` 时，使菜单不覆盖触发它的元素\n   * 为 `auto` 时，简单菜单覆盖触发它的元素。级联菜单不覆盖触发它的元素\n   */\n  covered?: boolean | 'auto';\n\n  /**\n   * 子菜单的触发方式，默认为 `hover`\n   * 为 `click` 时，点击时触发子菜单\n   * 为 `hover` 时，鼠标悬浮时触发子菜单\n   */\n  subMenuTrigger?: 'click' | 'hover';\n\n  /**\n   * 子菜单的触发延迟时间（单位：毫秒），只有在 `subMenuTrigger: hover` 时，这个参数才有效，默认为 `200`\n   */\n  subMenuDelay?: number;\n};\n\ntype EVENT = 'open' | 'opened' | 'close' | 'closed';\ntype STATE = 'opening' | 'opened' | 'closing' | 'closed';\n\nconst DEFAULT_OPTIONS: OPTIONS = {\n  position: 'auto',\n  align: 'auto',\n  gutter: 16,\n  fixed: false,\n  covered: 'auto',\n  subMenuTrigger: 'hover',\n  subMenuDelay: 200,\n};\n\nclass Menu {\n  /**\n   * 触发菜单的元素的 JQ 对象\n   */\n  public $anchor: JQ;\n\n  /**\n   * 菜单元素的 JQ 对象\n   */\n  public $element: JQ;\n\n  /**\n   * 配置参数\n   */\n  public options: OPTIONS = extend({}, DEFAULT_OPTIONS);\n\n  /**\n   * 当前菜单状态\n   */\n  private state: STATE = 'closed';\n\n  /**\n   * 是否是级联菜单\n   */\n  private isCascade: boolean;\n\n  /**\n   * 菜单是否覆盖在触发它的元素的上面\n   */\n  private isCovered: boolean;\n\n  public constructor(\n    anchorSelector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    menuSelector: Selector | HTMLElement | ArrayLike<HTMLElement>,\n    options: OPTIONS = {},\n  ) {\n    this.$anchor = $(anchorSelector).first();\n    this.$element = $(menuSelector).first();\n\n    // 触发菜单的元素 和 菜单必须是同级的元素，否则菜单可能不能定位\n    if (!this.$anchor.parent().is(this.$element.parent())) {\n      throw new Error('anchorSelector and menuSelector must be siblings');\n    }\n\n    extend(this.options, options);\n\n    // 是否是级联菜单\n    this.isCascade = this.$element.hasClass('mdui-menu-cascade');\n\n    // covered 参数处理\n    this.isCovered =\n      this.options.covered === 'auto' ? !this.isCascade : this.options.covered!;\n\n    // 点击触发菜单切换\n    this.$anchor.on('click', () => this.toggle());\n\n    // 点击菜单外面区域关闭菜单\n    $document.on('click touchstart', (event: Event) => {\n      const $target = $(event.target as HTMLElement);\n\n      if (\n        this.isOpen() &&\n        !$target.is(this.$element) &&\n        !contains(this.$element[0], $target[0]) &&\n        !$target.is(this.$anchor) &&\n        !contains(this.$anchor[0], $target[0])\n      ) {\n        this.close();\n      }\n    });\n\n    // 点击不含子菜单的菜单条目关闭菜单\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const that = this;\n    $document.on('click', '.mdui-menu-item', function () {\n      const $item = $(this);\n\n      if (\n        !$item.find('.mdui-menu').length &&\n        $item.attr('disabled') === undefined\n      ) {\n        that.close();\n      }\n    });\n\n    // 绑定点击或鼠标移入含子菜单的条目的事件\n    this.bindSubMenuEvent();\n\n    // 窗口大小变化时，重新调整菜单位置\n    $window.on(\n      'resize',\n      $.throttle(() => this.readjust(), 100),\n    );\n  }\n\n  /**\n   * 是否为打开状态\n   */\n  private isOpen(): boolean {\n    return this.state === 'opening' || this.state === 'opened';\n  }\n\n  /**\n   * 触发组件事件\n   * @param name\n   */\n  private triggerEvent(name: EVENT): void {\n    componentEvent(name, 'menu', this.$element, this);\n  }\n\n  /**\n   * 调整主菜单位置\n   */\n  private readjust(): void {\n    let menuLeft;\n    let menuTop;\n\n    // 菜单位置和方向\n    let position: 'bottom' | 'top' | 'center';\n    let align: 'left' | 'right' | 'center';\n\n    // window 窗口的宽度和高度\n    const windowHeight = $window.height();\n    const windowWidth = $window.width();\n\n    // 配置参数\n    const gutter = this.options.gutter!;\n    const isCovered = this.isCovered;\n    const isFixed = this.options.fixed;\n\n    // 动画方向参数\n    let transformOriginX;\n    let transformOriginY;\n\n    // 菜单的原始宽度和高度\n    const menuWidth = this.$element.width();\n    const menuHeight = this.$element.height();\n\n    // 触发菜单的元素在窗口中的位置\n    const anchorRect = this.$anchor[0].getBoundingClientRect();\n    const anchorTop = anchorRect.top;\n    const anchorLeft = anchorRect.left;\n    const anchorHeight = anchorRect.height;\n    const anchorWidth = anchorRect.width;\n    const anchorBottom = windowHeight - anchorTop - anchorHeight;\n    const anchorRight = windowWidth - anchorLeft - anchorWidth;\n\n    // 触发元素相对其拥有定位属性的父元素的位置\n    const anchorOffsetTop = this.$anchor[0].offsetTop;\n    const anchorOffsetLeft = this.$anchor[0].offsetLeft;\n\n    // 自动判断菜单位置\n    if (this.options.position === 'auto') {\n      if (anchorBottom + (isCovered ? anchorHeight : 0) > menuHeight + gutter) {\n        // 判断下方是否放得下菜单\n        position = 'bottom';\n      } else if (\n        anchorTop + (isCovered ? anchorHeight : 0) >\n        menuHeight + gutter\n      ) {\n        // 判断上方是否放得下菜单\n        position = 'top';\n      } else {\n        // 上下都放不下，居中显示\n        position = 'center';\n      }\n    } else {\n      position = this.options.position!;\n    }\n\n    // 自动判断菜单对齐方式\n    if (this.options.align === 'auto') {\n      if (anchorRight + anchorWidth > menuWidth + gutter) {\n        // 判断右侧是否放得下菜单\n        align = 'left';\n      } else if (anchorLeft + anchorWidth > menuWidth + gutter) {\n        // 判断左侧是否放得下菜单\n        align = 'right';\n      } else {\n        // 左右都放不下，居中显示\n        align = 'center';\n      }\n    } else {\n      align = this.options.align!;\n    }\n\n    // 设置菜单位置\n    if (position === 'bottom') {\n      transformOriginY = '0';\n      menuTop =\n        (isCovered ? 0 : anchorHeight) +\n        (isFixed ? anchorTop : anchorOffsetTop);\n    } else if (position === 'top') {\n      transformOriginY = '100%';\n      menuTop =\n        (isCovered ? anchorHeight : 0) +\n        (isFixed ? anchorTop - menuHeight : anchorOffsetTop - menuHeight);\n    } else {\n      transformOriginY = '50%';\n\n      // =====================在窗口中居中\n      // 显示的菜单的高度，简单菜单高度不超过窗口高度，若超过了则在菜单内部显示滚动条\n      // 级联菜单内部不允许出现滚动条\n      let menuHeightTemp = menuHeight;\n\n      // 简单菜单比窗口高时，限制菜单高度\n      if (!this.isCascade) {\n        if (menuHeight + gutter * 2 > windowHeight) {\n          menuHeightTemp = windowHeight - gutter * 2;\n          this.$element.height(menuHeightTemp);\n        }\n      }\n\n      menuTop =\n        (windowHeight - menuHeightTemp) / 2 +\n        (isFixed ? 0 : anchorOffsetTop - anchorTop);\n    }\n\n    this.$element.css('top', `${menuTop}px`);\n\n    // 设置菜单对齐方式\n    if (align === 'left') {\n      transformOriginX = '0';\n      menuLeft = isFixed ? anchorLeft : anchorOffsetLeft;\n    } else if (align === 'right') {\n      transformOriginX = '100%';\n      menuLeft = isFixed\n        ? anchorLeft + anchorWidth - menuWidth\n        : anchorOffsetLeft + anchorWidth - menuWidth;\n    } else {\n      transformOriginX = '50%';\n\n      //=======================在窗口中居中\n      // 显示的菜单的宽度，菜单宽度不能超过窗口宽度\n      let menuWidthTemp = menuWidth;\n\n      // 菜单比窗口宽，限制菜单宽度\n      if (menuWidth + gutter * 2 > windowWidth) {\n        menuWidthTemp = windowWidth - gutter * 2;\n        this.$element.width(menuWidthTemp);\n      }\n\n      menuLeft =\n        (windowWidth - menuWidthTemp) / 2 +\n        (isFixed ? 0 : anchorOffsetLeft - anchorLeft);\n    }\n\n    this.$element.css('left', `${menuLeft}px`);\n\n    // 设置菜单动画方向\n    this.$element.transformOrigin(`${transformOriginX} ${transformOriginY}`);\n  }\n\n  /**\n   * 调整子菜单的位置\n   * @param $submenu\n   */\n  private readjustSubmenu($submenu: JQ): void {\n    const $item = $submenu.parent('.mdui-menu-item');\n\n    let submenuTop;\n    let submenuLeft;\n\n    // 子菜单位置和方向\n    let position: 'top' | 'bottom';\n    let align: 'left' | 'right';\n\n    // window 窗口的宽度和高度\n    const windowHeight = $window.height();\n    const windowWidth = $window.width();\n\n    // 动画方向参数\n    let transformOriginX;\n    let transformOriginY;\n\n    // 子菜单的原始宽度和高度\n    const submenuWidth = $submenu.width();\n    const submenuHeight = $submenu.height();\n\n    // 触发子菜单的菜单项的宽度高度\n    const itemRect = $item[0].getBoundingClientRect();\n    const itemWidth = itemRect.width;\n    const itemHeight = itemRect.height;\n    const itemLeft = itemRect.left;\n    const itemTop = itemRect.top;\n\n    // 判断菜单上下位置\n    if (windowHeight - itemTop > submenuHeight) {\n      // 判断下方是否放得下菜单\n      position = 'bottom';\n    } else if (itemTop + itemHeight > submenuHeight) {\n      // 判断上方是否放得下菜单\n      position = 'top';\n    } else {\n      // 默认放在下方\n      position = 'bottom';\n    }\n\n    // 判断菜单左右位置\n    if (windowWidth - itemLeft - itemWidth > submenuWidth) {\n      // 判断右侧是否放得下菜单\n      align = 'left';\n    } else if (itemLeft > submenuWidth) {\n      // 判断左侧是否放得下菜单\n      align = 'right';\n    } else {\n      // 默认放在右侧\n      align = 'left';\n    }\n\n    // 设置菜单位置\n    if (position === 'bottom') {\n      transformOriginY = '0';\n      submenuTop = '0';\n    } else if (position === 'top') {\n      transformOriginY = '100%';\n      submenuTop = -submenuHeight + itemHeight;\n    }\n\n    $submenu.css('top', `${submenuTop}px`);\n\n    // 设置菜单对齐方式\n    if (align === 'left') {\n      transformOriginX = '0';\n      submenuLeft = itemWidth;\n    } else if (align === 'right') {\n      transformOriginX = '100%';\n      submenuLeft = -submenuWidth;\n    }\n\n    $submenu.css('left', `${submenuLeft}px`);\n\n    // 设置菜单动画方向\n    $submenu.transformOrigin(`${transformOriginX} ${transformOriginY}`);\n  }\n\n  /**\n   * 打开子菜单\n   * @param $submenu\n   */\n  private openSubMenu($submenu: JQ): void {\n    this.readjustSubmenu($submenu);\n\n    $submenu\n      .addClass('mdui-menu-open')\n      .parent('.mdui-menu-item')\n      .addClass('mdui-menu-item-active');\n  }\n\n  /**\n   * 关闭子菜单，及其嵌套的子菜单\n   * @param $submenu\n   */\n  private closeSubMenu($submenu: JQ): void {\n    // 关闭子菜单\n    $submenu\n      .removeClass('mdui-menu-open')\n      .addClass('mdui-menu-closing')\n      .transitionEnd(() => $submenu.removeClass('mdui-menu-closing'))\n\n      // 移除激活状态的样式\n      .parent('.mdui-menu-item')\n      .removeClass('mdui-menu-item-active');\n\n    // 循环关闭嵌套的子菜单\n    $submenu.find('.mdui-menu').each((_, menu) => {\n      const $subSubmenu = $(menu);\n\n      $subSubmenu\n        .removeClass('mdui-menu-open')\n        .addClass('mdui-menu-closing')\n        .transitionEnd(() => $subSubmenu.removeClass('mdui-menu-closing'))\n        .parent('.mdui-menu-item')\n        .removeClass('mdui-menu-item-active');\n    });\n  }\n\n  /**\n   * 切换子菜单状态\n   * @param $submenu\n   */\n  private toggleSubMenu($submenu: JQ): void {\n    $submenu.hasClass('mdui-menu-open')\n      ? this.closeSubMenu($submenu)\n      : this.openSubMenu($submenu);\n  }\n\n  /**\n   * 绑定子菜单事件\n   */\n  private bindSubMenuEvent(): void {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const that = this;\n\n    // 点击打开子菜单\n    this.$element.on('click', '.mdui-menu-item', function (event) {\n      const $item = $(this as HTMLElement);\n      const $target = $(event.target as HTMLElement);\n\n      // 禁用状态菜单不操作\n      if ($item.attr('disabled') !== undefined) {\n        return;\n      }\n\n      // 没有点击在子菜单的菜单项上时，不操作（点在了子菜单的空白区域、或分隔线上）\n      if ($target.is('.mdui-menu') || $target.is('.mdui-divider')) {\n        return;\n      }\n\n      // 阻止冒泡，点击菜单项时只在最后一级的 mdui-menu-item 上生效，不向上冒泡\n      if (!$target.parents('.mdui-menu-item').first().is($item)) {\n        return;\n      }\n\n      // 当前菜单的子菜单\n      const $submenu = $item.children('.mdui-menu');\n\n      // 先关闭除当前子菜单外的所有同级子菜单\n      $item\n        .parent('.mdui-menu')\n        .children('.mdui-menu-item')\n        .each((_, item) => {\n          const $tmpSubmenu = $(item).children('.mdui-menu');\n\n          if (\n            $tmpSubmenu.length &&\n            (!$submenu.length || !$tmpSubmenu.is($submenu))\n          ) {\n            that.closeSubMenu($tmpSubmenu);\n          }\n        });\n\n      // 切换当前子菜单\n      if ($submenu.length) {\n        that.toggleSubMenu($submenu);\n      }\n    });\n\n    if (this.options.subMenuTrigger === 'hover') {\n      // 临时存储 setTimeout 对象\n      let timeout: any = null;\n      let timeoutOpen: any = null;\n\n      this.$element.on('mouseover mouseout', '.mdui-menu-item', function (\n        event,\n      ) {\n        const $item = $(this as HTMLElement);\n        const eventType = event.type;\n        const $relatedTarget = $(\n          (event as MouseEvent).relatedTarget as HTMLElement,\n        );\n\n        // 禁用状态的菜单不操作\n        if ($item.attr('disabled') !== undefined) {\n          return;\n        }\n\n        // 用 mouseover 模拟 mouseenter\n        if (eventType === 'mouseover') {\n          if (\n            !$item.is($relatedTarget) &&\n            contains($item[0], $relatedTarget[0])\n          ) {\n            return;\n          }\n        }\n\n        // 用 mouseout 模拟 mouseleave\n        else if (eventType === 'mouseout') {\n          if (\n            $item.is($relatedTarget) ||\n            contains($item[0], $relatedTarget[0])\n          ) {\n            return;\n          }\n        }\n\n        // 当前菜单项下的子菜单，未必存在\n        const $submenu = $item.children('.mdui-menu');\n\n        // 鼠标移入菜单项时，显示菜单项下的子菜单\n        if (eventType === 'mouseover') {\n          if ($submenu.length) {\n            // 当前子菜单准备打开时，如果当前子菜单正准备着关闭，不用再关闭了\n            const tmpClose = $submenu.data('timeoutClose.mdui.menu');\n            if (tmpClose) {\n              clearTimeout(tmpClose);\n            }\n\n            // 如果当前子菜单已经打开，不操作\n            if ($submenu.hasClass('mdui-menu-open')) {\n              return;\n            }\n\n            // 当前子菜单准备打开时，其他准备打开的子菜单不用再打开了\n            clearTimeout(timeoutOpen);\n\n            // 准备打开当前子菜单\n            timeout = timeoutOpen = setTimeout(\n              () => that.openSubMenu($submenu),\n              that.options.subMenuDelay,\n            );\n\n            $submenu.data('timeoutOpen.mdui.menu', timeout);\n          }\n        }\n\n        // 鼠标移出菜单项时，关闭菜单项下的子菜单\n        else if (eventType === 'mouseout') {\n          if ($submenu.length) {\n            // 鼠标移出菜单项时，如果当前菜单项下的子菜单正准备打开，不用再打开了\n            const tmpOpen = $submenu.data('timeoutOpen.mdui.menu');\n            if (tmpOpen) {\n              clearTimeout(tmpOpen);\n            }\n\n            // 准备关闭当前子菜单\n            timeout = setTimeout(\n              () => that.closeSubMenu($submenu),\n              that.options.subMenuDelay,\n            );\n\n            $submenu.data('timeoutClose.mdui.menu', timeout);\n          }\n        }\n      });\n    }\n  }\n\n  /**\n   * 动画结束回调\n   */\n  private transitionEnd(): void {\n    this.$element.removeClass('mdui-menu-closing');\n\n    if (this.state === 'opening') {\n      this.state = 'opened';\n      this.triggerEvent('opened');\n    }\n\n    if (this.state === 'closing') {\n      this.state = 'closed';\n      this.triggerEvent('closed');\n\n      // 关闭后，恢复菜单样式到默认状态，并恢复 fixed 定位\n      this.$element.css({\n        top: '',\n        left: '',\n        width: '',\n        position: 'fixed',\n      });\n    }\n  }\n\n  /**\n   * 切换菜单状态\n   */\n  public toggle(): void {\n    this.isOpen() ? this.close() : this.open();\n  }\n\n  /**\n   * 打开菜单\n   */\n  public open(): void {\n    if (this.isOpen()) {\n      return;\n    }\n\n    this.state = 'opening';\n    this.triggerEvent('open');\n\n    this.readjust();\n\n    this.$element\n      // 菜单隐藏状态使用使用 fixed 定位。\n      .css('position', this.options.fixed ? 'fixed' : 'absolute')\n      .addClass('mdui-menu-open')\n      .transitionEnd(() => this.transitionEnd());\n  }\n\n  /**\n   * 关闭菜单\n   */\n  public close(): void {\n    if (!this.isOpen()) {\n      return;\n    }\n\n    this.state = 'closing';\n    this.triggerEvent('close');\n\n    // 菜单开始关闭时，关闭所有子菜单\n    this.$element.find('.mdui-menu').each((_, submenu) => {\n      this.closeSubMenu($(submenu));\n    });\n\n    this.$element\n      .removeClass('mdui-menu-open')\n      .addClass('mdui-menu-closing')\n      .transitionEnd(() => this.transitionEnd());\n  }\n}\n\nmdui.Menu = Menu;\n","import $ from 'mdui.jq/es/$';\nimport 'mdui.jq/es/methods/data';\nimport 'mdui.jq/es/methods/on';\nimport mdui from '../../mdui';\nimport { $document } from '../../utils/dom';\nimport { parseOptions } from '../../utils/parseOptions';\nimport './index';\n\nconst customAttr = 'mdui-menu';\nconst dataName = '_mdui_menu';\n\ntype OPTIONS = {\n  target: string;\n  position?: 'auto' | 'top' | 'bottom' | 'center';\n  align?: 'auto' | 'left' | 'right' | 'center';\n  gutter?: number;\n  fixed?: boolean;\n  covered?: boolean | 'auto';\n  subMenuTrigger?: 'click' | 'hover';\n  subMenuDelay?: number;\n};\n\n$(() => {\n  $document.on('click', `[${customAttr}]`, function () {\n    const $this = $(this as HTMLElement);\n    let instance = $this.data(dataName);\n\n    if (!instance) {\n      const options = parseOptions(this as HTMLElement, customAttr) as OPTIONS;\n      const menuSelector = options.target;\n      // @ts-ignore\n      delete options.target;\n\n      instance = new mdui.Menu($this, menuSelector, options);\n      $this.data(dataName, instance);\n\n      instance.toggle();\n    }\n  });\n});\n"]}]}